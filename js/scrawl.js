const t={},e=[],i={},n=[],s={},r=[],o={},a=[],l={},c=[],h={},u=[],d={},f=[],p={},g=[],m={},y=[],b={},S=[],A={},C=[],k={},v=[],P={},O={},x=[],D={},w=[],F={},R=[],T={},E=[],H={},I=[],L={},B=[],$={};function M(h=""){const u=function(t,e,i=!1){t.forEach((t=>{const n=e[t];n&&n.kill&&n.kill(i)}))};if(h){u(a.filter((t=>0===t.indexOf(h))),o);u(c.filter((t=>0===t.indexOf(h))),l);u(v.filter((t=>0===t.indexOf(h))),k,!0);u(B.filter((t=>0===t.indexOf(h))),L);u(I.filter((t=>0===t.indexOf(h))),H);u(n.filter((t=>0===t.indexOf(h))),i);u(r.filter((t=>0===t.indexOf(h))),s);u(S.filter((t=>0===t.indexOf(h))),b);u(e.filter((t=>0===t.indexOf(h))),t);u(x.filter((t=>0===t.indexOf(h))),O);u(w.filter((t=>0===t.indexOf(h))),D);u(R.filter((t=>0===t.indexOf(h))),F)}}function X(t=""){const e=`100px ${t}`;return C.includes(e)}function Y(t=""){const e=`100px ${t}`;return C.includes(e)?A[e]:null}function G(t=""){return a.includes(t)?o[t]:null}function N(t=""){return c.includes(t)?l[t]:null}function z(t=""){return y.includes(t)?m[t]:null}function j(t=""){return u.includes(t)?h[t]:null}function V(t=""){return B.includes(t)?L[t]:null}function W(t=""){return I.includes(t)?H[t]:null}function U(t=""){return B.includes(t)?L[t]:f.includes(t)?d[t]:null}function Z(t=""){return f.includes(t)?d[t]:null}function K(t=""){return S.includes(t)?b[t]:null}function _(t=""){return v.includes(t)?k[t]:null}function q(t=""){return E.includes(t)?T[t]:null}function Q(t=""){return g.includes(t)?p[t]:null}const J={};var tt=Object.freeze({__proto__:null,anchor:t,anchornames:e,animation:i,animationnames:n,animationtickers:s,animationtickersnames:r,artefact:o,artefactnames:a,asset:l,assetnames:c,canvas:h,canvasnames:u,cell:d,cellnames:f,checkFontIsLoaded:X,constructors:J,element:p,elementnames:g,entity:m,entitynames:y,filter:b,filternames:S,findArtefact:G,findAsset:N,findCanvas:j,findCell:Z,findElement:Q,findEntity:z,findFilter:K,findGroup:_,findPattern:U,findStack:q,findStyles:V,findTween:W,fontfamilymetadata:A,fontfamilymetadatanames:C,force:O,forcenames:x,getFontMetadata:Y,group:k,groupnames:v,palette:{},palettenames:[],particle:P,particlenames:[],purge:M,spring:D,springnames:w,stack:T,stacknames:E,styles:L,stylesnames:B,tween:H,tweennames:I,unstackedelement:$,unstackedelementnames:[],version:"8.14.0",world:F,worldnames:R});const et=Math.abs,it=Object.assign,nt=Math.atan2,st=Math.ceil,rt=window.getComputedStyle,ot=Math.cos,at=Object.create,lt=Object.entries,ct=Math.floor,ht=Math.hypot,ut=Array.isArray,dt=Number.isFinite,ft=Object.keys,pt=Math.max,gt=Math.min,mt=Date.now,yt=JSON.parse,bt=2*Math.PI,St=.5*Math.PI,At=Math.pow,Ct=Math.PI/180,kt=Math.random,vt=Math.round,Pt=Object.setPrototypeOf,Ot=Math.sin,xt=Math.sqrt,Dt=.016,wt=Object.values,Ft="BODY",Rt="image_",Tt="video_",Et="2d",Ht="absolute",It=["Canvas","Stack"],Lt="addEventListener",Bt="alpha-to-channels",$t="alpha-to-luminance",Mt="alphabetic",Xt="anchor",Yt="animation",Gt="anonymous",Nt="area-alpha",zt=",",jt="aria-hidden",Vt="aria-live",Wt="asset",Ut=/.*\/(.*?)\./,Zt="auto",Kt="autofocus",_t="average-channels",qt="bezier",Qt="rgb(0 0 0 / 1)",Jt="black-white",te="rgb(0 0 0 / 0)",ee="blend",ie="block",ne="bluenoise",se="blur",re="blurAction",oe="border-box",ae="bottom",le="canvas",ce="center",he="channels-to-alpha",ue="chroma",de="clamp-channels",fe="clear",pe="click",ge="clickAction",me="close",ye="color",be="colors-to-alpha",Se="compose",Ae="control",Ce="coord",ke=["topLeft","topRight","bottomRight","bottomLeft"],ve='[data-scrawl-corner-div="sc"]',Pe="corrode",Oe="data-scrawl-group",xe="data-tab-order",De="12px sans-serif",we="any_random_string_will_do",Fe="description",Re="destination-out",Te="destination-over",Ee="dimensions",He="disabled",Ie="displace",Le="display-p3",Be="div",$e="down",Me="download",Xe="element",Ye="emboss",Ge="end",Ne="endControl",ze="enter",je="entity",Ve="euler",We="fill",Ue="filter",Ze="flood",Ke="focus",_e="focusAction",qe=["Label","EnhancedLabel"],Qe="form",Je="function",ti="gaussian-blur",ei="glitch",ii=["Cell","CellFragment"],ni="grayscale",si="green",ri="hanging",oi="height",ai="high",li="href",ci="hreflang",hi="ideographic",ui="img",di=["RGB","HSL","HWB","XYZ","LAB","LCH","OKLAB","OKLCH"],fi="invert-channels",pi="leave",gi="left",mi="lineDash",yi="linear",bi="lock-channels-to-levels",Si="ltr",Ai="luminance-to-alpha",Ci="map-to-gradient",ki="matrix",vi="mean",Pi="mimic",Oi="middle",xi="modify-ok-channels",Di="modulate-channels",wi="modulate-ok-channels",Fi="mouse",Ri="mousedown",Ti="mouseenter",Ei="mouseleave",Hi="mousemove",Ii="mouseup",Li="move",Bi="multiply",$i="name",Mi="negative",Xi="newsprint",Yi="none",Gi="normal",Ni="offset",zi="particle",ji="path",Vi="%",Wi="0%",Ui="100%",Zi="50%",Ki="ping",_i="pivot",qi="pixelate",Qi="pointerdown",Ji="pointerenter",tn="pointerleave",en="pointermove",nn="pointerup",sn="polite",rn="process-image",on="0px",an="quadratic",ln=["radiusX"],cn=["radiusX","radiusY"],hn=["radiusY"],un="random",dn="random-noise",fn="rect-grid",pn="rectangle",gn="red",mn="reduce-palette",yn="referrerpolicy",bn="rel",Sn="relative",An="removeEventListener",Cn="reverseByDelta",kn="RGB",vn="right",Pn="role",On="root",xn="rotate-hue",Dn="round",wn="set-channel-to-level",Fn="source",Rn="source-in",Tn="source-out",En="source-over",Hn=" ",In="srgb",Ln="start",Bn="startControl",$n=["direction","fillStyle","filter","font","fontKerning","fontStretch","fontVariantCaps","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","letterSpacing","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","textAlign","textBaseline","textRendering","wordSpacing"],Mn=["fillStyle","filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle"],Xn=["direction","font","fontKerning","fontStretch","fontVariantCaps","letterSpacing","textRendering","wordSpacing"],Yn="step-channels",Gn="styles",Nn="subscribe",zn="swirl",jn="Action",Vn="Bezier",Wn="Canvas",Un="Cell",Zn="Color",Kn="Coordinate",_n="EnhancedLabel",qn="Filter",Qn="Group",Jn="Image",ts="Label",es="Line",is="Palette",ns="Particle",ss="Picture",rs="Polyline",os="Quadratic",as="Quaternion",ls="RenderAnimation",cs="Sprite",hs="Stack",us="Ticker",ds="Tween",fs="Vector",ps="Video",gs="World",ms="tabOrder",ys="target",bs="threshold",Ss="tiles",As="tint-channels",Cs="top",ks="touchcancel",vs="touchend",Ps="touchmove",Os="touchstart",xs="true",Ds="tween",ws="type",Fs="undefined",Rs="unknown",Ts="up",Es="updateByDelta",Hs="user-defined-legacy",Is="value",Ls="vary-channels-by-weights",Bs="video",$s="rgb(255 255 255 / 1)",Ms="width",Xs="M0,0",Ys="",Gs=["ARTICLE","ASIDE","DIV","FOOTER","HEADER","MAIN","NAV","SECTION"],Ns=["ARTICLE","ASIDE","DIV","FOOTER","HEADER","MAIN","NAV","SECTION","ADDRESS","BLOCKQUOTE","DL","FIGURE","FORM","H1","H2","H3","H4","H5","H6","HGROUP","MENU","METER","OL","P","PRE","PROGRESS","SEARCH","SELECT","TABLE","TEXTAREA","UL","OUTPUT"],zs=["BASE","HEAD","LINK","META","STYLE","TITLE","BODY","DD","DT","FIGCAPTION","HR","LI","ABBR","B","BDI","BDO","BR","CITE","CODE","DATA","DFN","EM","I","KBD","MARK","Q","RP","RT","RUBY","S","SAMP","SMALL","SPAN","STRONG","SUB","SUP","TIME","U","VAR","WBR","AREA","MAP","TRACK","SOURCE","NOSCRIPT","SCRIPT","DEL","INS","CAPTION","COL","COLGROUP","TBODY","TD","TFOOT","TH","THEAD","TR","DATALIST","FIELDSET","LABEL","LEGEND","OPTGROUP","OPTION","SLOT","DIALOG","SUMMARY","TEMPLATE","ACRONYM","BIG","CENTER","CONTENT","DIR","FONT","FRAME","FRAMESET","IMAGE","MARQUEE","MENUITEM","NOBR","NOEMBED","NOFRAMES","PARAM","PLAINTEXT","RB","RTC","SHADOW","STRIKE","TT","XMP","ANIMATE","ANIMATEMOTION","ANIMATETRANSFORM","CIRCLE","CLIPPATH","CURSOR","DEFS","DESC","ELLIPSE","FEBLEND","FECOLORMATRIX","FECOMPONENTTRANSFER","FECOMPOSITE","FECONVOLVEMATRIX","FEDIFFUSELIGHTING","FEDISPLACEMENTMAP","FEDISTANTLIGHT","FEDROPSHADOW","FEFLOOD","FEFUNCA","FEFUNCB","FEFUNCG","FEFUNCR","FEGAUSSIANBLUR","FEIMAGE","FEMERGE","FEMERGENODE","FEMORPHOLOGY","FEOFFSET","FEPOINTLIGHT","FESPECULARLIGHTING","FESPOTLIGHT","FETILE","FETURBULENCE","FILTER","FONT-FACE-FORMAT","FONT-FACE-NAME","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE","FONT","FONT","FOREIGNOBJECT","G","GLYPH","GLYPHREF","HKERN","IMAGE","LINE","LINEARGRADIENT","MARKER","MASK","METADATA","MISSING-GLYPH","MPATH","PATH","PATTERN","POLYGON","POLYLINE","RADIALGRADIENT","RECT","SCRIPT","SET","STOP","STYLE","SWITCH","SYMBOL","TEXT","TEXTPATH","TREF","TSPAN","USE","VIEW","VKERN"],js=Math.PI,Vs="ms",Ws=(t,e)=>{if(null!=e){gi===t||Cs===t?t=Wi:vn===t||ae===t?t=Ui:ce===t&&(t=Zi);const i=!(!t.substring&&!e.substring);return lr(t)?t+=lr(e)?e:parseFloat(e):t=parseFloat(t)+(lr(e)?e:parseFloat(e)),i?t+Vi:t}return t},Us=function(t,e,i){return t<e?e:t>i?i:t},Zs=t=>{if(lr(t))return[Vs,t];if(t.substring){const e=t.match(/^\d+\.?\d*(\D*)/);let i=e[1].toLowerCase?e[1].toLowerCase():Vs,n=parseFloat(t);if(dt(n)){switch(i){case"s":n*=1e3;break;case"%":break;default:i=Vs}return[i,n]}return[Vs,0]}},Ks=t=>dt(t)?((t%=360)<0&&(t+=360),t):0,_s=t=>{if(dt(t)){if(t<-1e-6)return t;if(t>1e-6)return t}return 0},qs=()=>{},Qs=function(t){return t},Js=function(){return new Error("Clone functionality is not supported for this object")},tr={},er=()=>{function t(){return ct(65536*(1+kt())).toString(16).substring(1)}return`${t()}${t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`},ir=()=>performance.now().toString(36)+kt().toString(36).substr(2),nr=function(t,e,i){return e+t*(i-e)},sr=t=>"boolean"==typeof t,rr=t=>"[object HTMLCanvasElement]"===Object.prototype.toString.call(t),or=t=>!!(t&&t.querySelector&&t.dispatchEvent),ar=t=>typeof t===Je,lr=t=>!!dt(t),cr=t=>"[object Object]"===Object.prototype.toString.call(t),hr=t=>!(!t||!t.type||t.type!==as),ur=(t,e)=>{if(cr(t)&&cr(e))for(const i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},dr=(t,e)=>(cr(t)&&cr(e)&&lt(e).forEach((([i,n])=>{null==n?delete t[i]:t[i]=e[i]})),t),fr=(t,e)=>(ut(t)&&(ut(e)?e.forEach((e=>fr(t,e))):t.includes(e)||t.push(e)),t),pr=(t,e)=>{if(ut(t)){const i=t.indexOf(e);i>=0&&t.splice(i,1)}return t},gr=t=>typeof t!==Fs,mr=(...t)=>t.every((t=>typeof t!==Fs)),yr=(...t)=>t.find((t=>typeof t!==Fs)),br=(...t)=>!!t.find((t=>typeof t!==Fs)),Sr={out:t=>1-ot(t*js/2),in:t=>Ot(t*js/2),easeIn:t=>{const e=1-t;return 1-e*e},easeIn3:t=>{const e=1-t;return 1-e*e*e},easeIn4:t=>{const e=1-t;return 1-e*e*e*e},easeIn5:t=>{const e=1-t;return 1-e*e*e*e*e},easeOutIn:t=>t<.5?2*t*t:1-At(-2*t+2,2)/2,easeOutIn3:t=>t<.5?4*t*t*t:1-At(-2*t+2,3)/2,easeOutIn4:t=>t<.5?8*t*t*t*t:1-At(-2*t+2,4)/2,easeOutIn5:t=>t<.5?16*t*t*t*t*t:1-At(-2*t+2,5)/2,easeInOut:t=>{const e=.5-t;return t<.5?.5+-2*e*e:.5+At(2*(t-.5),2)/2},easeInOut3:t=>{const e=.5-t;return t<.5?.5+-4*e*e*e:.5+At(2*(t-.5),3)/2},easeInOut4:t=>{const e=.5-t;return t<.5?.5+-8*e*e*e*e:.5+At(2*(t-.5),4)/2},easeInOut5:t=>{const e=.5-t;return t<.5?.5+-16*e*e*e*e*e:.5+At(2*(t-.5),5)/2},easeOut:t=>t*t,easeOut3:t=>t*t*t,easeOut4:t=>t*t*t*t,easeOut5:t=>t*t*t*t*t,none:t=>t,linear:t=>t,cosine:t=>.5*(1+ot((1-t)*js)),hermite:t=>t*t*(2*-t+3),quintic:t=>t*t*t*(t*(6*t-15)+10),easeOutSine:t=>1-ot(t*js/2),easeInSine:t=>Ot(t*js/2),easeOutInSine:t=>-(ot(js*t)-1)/2,easeOutQuad:t=>t*t,easeInQuad:t=>1-(1-t)*(1-t),easeOutInQuad:t=>t<.5?2*t*t:1-At(-2*t+2,2)/2,easeOutCubic:t=>t*t*t,easeInCubic:t=>1-At(1-t,3),easeOutInCubic:t=>t<.5?4*t*t*t:1-At(-2*t+2,3)/2,easeOutQuart:t=>t*t*t*t,easeInQuart:t=>1-At(1-t,4),easeOutInQuart:t=>t<.5?8*t*t*t*t:1-At(-2*t+2,4)/2,easeOutQuint:t=>t*t*t*t*t,easeInQuint:t=>1-At(1-t,5),easeOutInQuint:t=>t<.5?16*t*t*t*t*t:1-At(-2*t+2,5)/2,easeOutExpo:t=>0===t?0:At(2,10*t-10),easeInExpo:t=>1===t?1:1-At(2,-10*t),easeOutInExpo:t=>0===t||1===t?t:t<.5?At(2,20*t-10)/2:(2-At(2,-20*t+10))/2,easeOutCirc:t=>1-xt(1-At(t,2)),easeInCirc:t=>xt(1-At(t-1,2)),easeOutInCirc:t=>t<.5?(1-xt(1-At(2*t,2)))/2:(xt(1-At(-2*t+2,2))+1)/2,easeOutBack:t=>2.70158*t*t*t-1.70158*t*t,easeInBack:t=>1+2.70158*At(t-1,3)+1.70158*At(t-1,2),easeOutInBack:t=>{const e=2.5949095;return t<.5?At(2*t,2)*(7.189819*t-e)/2:(At(2*t-2,2)*((e+1)*(2*t-2)+e)+2)/2},easeOutElastic:t=>{const e=2*js/3;return 0===t||1===t?t:-At(2,10*t-10)*Ot((10*t-10.75)*e)},easeInElastic:t=>{const e=2*js/3;return 0===t||1===t?t:At(2,-10*t)*Ot((10*t-.75)*e)+1},easeOutInElastic:t=>{const e=2*js/4.5;return 0===t||1===t?t:t<.5?-At(2,20*t-10)*Ot((20*t-11.125)*e)/2:At(2,-20*t+10)*Ot((20*t-11.125)*e)/2+1},easeOutBounce:t=>{const e=7.5625,i=2.75;return(t=1-t)<1/i?1-e*t*t:t<2/i?1-(e*(t-=1.5/i)*t+.75):t<2.5/i?1-(e*(t-=2.25/i)*t+.9375):1-(e*(t-=2.625/i)*t+.984375)},easeInBounce:t=>{const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeOutInBounce:t=>{const e=7.5625,i=2.75;let n;return t<.5?(n=(t=1-2*t)<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375,(1-n)/2):(n=(t=2*t-1)<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375,(1+n)/2)}},Ar=()=>at(Object.prototype);let Cr=!1;const kr=()=>Cr,vr=t=>Cr=t;let Pr=!1;const Or=()=>Pr,xr=t=>Pr=t;let Dr=!1;const wr=()=>Dr,Fr=t=>Dr=t;let Rr=!1;const Tr=()=>Rr,Er=t=>Rr=t;let Hr=!1;const Ir=()=>Hr,Lr=t=>Hr=t;let Br=!1;const $r=()=>Br,Mr=t=>Br=t;let Xr=!1;const Yr=()=>Xr,Gr=t=>Xr=t;let Nr=!1;const zr=()=>Nr,jr=t=>Nr=t;let Vr=!1;const Wr=()=>Vr,Ur=t=>Vr=t;let Zr=!1;const Kr=()=>Zr,_r=t=>Zr=t;let qr=!0;const Qr=t=>qr=t;let Jr=!1;const to=t=>Jr=t;let eo=!0;const io=t=>eo=t,no=function(){Pr=!0,Dr=!0},so="GenericArray",ro=function(){const t=[];return Pt(t,ro.prototype),t};J.GenericArray=ro;const oo=ro.prototype=at(Array.prototype);oo.constructor=ro,oo.type=so;const ao=[],lo=function(){return ao.length||ao.push(new ro),ao.shift()},co=function(...t){t.forEach((t=>{t&&t.type===so&&(t.length=0,ao.push(t),ao.length>20&&(console.log("purging genericArrayPool"),ao.length=10))}))},ho=[],uo=[],fo=t=>{fr(uo,t),Qr(!0)},po=t=>{pr(uo,t),Qr(!0)},go=t=>uo.includes(t),mo=()=>{qr&&(Qr(!1),(()=>{const t=lo();let e,n,s,r;for(s=0,r=uo.length;s<r;s++)e=i[uo[s]],e&&(n=ct(e.order)||0,t[n]||(t[n]=lo()),t[n].push(e));for(ho.length=0,s=0,r=t.length;s<r;s++)e=t[s],e&&(ho.push(...e),co(e));co(t)})());for(let t=0,e=ho.length;t<e;t++){const e=ho[t];if(e.chokedAnimation){const t=mt();e.lastRun+825/e.maxFrameRate<t&&(e.fn(),e.lastRun=t)}else e.fn()}Jr&&window.requestAnimationFrame(mo)},yo=()=>{to(!0),mo()},bo=()=>to(!1),So=function(t,e,i=tr){if(typeof window.IntersectionObserver===Je&&t&&t.run){const n=new IntersectionObserver((e=>{let i,n,s;for(i=0,n=e.length;i<n;i++)s=e[i],s.isIntersecting&&!t.isRunning()?t.run():!s.isIntersecting&&t.isRunning()&&t.halt()}),i);return e&&e.domElement&&n.observe(e.domElement),function(){n.disconnect()}}return qs},Ao=function(t,e,i){return t&&ar(e)&&i?(ko(t,e,i,An),ko(t,e,i,Lt),function(){Co(t,e,i)}):qs},Co=function(t,e,i){t&&ar(e)&&i&&ko(t,e,i,An)},ko=function(t,e,i,n){const s=lo(),r=lo();ut(t)?s.push(...t):s.push(t),i.substring?r.push(...document.body.querySelectorAll(i)):ut(i)?r.push(...i):r.push(i),navigator.pointerEnabled||navigator.msPointerEnabled?Po(s,e,r,n):vo(s,e,r,n),co(r,s)},vo=function(t,e,i,n){let s,r,o,a,l,c;for(s=0,r=t.length;s<r;s++)for(l=t[s],o=0,a=i.length;o<a;o++)if(c=i[o],or(c)||c.document||c.characterSet)switch(l){case Li:c[n](Hi,e,!1),c[n](Ps,e,{passive:!1}),c[n]("touchfollow",e,{passive:!1});break;case Ts:c[n](Ii,e,!1),c[n](vs,e,{passive:!1});break;case $e:c[n](Ri,e,!1),c[n](Os,e,{passive:!1});break;case pi:c[n](Ei,e,!1),c[n]("touchleave",e,{passive:!1});break;case ze:c[n](Ti,e,!1),c[n]("touchenter",e,{passive:!1})}},Po=function(t,e,i,n){let s,r,o,a,l,c;for(s=0,r=t.length;s<r;s++)for(l=t[s],o=0,a=i.length;o<a;o++)if(c=i[o],or(c)||c.document||c.characterSet)switch(l){case Li:c[n](en,e,!1);break;case Ts:c[n](nn,e,!1);break;case $e:c[n](Qi,e,!1);break;case pi:c[n](tn,e,!1);break;case ze:c[n](Ji,e,!1)}},Oo=function(t,e,i){return t&&ar(e)&&i?(Do(t,e,i,An),Do(t,e,i,Lt),function(){xo(t,e,i)}):qs},xo=function(t,e,i){t&&ar(e)&&i&&Do(t,e,i,An)},Do=function(t,e,i,n){const s=lo(),r=lo();let o,a,l,c,h,u;for(ut(t)?s.push(...t):s.push(t),i.substring?r.push(...document.body.querySelectorAll(i)):ut(i)?r.push(...i):r.push(i),o=0,a=s.length;o<a;o++)for(h=s[o],l=0,c=r.length;l<c;l++)u=r[l],(or(u)||u.document||u.characterSet)&&u[n](h,e,!1);co(r,s)},wo="~~~",Fo=["Image","Sprite","Video","Canvas","Stack"];function Ro(t=tr){t.defs={},t.getters={},t.setters={},t.deltaSetters={},t.get=function(t){let e,i;if(gr(t)){if(i=this.getters[t],i)return i.call(this);{const i=this.defs[t];if(typeof i!==Fs)return e=this[t],typeof e!==Fs?e:i}}return null},t.set=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==$i&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Fs&&(this[i]=n))}return this},t.setDelta=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.deltaSetters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==$i&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Fs&&(this[i]=Ws(this[i],n)))}return this};t.defs=ur(t.defs,{name:""});const e=t.getters;e.type=function(){return this.type},e.isArtefact=function(){return this.isArtefact},e.isAsset=function(){return this.isAsset},t.packetExclusions=[],t.packetExclusionsByRegex=[],t.packetCoordinates=[],t.packetObjects=[],t.packetFunctions=[],t.saveAsPacket=function(t=tr){sr(t)&&t&&(t={includeDefaults:!0});const e=this.defs,i=ft(e),n=this.packetExclusions,s=this.packetExclusionsByRegex,r=this.packetCoordinates,o=this.packetObjects,a=this.packetFunctions;let l=t.includeDefaults||!1,c={};return l&&!ut(l)?l=ft(e):l||(l=[]),lt(this).forEach((([t,e])=>{let h,u=!0;if(i.includes(t)||(u=!1),u&&n.includes(t)&&(u=!1),u&&(h=s.some((e=>new RegExp(e).test(t))),h&&(u=!1)),u)if(a.includes(t)){if(gr(e)&&null!=e){const i=this.stringifyFunction(e);i&&i.length&&(c[t]=i)}}else o.includes(t)&&this[t]&&this[t].name?c[t]=this[t].name:r.includes(t)?(l.includes(t)||e[0]||e[1])&&(c[t]=e):(h=this.processPacketOut(t,e,l),h&&(c[t]=e))}),this),c=this.finalizePacketOut(c,t),JSON.stringify([this.name,this.type,this.lib,c])},t.stringifyFunction=function(t){const e=t.toString().match(/\(([\s\S]*?)\)[\s\S]*?\{([\s\S]*)\}/),i=e[1],n=e[2];return!!mr(i,n)&&`${i}${wo}${n}`},t.processPacketOut=function(t,e,i){let n=!0;return i.includes(t)||e!==this.defs[t]||(n=!1),n},t.finalizePacketOut=function(t){return t},t.importPacket=function(t){const e=this,i=function(t){return new Promise(((i,n)=>{let s;t.substring||n(new Error("Packet url supplied for import is not a string")),"["===t[0]?(s=e.actionPacket(t),s&&s.lib?i(s):n(s)):t.includes('"name":')?n(new Error("Bad packet supplied for import")):fetch(t).then((t=>{if(!t.ok)throw new Error(`Packet import from server failed - ${t.status}: ${t.statusText} - ${t.url}`);return t.text()})).then((t=>{if(s=e.actionPacket(t),!s||!s.lib)throw s;i(s)})).catch((t=>n(t)))}))};if(ut(t)){const e=[];return t.forEach((t=>e.push(i(t)))),new Promise(((t,i)=>{Promise.all(e).then((e=>t(e))).catch((t=>i(t)))}))}if(t.substring)return i(t);Promise.reject(new Error("Argument supplied for packet import is not a string or array of strings"))},t.actionPacket=function(t){try{if(t&&t.substring){if("["===t[0]){let e,i,n,s;try{[e,i,n,s]=yt(t)}catch(t){throw new Error(`Failed to process packet due to JSON parsing error - ${t.message}`)}if(mr(e,i,n,s)){if(Fo.includes(i))throw new Error("Failed to process packet - Stacks, Canvases and visual assets are excluded from the packet system");let t=tt[n][e];if(t)t.set(s);else{if(s.outerHTML&&s.host){const t=document.querySelector(`#${s.host}`);if(t){const i=document.createElement("div");i.innerHTML=s.outerHTML;const n=i.firstElementChild;n&&(n.id=e,t.appendChild(n),s.domElement=n)}}if(t=new J[i](s),!t)throw new Error("Failed to create Scrawl-canvas object from supplied packet")}if(t.packetFunctions.forEach((e=>this.actionPacketFunctions(t,e))),s.anchor&&t.anchor&&t.anchor.packetFunctions.forEach((e=>{t.anchor[e]=s.anchor[e],this.actionPacketFunctions(t.anchor,e),t.anchor.build()})),s.button&&t.button&&t.button.packetFunctions.forEach((e=>{t.button[e]=s.button[e],this.actionPacketFunctions(t.button,e),t.button.build()})),t)return t;throw new Error("Failed to process supplied packet")}throw new Error("Failed to process packet - JSON string holds incomplete data")}throw new Error("Failed to process packet - JSON string does not represent an array")}throw new Error("Failed to process packet - not a JSON string")}catch(t){return console.log(t),t}},t.actionPacketFunctions=function(t,e){const i=t[e];if(gr(i)&&null!=i&&i.substring)if(i===wo)t[e]=qs;else{let n,s,r;[n,s]=i.split(wo),n=n.split(zt),n=n.map((t=>t.trim())),s.includes("[native code]")?t[e]=qs:(r=new Function(...n,s),t[e]=r.bind(t))}},t.clone=function(t=tr){const e=this.name;let i,n,s,r;this.name=t.name||Ys,t.useNewTicker?(n=this.ticker,this.ticker=null,i=this.saveAsPacket(),this.ticker=n):(this.anchor&&(s=this.anchor,this.anchor=null),this.button&&(r=this.button,this.button=null),i=this.saveAsPacket(),s&&(this.anchor=s),r&&(this.button=r)),this.name=e;let o=this.actionPacket(i);return this.packetFunctions.forEach((t=>{this[t]&&(o[t]=this[t])})),o=this.postCloneAction(o,t),o.set(t),o},t.postCloneAction=function(t){return t},t.kill=function(){return this.deregister()},t.makeName=function(t){return t&&t.substring&&!tt[`${this.lib}names`].includes(t)?this.name=t:this.name=ir(),this},t.register=function(){if(!gr(this.name))throw new Error(`core/base error - register() name not set: ${this}`);const t=tt[`${this.lib}names`],e=tt[this.lib];return this.isArtefact&&(fr(a,this.name),o[this.name]=this),this.isAsset&&(fr(c,this.name),l[this.name]=this),fr(t,this.name),e[this.name]=this,this},t.deregister=function(){if(!gr(this.name))throw new Error(`core/base error - deregister() name not set: ${this}`);const t=tt[`${this.lib}names`],e=tt[this.lib];return this.isArtefact&&(pr(a,this.name),delete o[this.name]),this.isAsset&&(pr(c,this.name),delete l[this.name]),pr(t,this.name),delete e[this.name],this}}const Animation=function(t=tr){return this.makeName(t.name),this.order=gr(t.order)?t.order:this.defs.order,this.fn=t.fn||qs,this.onRun=t.onRun||qs,this.onHalt=t.onHalt||qs,this.onKill=t.onKill||qs,this.maxFrameRate=t.maxFrameRate||60,this.lastRun=0,this.chokedAnimation=!0,this.register(),t.delay||this.run(),this},To=Animation.prototype=Ar();To.type="Animation",To.lib=Yt,To.isArtefact=!1,To.isAsset=!1,Ro(To);To.defs=ur(To.defs,{order:1,maxFrameRate:60,fn:null,onRun:null,onHalt:null,onKill:null}),To.stringifyFunction=qs,To.processPacketOut=qs,To.finalizePacketOut=qs,To.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},To.clone=Js,To.run=function(){return this.onRun(),fo(this.name),setTimeout((()=>no()),20),this},To.isRunning=function(){return go(this.name)},To.halt=function(){return this.onHalt(),po(this.name),this},To.kill=function(){return this.onKill(),po(this.name),this.deregister(),!0};const Eo=function(t){return!!t&&new Animation(t)};J.Animation=Animation;const Ho="change",Io="touch",Lo=[],Bo={x:0,y:0,scrollX:0,scrollY:0,w:0,h:0,type:Fi,prefersReducedMotion:!1,prefersDarkColorScheme:!1,prefersReduceTransparency:!1,prefersContrast:!1,prefersReduceData:!1,prefersInvertedColors:!1,prefersForcedColors:!1,displaySupportsP3Color:!1,canvasSupportsP3Color:!1,devicePixelRatio:0,rawTouches:[]},$o=window.matchMedia("(prefers-contrast: more)");$o.addEventListener(Ho,(()=>{const t=$o.matches;Bo.prefersContrast!==t&&(Bo.prefersContrast=t,Er(!0))})),Bo.prefersContrast=$o.matches;const Mo=window.matchMedia("(prefers-reduced-motion: reduce)");Mo.addEventListener(Ho,(()=>{const t=Mo.matches;Bo.prefersReducedMotion!==t&&(Bo.prefersReducedMotion=t,Lr(!0))})),Bo.prefersReducedMotion=Mo.matches;const Xo=window.matchMedia("(prefers-color-scheme: dark)");Xo.addEventListener(Ho,(()=>{const t=Xo.matches;Bo.prefersDarkColorScheme!==t&&(Bo.prefersDarkColorScheme=t,Mr(!0))})),Bo.prefersDarkColorScheme=Xo.matches;const Yo=window.matchMedia("(prefers-reduced-transparency: reduce)");Yo.addEventListener(Ho,(()=>{const t=Yo.matches;Bo.prefersReduceTransparency!==t&&(Bo.prefersReduceTransparency=t,Gr(!0))})),Bo.prefersReduceTransparency=Yo.matches;const Go=window.matchMedia("(prefers-reduced-data: reduce)");Go.addEventListener(Ho,(()=>{const t=Go.matches;Bo.prefersReduceData!==t&&(Bo.prefersReduceData=t,jr(!0))})),Bo.prefersReduceData=Go.matches;const No=window.matchMedia("(inverted-colors: inverted)");No.addEventListener(Ho,(()=>{const t=No.matches;Bo.prefersInvertedColors!==t&&(Bo.prefersInvertedColors=t,_r(!0))})),Bo.prefersInvertedColors=No.matches;const zo=window.matchMedia("(forced-colors: active)");zo.addEventListener(Ho,(()=>{const t=zo.matches;Bo.prefersForcedColors!==t&&(Bo.prefersForcedColors=t,Ur(!0))})),Bo.prefersForcedColors=zo.matches;const jo=window.matchMedia("(color-gamut: p3)");jo.addEventListener(Ho,(()=>{const t=jo.matches;Bo.displaySupportsP3Color!==t&&(Bo.displaySupportsP3Color=t)})),Bo.displaySupportsP3Color=jo.matches;Bo.canvasSupportsP3Color=(()=>{const t=document.createElement("canvas");try{return t.getContext("2d",{colorSpace:Le}).getContextAttributes().colorSpace===Le}catch{console.log("checkCanvasSupportsDisplayP3 errored")}return!1})();const Vo=()=>Bo.devicePixelRatio;let Wo=!1;const Uo=()=>Wo,Zo=t=>Wo=t;let Ko=qs;const _o=t=>Ko=t,qo=()=>{const t=window.devicePixelRatio;Bo.devicePixelRatio=t,wt(h).forEach((t=>t.dirtyDimensions=!0)),wt(d).forEach((t=>t.dirtyDimensions=!0)),wt(m).forEach((t=>t.dirtyHost=!0)),Wo||Ko(),matchMedia(`(resolution: ${t}dppx)`).addEventListener(Ho,qo,{once:!0})};qo();const Qo=function(){const t=document.documentElement.clientWidth,e=document.documentElement.clientHeight;Bo.w===t&&Bo.h===e||(Bo.w=t,Bo.h=e,xr(!0),Fr(!0))},Jo=function(){const t=window.pageXOffset,e=window.pageYOffset;Bo.scrollX===t&&Bo.scrollY===e||(Bo.x+=t-Bo.scrollX,Bo.y+=e-Bo.scrollY,Bo.scrollX=t,Bo.scrollY=e,xr(!0))},ta=function(t){const e=vt(t.pageX),i=vt(t.pageY);Bo.x===e&&Bo.y===i||(Bo.type=navigator.pointerEnabled?"pointer":Fi,Bo.x=e,Bo.y=i,xr(!0))};let ea=0,ia=16;const na=function(){return ia},sa=function(t){dt(t)&&(ia=t)},ra=function(t,e=!0){if(Bo.rawTouches.length=0,t.touches&&t.touches.length){Bo.rawTouches.push(...t.touches);const e=t.touches[0],i=vt(e.pageX),n=vt(e.pageY);Bo.x===i&&Bo.y===n||(Bo.type=Io,Bo.x=i,Bo.y=n)}else Bo.type=Io,e&&(Bo.x=0,Bo.y=0);const i=mt();i>ea+ia&&(ea=i,oa())},oa=function(){for(let t=0,e=Lo.length;t<e;t++)aa(Lo[t])},aa=function(t){const e=o[t];if(e){const{here:t,domElement:i}=e;if(t.prefersContrast=Bo.prefersContrast,t.prefersReducedMotion=Bo.prefersReducedMotion,t.prefersDarkColorScheme=Bo.prefersDarkColorScheme,t.prefersReduceTransparency=Bo.prefersReduceTransparency,t.prefersReduceData=Bo.prefersReduceData,t.prefersInvertedColors=Bo.prefersInvertedColors,t.prefersForcedColors=Bo.prefersForcedColors,t.devicePixelRatio=Bo.devicePixelRatio,Tr()&&e.contrastActions(),Ir()&&e.reducedMotionActions(),$r()&&e.colorSchemeActions(),Yr()&&e.reducedTransparencyActions(),zr()&&e.reducedDataActions(),Kr()&&e.invertedColorsActions(),Wr()&&e.forcedColorsActions(),i){const n=i.getBoundingClientRect(),s=vt(n.left+window.pageXOffset),r=vt(n.top+window.pageYOffset),o=n.top,a=n.height,l=window.innerHeight;t.w=vt(n.width),t.h=vt(a),t.type=Bo.type;const c=o/l,h=(o+a)/l,u=(c+h)/2;t.inViewportTop=c,t.inViewportBase=h,t.inViewportCenter=u,e.localMouseListener?(t.localListener=!0,t.active=!1,t.normX=!!t.originalWidth&&t.x/t.originalWidth,t.normY=!!t.originalHeight&&t.y/t.originalHeight,t.offsetX=s,t.offsetY=r,t.x>e.activePadding&&t.x<t.originalWidth-e.activePadding&&t.y>0+e.activePadding&&t.y<t.originalHeight-e.activePadding&&(t.active=!0)):(t.localListener=!1,t.active=!0,t.x=vt(Bo.x-s),t.y=vt(Bo.y-r),t.normX=!!t.w&&t.x/t.w,t.normY=!!t.h&&t.y/t.h,t.offsetX=s,t.offsetY=r,(t.normX<0||t.normX>1||t.normY<0||t.normY>1)&&(t.active=!1));const d=Bo.rawTouches;if(t.touches||(t.touches=[]),d.length){t.touches.length=0;for(let e=0,i=d.length;e<i;e++){const i=d[e];t.touches.push([vt(i.pageX-s),vt(i.pageY-r)])}}if(e.type===Wn&&e.updateBaseHere(t,e.fit),e.checkForResize&&!e.dirtyDimensions&&!e.dirtyDomDimensions){const[i,n]=e.currentDimensions;if(e.type===Wn){const s=e.computedStyles,r=ct(t.w-parseFloat(s.borderLeftWidth)-parseFloat(s.borderRightWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)),o=ct(t.h-parseFloat(s.borderTopWidth)-parseFloat(s.borderBottomWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom));i===r&&n===o||e.set({dimensions:[r,o]})}else i===t.w&&n===t.h||e.set({dimensions:[t.w,t.h]})}}}},la=Eo({name:"SC-core-listeners-tracker",order:0,delay:!0,fn:function(){const t=kr(),e=Or(),i=wr(),n=Tr(),s=Ir(),r=$r(),o=Yr(),a=zr(),l=Kr(),c=Wr();(t&&e||s||n||r||o||a||l||c)&&oa(),t&&e&&xr(!1),n&&Er(!1),s&&Lr(!1),r&&Mr(!1),o&&Gr(!1),a&&jr(!1),l&&_r(!1),c&&Ur(!1),i&&(Fr(!1),wt(m).forEach((t=>{qe.includes(t.type)&&t.recalculateFont(!0)})))}}),ca=function(){ua(An),ua(Lt),vr(!0),xr(!0),la.run()},ha=function(){vr(!1),xr(!1),la.halt(),ua(An)},ua=function(t){navigator.pointerEnabled||navigator.msPointerEnabled?(window[t](en,ta,!1),window[t](nn,ta,!1),window[t](Qi,ta,!1),window[t](tn,ta,!1),window[t](Ji,ta,!1)):(window[t](Hi,ta,!1),window[t](Ii,ta,!1),window[t](Ri,ta,!1),window[t](Ei,ta,!1),window[t](Ti,ta,!1),window[t](Ps,ra,{passive:!0}),window[t](Os,ra,{passive:!0}),window[t](vs,ra,{passive:!0}),window[t](ks,ra,{passive:!0})),window[t]("scroll",Jo,{passive:!0}),window[t]("resize",Qo,!1)},da=function(){const{fontfamilymetadata:t,fontfamilymetadatanames:e}=tt;e.forEach((e=>delete t[e])),e.length=0},fa=t=>{const{canvasSupportsP3Color:e,displaySupportsP3Color:i}=Bo;return t&&e&&i?Le:In},pa=["bottom","boxSizing","display","height","left","perspective","perspectiveOrigin","position","right","top","transform","transformOrigin","width","zIndex"],ga=[];let ma=!1;const ya=function(t=Ys){if(ma||t){const e=lo();let i,n,s,r,a,l,c,h,u,d,f,p,g,m,y;t&&t.substring?e.push(t):(ma=!1,e.push(...ga),ga.length=0);const b=Uo(),S=Vo();for(i=0,n=e.length;i<n;i++)if(s=o[e[i]],s&&(r=s.domElement,r&&(s.dirtyClasses&&(s.dirtyClasses=!1,r.className.substring&&(r.className=s.classes)),a=r.style,a))){if(s.dirtyCss)for(s.dirtyCss=!1,p=s.css||tr,g=ft(p),d=0,f=g.length;d<f;d++)m=g[d],y=p[m],pa.includes(m)||(a[m]=y);s.dirtyPerspective&&(s.dirtyPerspective=!1,l=s.perspective,a.perspectiveOrigin=`${l.x} ${l.y}`,a.perspective=`${l.z}px`),s.dirtyPosition&&(s.dirtyPosition=!1,a.position=s.position),s.dirtyDomDimensions&&(s.dirtyDomDimensions=!1,c=s.currentDimensions,h=c[0],u=c[1],s.type===Wn?(b?(r.width=h,r.height=u):(s.ignoreCanvasCssDimensions||(a.width=`${h}px`,a.height=`${u}px`),r.width=h*S,r.height=u*S),s.renderOnResize&&s.render()):(a.width=`${h}px`,a.height=u?`${u}px`:Zt)),s.dirtyTransformOrigin&&(s.dirtyTransformOrigin=!1,a.transformOrigin=s.currentTransformOriginString),s.dirtyTransform&&(s.dirtyTransform=!1,a.transform=s.currentTransformString),s.dirtyVisibility&&(s.dirtyVisibility=!1,a.display=s.visibility?ie:Yi),s.dirtyStampOrder&&(s.dirtyStampOrder=!1,a.zIndex=s.stampOrder)}co(e)}},ba=(t=100)=>{setTimeout((()=>{y.forEach((t=>{const e=m[t];qe.includes(e.type)&&e.recalculateFont()}))}),t)},Sa=[],Aa=[],Ca=t=>{fr(Sa,t),io(!0)},ka=t=>{pr(Sa,t),io(!0)},va=()=>(eo&&Pa(),Aa),Pa=function(){io(!1);const t=lo();let e,i,n,s;for(n=0,s=Sa.length;n<s;n++)e=o[Sa[n]],e&&(i=ct(e.order)||0,t[i]||(t[i]=lo()),t[i].push(e.name));for(Aa.length=0,n=0,s=t.length;n<s;n++)e=t[n],e&&(Aa.push(...e),co(e));co(t)},Oa=["lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit"],xa=["filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality"],Da=["shadowBlur","shadowOffsetX","shadowOffsetY"],wa=["fillStyle","shadowColor","strokeStyle"],State=function(){return this.set(this.defs),this.lineDash=[],this},Fa=State.prototype=Ar();Fa.type="State",Ro(Fa),Fa.defs={fillStyle:Qt,strokeStyle:Qt,globalAlpha:1,globalCompositeOperation:En,lineWidth:1,lineCap:"butt",lineJoin:"miter",lineDash:null,lineDashOffset:0,miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:Qt,font:De,direction:Si,fontKerning:Gi,textRendering:Zt,letterSpacing:on,wordSpacing:on,fontStretch:Gi,fontVariantCaps:Gi,filter:Yi,imageSmoothingEnabled:!0,imageSmoothingQuality:ai,textAlign:gi,textBaseline:Cs},Fa.processPacketOut=function(t,e,i){let n=!0;if(t===mi)e.length||(n=!!i.includes(mi));else i.includes(t)||e!==this.defs[t]||(n=!1);return n},Fa.finalizePacketOut=function(t){const e=t.fillStyle,i=t.strokeStyle;return e&&!e.substring&&(t.fillStyle=e.name),i&&!i.substring&&(t.strokeStyle=i.name),t};const Ra=Fa.getters,Ta=Fa.setters;Ra.canvasFont=function(){return this.font},Ta.canvasFont=function(t){this.font=t},Fa.getChanges=function(t,e){let i,n,s,r,o,a,l,c,h;const u=this.defs,d={},f=function(t,e){return typeof t[e]!==Fs?t[e]:u[e]};for(t.substring&&(t=m[t]),s=0,r=xa.length;s<r;s++)i=xa[s],c=f(this,i),h=f(e,i),h!==c&&(d[i]=c);for(s=0,r=Da.length;s<r;s++)i=Da[s],c=f(this,i),h=f(e,i),t.scaleShadow?(n=(c||0)*(t.scale||1),n!==h&&(d[i]=n)):c!==h&&(d[i]=c);if(this.lineWidth||e.lineWidth)for(s=0,r=Oa.length;s<r;s++)if(i=Oa[s],c=f(this,i),h=f(e,i),i===mi){if(c.length||h.length)if(c.length!==h.length)d.lineDash=c;else{for(l=!1,o=0,a=c.length;o<a;o++)if(c[o]!==h[o]){l=!0;break}l&&(d.lineDash=c)}}else"lineWidth"===i?t.scaleOutline?(n=(c||1)*(t.scale||1),n!==h&&(d.lineWidth=n)):c!==h&&(d.lineWidth=c):h!==c&&(d[i]=c);for(s=0,r=wa.length;s<r;s++)i=wa[s],h=f(e,i),c=f(this,i),c.substring&&h!==c?d[i]=c:c.type===Zn?(c=c.getData(),h!==c&&(d[i]=c)):d[i]=c;if(qe.includes(t.type))for(s=0,r=Xn.length;s<r;s++)i=Xn[s],c=f(this,i),h=f(e,i),h!==c&&(d[i]=c);return d},Fa.setStateFromEngine=function(t){let e;for(let i=0,n=$n.length;i<n;i++)e=$n[i],this[e]=t[e];return this.lineDash=gr(t.lineDash)?t.lineDash:[],this.lineDashOffset=yr(t.lineDashOffset,0),t.textAlign=gi,this.textAlign=gi,t.textBaseline=Cs,this.textBaseline=Cs,this};const Ea=function(t){return!!t&&new State};J.State=State;var Ha=function(){var t=4022871197;return function(e){if(e){e=e.toString();for(var i=0;i<e.length;i++){var n=.02519603282416938*(t+=e.charCodeAt(i));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}t=4022871197}},Ia=function(t){return function(){var e,i,n=48,s=1,r=n,o=new Array(n),a=0,l=new Ha;for(e=0;e<n;e++)o[e]=l(Math.random());var c=function(){++r>=n&&(r=0);var t=1768863*o[r]+2.3283064365386963e-10*s;return o[r]=t-(s=0|t)},h=function(t){return Math.floor(t*(c()+11102230246251565e-32*(2097152*c()|0)))};h.string=function(t){var e,i="";for(e=0;e<t;e++)i+=String.fromCharCode(33+h(94));return i};return h.cleanString=function(t){return t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[\x00-\x1F]/gi,"")).replace(/\n /,"\n")},h.hashString=function(t){for(t=h.cleanString(t),l(t),e=0;e<t.length;e++)for(a=t.charCodeAt(e),i=0;i<n;i++)o[i]-=l(a),o[i]<0&&(o[i]+=1)},h.seed=function(t){var e,i,n,s;void 0!==t&&null!=t||(t=Math.random()),"string"!=typeof t&&(e=t,i=function(t,e){return"function"==typeof e?e.toString():e},t=JSON.stringify(e,function(t,e){var i=[],n=[];return null==e&&(e=function(t,e){return i[0]===e?"[Circular ~]":"[Circular ~."+n.slice(0,i.indexOf(e)).join(".")+"]"}),function(s,r){if(i.length>0){var o=i.indexOf(this);~o?i.splice(o+1):i.push(this),~o?n.splice(o,1/0,s):n.push(s),~i.indexOf(r)&&(r=e.call(this,s,r))}else i.push(r);return null==t?r:t.call(this,s,r)}}(i,s),n)),h.initState(),h.hashString(t)},h.addEntropy=function(){var t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);!function(){var t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++)for(i=0;i<n;i++)o[i]-=l(t[e]),o[i]<0&&(o[i]+=1)}(a+++(new Date).getTime()+t.join("")+Math.random())},h.initState=function(){for(l(),e=0;e<n;e++)o[e]=l(" ");s=1,r=n},h.done=function(){l=null},void 0!==t&&h.seed(t),h.range=function(t){return h(t)},h.random=function(){return h(Number.MAX_VALUE-1)/Number.MAX_VALUE},h.floatBetween=function(t,e){return h.random()*(e-t)+t},h.intBetween=function(t,e){return Math.floor(h.random()*(e-t+1))+t},h}()};const La=function(t){return new Ia(t)},Ba={},$a={};let Ma=1e3;const Xa=t=>{dt(t)&&t>=200&&t<=1e4&&(Ma=t)},Ya=t=>{dt(t)&&t>=200&&t<=1e4&&(Ma=t)},Ga=t=>!!Ba[t],Na=t=>Ba[t]?($a[t]=mt(),Ba[t]):null,za=(t,e)=>{Ba[t]=e,$a[t]=mt()},ja=function(t,e=[]){const i=mt();return Ba[t]?($a[t]=i,Ba[t]):(Ba[t]=e,$a[t]=i,Ba[t])};let Va=200,Wa=0;const Ua=t=>{dt(t)&&t>=10&&t<=5e3&&(Va=t)};Eo({name:"SC-core-workstore-hygeine",order:998,fn:()=>(()=>{const t=mt();if(Wa<t-Va){const e=ft(Ba),i=t-Ma;for(let t,n=0,s=e.length;n<s;n++)t=e[n],$a[t]<i&&(delete Ba[t],delete $a[t]);Wa=t}})()});const Za=["Gradient","RadialGradient","Pattern"];function Ka(t=tr){t.setEngineFromState=function(t){const e=this.state,i=$n.length;let n,s,r,o;for(n=0;n<i;n++)s=$n[n],r=t[s],o=e[s],s===mi?(t.lineDash=o,t.setLineDash(t.lineDash)):r!==o&&(t[s]=o);return t.textAlign!==gi&&(t.textAlign=gi),t.textBaseline!==Cs&&(t.textBaseline=Cs),this},t.setToDefaults=function(){const t=this.state.defs,e=this.state,i=this.engine;return lt(t).forEach((([t,n])=>{t===mi?(ut(i.lineDash)?i.lineDash.length=0:i.lineDash=[],ut(e.lineDash)?e.lineDash.length=0:e.lineDash=[]):(i[t]=n,e[t]=n)})),i.textAlign=e.textAlign=gi,i.textBaseline=e.textBaseline=Cs,this},t.setEngine=function(t){const e=this.state,i=t.state;if(i){const n=i.getChanges(t,e),s=this.setEngineActions;if(ft(n).length){const i=this.engine;for(const r in n)s[r](n[r],i,Za,t,this),e[r]=n[r]}}return t},t.setEngineActions={fillStyle:function(t,e,i,n,s){if(t.substring){let i=!1;B.includes(t)?i=L[t]:f.includes(t)&&(i=d[t]),i?(n.state.fillStyle=i,e.fillStyle=i.getData(n,s)):e.fillStyle=t}else e.fillStyle=t.getData(n,s)},filter:function(t,e){e.filter=t},font:function(t,e){e.font=t},globalAlpha:function(t,e){e.globalAlpha=t},globalCompositeOperation:function(t,e){e.globalCompositeOperation=t},imageSmoothingEnabled:function(t,e){e.imageSmoothingEnabled=t},imageSmoothingQuality:function(t,e){e.imageSmoothingQuality=t},lineCap:function(t,e){e.lineCap=t},lineDash:function(t,e){e.lineDash=t,e.setLineDash&&e.setLineDash(t)},lineDashOffset:function(t,e){e.lineDashOffset=t},lineJoin:function(t,e){e.lineJoin=t},lineWidth:function(t,e){e.lineWidth=t},miterLimit:function(t,e){e.miterLimit=t},shadowBlur:function(t,e){e.shadowBlur=t},shadowColor:function(t,e){e.shadowColor=t},shadowOffsetX:function(t,e){e.shadowOffsetX=t},shadowOffsetY:function(t,e){e.shadowOffsetY=t},strokeStyle:function(t,e,i,n,s){if(t.substring){let i=!1;B.includes(t)?i=L[t]:f.includes(t)&&(i=d[t]),i?(n.state.strokeStyle=i,e.strokeStyle=i.getData(n,s)):e.strokeStyle=t}else e.strokeStyle=t.getData(n,s)},direction:function(t,e){e.direction=t},fontKerning:function(t,e){e.fontKerning=t},fontStretch:function(t,e){e.fontStretch=t},fontVariantCaps:function(t,e){e.fontVariantCaps=t},letterSpacing:function(t,e){e.letterSpacing=t},textAlign:function(t,e){e.textAlign=gi},textBaseline:function(t,e){e.textBaseline=Cs},textRendering:function(t,e){e.textRendering=t},wordSpacing:function(t,e){e.wordSpacing=t}},t.clearShadow=function(){return this.engine.shadowOffsetX=0,this.engine.shadowOffsetY=0,this.engine.shadowBlur=0,this.state.shadowOffsetX=0,this.state.shadowOffsetY=0,this.state.shadowBlur=0,this},t.restoreShadow=function(t){const e=t.state;return this.engine.shadowOffsetX=e.shadowOffsetX,this.engine.shadowOffsetY=e.shadowOffsetY,this.engine.shadowBlur=e.shadowBlur,this.state.shadowOffsetX=e.shadowOffsetX,this.state.shadowOffsetY=e.shadowOffsetY,this.state.shadowBlur=e.shadowBlur,this},t.setToClearShape=function(){return this.engine.fillStyle=te,this.engine.strokeStyle=te,this.engine.shadowColor=te,this.state.fillStyle=te,this.state.strokeStyle=te,this.state.shadowColor=te,this},t.saveEngine=function(){return this.engine.save(),this},t.restoreEngine=function(){return this.engine.restore(),this},t.getEntityHits=function(){const t=[],e=lo(),i=lo();return this.groupBuckets&&this.groupBuckets.forEach((t=>{t.visibility&&e.push(...t.getAllArtefactsAt(this.here))}),this),e.forEach((e=>{const n=e.artefact;n.visibility&&!i.includes(n.name)&&(i.push(n.name),t.push(n))})),co(i,e),t},t.rotateDestination=function(t,e,i,n){const s=n||this,r=s.mimic,o=s.pivot;let a,l,c=s.currentRotation;if(r&&r.name&&s.useMimicFlip?(a=r.flipReverse?-1:1,l=r.flipUpend?-1:1):(a=s.flipReverse?-1:1,l=s.flipUpend?-1:1),r&&r.name&&s.useMimicRotation?c=r.currentRotation:o&&o.name&&s.addPivotRotation&&(c=o.currentRotation),c){c*=Ct;const n=ot(c),s=Ot(c);t.setTransform(n*a,s*a,-s*l,n*l,e,i)}else t.setTransform(a,0,0,l,e,i);return this}}const _a="CellFragment",qa=function(t,e=In){this.name=t;const i=this.element=document.createElement(le);this.engine=i.getContext(Et,{willReadFrequently:!0,colorSpace:e}),i.width=1,i.height=1;return(this.state=Ea(tr)).setStateFromEngine(this.engine),this},Qa=qa.prototype=Ar();Qa.type=_a,Ro(Qa),Ka(Qa),Qa.stringifyFunction=qs,Qa.processPacketOut=qs,Qa.finalizePacketOut=qs,Qa.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Qa.clone=Js,Qa.setDimensions=function(t,e){this.w=t,this.h=e,this.element.width=t,this.element.height=e,this.engine.textAlign=gi,this.engine.textBaseline=Cs},Qa.clearCell=function(){this.engine.clearRect(0,0,this.w,this.h)};const Ja=[];let tl=0;const el=function(t=1,e=1,i=In){Ja.length||Ja.push(new qa("pool_"+tl++,fa(i===Le)));const n=Ja.shift();return n.setDimensions(t,e),n.engine.save(),n},il=function(...t){t.forEach((t=>{t&&t.type===_a&&(t.setDimensions(1,1),t.engine.restore(),t.state.setStateFromEngine(t.engine),Ja.push(t))}))},Coordinate=function(t,e){const i=[0,0];return Pt(i,Coordinate.prototype),t&&i.set(t,e),i},nl=Coordinate.prototype=at(Array.prototype);nl.constructor=Coordinate,nl.type=Kn,nl.set=function(t,e){return gr(t)&&(t.type===Kn?this.setFromArray(t):t.type===fs?this.setFromVector(t):t.type===as?this.setFromVector(t.v):ut(t)?this.setFromArray(t):gr(e)&&this.setFromArray([t,e])),this},nl.setFromArray=function(t){return this[0]=t[0],this[1]=t[1],this},nl.setFromVector=function(t){return this[0]=t.x,this[1]=t.y,this},nl.zero=function(){return this[0]=0,this[1]=0,this},nl.vectorAdd=function(t){return this[0]+=t.x,this[1]+=t.y,this},nl.vectorSubtract=function(t){return this[0]-=t.x,this[1]-=t.y,this},nl.add=function(t){return this[0]+=t[0],this[1]+=t[1],this},nl.subtract=function(t){return this[0]-=t[0],this[1]-=t[1],this},nl.multiply=function(t){return this[0]*=t[0],this[1]*=t[1],this},nl.divide=function(t){const[e,i]=t;return e&&i&&(this[0]/=e,this[1]/=i),this},nl.scalarMultiply=function(t){return this[0]*=t,this[1]*=t,this},nl.scalarDivide=function(t){return t&&t.toFixed&&(this[0]/=t,this[1]/=t),this},nl.getMagnitude=function(){return ht(...this)},nl.rotate=function(t){const[e,i]=this;let n=nt(i,e);n+=.01745329251*t;const s=ht(e,i);return this[0]=s*ot(n),this[1]=s*Ot(n),this},nl.reverse=function(){return this[0]=-this[0],this[1]=-this[1],this},nl.getDotProduct=function(t){return this[0]*t[0]+this[1]*t[1]},nl.normalize=function(){const t=this.getMagnitude();return t>0&&(this[0]/=t,this[1]/=t),this};const sl=[],rl=function(t,e){sl.length||sl.push(new Coordinate);const i=sl.shift();return i.set(t,e),i},ol=function(...t){t.forEach((t=>{t&&t.type===Kn&&sl.push(t.zero())}))},al=function(t,e){return new Coordinate(t,e)};J.Coordinate=Coordinate;const ll=180/Math.PI,cl="0",hl="hwb",ul="lab",dl="lch",fl="_max",pl="_min",gl="oklab",ml="oklch",yl="xyz",bl=["HSL","HWB"],Sl="HSL",Al="HWB",Cl="LAB",kl="LCH",vl="OKLAB",Pl="OKLCH",Ol=["RGB","HSL","HWB","LAB","LCH","OKLAB","OKLCH"],xl="XYZ",Dl=216/24389,wl=24389/27,Fl=Math.cbrt,Rl=null!=Fl?Fl:t=>At(t,1/3),Tl=[.3457/.3585,1,.2958/.3585],El=[[1.0479298208405488,.022946793341019088,-.05019222954313557],[.029627815688159344,.990434484573249,-.01707382502938514],[-.009243058152591178,.015055144896577895,.7518742899580008]],Hl=[[.9554734527042182,-.023098536874261423,.0632593086610217],[-.028369706963208136,1.0099954580058226,.021041398966943008],[.012314001688319899,-.020507696433477912,1.3303659366080753]],Il=[[506752/1228815,87881/245763,12673/70218],[87098/409605,175762/245763,12673/175545],[7918/409605,87881/737289,1001167/1053270]],Ll=[[12831/3959,-329/214,-1974/3959],[-851781/878810,1648619/878810,36519/878810],[705/12673,-2585/12673,705/667]],Bl=[[.8190224432164319,.3619062562801221,-.12887378261216414],[.0329836671980271,.9292868468965546,.03614466816999844],[.048177199566046255,.26423952494422764,.6335478258136937]],$l=[[.2104542553,.793617785,-.0040720468],[1.9779984951,-2.428592205,.4505937099],[.0259040371,.7827717662,-.808675766]],Ml=[[1.2268798733741557,-.5578149965554813,.28139105017721583],[-.04057576262431372,1.1122868293970594,-.07171106666151701],[-.07637294974672142,-.4214933239627914,1.5869240244272418]],Xl=[[.9999999984505198,.39633779217376786,.2158037580607588],[1.0000000088817609,-.10556134232365635,-.06385417477170591],[1.0000000546724108,-.08948418209496575,-1.2914855378640917]],Yl=document.createElement(le);Yl.width=1,Yl.height=1;const Gl=Yl.getContext(Et,{willReadFrequently:!0});Gl.globalAlpha=1,Gl.globalCompositeOperation=En;const Color=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.rgb=[],this.rgb_max=[],this.rgb_min=[],this.hsl=[],this.hsl_max=[],this.hsl_min=[],this.hwb=[],this.hwb_max=[],this.hwb_min=[],this.xyz=[],this.xyz_max=[],this.xyz_min=[],this.lab=[],this.lab_max=[],this.lab_min=[],this.lch=[],this.lch_max=[],this.lch_min=[],this.oklab=[],this.oklab_max=[],this.oklab_min=[],this.oklch=[],this.oklch_max=[],this.oklch_min=[],this.easingFunction=Qs,this.dirtyFilterIdentifier=!1,this.convert(te),this.convert(Qt,pl),this.convert($s,fl),this.set(t),this},Nl=Color.prototype=Ar();Nl.type=Zn,Nl.lib=Gn,Nl.isArtefact=!1,Nl.isAsset=!1,Ro(Nl);const zl={rgb:null,rgb_max:null,rgb_min:null,hsl:null,hsl_max:null,hsl_min:null,hwb:null,hwb_max:null,hwb_min:null,xyz:null,xyz_max:null,xyz_min:null,lab:null,lab_max:null,lab_min:null,lch:null,lch_max:null,lch_min:null,oklab:null,oklab_max:null,oklab_min:null,oklch:null,oklch_max:null,oklch_min:null,easing:yi,easingFunction:null,colorSpace:kn,returnColorAs:kn};Nl.defs=ur(Nl.defs,zl),Nl.packetFunctions=fr(Nl.packetFunctions,["easingFunction"]),Nl.kill=function(){const t=this.name;return wt(m).forEach((e=>{const i=e.state;if(i){const e=i.fillStyle,n=i.strokeStyle,s=i.shadowColor;cr(e)&&e.name===t&&(i.fillStyle=i.defs.fillStyle),cr(n)&&n.name===t&&(i.strokeStyle=i.defs.strokeStyle),cr(s)&&s.name===t&&(i.shadowColor=i.defs.shadowColor)}})),this.deregister(),this},Nl.get=function(t){if(gr(t)){if(t.toFixed)return this.getRangeColor(t);if("min"===t)return this.getMinimumColor();if("max"===t)return this.getMaximumColor();if(t===un)return this.generateRandomColor(),this.getCurrentColor();{const e=this.getters[t];if(e)return e.call(this);{const e=this.defs[t];if(typeof e!==Fs){const i=this[t];return typeof i!==Fs?i:e}return}}}return this.getCurrentColor()},Nl.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==$i&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Fs&&(this[a]=l));t.random&&this.generateRandomColor()}return this};const jl=Nl.setters;jl.color=function(t){this.convert(t)},Nl.setColor=function(t){return this.convert(t),this},jl.minimumColor=function(t){this.convert(t,pl)},Nl.setMinimumColor=function(t){return this.convert(t,pl),this},jl.maximumColor=function(t){this.convert(t,fl)},Nl.setMaximumColor=function(t){return this.convert(t,fl),this},jl.easing=function(t){this.setEasingHelper(t)},jl.easingFunction=jl.easing,Nl.setEasing=function(t){return this.setEasingHelper(t),this},Nl.setEasingFunction=Nl.setEasing,Nl.setEasingHelper=function(t){ar(t)?(this.easing=Je,this.easingFunction=t):t.substring&&Sr[t]?(this.easing=t,this.easingFunction=Qs):(this.easing=yi,this.easingFunction=Qs)},jl.colorSpace=function(t){this.setColorSpaceHelper(t)},Nl.setColorSpace=function(t){return this.setColorSpaceHelper(t),this},Nl.setColorSpaceHelper=function(t){if(t.substring&&(t=t.toUpperCase(),di.includes(t))){const e=this.getCurrentColor(),i=this.getMinimumColor(),n=this.getMaximumColor();this.colorSpace=t.toUpperCase(),this.updateColorConversions(e,i,n)}},jl.returnColorAs=function(t){this.setReturnColorAsHelper(t)},Nl.setReturnColorAs=function(t){return this.setReturnColorAsHelper(t),this},Nl.setReturnColorAsHelper=function(t){if(t.substring&&(t=t.toUpperCase(),Ol.includes(t))){const e=this.getCurrentColor(),i=this.getMinimumColor(),n=this.getMaximumColor();this.returnColorAs=t.toUpperCase(),this.updateColorConversions(e,i,n)}},Nl.updateColorConversions=function(t,e,i){this.convert(t),this.convert(e,pl),this.convert(i,fl)},Nl.getData=function(){return this.getCurrentColor()},Nl.getCurrentColor=function(){const{rgb:t,hsl:e,hwb:i,lab:n,lch:s,oklab:r,oklch:o}=this;return this.returnColor(t,e,i,n,s,r,o)},Nl.getMinimumColor=function(){const{rgb_min:t,hsl_min:e,hwb_min:i,lab_min:n,lch_min:s,oklab_min:r,oklch_min:o}=this;return this.returnColor(t,e,i,n,s,r,o)},Nl.getMaximumColor=function(){const{rgb_max:t,hsl_max:e,hwb_max:i,lab_max:n,lch_max:s,oklab_max:r,oklch_max:o}=this;return this.returnColor(t,e,i,n,s,r,o)},Nl.returnColor=function(t,e,i,n,s,r,o){null==t&&({rgb:t,hsl:e,hwb:i,lab:n,lch:s,oklab:r,oklch:o}=this);const{buildColorString:a,returnColorAs:l}=this;switch(l){case kn:return a(...t,kn);case Sl:return a(...e,Sl);case Al:return Vl?a(...i,Al):a(...t,kn);case Cl:return Wl?a(...n,Cl):a(...t,kn);case kl:return Ul?a(...s,kl):a(...t,kn);case vl:return Zl?a(...r,vl):a(...t,kn);case Pl:return Kl?a(...o,Pl):a(...t,kn);default:return te}},Nl.returnColorFromValues=function(t,e,i,n){const{colorSpace:s,returnColorAs:r}=this,o=this.buildColorString(t,e,i,n,s);let a=!1;return xl===s||s!==r?a=!0:(Al!==r||Vl)&&(Cl!==r||Wl)&&(kl!==r||Ul)&&(vl!==r||Zl)&&(Pl!==r||Kl)||(a=!0),a?(this.setColor(o),this.returnColor()):o},Nl.buildColorString=function(t,e,i,n,s){switch(s||(s=this.returnColorAs),s){case kn:return`rgb(${vt(t)} ${vt(e)} ${vt(i)} / ${n})`;case Sl:return`hsl(${t} ${e}% ${i}% / ${n})`;case Al:return`hwb(${t} ${e}% ${i}% / ${n})`;case Cl:return`lab(${t}% ${e} ${i} / ${n})`;case kl:return`lch(${t}% ${e} ${i} / ${n})`;case vl:return`oklab(${100*t}% ${e} ${i} / ${n})`;case Pl:return`oklch(${100*t}% ${e} ${i} / ${n})`;case xl:return`xyz(${t} ${e} ${i} / ${n})`;default:return te}},Nl.generateRandomColor=function(){let t=ct(256*kt()),e=ct(256*kt()),i=ct(256*kt());t>255&&(t=255),e>255&&(e=255),i>255&&(i=255),this.setColor(`rgb(${t} ${e} ${i})`)},Nl.checkColor=function(t){if(t.substring){let e=kn;return t.includes("hsl")?e=Sl:t.includes(hl)?e=Al:t.includes(gl)?e=vl:t.includes(ml)?e=Pl:t.includes(ul)?e=Cl:t.includes(dl)?e=kl:t.includes(yl)&&(e=xl),kn===e||Sl===e?t:(this.colorSpace=e,this.returnColorAs=e,this.convert(t),this.returnColor())}return te},Nl.getRangeColor=function(t,e=!1){if(gr(t)&&t.toFixed){let i=this.colorSpace;e&&(bl.includes(i)?i=kn:kl===i?i=Cl:Pl===i&&(i=vl));const n=this.calculateRangeColorValues(t,e),s=this.buildColorString(...n,i);this.setColor(s)}return this.getCurrentColor()},Nl.calculateRangeColorValues=function(t,e=!1){const{colorSpace:i,easing:n,easingFunction:s}=this;let r,o,a,l,c,h=i.toLowerCase();e&&(bl.includes(i)?h="rgb":kl===i?h=ul:Pl===i&&(h=gl));const[u,d,f,p]=this[`${h}_min`],[g,m,y,b]=this[`${h}_max`];let S=s;!e&&n!==Je&&Sr[n]&&(S=Sr[n]);const A=e?t:S(t);switch(h){case"hsl":case hl:return c=g-u,o=u===g?u:nr(A,c>180||c<-180?c>0?u+360:u-360:u,g),r=p===b?p:nr(A,p,b),a=d===m?d:nr(A,d,m),l=f===y?f:nr(A,f,y),[o,a,l,r];case dl:case ml:return c=y-f,l=f===y?f:nr(A,c>180||c<-180?c>0?f+360:f-360:f,y),r=p===b?p:nr(A,p,b),a=d===m?d:nr(A,d,m),o=u===g?u:nr(A,u,g),[o,a,l,r];default:return r=p===b?p:nr(A,p,b),o=u===g?u:nr(A,u,g),a=d===m?d:nr(A,d,m),l=f===y?f:nr(A,f,y),[o,a,l,r]}},Nl.getAlphaValue=function(t){let e=1;return null!=t&&(e=t.includes(Vi)?parseFloat(t)/100:parseFloat(t)),dt(e)?e>1?e=1:e<0&&(e=0):e=1,e},Nl.getHueValue=function(t){return t===Yi?0:(t=t.includes("deg")?parseFloat(t):t.includes("rad")?parseFloat(t)/Ct:t.includes("grad")?parseFloat(t)/400*360:t.includes("turn")?360*parseFloat(t):parseFloat(t),dt(t)?Ks(t):0)},Nl.getColorValuesFromString=function(t,e){const i=(t=(t=(t=(t=t.replace(e,Ys)).replace("(",Ys)).replace(")",Ys)).replace("/",Ys)).split(Hn).filter((t=>null!=t&&t!==Ys));return null!=i[0]&&i[0]!==Yi||(i[0]=cl),null!=i[1]&&i[1]!==Yi||(i[1]=cl),null!=i[2]&&i[2]!==Yi||(i[2]=cl),i},Nl.extractFromHwbColorString=function(t){const{getAlphaValue:e,getHueValue:i,getColorValuesFromString:n}=this;let s,r,o;const a=n(t,hl),l=i(a[0]),c=parseFloat(a[1]),h=parseFloat(a[2]),u=e(a[3]);return[s,r,o]=this.convertHWBtoRGB(l,c,h),s=ct(255*s),s>255&&(s=255),s<0&&(s=0),r=ct(255*r),r>255&&(r=255),r<0&&(r=0),o=ct(255*o),o>255&&(o=255),o<0&&(o=0),[u,s,r,o]},Nl.extractFromXyzColorString=function(t){const{getAlphaValue:e,getColorValuesFromString:i}=this,n=i(t,yl),s=parseFloat(n[0]),r=parseFloat(n[1]),o=parseFloat(n[2]);return[e(n[3]),s,r,o]},Nl.extractFromLabColorString=function(t){const{getAlphaValue:e,getColorValuesFromString:i}=this;let n,s,r;const o=i(t,ul);n=parseFloat(o[0]),n>100&&(n=100),n<0&&(n=0),s=o[1].includes(Vi)?1.25*parseFloat(o[1]):parseFloat(o[1]),s>160&&(s=160),s<-160&&(s=-160),r=o[2].includes(Vi)?1.25*parseFloat(o[2]):parseFloat(o[2]),r>160&&(r=160),r<-160&&(r=-160);return[e(o[3]),n,s,r]},Nl.extractFromOklabColorString=function(t){const{getAlphaValue:e,getColorValuesFromString:i}=this;let n,s,r;const o=i(t,gl);n=o[0].includes(Vi)?parseFloat(o[0])/100:parseFloat(o[0]),n>1&&(n=1),n<0&&(n=0),s=o[1].includes(Vi)?parseFloat(o[1])/100*.4:parseFloat(o[1]),s>.5&&(s=.5),s<-.5&&(s=-.5),r=o[2].includes(Vi)?parseFloat(o[2])/100*.4:parseFloat(o[2]),r>.5&&(r=.5),r<-.5&&(r=-.5);return[e(o[3]),n,s,r]},Nl.extractFromLchColorString=function(t){const{getAlphaValue:e,getHueValue:i,getColorValuesFromString:n}=this;let s,r;const o=n(t,dl);s=parseFloat(o[0]),s>100&&(s=100),s<0&&(s=0),r=o[1].includes(Vi)?1.5*parseFloat(o[1]):parseFloat(o[1]),r>230&&(r=230),r<0&&(r=0);const a=i(o[2]);return[e(o[3]),s,r,a]},Nl.extractFromOklchColorString=function(t){const{getAlphaValue:e,getHueValue:i,getColorValuesFromString:n}=this;let s,r;const o=n(t,ml);s=s=o[0].includes(Vi)?parseFloat(o[0])/100:parseFloat(o[0]),s>1&&(s=1),s<0&&(s=0),r=o[1].includes(Vi)?parseFloat(o[1])/100*.4:parseFloat(o[1]),r>.4&&(r=.4),r<0&&(r=0);const a=i(o[2]);return[e(o[3]),s,r,a]},Nl.convert=function(t,e=Ys){t=t.toLowerCase();const i=this[`rgb${e}`],n=this[`hsl${e}`],s=this[`hwb${e}`],r=this[`xyz${e}`],o=this[`lab${e}`],a=this[`lch${e}`],l=this[`oklab${e}`],c=this[`oklch${e}`];if(!i)return this;let h,u,d,f;return i.length=0,n.length=0,s.length=0,r.length=0,o.length=0,a.length=0,l.length=0,c.length=0,t.includes(hl)&&!Vl?([h,u,d,f]=this.extractFromHwbColorString(t),i.push(u,d,f,h),n.push(...this.convertRGBtoHSL(u,d,f),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),r.push(...this.convertRGBtoXYZ(u,d,f),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):t.includes(yl)?([h,u,d,f]=this.extractFromXyzColorString(t),i.push(...this.convertXYZtoRGB(u,d,f),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),r.push(u,d,f,h),o.push(...this.convertXYZtoLAB(u,d,f),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):t.includes(gl)&&!Zl?([h,u,d,f]=this.extractFromOklabColorString(t),l.push(u,d,f,h),c.push(...this.convertOKLABtoOKLCH(u,d,f),h),r.push(...this.convertOKLABtoXYZ(u,d,f),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h)):t.includes(ml)&&!Kl?([h,u,d,f]=this.extractFromOklchColorString(t),c.push(u,d,f,h),l.push(...this.convertOKLCHtoOKLAB(u,d,f),h),r.push(...this.convertOKLABtoXYZ(l[0],l[1],l[2]),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h)):t.includes(ul)&&!Wl?([h,u,d,f]=this.extractFromLabColorString(t),o.push(u,d,f,h),r.push(...this.convertLABtoXYZ(u,d,f),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),a.push(...this.convertLABtoLCH(u,d,f),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):t.includes(dl)&&!Ul?([h,u,d,f]=this.extractFromLchColorString(t),a.push(u,d,f,h),o.push(...this.convertLCHtoLAB(u,d,f),h),r.push(...this.convertLABtoXYZ(o[0],o[1],o[2]),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):([u,d,f,h]=this.getColorFromCanvas(t),i.push(u,d,f,h),n.push(...this.convertRGBtoHSL(u,d,f),h),s.push(...this.convertRGBHtoHWB(u,d,f,n[0]),h),r.push(...this.convertRGBtoXYZ(u,d,f),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)),this},Nl.extractRGBfromColor=function(t){let e,i,n,s;return(t=t.toLowerCase()).includes(hl)&&!Vl?([e,i,n,s]=this.extractFromHwbColorString(t),[i,n,s,e]):t.includes(yl)?([e,i,n,s]=this.extractFromXyzColorString(t),[...this.convertXYZtoRGB(i,n,s),e]):t.includes(gl)&&!Zl?([e,i,n,s]=this.extractFromOklabColorString(t),[...this.convertXYZtoRGB(...this.convertOKLABtoXYZ(i,n,s)),e]):t.includes(ml)&&!Kl?([e,i,n,s]=this.extractFromOklchColorString(t),[...this.convertXYZtoRGB(...this.convertOKLABtoXYZ(...this.convertOKLCHtoOKLAB(i,n,s))),e]):t.includes(ul)&&!Wl?([e,i,n,s]=this.extractFromLabColorString(t),[...this.convertXYZtoRGB(...this.convertLABtoXYZ(i,n,s)),e]):t.includes(dl)&&!Ul?([e,i,n,s]=this.extractFromLchColorString(t),[...this.convertXYZtoRGB(...this.convertLABtoXYZ(...this.convertLCHtoLAB(i,n,s))),e]):this.getColorFromCanvas(t)},Nl.convertRGBtoHex=function(t,e,i){if(t.substring&&(t=parseInt(t,10)),e.substring&&(e=parseInt(e,10)),i.substring&&(i=parseInt(i,10)),dt(t)&&dt(e)&&dt(i)){return`#${(cl+t.toString(16)).slice(-2)}${(cl+e.toString(16)).slice(-2)}${(cl+i.toString(16)).slice(-2)}`}return"#000000"},Nl.getColorFromCanvas=function(t){let e=0,i=0,n=0,s=0;Gl.clearRect(0,0,1,1),Gl.fillStyle=t,Gl.fillRect(0,0,1,1);const r=Gl.getImageData(0,0,1,1);return r&&r.data&&([e,i,n,s]=r.data,s/=255),[e,i,n,s]},Nl.convertRGBtoHSL=function(t,e,i){const n=pt(t/=255,e/=255,i/=255),s=gt(t,e,i),r=(s+n)/2,o=n-s;let a=0,l=0;if(0!==o){switch(l=0===r||1===r?0:(n-r)/gt(r,1-r),n){case t:a=(e-i)/o+(e<i?6:0);break;case e:a=(i-t)/o+2;break;case i:a=(t-e)/o+4}a*=60}return[a,100*l,100*r]},Nl.convertHSLtoRGB=function(t,e,i){t=Ks(t),e/=100,i/=100;const n=function(n){const s=(n+t/30)%12,r=e*gt(i,1-i);return i-r*pt(-1,gt(s-3,9-s,1))};return[n(0),n(8),n(4)]},Nl.convertRGBtoHWB=function(t,e,i){const n=this.convertRGBtoHSL(t,e,i),s=gt(t/=256,e/=256,i/=256),r=1-pt(t,e,i);return[n[0],100*s,100*r]},Nl.convertRGBHtoHWB=function(t,e,i,n){return[n,100*gt(t/=256,e/=256,i/=256),100*(1-pt(t,e,i))]},Nl.convertHWBtoRGB=function(t,e,i){if((e/=100)+(i/=100)>=1){const t=e/(e+i);return[t,t,t]}const n=this.convertHSLtoRGB(t,100,50);for(let t=0;t<3;t++)n[t]*=1-e-i,n[t]+=e;return n},Nl.multiplyMatrices=function(t,e){const i=t.length;ut(t[0])||(t=[t]),ut(e[0])||(e=e.map((t=>[t])));const n=e[0].length,s=e[0].map(((t,i)=>e.map((t=>t[i]))));let r=t.map((t=>s.map((e=>ut(t)?t.reduce(((t,i,n)=>t+i*(e[n]||0)),0):e.reduce(((e,i)=>e+i*t),0)))));return 1===i&&(r=r[0]),1===n?r.map((t=>t[0])):r},Nl.lin_sRGB=function(t){return t.map((t=>{const e=t<0?-1:1,i=et(t);return i<.04045?t/12.92:e*At((i+.055)/1.055,2.4)}))},Nl.convertRGBtoXYZ=function(t,e,i){const n=lo();n.push(t/255,e/255,i/255);const s=lo();s.push(...this.lin_sRGB(n));const r=lo();r.push(...Il);const o=this.multiplyMatrices(r,s);return co(n,s,r),o},Nl.convertRGBtoOKLAB=function(t,e,i){const n=lo();n.push(t/255,e/255,i/255);const[s,r,o]=this.lin_sRGB(n),a=.2119034982*s+.6806995451*r+.1073969566*o,l=.0883024619*s+.2817188376*r+.6299787005*o,c=Rl(.4122214708*s+.5363325363*r+.0514459929*o),h=Rl(a),u=Rl(l);return co(n),[.2104542553*c+.793617785*h-.0040720468*u,1.9779984951*c-2.428592205*h+.4505937099*u,.0259040371*c+.7827717662*h-.808675766*u]},Nl.convertOKLABtoRGB=function(t,e,i){const n=t+.3963377774*e+.2158037573*i,s=t-.1055613458*e-.0638541728*i,r=t-.0894841775*e-1.291485548*i,o=n*n*n,a=s*s*s,l=r*r*r,c=lo();c.push(4.0767416621*o-3.3077115913*a+.2309699292*l,-1.2684380046*o+2.6097574011*a-.3413193965*l,-.0041960863*o-.7034186147*a+1.707614701*l);const[h,u,d]=this.gam_sRGB(c),f=vt(255*h),p=vt(255*u),g=vt(255*d);return co(c),[f,p,g]},Nl.gam_sRGB=function(t){return t.map((t=>{const e=t<0?-1:1,i=et(t);return i>.0031308?e*(1.055*At(i,1/2.4)-.055):12.92*t}))},Nl.convertXYZtoRGB=function(t,e,i){const n=lo();n.push(...Ll);const s=lo();s.push(t,e,i);const r=this.multiplyMatrices(n,s),o=this.gam_sRGB(r);return co(n,s),[vt(255*o[0]),vt(255*o[1]),vt(255*o[2])]},Nl.convertXYZtoLAB=function(t,e,i){const n=lo();n.push(...El);const s=lo();s.push(t,e,i);const r=this.multiplyMatrices(n,s).map(((t,e)=>t/Tl[e])).map((t=>t>Dl?Rl(t):(wl*t+16)/116));return co(n,s),[116*r[1]-16,500*(r[0]-r[1]),200*(r[1]-r[2])]},Nl.convertLABtoXYZ=function(t,e,i){const n=(t+16)/116,s=e/500+n,r=n-i/200,o=lo();o.push(At(s,3)>Dl?At(s,3):(116*s-16)/wl,t>8?At((t+16)/116,3):t/wl,At(r,3)>Dl?At(r,3):(116*r-16)/wl);const a=lo();a.push(...Hl);const l=lo();l.push(...o.map(((t,e)=>t*Tl[e])));const c=this.multiplyMatrices(a,l);return co(o,a,l),c},Nl.convertLABtoLCH=function(t,e,i){const n=nt(i,e)*ll;return[t,xt(At(e,2)+At(i,2)),n>=0?n:n+360]},Nl.convertLCHtoLAB=function(t,e,i){return[t,e*ot(i*Ct),e*Ot(i*Ct)]},Nl.convertXYZtoOKLAB=function(t,e,i){const n=lo();n.push(...Bl);const s=lo();s.push(t,e,i);const r=lo();r.push(...$l);const o=this.multiplyMatrices(n,s),a=this.multiplyMatrices(r,o.map((t=>Rl(t))));return co(n,s,r),a},Nl.convertOKLABtoXYZ=function(t,e,i){const n=lo();n.push(...Xl);const s=lo();s.push(t,e,i);const r=lo();r.push(...Ml);const o=this.multiplyMatrices(n,s),a=this.multiplyMatrices(r,o.map((t=>t**3)));return co(n,s,r),a},Nl.convertOKLABtoOKLCH=function(t,e,i){const n=nt(i,e)*ll;return[t,xt(e**2+i**2),n>=0?n:n+360]},Nl.convertOKLCHtoOKLAB=function(t,e,i){return[t,e*ot(i*Ct),e*Ot(i*Ct)]};let Vl=!1,Wl=!1,Ul=!1,Zl=!1,Kl=!1;!function(){let t,e=0,i=0,n=0;Gl.save(),Gl.fillStyle="hwb(90 10% 10%)",Gl.fillRect(0,0,1,1),t=Gl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Vl=!0),Gl.restore(),Gl.save(),Gl.fillStyle="lab(29.2345% 39.3825 20.0664)",Gl.fillRect(0,0,1,1),t=Gl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Wl=!0),Gl.restore(),Gl.save(),Gl.fillStyle="lch(52.2345% 72.2 56.2)",Gl.fillRect(0,0,1,1),t=Gl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Ul=!0),Gl.restore(),Gl.save(),Gl.fillStyle="oklab(59.686% 0.1009 0.1192)",Gl.fillRect(0,0,1,1),t=Gl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Zl=!0),Gl.restore(),Gl.save(),Gl.fillStyle="oklch(59.686% 0.15619 49.7694)",Gl.fillRect(0,0,1,1),t=Gl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Kl=!0),Gl.restore()}();const _l=function(t){return!!t&&new Color(t)};J.Color=Color;const ql=new Float32Array([.37,.69,.62,.78,.06,.84,.27,.14,.46,1,.58,.28,.62,.8,.3,.7,.93,.53,.76,.24,.15,.51,.79,.28,.99,.16,.22,.45,.03,.73,.34,.96,.5,.3,.07,.84,.51,.27,.89,.8,.66,.25,.54,.94,.08,.66,.36,.85,.69,.93,.26,.79,.68,.36,.23,.5,.83,.34,.64,.91,.73,.8,.95,.59,.1,.76,.82,.03,.62,.47,.09,.55,.33,.22,.45,.04,.76,.52,.69,.24,.78,.12,.59,.37,.03,.82,.93,.69,.42,.34,.89,.62,.27,1,.53,.09,.38,.71,.13,.52,.19,.66,.33,.42,.63,.28,.36,.61,.73,.06,.56,.97,.35,.72,.91,.3,.98,.53,.2,.08,.5,.22,.87,.93,.08,.44,.91,.56,.12,.99,.01,.49,.37,.68,.89,.55,.3,.84,.17,.67,.1,.48,.89,.23,.47,.06,.29,.61,.67,.91,.2,.47,.64,.05,.77,.94,.62,.09,.58,.12,.77,.47,.93,.39,.73,.09,.47,.58,.15,.39,.02,.64,.32,.77,.98,.03,.28,.44,.11,.01,.73,.44,.88,.02,.76,.53,.41,.05,.25,.36,.02,.31,.52,.39,.28,.57,.91,.7,.98,0,.76,.94,.66,.85,.33,.18,.88,.01,.99,.46,.69,.94,.32,.51,.45,.07,.55,.22,.11,.8,.42,.17,.87,.47,.81,.23,.88,.43,.6,.11,.75,.06,.88,.72,.47,.92,.13,.31,.84,.47,.27,.16,.5,.09,.78,.44,.34,.56,.95,.69,.36,.13,.64,.29,.04,.87,.41,.53,.31,.87,.22,.6,.09,.77,.22,.72,.4,.88,.37,.75,.06,.58,.65,.86,.99,.42,.37,.58,.04,.74,.35,.57,.83,.39,.5,.91,.42,.27,.69,.02,.8,.22,.63,.97,.04,.34,.69,.97,.51,.83,.45,.24,.56,.49,.64,.81,.99,.55,.31,.17,.62,.1,.69,.15,.86,.2,.52,.67,.77,.19,.7,.85,.45,.18,.12,.4,.3,.82,.37,.53,.07,.27,.56,.64,.44,.34,.56,.25,.2,.08,.76,.64,.15,.78,.95,.72,.87,.51,.36,.02,.74,.3,.07,.64,.34,0,.82,.28,.97,.22,.5,.81,.02,.25,.41,.69,.2,.03,.76,.42,.69,.85,.59,.14,.91,.76,.28,.06,.61,.47,.73,.8,.55,.25,.61,.82,.19,.72,.13,.98,.41,.03,.64,.96,.12,.52,.27,.17,.97,.42,.13,.35,.2,.78,.11,.86,.82,.24,.95,.49,.14,.25,.17,.69,.85,.21,.95,.58,.35,.15,.44,.29,.78,.84,.2,.28,.88,.09,.2,.92,.13,.75,.17,.37,.23,.52,.89,.82,.47,1,.39,.29,.75,.59,.96,.14,.42,.92,.63,.04,1,.67,.78,.5,.24,.61,.17,.71,.92,.41,.11,.96,.74,.07,.83,.66,.89,.4,.85,.23,.55,.36,.27,.19,.04,.67,.94,.58,.63,.2,.97,.75,.55,.92,.72,.46,.55,.69,.34,.17,.67,.56,.88,.96,.52,.62,.94,.88,.21,.04,.37,.25,.72,.02,.81,.16,.91,.4,.21,1,.16,.7,.94,.1,.78,.55,.45,.7,.51,.86,.29,.48,.05,.93,.59,.81,.72,.29,.83,.59,.73,0,.49,.3,.64,.39,.11,.71,.32,.97,.78,.34,.05,.37,.49,.12,.9,.68,.56,.92,.49,.14,.55,.76,.6,.34,.72,.64,.4,.03,.88,.6,.71,.13,.65,.05,.27,.56,.22,.94,.47,.09,.33,.84,.47,.27,.09,.57,.23,.34,.07,.95,.56,.87,.11,.46,.2,.77,.87,.5,.18,.29,.79,.14,.61,.51,.29,.99,.01,.91,.65,.47,.58,.3,.23,.13,.83,.4,.49,.15,.25,.36,.17,.84,.13,.41,.07,1,.44,.77,.09,.35,.73,.3,.11,.34,.57,.47,.93,.63,.41,.53,.49,.32,.86,.55,.02,.84,.51,.34,.26,.04,.39,.92,.33,.25,.84,.17,.35,.8,.43,.67,.31,.03,.51,.47,.08,.94,.25,.55,.91,.71,.15,.45,.58,.89,.67,.02,.47,.57,.62,.82,.73,.53,.27,.81,.07,.19,.65,.4,.92,0,.44,.16,1,.53,.8,.33,.96,.29,.07,.44,.94,.34,.74,.84,.67,0,.84,.64,.71,.04,.55,.89,.39,.72,.53,.82,.42,.65,.02,.36,.94,.29,.63,0,.37,.25,.67,.93,.51,.37,.04,.74,.12,.68,.44,.81,.11,.38,.78,.99,.45,.71,.89,.33,.59,.91,.69,.51,.05,.64,.27,.89,.61,.84,.31,.24,.5,.04,.18,.44,.8,.66,.14,.75,.82,.11,.18,.99,.65,.12,.77,.25,.62,.32,.09,.75,.65,.47,.58,.16,.05,.65,.08,.94,.56,.73,.25,.84,.14,.38,.87,.64,.16,.78,.4,.64,.2,.33,.99,.02,.86,.2,.53,.42,.86,.1,.94,.14,.23,.99,.03,.4,.88,.72,.24,.07,.8,.32,.69,.83,.04,.25,.68,.22,.48,.55,.76,.86,.39,.17,.53,.09,.42,.34,.5,.26,.23,1,.18,.77,.31,.94,.15,.88,.29,.73,.21,.8,.69,.53,.95,.76,.56,.11,.6,.05,.44,.23,.96,.82,.56,.35,.21,.72,.52,.88,.16,.82,.08,.52,.27,.8,.1,.02,.84,.3,.78,.98,.43,.73,.19,.52,.14,.89,.65,.79,.6,.92,.52,.07,.98,.27,.51,.3,.78,.88,.23,.42,.7,.1,.91,.77,.43,.96,.22,.87,.71,.8,.95,.55,.76,.45,.15,.02,.99,.54,.2,.73,.96,.24,.55,.36,.05,.95,.13,.75,.55,.77,.25,.36,.13,.8,.19,.29,.71,.36,.45,.65,.33,.61,.51,.37,1,.56,.46,.89,.23,.5,.4,.91,.58,.07,.83,.65,.12,.25,.61,.79,.14,.97,.63,.78,.12,.89,.43,.38,.61,.69,0,.45,.19,.6,.02,.92,.5,.42,.09,.24,.42,.16,.89,.48,.99,.76,.66,.87,.27,.45,.16,.62,.89,.25,.04,.33,.22,.62,.37,0,.67,.18,.45,.75,.62,.42,.18,.57,.01,.36,.8,.05,.68,.4,1,.27,.86,.4,.22,.37,.83,.44,.68,.05,.56,.35,.06,.59,.94,.49,.38,.58,.16,.53,.13,.29,.36,.51,.2,.26,.36,.89,.69,.31,.42,.63,.91,.5,.04,.31,.85,.72,.47,.83,.61,.36,.48,.07,.93,.64,.72,1,.6,.49,.89,.54,.08,.76,.92,.16,.09,.82,.29,.14,.61,.18,.75,.65,.11,.29,.78,.15,.42,.36,.99,.01,.49,.69,.31,.89,.25,.18,.94,.58,.7,.85,.09,.5,.22,.85,.69,.39,.33,.78,.15,.58,.85,.04,.72,.35,.84,.28,.4,.16,.33,.56,.01,.69,.96,.06,.47,.83,.56,.69,.93,.54,.74,.94,.86,.53,.98,.38,.24,.95,.11,.67,.86,.51,.3,.96,.46,.57,.34,.05,.15,.71,.31,.77,.03,.6,.2,.94,.72,.45,.82,.17,.31,.8,.2,.05,.69,.84,.76,.01,1,.09,.84,.44,.62,.11,.22,.5,.81,.05,.29,.45,.77,.68,.09,.91,.2,.28,0,.89,.18,.69,.32,.51,.44,.03,.35,.25,.67,.03,.84,.2,.56,.46,.89,.23,.69,.78,.95,.37,.09,.55,.87,.44,.73,.95,.52,.82,.23,.73,.91,.44,.04,.55,.46,.73,.41,.03,.31,.14,.78,.36,.97,.56,.8,.11,.99,.52,.27,.91,.64,.95,.49,.19,.66,.03,.55,.85,.13,.62,.8,.41,.29,.75,.39,.13,.99,.45,.05,.27,.47,.12,.41,.63,.29,.15,.84,.54,.32,.74,.22,.13,.64,.85,.08,.16,.75,.51,.47,.64,.95,.58,.14,.91,.51,.39,.13,.25,.97,.69,.01,.56,.87,.28,.93,.38,.62,.44,.67,.57,.7,.01,.8,.98,.6,.89,.73,.16,.71,.12,.59,.36,.54,.15,.57,.67,.45,.25,.95,.83,.11,.22,.84,.09,.77,.92,.16,.41,.96,.35,.25,.75,.65,0,.44,.53,.06,.28,.83,.99,.23,0,.59,.24,.05,.63,.28,.55,.36,.16,.83,.72,.31,.08,.66,.81,.53,.22,.9,.62,.28,.05,.45,.64,.22,.71,.07,.35,.45,.31,.1,.77,.6,.95,.24,.73,.49,.99,.22,.1,.55,.91,.63,.24,.74,.41,.79,.16,.81,.33,.22,.04,.81,.67,.48,.04,.8,.44,.99,.41,.78,.25,.6,.94,.28,.82,.91,.2,.11,.44,.73,.34,.79,.06,.85,.63,.51,.42,.9,.73,.44,.64,.05,.49,.24,.9,.2,.33,.93,.15,.48,.34,.19,0,.45,.34,.97,.84,.21,.95,.26,.41,.82,.98,.72,.54,.34,.62,.39,.57,.93,.69,.53,.44,.8,.64,.53,.71,.11,.94,.37,.58,.87,.2,.73,.47,.42,.67,.34,.49,.91,.38,.72,.13,.89,.77,.08,.96,.64,.19,1,.85,.47,.25,.96,.71,.47,.12,.76,.16,.91,.3,.51,.85,.8,.15,.75,.55,.89,.36,.46,.07,.89,.43,.04,.36,.87,.48,.85,.17,.02,.52,.31,.09,.87,.64,.97,.58,.71,.91,.51,.1,.9,.59,.27,.16,.62,.57,.01,.49,.38,.73,.42,0,.6,.38,.86,.28,.64,.24,1,.56,.3,.76,.18,.1,.35,.23,.14,.98,.31,.8,.72,.15,.84,.53,.25,.4,.73,.85,.55,.67,.91,.25,.55,.51,.03,.69,.88,.75,.03,.34,.09,.16,.78,.05,.75,.88,.28,.2,.37,.13,.3,.22,.04,.87,.44,.54,.15,.25,1,.32,.64,.93,.25,.13,.64,.8,.16,.55,.97,.41,.48,.24,.61,.4,.27,.53,.12,.36,.16,.6,.36,.05,.4,.58,.82,.37,.69,.95,0,.56,.39,.66,.23,0,.81,.18,.69,.32,.8,.28,.67,.62,.26,.73,.58,.27,.67,.83,.94,.55,.2,.36,.5,.08,.84,.42,.35,.2,.74,.38,.93,.71,.08,.3,.97,.83,.19,.88,.15,.67,.24,.8,.07,.51,.84,.02,.18,.69,.45,.04,.91,.58,.8,.47,.71,.6,.08,.56,.41,.04,.36,.77,.09,.9,.58,.05,.31,.39,.09,.75,.63,.31,.82,.45,.12,.61,.51,.22,.63,.93,.51,.2,.47,.32,.06,.66,.59,.97,.9,.69,.58,.16,.31,.82,.06,.76,.41,.1,.82,.02,.58,.89,.05,.28,.84,.08,.3,.77,.02,.67,.33,.81,.02,.67,.75,.57,.91,.8,.09,.85,.67,.99,.25,.51,.13,.45,.25,.12,.88,.46,.95,.6,.28,.98,.49,.16,.57,.18,.95,.81,.16,.04,.98,.44,.35,.77,.04,.61,.7,.29,.01,.67,.16,.27,.99,.63,.47,0,.2,.83,.47,.88,.13,.66,.54,.08,.98,.5,.32,.56,.97,.69,.4,.61,.48,.94,.37,.83,.6,.29,.94,.03,.87,.37,.16,.91,.65,.49,.97,.45,.64,.67,.22,.13,1,.84,.49,.16,.94,.07,.42,.19,.28,.94,.36,.89,.46,.83,.29,.7,.91,.14,.42,.8,.73,.07,.47,.75,.38,.97,.63,.69,.91,.47,.69,.56,.14,.47,.76,.52,.97,.44,.75,.5,.64,.19,.84,.99,.13,.5,.91,.86,.32,.05,.23,.42,.52,.3,.17,.33,.04,.89,.61,.73,.34,.93,.75,.15,.31,.7,.41,.07,.64,.84,.75,.41,.08,.48,.32,.39,.7,.11,.87,.14,.47,.27,.95,.77,.47,.93,.62,.53,.77,.12,.31,.96,.67,.49,.38,.73,.24,.4,.33,.6,.78,.39,.85,.15,.44,.2,.11,.89,.78,.09,.24,.73,.14,.45,.67,.22,.53,.83,.27,.75,.3,.2,.85,0,.28,.83,.37,.52,.78,.71,.6,.22,.37,.89,.66,.78,.57,.03,.68,.74,.17,.38,.03,.59,.81,.63,.98,.52,.22,.35,.27,.12,.85,.01,.25,.35,.19,.6,.3,.92,.8,.35,.3,.17,.36,.7,.23,.1,.88,.38,.55,.28,.72,.57,.17,.38,.47,.98,.72,.63,.89,.75,.55,.93,.64,.08,.78,.82,.19,.62,.53,.37,.05,.84,.49,.94,.23,.35,.01,.99,.53,.66,.76,.95,.57,.23,.64,.31,.89,.4,.12,.86,.16,.41,.31,.81,.03,.86,.56,.81,.25,.11,.58,.19,.8,.93,.05,.84,.25,.11,.73,.02,.67,.93,.36,.55,.31,.66,.2,.51,.41,.86,.06,.33,.63,.42,.01,.98,.59,.1,.7,.57,.18,.44,.92,.64,.27,.42,.04,.81,.54,.71,.25,.99,.49,.82,.11,.25,.55,.66,.95,.12,.24,.38,.03,.28,.88,.57,.92,.42,.53,.59,.77,.44,.12,.88,.02,.24,.7,.09,.86,.67,.03,.93,.58,.33,.95,.6,.06,.44,.9,.08,.24,.63,.14,.79,.28,.16,.02,.39,.12,.8,.44,.36,.28,.49,.42,.02,.24,.91,.66,.13,.59,.2,.73,.47,.6,.3,.21,.89,.26,.07,.48,.79,.01,.95,.52,.66,.07,.55,.73,.89,.07,.2,.49,.38,.61,.17,.4,.78,.97,.01,.62,.48,.69,.22,.47,.97,.59,.52,.8,.26,.72,.05,.42,.89,.8,.03,1,.76,.17,.93,.78,.09,.69,.45,.89,.39,.82,.34,.98,.75,.1,.04,.34,.17,.9,.32,.11,.49,.05,.15,.33,.38,.61,.97,.07,.85,.34,.44,.77,.54,.73,.17,.69,.8,.05,.65,.19,.93,.09,.83,.51,.97,.36,.53,.43,.62,.97,.51,.81,.16,.45,.03,.75,.27,.16,.8,.35,.67,.77,.85,.53,.11,.56,.36,.96,.6,.24,.48,.69,.23,.91,.12,1,.69,.8,.55,.44,.98,.31,.8,.08,.89,.69,.84,.39,.12,.62,.18,.88,.31,.7,.56,.2,.78,.35,.62,.24,.58,.97,.65,.7,.95,.04,.49,.91,.33,.68,.47,.29,.38,.95,.16,.67,.37,.29,.19,.89,.49,.61,.16,.95,.56,.48,.27,.62,.34,.56,.48,.28,.92,.55,.15,.77,.05,.63,.24,.12,.49,.59,.84,.97,.53,.75,.64,.97,.44,.86,.62,.91,.22,.79,.44,.31,.72,.52,.19,.93,.09,.88,.49,.41,.11,.98,.31,.72,.28,.41,.58,.3,.74,.66,.15,.84,.05,.2,.41,.27,.62,.87,.82,.53,.67,.47,.86,.58,.04,.42,.94,.33,.69,.88,.45,.83,.67,.05,.86,.98,.01,.66,.57,.3,.85,.05,.22,.27,.71,.03,.37,.53,.27,.16,.03,.57,.69,.82,.42,.53,.99,.36,.09,.83,.28,.98,.02,.46,.15,.33,.43,.18,.28,.75,.24,.82,.08,.22,.89,.85,.13,.76,.58,.07,.89,.77,.07,.42,.04,.83,.22,.7,.34,.13,.9,.7,.06,.25,.74,.11,.83,.35,.25,.52,.43,.94,.53,.86,.72,.31,.2,.7,.56,.36,.27,.2,.58,.36,.74,.1,.5,.69,.16,.93,.04,.78,.6,.28,.65,.34,.96,.23,.62,.36,.47,.88,.06,.72,.95,.21,.04,.79,.27,.91,.59,.33,.77,.1,.69,.31,.21,.36,.12,.95,.31,.2,1,.28,.48,.03,.24,.76,.07,.19,.34,.76,.15,.33,.55,.39,.76,.16,.48,.37,.94,.51,.84,.62,.92,.67,.42,.94,.79,.45,.97,.36,.03,.75,.13,.24,.46,.73,.14,.4,.85,.69,.5,.83,.76,.09,.89,.45,.68,.56,.4,.64,.52,.05,.23,.53,.34,.81,.44,.24,.67,.56,.98,.37,.52,.78,.02,.4,.21,.81,.45,.87,.59,.4,.2,.66,1,.08,.29,.2,.67,.01,.39,.27,.79,.45,.09,0,.78,.94,.07,.8,.28,.66,.02,.88,.39,.58,.23,.42,.91,.13,.38,.82,.03,.56,.77,.16,.82,.54,.16,.61,.33,.12,.63,.44,.37,.48,.73,0,.91,.56,1,.44,.07,.92,.63,0,.77,.52,.12,.8,.18,.59,.4,.99,.29,.56,.52,.94,.42,.62,.84,.08,.95,.25,.6,.74,.65,.11,.16,.45,.21,.06,.76,.32,.49,.18,.07,.66,.27,.61,.86,.66,.91,.48,.61,.89,.19,.75,.29,.04,.91,.54,.6,.34,.01,.99,.14,.31,.72,.81,.41,.99,.62,.05,.49,.96,.73,.33,.13,.67,.27,.88,.59,.94,.65,.16,.37,.99,.05,.81,.53,0,.73,.6,.85,.8,.36,.47,.09,.94,.64,.13,.91,.84,.47,.67,.53,.22,.42,.96,.55,.34,.76,.12,.48,.69,.04,.75,.53,.47,.2,.71,.9,.26,0,.67,.85,.42,.91,.78,.55,.87,.19,.11,.97,.66,.37,.48,.16,.65,.8,.56,.27,.72,.4,.61,.47,.71,.92,.67,.83,.15,.64,.92,.05,.47,.12,.28,.73,.2,.51,.82,.42,0,.32,.77,.56,.29,.8,.98,.59,.11,.63,.27,.87,.54,.92,.19,.42,.02,.8,.18,.07,.53,.32,.13,.99,.63,.38,.24,.15,.84,.77,.18,.85,.49,.93,.59,.16,.69,.27,.84,.12,.59,.18,.89,.45,.83,.19,.44,.11,.75,.5,.56,.09,.31,.65,.25,.92,.44,.35,.7,.13,.55,.97,.76,.59,.86,.55,.36,.25,.62,.17,.32,.11,.61,.85,.13,.45,.23,.64,.84,.99,.34,.86,.29,.98,.78,.09,.63,.31,.5,1,.38,.22,.08,.49,.26,.02,.99,.71,.59,.31,.22,.13,.84,.24,.04,.35,.84,.44,.17,.89,.05,.86,.38,.25,.07,.53,.45,.36,.25,.7,.8,.66,.91,.5,.36,.06,.69,.89,.2,.82,1,.39,.7,.09,.36,.19,.91,.72,.37,.78,.16,.47,.81,.34,.56,.29,.95,.37,.8,.67,.44,.58,.2,.49,.71,.96,.29,.49,.71,.44,.25,.11,.34,.01,.46,.91,.22,.37,.55,.28,.01,.79,.59,.05,.98,.36,.29,.23,.85,.78,.71,.47,.11,.76,.87,.22,.96,.39,.28,.09,.23,.17,.31,.05,.46,1,.69,.39,.88,.77,.98,.36,.05,.73,.94,.06,.18,.44,.57,.1,.17,.59,.25,.35,.94,.42,.08,.59,.74,.33,.95,.61,.81,.41,.33,.08,.52,.79,.45,.91,.72,.58,.95,.75,.49,.17,.99,.33,.23,.65,.15,.55,.31,.84,0,.76,.87,.17,.38,.22,0,.87,.99,.63,.3,.11,.54,.5,.05,.24,.86,.52,.64,.47,.4,0,1,.61,.33,.69,.08,.98,.52,.12,.71,.43,.25,.92,.02,.86,.35,.78,.05,.65,.41,.1,.63,.05,.77,.65,.96,.4,.81,.66,.09,.78,.71,.86,.42,.35,.22,.72,.52,.86,.71,.04,.97,.4,.19,.95,.15,.37,.57,.06,.79,.46,.65,.72,.51,.93,.69,.82,.74,.07,.57,.28,.03,.43,.72,.56,.3,.81,.52,.4,.7,.28,.81,.66,.42,.91,.67,.12,.82,.55,.87,.18,.45,.77,.09,.69,.16,.77,.65,.24,.92,.39,.64,.08,.51,.32,.41,.23,.09,.7,.58,.8,.49,.1,.79,.96,.72,.2,.95,.53,.09,.61,.98,.52,.33,.54,.15,.78,.39,.94,.73,.17,.66,.6,.12,.92,.77,.27,.83,.57,.11,.23,.43,.03,.87,.25,.75,.63,.84,.08,.61,.76,.15,.53,.94,.27,.08,.91,.53,.22,.94,.36,.9,.5,.21,.56,.16,.56,.34,.97,.49,.1,.62,.67,.93,.49,.14,.62,.2,.58,.12,.34,.63,.55,.84,.68,.3,.51,.2,.91,.02,.89,.38,.45,.13,.27,.41,.18,.79,.94,.52,.11,.25,.19,.66,.89,.14,.59,.88,.02,.49,.21,.78,.51,0,.47,.75,.21,.03,.7,.84,.27,.54,.38,.22,.91,.56,.84,.02,.73,.18,.28,.83,.02,.92,.64,.88,.29,.04,.44,.75,.93,.45,.39,.61,.11,.67,.42,.28,.47,.82,.06,.75,.69,.43,.23,.04,.58,.33,.45,.96,.32,.41,.22,.05,.32,.16,.91,.49,.81,.95,.65,.55,.38,.21,.47,.17,1,.31,.49,.22,.69,.42,.69,.56,.84,.34,.73,.82,.56,.13,.3,.84,.73,.89,.29,.44,.03,.24,.92,.21,.84,.06,.28,.38,.81,.42,.94,.48,.82,.27,.01,.44,.23,.94,.05,.56,.33,.62,.3,.05,.8,.98,.61,.51,.86,.14,.36,.62,.81,.94,.48,.08,.4,.22,.31,.95,.73,.35,.99,.06,.3,.87,.62,.37,.27,.92,.36,.12,.64,.02,.88,.47,.29,.13,.44,.36,.88,.49,.99,.6,.7,.12,.47,.8,.36,.95,.65,.28,.19,.02,.27,.86,.49,.27,.77,.92,.15,.63,.43,.29,.12,.84,.94,.48,.8,.86,.06,.77,.37,.58,.8,.98,.62,.75,.68,.27,.18,.35,.73,.14,.9,.8,.01,.35,.56,.89,.36,.08,.84,.3,.12,.21,.44,.16,0,.29,.47,.17,.71,.04,.27,.06,.94,.62,.83,.69,.53,.36,.15,.56,.77,.97,0,.25,.75,.09,.67,.76,.89,.09,.72,.59,.83,.69,.23,.84,.16,.72,.56,.33,0,.25,.91,.67,.47,.22,.74,.38,.59,.96,.7,.77,.55,.11,.62,.14,.82,.58,.27,.72,.15,.98,.58,.67,.52,.43,.99,.57,.76,.95,.03,.61,.78,.18,.58,.09,.23,.42,.36,.2,.55,.25,.6,.18,.13,.55,.84,.63,.7,.06,.18,.84,.35,.04,.7,.2,.88,.97,.36,.62,.08,.64,.19,.27,.1,.63,.89,.01,.71,.53,.47,.04,.4,.58,.78,.51,.08,.26,.68,.49,.6,.83,.7,.11,.67,.57,.97,.64,.76,.48,1,.6,.76,.66,.88,.99,.61,.4,.47,.69,.51,.17,.13,.32,.58,.78,1,.45,.33,.59,.88,.52,.31,1,.37,.14,.59,.96,.42,.32,.12,.99,.42,.54,.95,.49,.18,.83,.64,.73,.37,.09,.84,.03,.3,.16,.84,.34,.01,.84,.17,.44,.29,.54,.39,.66,.89,.43,.11,.83,.06,.78,.2,.88,.3,.15,.41,.33,.73,.51,.97,.67,.31,.92,.65,.75,.84,.98,.74,0,.9,.49,.77,.36,.89,.4,.52,.96,.75,.42,.58,1,.5,.33,.01,.67,.18,.53,.33,.7,.39,.55,.93,.22,.51,.15,.28,.35,.23,.89,.13,.96,0,.88,.44,.99,.33,.09,.95,.28,.21,.45,.78,.16,.33,0,.91,.36,.82,.08,.4,.53,.09,.35,.53,.78,.93,.34,.84,.76,.43,.87,.08,.27,.02,.66,.22,.69,.1,.16,.64,.55,.22,.47,.31,.51,.18,.78,.46,.09,.8,.03,.67,.26,.4,.88,.12,.45,.28,.58,.97,.48,.79,.65,.11,.5,.27,.47,.94,.67,.86,.94,.19,.06,.8,.2,.53,.33,.47,.41,.09,.71,.81,.23,.71,.1,.83,.25,.14,.37,.81,.03,.51,.11,.33,.06,.42,.82,.31,.69,1,.08,.25,.12,.81,.33,.09,.65,.24,.09,.75,.86,.58,.47,.78,.27,.89,.06,1,.47,.79,.68,.42,.86,.95,.06,.83,.77,.55,.31,.23,.67,.63,.8,.2,.73,.41,.65,.04,.98,.84,.27,.47,.53,.09,.24,.69,.31,.94,.2,.24,.85,.03,.16,.22,.1,.38,.01,.66,.95,.48,.73,.88,.4,.12,.89,.45,.8,.4,.85,.03,.89,.8,.66,.01,.88,.25,.58,.18,.36,.75,.91,.08,.52,.76,.97,.18,.75,.24,.42,.55,1,.22,.77,.63,.38,.05,.58,.23,.02,.75,.48,.35,.59,.93,.74,.24,.96,.62,.02,.52,.46,.88,.22,.56,.42,.05,.86,.58,.45,.18,.88,.27,.63,.58,.41,.09,.21,.44,.58,.73,.47,.2,.92,.56,.37,.91,.46,.17,.26,.38,.95,.09,.83,.42,.74,.15,.6,.31,.04,.33,.73,.56,.46,.66,.18,.44,.73,.48,.16,.38,.51,.03,.59,.13,.88,.52,.35,.14,.62,.95,.8,.73,.44,.57,.15,.76,.59,.73,.44,.78,.89,.66,.6,1,.27,.55,.22,.36,.16,.53,.63,.84,.35,.28,.95,.05,.7,.61,.13,.7,.25,.95,.55,.69,.92,.49,.86,.14,.31,.58,.22,.33,.04,.55,.68,.12,.88,.06,.35,.45,.93,.83,.15,.7,.32,.77,.42,.69,.98,.12,.86,0,.66,.16,.82,.44,.33,.93,.58,.05,.99,.64,.75,.93,.26,.71,.34,1,.69,.51,.92,.7,.16,.95,.64,.81,.02,.86,.68,.59,.28,.02,.84,.69,.31,.82,.63,.06,.69,.16,.56,.63,.36,.22,.87,.09,.97,.18,.62,.11,.32,1,.02,.64,.94,.84,.11,.91,.22,.84,.93,.45,.73,.31,.58,.71,.05,.38,.29,.19,.97,.87,0,.46,.93,.11,.39,.57,.28,.49,.73,.45,.8,.06,.72,.84,.78,.31,.92,.05,.57,.73,.53,.24,.33,.98,.49,.41,.34,.06,.44,.31,.71,.07,.64,.44,.81,.7,.95,.65,.42,.91,.81,.33,.62,.16,.72,.59,.28,.09,.51,.97,.88,.12,.53,.28,.61,.25,.4,.52,.3,.58,.89,.22,.76,.18,.38,.7,.29,.36,.47,.18,.55,.11,.22,.8,.39,.14,.05,.24,.86,.53,.33,.51,.27,.37,.11,.98,.4,.75,.14,.49,.02,.92,.54,.73,.31,.96,.45,.02,.84,.49,.67,.44,.53,.84,.89,.25,.52,.8,.39,.25,.06,.77,.29,.67,.61,.42,.34,.25,.8,.07,.18,.91,.49,.87,.67,.12,.62,.33,.52,.81,.32,.66,.19,.96,.06,.35,.08,.2,.9,.64,.48,.13,.05,.44,.22,.5,.18,.65,.13,.45,.78,.16,.25,.76,.92,.63,.84,.15,.38,.22,.98,.27,.53,.01,.16,.79,.62,.27,.06,.41,.53,.94,.26,.03,.87,.42,.24,.6,.35,.21,.83,.56,.04,.78,.7,.97,.07,.37,.11,.53,.65,.08,.85,.5,.12,.8,.01,.87,.41,.75,.63,.01,.56,.77,.36,.45,.8,.04,.69,.14,.95,.44,.83,.16,.53,.67,.24,.99,.61,.41,.23,.12,.38,.78,.21,.3,.92,.11,.8,.27,.72,.37,.45,.04,.73,.87,.16,.6,.51,.34,.56,.02,.76,.12,.69,0,.63,1,.42,.77,.24,.56,.02,.46,.84,.27,.69,.07,.23,.84,.48,.76,.68,.85,.94,.53,.16,.31,.38,.98,.6,.67,.76,.96,.08,.88,.38,.95,.67,.56,.87,.06,.2,.52,.11,.77,.47,.55,.69,.09,.91,.39,.48,.24,.13,.45,.91,.19,.84,.75,.48,.78,.55,.66,.75,.02,.44,.65,.96,.16,.91,.34,.45,.19,.84,.7,.78,.41,.28,.93,.42,.74,.24,.91,.6,.68,.31,.84,.95,.48,.29,.86,.94,.61,.29,.41,.72,.87,.2,.58,.77,.3,.05,.88,.44,.35,.19,.77,.96,.49,.91,.62,.53,.7,.38,.58,.31,.95,.06,.16,.65,.93,.21,.42,.67,.95,.21,.89,.46,.97,.27,.49,.95,.88,.17,.51,.36,.84,.16,.31,.7,.96,.2,.75,.42,.15,.98,.55,.01,.31,.22,.42,.6,.25,.76,.44,.89,.23,.55,.16,.33,.85,.28,.71,.59,.03,.3,.09,.63,.34,.58,.7,.23,.96,0,.33,.82,.18,.74,.31,.87,.98,.56,.77,.7,.58,.06,.3,.12,.98,.19,.13,.95,.31,.8,.09,.49,.39,.76,.08,.55,.28,.62,.46,1,.13,.84,.57,.03,.64,.34,.52,.09,.22,.46,.16,.07,.24,.66,.18,.12,.7,.21,.99,.07,.34,.62,.04,.73,.38,.94,.62,.81,.09,.69,.07,.66,.27,0,.83,.09,.99,.66,.05,.19,.75,.61,.5,.78,.31,.56,.08,.48,.33,.82,.12,.71,.16,.86,.2,.36,.55,.45,.28,.69,.09,.61,.94,.78,.37,.53,.05,.9,.57,.71,.36,.88,.63,.09,.48,.82,.02,.72,.67,.11,.74,.84,.4,0,.62,.47,.36,.2,.82,.49,.92,.41,.82,1,.45,.31,.88,.66,.14,.94,.45,.58,.64,.07,.69,.37,.02,.33,.96,.43,.67,.56,.35,.4,.84,.5,.56,.71,.9,.26,.67,.23,.64,.82,.93,.04,.23,.34,.07,.49,.31,.96,.17,.83,.39,.73,.99,.8,.36,.55,.92,.73,.44,.53,.02,.85,.56,.47,.79,.26,.97,.49,.22,.12,.57,.28,.38,.87,.53,.84,.44,.57,.35,.24,.14,.77,.47,.91,.41,.25,1,.35,.13,.73,.96,.61,0,.73,.24,.59,.42,.62,.75,.08,.82,.1,.74,.96,.01,.5,.42,.17,.09,.3,.63,.45,.81,.28,.11,.44,.77,1,.71,.36,.18,.96,.49,.03,.29,.93,.52,.7,.89,.13,.54,.99,.76,.13,.69,.25,.17,0,.77,.09,.59,.55,.42,.71,.24,.05,.93,.19,.44,.82,.14,.51,.23,.82,.16,.91,.61,.04,.7,.24,.05,.17,.34,.55,.03,.98,.5,.13,.39,.71,.57,.91,.64,.75,.21,.7,.11,.45,.92,.26,.04,.51,.63,.87,.02,.33,.8,.93,.39,.31,.65,.15,.43,.87,.11,.67,.35,.85,.72,.01,.95,.45,.31,.13,.19,.75,.68,.86,.44,.26,.58,.86,.09,.55,.83,.02,.88,.53,.38,.16,.9,.53,.37,.95,.09,.3,.55,.67,.33,.23,.86,.4,.62,.25,.85,.58,.66,.98,.86,.12,.19,.66,.94,.2,.53,.16,.06,.58,.87,.33,.54,.86,.36,.17,.11,.45,.23,.79,.07,.42,.27,.48,.36,.88,.55,.66,.4,.22,.84,.18,.29,.87,.5,.33,.78,.51,.27,.95,.62,.88,.09,.4,.77,.27,.47,.8,.91,.32,.64,.98,.41,.84,.78,.42,.31,.88,.1,.77,.43,.18,.85,.55,.39,.88,.78,.56,.15,.64,.3,.75,.18,.69,.42,.21,.6,.15,.74,.25,.89,.05,.71,.3,.56,.92,.44,.78,.2,.5,.69,.22,.64,1,.38,.93,.05,.53,.95,.35,.02,.69,.33,.15,.67,.45,.27,.81,.23,.84,.31,.66,.05,.83,.49,.89,.01,.44,1,.6,.48,.14,.91,.32,.74,.03,.45,.24,.72,.35,.41,.51,.04,.74,.33,.84,.27,.75,.44,.24,.16,.61,.76,.64,.99,.75,.31,.94,.65,.85,.05,.64,.96,.07,.32,.57,.92,.49,.92,.7,.05,.99,.11,.6,.88,.04,.72,.11,.47,.75,.64,.53,0,.71,.22,.08,.53,.43,.76,.5,.13,.61,.06,.18,.58,.67,.25,.53,.3,.81,.02,.11,.43,.29,.04,.34,.85,.6,.44,.91,.12,.27,.5,.99,.06,.69,.45,.52,.94,.61,.79,.39,.19,.01,.61,.07,.39,.96,.16,.76,.04,.6,.78,.28,.49,.11,.64,.21,.8,.5,.96,.39,.77,.62,.08,.42,.68,.11,.49,.42,.78,.19,.71,.23,.93,.8,.18,.7,.05,.55,.77,.2,.95,.36,.82,.49,.02,.94,.57,.88,.84,.59,.41,.93,.5,.63,.02,.8,.89,.39,.47,.28,.55,.03,.6,.38,.16,.54,.31,.72,.19,.79,.84,.27,.75,.06,.34,.81,.56,.37,.75,.19,.45,.39,.85,.59,.22,.36,.27,.94,.34,.97,.59,.86,.17,.97,.03,.22,.88,.29,.7,.95,.82,.34,.92,.06,.97,.49,.34,.93,.77,.64,.96,.51,.21,.82,.02,.99,.35,.56,.88,.76,.36,.27,.87,0,.35,.12,.22,.67,1,.81,.26,.65,.89,.29,.53,.36,.86,.45,.08,.22,.67,.83,.4,.73,.91,.23,.12,.58,.89,.2,1,.55,.76,.94,.59,.15,1,.63,.35,.57,.13,.28,.41,.87,.24,.35,.69,.07,.5,.11,.89,.6,.21,.7,.08,.3,.15,.26,.04,.67,.13,.39,.98,.7,.09,.67,.05,.89,.15,.84,.48,.71,.12,.77,.95,.57,.03,.44,.58,.12,.17,.43,.63,.11,.22,.66,.31,.94,.69,.24,.33,.95,.05,.78,.13,.85,.18,.49,.42,.3,.66,.37,.59,.78,.68,.36,.52,.24,.03,.45,.15,.59,.65,.21,.7,.59,.15,.23,.67,.08,.36,.7,.23,.47,.63,.73,.04,.17,.53,.64,.8,.19,.44,.83,.57,.46,.32,.5,.75,.11,.47,.8,.03,.7,.25,.91,.51,.73,.97,.33,.05,.56,.08,.42,.78,.27,.02,.49,.3,.14,.33,.03,.88,.25,.32,0,.45,.75,.64,.51,.09,.64,.96,.45,.84,.6,.42,.66,.16,.28,.78,.43,.84,.64,.47,.73,.96,.22,.83,.29,.17,.52,.34,.22,.96,.31,.78,.36,.22,.96,.28,.44,.22,.67,.4,.98,.48,.67,.86,.97,.51,.86,.95,.45,.55,.08,.79,.15,.55,.67,.5,.91,.59,.45,.66,.09,.81,.73,.13,.84,.27,.08,.46,.91,.12,.64,.55,.75,.83,.4,.87,.27,.08,.96,.33,.83,.43,.91,.78,.14,.52,.84,.09,.22,.43,.84,.97,.09,.31,.73,.99,.66,.03,.87,.08,.16,.95,.35,.22,.58,.78,.42,.19,.65,.33,.16,.42,.58,.18,.95,.35,.66,.62,.85,.36,.75,.92,.84,.64,.47,.38,.74,.55,.89,.81,.16,.98,.38,.78,.57,.11,.31,.19,.87,.25,.98,.73,.39,.55,.11,.99,.18,.38,.89,.53,.45,.76,.58,.87,.46,.78,.58,.73,.5,.42,.67,.08,.63,.87,.5,.09,.91,.14,.29,.21,.36,.77,.24,.3,.74,.15,.03,.83,.27,.63,.99,0,.41,.26,.73,.04,.25,.56,.9,0,.22,.55,.48,.94,.64,.33,.17,.83,.4,.99,.21,.33,.11,.73,.53,.43,.78,.48,.09,.55,.31,.59,.95,.31,.75,.4,.92,.67,.33,.24,.43,.61,.53,.15,.41,.28,.94,.71,.61,.38,.83,.7,.09,.98,.51,.11,.94,.8,.03,.87,.27,.75,.86,.48,.15,.99,.07,.44,.68,.11,.56,.22,.86,.18,.64,.8,.08,.39,.27,.05,.84,.23,.91,.73,.5,.01,.76,.33,.09,.46,.02,.91,.27,.49,.73,.01,.56,.09,.31,.7,.02,.24,.1,.93,.39,.01,.62,.11,.89,.55,.73,.02,.81,.35,.77,.62,.83,.73,.01,.55,.06,.38,.48,.67,.35,.89,.42,.49,.33,.77,.88,.18,.46,.98,.38,.76,.29,.63,1,.4,.76,.2,.01,.98,.58,.77,.05,.3,.68,.5,0,.94,.19,.65,.05,.88,.37,.73,0,.18,.47,.07,.65,.27,.86,.13,.51,.71,.87,.03,.92,.24,.77,.49,.34,.2,.78,.02,.49,.91,.16,.32,.75,.59,.28,.39,.55,.95,.65,.46,0,.7,.31,.23,.8,.2,.53,.25,.39,0,.51,.95,.11,.22,.5,.94,.62,.69,.47,.33,.16,.41,.96,.64,.54,.91,.59,.8,.69,.87,.62,.31,.67,.8,.28,.85,.15,.48,1,.6,.66,.29,.15,.86,.2,.99,.27,.33,.16,.4,.66,.19,.58,.07,.54,.94,.45,.63,.81,.59,.04,.25,.57,.76,.08,.18,.59,.8,.09,.29,.64,.81,.15,.53,.86,.45,.32,.05,.89,.66,.42,.72,.24,.48,.35,.88,.61,.81,.45,.58,.84,.36,.25,.63,.22,.99,.66,.84,.36,.91,.56,.15,.45,.59,.02,.79,.2,.47,.37,.82,.59,.06,.86,.44,.56,.31,.53,.25,.62,.44,.01,.82,.2,.69,.48,.09,.37,.21,.82,.42,.9,.58,.45,.93,.64,.87,.98,.75,.7,.29,.44,.58,.31,.72,.18,.55,.88,0,.61,.27,.82,.19,.38,.13,.27,.45,.19,.34,.15,.08,.4,.96,.23,.64,.91,.41,.2,.81,.42,.92,.75,.49,.35,.75,.52,.45,.89,.96,.29,.45,.94,.24,.33,.13,.27,.99,.19,.9,.79,.96,.22,.71,.86,.94,.24,.45,.69,.91,.58,.33,.07,.69,.18,.12,.71,.59,.14,.52,.3,.83,.15,.86,.62,.09,.16,.97,.23,.29,.91,.12,.78,.94,.44,.15,.53,.8,.24,.72,.05,.96,.81,.29,.37,1,.64,.27,.07,.69,.15,.97,.64,.11,.8,.98,.07,.88,.73,.37,.89,.55,1,.06,.77,.15,.88,.55,.07,.63,.11,.34,.75,.05,.33,.12,.46,.36,.05,.62,.82,.97,.03,.87,.11,.28,.42,.78,.93,.7,.06,.45,.67,.9,.63,.07,.97,.53,.77,.92,.48,.12,.36,.53,.8,.04,.7,.34,.06,.53,.23,.66,.59,.08,.82,.69,.05,.55,.09,.86,.69,.43,.78,.86,.7,.38,.14,.33,.63,.52,.4,.13,.31,.67,.04,.39,.52,.21,.02,.75,.92,.61,.42,.95,.8,.25,.86,.34,.94,.05,.45,.69,.22,.75,.44,.38,.71,.05,.66,.46,.53,.7,.03,.57,.29,.11,.61,.42,.52,.19,.69,.92,.07,.55,.85,.41,.95,.79,.45,.3,.4,.24,.69,.15,.42,.79,.2,.11,.67,.14,.28,.42,.61,.31,.69,.98,.3,.76,.94,.52,.85,.09,.59,.7,.19,.57,.91,.23,.15,.75,.37,.47,.79,.99,.62,.09,.5,.36,.56,.86,.01,.25,.75,.39,.81,.65,.22,.58,.87,.72,.02,.62,.44,.28,.92,.5,.12,.85,.33,.04,.94,.4,.14,.23,.6,.8,.24,.73,.02,.16,.6,.5,.04,.55,.72,.44,.07,.86,0,.6,.47,.54,.84,.95,.14,.86,.41,.48,.24,.29,.54,.01,.65,.48,.09,.74,.2,.61,.37,1,.31,.91,.55,.06,.86,.58,.4,.21,.09,.31,.82,.4,.87,.49,.93,.76,.33,.11,.44,.64,.22,.14,.73,.32,.12,.58,.5,.01,.86,.93,.51,.36,.6,.3,.56,.95,.34,.48,.85,.73,.92,.24,.81,.41,.57,.15,.22,.68,.27,.41,.78,.95,.29,.84,.68,.49,.41,.09,.65,.58,.24,.05,.38,.84,.23,.13,.97,.3,.77,.51,.96,.31,.1,.46,.03,.39,.29,.18,.82,.97,.3,.17,.67,.76,.6,.99,.44,.8,.26,.89,.31,.73,.38,.92,.34,.52,.39,.99,.3,.91,.23,.67,.94,.28,.17,.73,.36,1,.77,.27,.07,.75,.28,.61,.99,.8,.11,.84,.91,.36,.22,.98,.38,.68,.56,.78,.11,.53,0,.66,.25,.76,.17,.49,.99,.81,.89,.6,.25,.95,.75,.05,.17,.27,.84,.56,.88,.35,.84,.45,.52,.62,.2,.86,.27,.73,.59,.17,.75,.05,.92,.71,.09,.51,.75,.63,.09,.36,.02,.5,.13,.04,.49,.87,.38,.02,.99,.54,.23,.5,.39,.02,.13,.8,.27,.9,.51,.19,.85,.69,.54,.17,.76,.64,.43,.6,.18,.45,.13,.58,.91,.27,.8,.99,.67,.51,.72,.08,.88,.56,.08,.39,.28,.2,.7,.09,.56,.64,.51,1,.08,.48,.13,.63,.87,.54,.09,.8,.35,.1,.58,.81,.48,.92,.57,.22,.15,.9,.42,.48,.68,.09,.36,.17,.64,.58,.73,.16,.78,.55,.29,.03,.93,.27,.85,.72,.17,.81,.45,.92,.31,.64,0,.28,.72,.16,.53,.08,.36,.69,.59,1,.01,.49,.16,.76,.06,.27,.95,.02,.99,.68,.36,.11,.67,.08,.47,.81,.26,.44,.86,.02,.25,.91,.19,.56,.84,.65,.95,.73,.31,.8,.62,.45,.72,.16,.87,.09,.76,.61,.99,.34,.71,.95,.03,.73,.3,.42,.94,.58,.88,.33,.09,.94,.85,.34,.66,.87,.18,.72,.62,.16,.08,.42,.24,.34,.47,.69,.85,.96,.02,.5,.89,.36,.17,.75,.01,.82,.2,.67,.96,.04,.75,.27,.15,.63,.47,.89,.39,.23,.65,.35,.83,.04,.66,.79,.32,.18,.55,.77,.25,.53,.39,.05,.33,.45,.09,.62,.89,.48,.14,.44,.33,.95,.41,.6,.35,.11,.7,.22,.84,.38,.47,.44,.66,.82,.22,.45,.54,.38,.86,.69,.28,.95,.55,.68,.81,.39,.16,.77,.42,.91,.84,.42,.32,.64,.13,.19,.98,.61,.39,.8,.69,.3,.46,.26,.37,.6,.22,.95,.05,.31,.89,.59,.36,.66,.88,.43,.22,.56,.45,.17,.61,.34,.91,.12,.07,.24,.47,.8,.56,.05,.69,.23,.06,.53,.4,.48,.36,.84,.56,.91,.64,.97,.13,.2,.43,.24,.79,.62,.72,.4,.97,.47,.24,.58,.42,.3,.81,.22,.45,.69,.36,.84,.71,.15,1,.02,.52,.11,.29,.43,.49,.11,.61,.95,.86,.01,.92,.71,.88,.97,.27,.69,.93,.84,.17,.35,.78,.65,.05,.51,.14,.88,.04,.73,.96,.43,.58,.13,.96,.04,.86,.31,.94,.14,.77,.23,.09,.64,.2,.47,.37,.12,.6,.31,.49,.09,.56,.3,.22,.52,.97,.87,.56,.74,.38,.28,.12,.53,.98,.14,.75,.09,.87,.17,.55,.69,.12,.52,.8,.19,.05,.29,.51,.15,.73,.03,.86,.38,.11,.8,.47,.66,.77,.41,.01,.71,.18,.27,.49,.79,1,.75,.25,0,.95,.2,.76,.33,.03,.8,.59,.75,.55,.34,.89,.15,.55,.22,.07,.78,.33,.94,.72,.59,.35,.55,.85,.03,.98,.5,.05,.31,.6,.76,.18,.69,.88,.75,.97,.24,.71,.37,.14,.43,.32,.6,.12,.22,.75,.5,.02,.24,.44,.7,.56,.89,.21,.69,.76,.28,.62,.22,.53,.07,.82,.67,.25,.75,.59,.4,.49,.91,.72,.32,.42,.94,.8,.02,.91,.71,.2,.84,.91,.63,.03,1,.8,.06,.16,.72,.01,.48,.78,.66,.89,.43,.03,.36,.93,.67,.81,.01,.44,.92,.24,.65,.4,.47,.74,.96,.23,.8,.92,.32,.65,.25,.58,.97,.19,.28,.61,.86,.99,.36,.61,.94,.41,.58,.31,.15,.95,.68,.44,.09,.48,.72,.16,.4,.29,.91,.03,.67,.47,.07,.3,.91,.68,.6,.85,.12,.05,.77,.08,.93,.29,.13,.57,.2,.75,.26,.44,.85,.95,.41,.63,.15,.55,.84,.04,.46,.75,.53,.83,.05,.47,.56,.82,.36,.59,.75,.13,.95,.08,.28,.85,.55,.08,.99,.48,.88,.37,.75,.3,.91,.2,.36,.07,.64,.17,.01,.62,.85,.55,.15,.58,.34,.85,.44,.07,.55,.26,.73,.38,.6,.45,.67,.37,.27,.43,.1,.94,.19,.07,.73,.63,.21,.53,.58,.3,.48,.77,.37,.84,.15,.96,.08,.89,.69,.37,.57,.07,.48,.78,.88,.7,.43,.05,.94,.55,.14,.22,.5,.76,.11,.88,.04,.46,.64,.53,.82,.29,.61,.91,.24,.84,.52,.65,.11,.95,.19,.56,.99,.83,.42,.02,.52,.19,.39,.51,.84,.15,.47,.62,.8,.42,.89,.65,.95,.37,.08,.22,.48,.01,.27,.36,.19,.64,.28,1,.18,.24,.67,.96,.36,.06,.16,.97,.31,.52,.78,.38,.48,.16,.4,.83,.36,.19,.65,.12,.18,.45,.61,.5,.95,.82,.23,.78,.45,.27,.05,.96,.39,.69,.23,.53,.17,.77,.98,.36,.14,.84,.2,.12,.73,.58,.99,.81,.62,.32,.24,.56,.81,.27,.87,.41,.05,.92,.25,.62,.08,.76,.56,.33,.62,.42,0,.16,.63,.39,.97,.19,.16,.03,.53,.33,.74,.39,.69,.09,.84,.44,.17,.67,.73,.2,.36,.09,.89,.16,.69,.37,.06,.58,.97,.24,.36,.8,.4,.26,.77,.36,.16,.75,.31,.98,.65,.27,.97,.41,.68,.25,.73,.32,.12,.51,.02,.72,.58,.88,.82,.67,.93,.42,.91,.8,.11,.58,.89,.38,.76,.31,.71,.92,.64,.44,.84,.2,.62,.02,.99,.72,.64,.45,.03,.71,.8,.6,1,.02,.72,.09,.42,.71,.32,.98,.88,.37,.73,.18,.51,.77,.03,1,.62,.41,0,.67,.47,.94,.52,.32,.89,.48,.23,.14,.89,.52,.78,.39,1,.49,.12,.77,.18,.68,.13,1,.2,.52,.05,.27,.78,.22,.54,.82,.92,.11,.27,.53,.37,.77,.89,.24,.85,.03,.47,.31,.96,.57,.25,.34,.97,.85,.27,.76,.59,.03,.5,.99,.74,.44,0,.73,.47,.6,.71,.01,.49,.66,.59,.25,.88,.45,.1,.71,.21,.55,0,.9,.09,1,.48,.18,.82,.63,.29,.34,.11,.53,.75,.05,.7,.49,.33,.69,0,.84,.44,.09,.19,.5,.27,.04,.69,.15,.5,.66,.33,.24,.12,.91,.56,.26,.42,.91,.51,.3,.38,.89,.16,.54,.02,.41,.58,.66,.11,.81,.28,.88,.13,.66,.82,.29,.87,.57,.09,.77,.26,.03,.93,.09,.41,.66,.02,.47,.67,.05,.16,.31,.72,.96,.61,.36,.84,.55,.42,.67,.93,.89,.7,.13,1,.35,.47,.68,.75,.6,.94,.45,.63,.16,.58,.78,.9,.63,.73,.03,.81,.53,.59,.03,.49,.98,.41,.23,.8,.34,.16,.82,.2,.93,.3,.14,.86,.95,.21,.11,.94,.78,.06,.55,.81,.36,.9,.74,.37,.83,.28,.59,.69,.25,.92,.4,.17,.65,1,.18,.59,.29,.14,.58,.97,.27,.51,.15,.58,.95,.63,.41,.88,.77,.34,.92,.42,.81,.88,.59,.79,.31,.96,.15,.06,.35,.23,.86,.67,.78,.25,.63,.84,.11,.21,.51,.97,.59,.44,.2,.38,.48,.34,.13,.52,.2,.89,.39,.63,.7,.55,.18,.73,.86,.3,.96,.21,.89,.44,.64,.55,.02,.47,.25,.73,.05,.8,.35,.18,.47,.38,.51,.74,.27,.07,.86,.31,.02,.83,.09,.28,.98,.11,.41,.19,.26,.13,.39,.89,.22,.42,.12,.67,.32,.72,.11,.91,.64,.27,.38,.66,.51,.8,.05,.34,.45,.55,.85,.33,.4,.17,.7,.59,.13,.09,.63,.16,.51,.42,.03,.76,.39,.52,.05,.78,.45,.23,.39,.85,.47,.22,.87,.09,.36,.77,.71,.33,.01,.8,.55,.11,.58,1,.05,.27,.19,.09,.52,.05,.69,.47,.82,.71,.63,.75,.56,.04,.21,.99,.47,.31,.75,.8,.27,.33,0,.72,.91,.56,.93,.05,.74,.96,.3,.72,.07,.36,.97,.42,.8,.35,.59,.51,.13,.35,.6,.81,.08,.25,.83,.33,.9,.51,.29,.1,.88,.59,.03,.84,.07,.62,.42,.78,.15,.53,.24,.39,.67,.48,.71,.36,.67,.53,.87,.5,.67,.09,.62,.93,.8,.87,.2,.62,.47,.84,.53,.07,.59,.88,.12,.27,.58,.93,.67,.27,.03,.7,.48,.91,.28,.96,.42,.49,.31,.97,.78,.64,.22,.85,.12,.97,.71,.53,.87,.73,.04,.92,.67,.78,.42,.63,.2,.91,.44,1,.22,.76,.34,.25,.16,.45,.63,.55,.75,.36,.95,.42,.22,.36,.89,.52,.07,.95,.13,.47,.36,.58,.07,.9,.68,.05,.91,.42,.15,.64,.08,.78,.19,.69,.6,.4,.8,.53,.17,.83,.22,.05,.64,.27,.98,.07,.73,.78,.52,.93,.31,.75,.96,.17,.11,.64,.97,.4,.71,.25,.66,.31,.95,.22,.92,.55,.64,.98,.77,.9,.17,.03,.83,.24,.94,.02,.79,.34,1,.77,.29,.07,.36,.55,.09,.9,.36,0,.21,.79,.44,.94,.36,.72,.64,.41,.15,.78,.89,.57,.12,.63,.02,.23,.77,.88,.7,.25,.1,.94,.34,.56,.65,.31,.22,.08,.32,.63,.13,.55,.28,0,.95,.73,.51,.05,.27,.66,.47,.09,.94,.65,.73,.83,.31,.92,.69,.12,.84,.63,.73,.09,.25,.39,.2,.44,.3,.91,.82,.75,.16,.45,.37,.61,.53,.75,.87,.5,.33,.28,.42,.84,.23,.12,.03,.45,.93,.59,.5,.88,.11,.55,.16,.83,.41,.25,.16,.02,.38,.59,.49,.68,.42,.8,.56,.19,.77,.97,.53,.16,.77,.48,.02,.31,.38,.12,.44,.59,.34,.96,.58,.47,.74,.11,.6,.22,.45,.16,.58,.71,.25,.45,.77,.28,.56,.74,1,.69,.33,.03,.17,.47,.99,.2,.09,.51,.36,.22,.76,.86,.51,.37,.66,.2,.03,.45,.37,.68,.06,.89,.46,.4,.8,.93,.49,.69,.19,.8,.36,.49,.16,.34,.82,.61,.12,.86,.56,.38,.9,.49,.03,.38,.09,.2,.57,.47,.27,.15,.92,.57,1,.76,.6,.84,.7,.64,.08,.32,.55,.97,.22,.14,.28,1,.2,.67,.83,.98,0,.55,.48,.88,.64,.27,.76,.13,.32,.4,.71,.89,.47,.68,.57,.97,.66,.84,.71,.12,.22,.86,.01,.28,.33,.14,.49,.08,.44,.87,.36,.59,.82,.71,.95,.05,.25,.62,.12,.78,.22,.13,.42,.31,.71,.86,.04,.39,.9,.48,.97,.64,.05,.95,.18,.42,.28,.14,.86,.63,.76,.84,.01,.87,.76,.65,.97,.05,.44,.31,1,.1,.83,.56,.91,.59,.84,.55,.27,.16,.75,0,.58,.15,.37,.91,.42,.98,.65,.87,.58,.1,.42,.98,.35,.76,.18,.69,.14,.31,.6,.95,.78,.42,0,.99,.81,.3,.49,.04,.45,.15,.3,.02,.49,.23,.4,.69,.85,0,.67,.83,.48,.08,.39,.11,.45,.58,.15,.79,.34,.71,1,.38,.2,.67,.96,.78,.27,.2,.37,0,.29,.09,.34,.55,.45,1,.36,.6,.76,.92,.69,.88,.64,.37,.81,.21,.69,.11,.4,.18,.5,.67,.86,.74,.5,.36,.69,.87,.65,.98,.18,.52,.95,.66,.8,.2,.11,.83,.33,.69,.5,.86,.65,.55,.39,.23,.5,.27,.39,.55,.33,.25,.47,.82,.2,.61,.71,.16,.3,.73,.34,.14,.2,.76,.99,.62,.25,.95,.67,.27,.05,.78,.09,.3,.05,.24,.7,.92,.22,.69,.49,.03,.31,.8,.44,.85,.2,.71,.51,.87,.34,.67,.07,.4,.87,.71,.82,.67,.95,.55,.78,.12,1,.19,.49,.78,.28,.94,.73,.56,.8,.25,.36,.73,.66,.91,.29,.17,.04,.81,.58,.08,.46,.03,.55,.87,.75,.95,.8,.5,.86,.2,.04,.78,.31,.08,.51,.18,.44,.84,.03,.27,.67,.05,1,.26,.9,.86,.34,.22,.97,.42,.06,.92,.27,.02,.77,.49,.26,.57,.1,.3,0,.59,.27,.41,.54,.21,.82,.11,.02,.48,.78,.92,.07,.61,.7,.11,.92,.59,.15,.72,.9,.05,.58,.48,.42,.06,.97,.64,.44,.02,.37,.51,.83,.13,.54,.83,.22,.56,.63,.75,.46,.81,.55,.4,.13,.85,.25,.92,.62,.95,.08,.56,.36,.12,.25,.59,.17,.75,.53,.61,.12,.37,.29,.22,.07,.88,.35,.58,.89,.03,.56,.38,.11,.45,.33,.03,.64,.95,.84,.03,.21,.42,.06,.61,.52,.43,.87,.33,.89,.64,.14,.42,.09,.6,.2,.4,.74,.92,.28,.64,.83,.91,.39,.13,.59,.25,.53,.93,.79,.57,.45,.51,.65,.08,.61,.57,.16,.29,.82,.16,.55,.61,.35,.06,.84,.42,.69,.34,.76,.52,.85,.91,.02,.75,.38,.6,.31,.95,.11,.67,.35,.97,.45,.19,.85,.03,.38,.55,.28,.35,.94,.75,.89,.25,.49,.8,.31,.91,.71,.06,.42,.35,.74,.45,.86,.97,.52,.19,.14,.98,.31,.05,.77,.47,.57,.06,.41,.51,.25,.91,.64,.8,.08,.45,.94,.84,.24,.93,.2,.96,.52,.59,.41,.18,.46,.27,.75,.65,.31,.95,.62,.18,.75,.89,.48,.15,.53,.31,.95,.56,.76,.94,.7,.13,.23,.73,.53,.25,.97,.69,.31,.51,.65,.16,.05,.59,.53,.13,.22,.67,.56,.79,.99,.09,.75,.17,.39,.12,.33,.77,.03,.73,.4,.8,.01,.72,.47,.67,1,.45,.89,.16,.76,.92,.2,.82,.95,.45,.09,.67,.47,.97,.25,.89,.73,.19,.43,.74,.17,.86,.24,.73,.49,.77,1,.65,.08,.79,.23,.14,.62,0,.59,.73,.09,.23,.55,.87,.18,.59,.93,.13,.4,.33,.28,.69,.41,.84,.63,.25,.95,.67,.35,.75,.2,.67,.76,0,.48,.99,.73,.3,.14,.37,.05,.47,.78,.65,0,.76,.95,.72,.84,.09,.51,.43,.14,.87,.52,.81,.22,.31,.11,.42,.76,.63,.09,.49,.24,.35,.78,.29,.94,.04,.8,.38,.19,.75,.88,.11,.98,.78,.38,.69,.97,.43,.47,.03,.34,.27,.66,.44,.32,.48,.7,.89,.2,.96,.44,.23,.92,.44,.88,.64,.35,.24,.12,.7,.21,.53,.38,.03,.64,.47,.16,.25,.71,.31,.18,.59,.14,.45,.53,.84,.29,.57,.01,.52,.64,.09,.37,.28,.21,.88,.44,.51,.69,.38,.84,.95,.34,.16,.85,.64,.47,.76,.96,.3,.64,.02,.77,.07,.82,.95,.01,.57,.18,.73,.43,.09,.16,.99,.84,.12,.37,.32,.18,.41,.87,.52,.7,.64,.56,.27,.41,.1,.33,.85,.48,.04,.63,.2,.97,.8,.25,.7,.01,.47,.99,.68,.58,.89,.24,.39,.78,.87,.13,.4,0,.55,.64,.45,.11,.6,.48,.03,.54,.34,.44,.27,.87,.31,0,.82,.75,.94,.88,.2,.78,.02,.92,.85,.08,.59,.82,.1,.67,.29,.11,.51,.19,.09,.95,.78,.4,.07,.81,.95,.68,.31,.55,.07,.88,.37,.55,.09,.78,.85,.41,.07,.69,.05,1,.39,.79,.31,.81,.92,.69,.58,.12,.63,.16,.95,.05,.29,.47,.18,.53,.42,.98,.37,.13,.32,.07,.22,.49,.71,.17,.56,.65,.46,.35,.89,.08,.51,.87,.81,.54,.29,.47,.92,.59,.87,.67,.56,.04,.22,.94,.09,.82,.98,.72,.89,.58,.15,.26,.31,.55,.89,.35,.04,.59,.93,.38,.09,.56,.36,.02,.72,.96,.05,.69,.19,.98,.58,.82,.89,.2,.73,.31,.92,.85,.28,.95,.22,.81,.64,.09,.55,.18,.36,.26,.6,.13,.72,.47,.55,.63,.22,.28,.52,.35,.72,.53,.88,.59,.98,.69,.29,.55,.89,.52,.31,.61,.46,.25,.12,1,.75,.27,.67,.89,.99,.52,.3,.64,.93,.32,.2,.61,.89,.47,.23,.13,.42,.05,.86,.75,.41,.32,.72,.91,.59,.75,.11,.69,.78,.27,.02,.51,.73,.8,.57,.92,.45,.28,1,.11,.22,.78,.28,.67,.39,.24,0,.36,.65,.09,.53,.04,.8,.27,.17,.62,.34,.77,.42,.31,.15,.66,.2,.45,.98,.7,.39,.77,.13,.67,.47,.16,.33,.67,.28,.76,.84,.2,.48,.14,.56,.35,.51,.67,.29,.47,.09,.38,1,.56,.05,.64,.42,.7,.58,.05,.71,.5,.93,.77,.64,.11,.53,.4,.05,.95,.36,.14,.69,.99,.41,0,.47,.17,.79,.02,.35,.75,.44,.14,.02,.73,.2,.85,.09,.76,.91,.4,.49,.79,.02,.45,.34,.19,0,.72,.88,.48,.77,.26,.08,.71,.59,.99,.55,.27,.49,.94,0,.81,.27,.56,.16,.81,.24,.91,.08,.62,.84,.93,.68,.43,.06,.37,.84,.23,.87,.44,.73,.53,.16,1,.76,.6,.95,.71,.83,.24,.73,.33,.45,.92,.71,.82,.48,.1,.92,.55,0,.5,.34,.06,.78,.53,.03,.95,.43,.28,.95,.55,.78,.89,.61,.17,.43,.94,.33,.81,.22,.45,.91,.09,.74,.16,.69,.26,.83,.51,.15,.23,.78,.14,.36,.89,.16,.41,.22,.88,.44,1,.84,.67,.25,.85,.29,.79,.44,.16,.77,.86,.96,.27,.39,.83,.05,.25,.84,.5,.63,.98,.36,.64,.42,.58,.19,.68,.34,.22,.62,.16,.76,.68,.42,.25,.56,.13,.37,.53,.92,.05,.36,.84,.72,.17,.35,.56,.2,.64,.49,.08,.35,.99,.41,.47,.31,.67,.21,.33,.15,.27,.98,.12,.64,.03,.58,.37,.05,.91,.64,.44,.11,.33,.18,.48,.42,.15,.99,.17,.51,.09,.39,1,.27,.2,.73,.61,.27,.95,.84,.64,.28,.9,.66,.15,.84,.6,.73,.04,.22,.13,.5,.97,.08,.52,.67,.61,.86,.73,.03,.4,.84,.94,.63,.42,.05,.76,.3,.87,.53,.02,.47,.99,.3,.69,.03,.57,.29,.07,.33,.16,.5,.73,.07,.58,.89,.09,.64,.3,.58,.15,.67,.45,.56,.64,.94,.31,.7,.25,.13,.93,0,.29,.84,.04,.94,.11,.86,.56,.95,.09,.89,.8,.04,.97,.67,.82,.3,.42,.65,.23,.02,.8,.91,.7,.12,.76,.87,.42,.71,.64,.03,.57,.87,.44,.11,.56,.48,.85,.63,.75,.51,.8,.93,.7,.31,.83,.25,.06,.8,.55,.84,.04,.91,.56,.77,.67,.86,.22,.02,.56,.67,.06,.39,.84,.69,.12,.77,.41,.09,.21,.35,.49,.24,.09,.4,.86,.47,.33,.81,.6,.25,.79,.04,.37,.09,.98,.3,.57,.23,.33,.54,.14,.92,.63,.38,.96,.6,.74,.82,.25,.55,.8,.73,.13,.48,.69,.78,.91,.63,.44,.2,.93,.35,.7,.23,.52,.07,.75,.91,.33,.97,.09,.16,.78,.09,.4,.55,.8,.51,.73,.39,.62,.53,.79,.27,.38,.3,.61,.51,.35,.28,.58,.21,.07,.73,.19,.87,.5,.41,.63,.3,.45,1,.38,.05,.95,.2,.28,.84,.75,.15,1,.69,.78,.89,.04,.31,.38,.16,.29,.45,.13,.19,.48,.57,.39,.94,.65,.23,.69,.34,.27,.05,.45,.61,.31,.73,.89,.49,.79,.97,.45,.33,.2,.58,.47,.71,.82,.58,.98,.72,.34,.64,.96,.55,.7,.02,.39,.72,.2,.89,.29,.48,.17,.67,.79,.51,.01,.89,.8,.19,.69,.47,.09,.33,.22,.42,.64,.09,.34,.96,.38,.86,.22,.56,.01,.36,.83,.65,.03,.48,.37,.81,1,.41,.84,.2,.6,.27,.71,.38,.58,.84,.45,.89,.22,.33,.96,.1,.23,.45,.99,.7,.49,.06,.8,.16,.45,.72,.91,.4,.49,.96,.56,.11,.68,.94,.11,.58,.06,.23,.54,.3,.8,.45,.53,.1,.23,.36,.3,.01,.39,.22,.72,.47,.93,.7,.05,.55,.91,.66,.77,.85,.17,.31,.45,.75,.09,.6,.92,.4,.15,.95,.83,.44,.13,.35,.16,.22,.03,.53,.92,.04,.96,.31,.14,.41,0,.8,.46,.2,.11,.27,.92,.16,.32,.99,.45,.57,.72,.8,.6,.39,.11,.96,.64,.36,.3,.59,.25,.02,.85,.15,.69,.94,.04,.86,.19,.5,.66,.27,.97,.41,.11,.29,1,.15,.28,.56,.85,.19,.03,.58,.37,.11,.53,0,.87,.48,.23,1,.04,.71,.62,.13,.67,.91,.58,.31,.16,.01,.64,.91,.24,1,.2,.85,.11,.32,.78,.62,.28,.89,.33,.2,.48,.71,.88,.82,.67,.61,.14,.9,.68,.96,.72,.51,.81,.92,.64,.33,.07,.56,.2,.83,.63,.41,.24,.98,.1,.34,.71,.04,1,.36,.88,.44,.82,.69,.2,.55,.05,.67,.29,.65,.87,.58,.68,.85,.37,.65,.23,.87,.62,.69,.93,.14,.58,.89,.67,.42,.78,.61,.86,.65,.12,.34,.94,0,.22,.91,.47,.2,.08,.75,.43,.95,.53,.77,.9,.56,.49,.28,.77,.59,.43,.91,.1,.05,.62,.74,.88,.6,.51,.77,.69,.96,.11,.61,.73,.28,.69,.96,.79,.42,.81,.67,.12,.31,.53,.11,.26,.84,.47,.03,.79,.71,.88,.38,.2,.75,.42,.58,.68,.01,.56,.83,.14,.03,.37,.71,.06,.78,.98,.25,.36,.17,.41,.74,.02,.25,.34,.4,.63,.07,.6,.11,.53,.86,.78,.99,.14,.35,.75,.83,.33,.03,.52,.43,.89,.59,.08,.53,.26,.17,.02,.49,.91,.33,.18,.93,.46,.95,.07,.42,.76,.15,.27,.81,.44,.18,.53,.23,.37,.28,.52,.82,.04,.25,.52,.09,.47,.04,.24,.78,.42,.09,.88,.31,.71,.83,.62,.85,.16,.07,.35,.63,.42,.25,.97,.36,.67,.12,.23,.7,.33,.81,.53,.33,.2,.25,.05,.89,.41,.22,.46,.33,.92,.49,.23,.16,.63,.07,.34,.95,.59,.76,.36,.94,.78,.41,.55,.2,.28,.51,.11,.6,.83,.53,.07,.31,.77,.39,.65,.51,.25,1,.47,.82,.53,.41,.12,.54,.63,.05,.95,.49,.87,.56,.08,.87,.18,.31,.85,.47,.25,.17,.66,.44,.53,.88,.05,.15,.48,.68,.79,.27,.65,.22,.84,.77,.63,.97,.31,.58,.75,.41,.8,.56,.22,.75,.52,.3,.97,.1,.49,.73,.59,.03,.76,.95,.09,.67,.75,.4,.33,1,.73,.35,.79,.94,.55,.67,.17,.51,.63,.56,.06,.36,.28,.48,.69,.99,.83,.12,.19,.71,0,.1,.84,.54,1,.39,.76,.16,.47,.94,.67,.78,.48,.31,.07,.64,.77,.15,.87,.06,.76,.39,.92,.55,.24,.18,.04,.67,.5,.23,.7,.01,.34,.95,.81,.41,.93,.47,.27,.88,.14,.49,.96,.27,.2,.92,.75,.66,.11,.22,.58,.3,.87,.75,.45,.82,.28,.2,.36,.8,.64,.47,.77,.94,.2,.73,.97,.38,.01,.31,.22,.66,.27,.97,.6,.86,.18,.97,.11,.5,.33,.4,.13,.47,.67,.84,.09,.27,.66,.11,.38,0,.82,.2,.56,.4,.89,.05,.98,.32,.39,.82,.44,.2,.92,.09,.16,.58,.89,.2,.26,.4,.86,.32,.98,.83,.38,.78,.17,.99,.53,0,.24,.57,.31,.47,.88,.6,.8,.47,.2,.31,.8,.01,.58,.93,.29,.06,.11,.64,.39,.85,.58,.95,.35,.56,.66,.4,.58,.83,.3,.47,.75,.84,.42,.91,.83,.17,.57,.88,.64,.07,.72,.15,.65,.05,.34,.62,.73,.9,.09,.82,.45,.05,.58,.36,.87,.92,.67,.01,.67,.22,.09,.92,.58,.7,.11,.99,.16,.27,0,.66,.4,.05,.67,.56,.82,.75,.93,.5,.38,.77,.11,.28,.55,.37,.77,.67,.93,.03,.73,.9,.21,.38,.04,.98,.48,.86,.69,.91,.34,.65,.88,.6,.25,.69,.2,.55,.89,.62,0,.56,.85,.63,.49,.69,0,.56,.12,.71,.49,.08,.22,.72,.27,.12,.89,.43,.75,.91,.38,.79,.08,.67,.93,.33,.38,.95,.74,.61,.08,.49,.2,.65,.84,.42,.55,.99,.13,.72,.2,.01,.83,.24,.09,.99,.19,.03,.69,.09,.88,.58,.28,.07,.31,.45,1,.08,.5,.25,.56,.86,.23,.75,.99,.19,.41,.24,.67,.6,.13,.86,.41,.28,.06,.43,.17,.97,.37,.89,.33,.51,.01,.42,.76,.31,.5,.92,.55,.84,.35,.49,.11,.9,.47,.15,.09,.57,.2,.91,.42,.72,.05,.45,.06,.28,.85,.56,.35,.05,.55,.93,.44,.58,.16,.29,.53,.14,.23,.45,.05,.15,.35,.84,.47,.11,.28,.16,.73,.33,.41,.24,.8,.37,.97,.44,.63,.76,.05,.35,.59,.45,.03,.49,.67,.31,.11,.62,.16,.73,.52,.22,.06,.53,.16,.23,.67,.44,.95,.87,.37,.14,.72,.31,.78,.24,.88,.51,.28,.67,.46,.77,.31,.7,.5,.59,.95,.15,.36,.71,.48,.81,.13,.73,.2,.38,.78,.92,.43,.32,.51,.07,.8,.56,.01,.53,.36,.31,.97,.77,.19,.64,.8,.52,.73,.27,.47,.62,.8,.25,.67,.88,.19,.61,.73,.39,.24,.11,.61,.86,.2,.31,.25,.61,.82,.72,.01,.51,.25,.64,.85,.92,.62,.53,.15,.22,.67,.8,.28,.76,.7,.24,.77,.93,.44,.63,1,.78,.71,.95,.45,.77,.66,.95,.78,.69,.51,.99,.13,.91,.28,.07,.8,.33,.92,.18,.97,.81,.66,.94,.84,.58,.94,.2,.8,.47,.9,.34,.97,.84,.3,.69,.56,.86,.04,.36,.16,.26,.56,.98,.52,.19,.59,0,.34,.45,.95,.12,.57,.91,.16,.87,.35,.27,.78,.44,.22,0,.97,.6,.68,.53,.85,.29,.66,.12,.18,.97,.6,.48,.38,.29,.85,.95,.76,.47,.05,.68,.49,.93,.13,.57,.34,.84,.08,.55,.14,.41,.96,.34,.54,.1,.91,.03,.67,.95,.29,.79,.66,1,.54,.4,.95,.31,.66,.81,.98,.35,.08,.22,.79,.41,1,.44,.91,.49,.17,.11,.52,.87,.02,.37,.73,.06,.2,.51,.3,.11,.55,.02,.28,.4,.06,.34,.24,.82,.04,.58,.71,.53,.2,.11,.68,.38,.25,.53,.14,.31,.08,.4,.73,.06,.53,.27,.03,.4,.11,.61,.45,.99,.76,.11,.48,.83,.77,.69,.07,.8,.05,.94,.47,.81,.7,.09,.63,.85,.37,.05,.62,.41,.8,.05,.91,.52,.63,.83,.17,.34,.25,.95,.04,.59,.81,.47,.01,.67,.83,.14,.92,.72,.63,.1,.16,.83,.2,.55,.36,.02,.87,.23,.97,.03,.69,.92,.73,.06,.82,.14,.27,.83,.44,.32,.8,.16,.48,.41,.02,.8,.07,.73,.13,.44,.61,.09,.16,.7,.5,.31,.66,.02,.76,.29,.09,.62,.95,.41,.31,.64,.09,.48,.28,.84,.6,.38,.88,.63,.23,.97,.59,.18,.87,.56,.43,.62,.78,.47,.15,.88,.43,.84,.57,.49,.08,.88,.42,.76,.28,.17,.65,.37,1,.84,.69,.56,.77,.17,.36,0,.25,.41,.92,.55,.31,.47,.61,.38,.35,.64,.27,.89,.55,.22,.78,.34,.49,.73,.22,.47,.12,.57,.65,.32,.75,.93,.41,.06,.87,.41,.15,.34,.9,.53,.35,.75,.28,.2,.44,.07,.26,.42,.58,.91,.65,.29,.83,.3,.7,.42,.64,.2,.38,.31,.22,.51,.63,.7,.59,.97,.19,.63,.51,.91,.08,.56,.23,.35,.62,.18,.29,.9,.36,.49,.27,.78,.42,.96,.55,.15,.87,.69,.36,0,.85,.67,.25,.99,.58,.84,.68,.17,.91,.09,.8,.35,.73,.13,.85,.53,.71,.98,.09,.19,.37,.97,.31,.61,.75,0,.28,.95,.73,.59,.2,.52,.81,.95,.78,.42,.13,.6,.09,.22,.95,.51,.69,.89,.8,.16,.66,.22,.01,.91,.16,.85,.22,.74,.1,.16,.39,.95,.02,.27,.18,1,.85,.69,.97,.18,.4,.04,.13,.25,.53,.73,.66,.78,.48,.2,.71,.26,.99,.1,.58,.89,.66,.97,.51,.78,.34,.03,.43,.11,.96,.61,.17,.47,.81,.51,.89,.66,.44,1,.19,.3,.38,.47,.06,.78,.25,.38,.75,.64,.95,.88,.49,.85,.56,.78,.02,.86,.94,.57,.12,.85,.2,.47,.28,.58,.78,.2,.47,.58,.13,.75,.18,.39,.96,.34,.5,.44,.04,.53,.9,.47,.38,.24,0,.77,.29,.85,.67,.03,.25,.12,.97,.45,.69,.16,.35,.04,.99,.7,.1,.56,0,.25,.51,.76,.33,.88,.64,.28,.08,.6,.47,.33,.64,.99,.38,.69,.25,.94,.45,.58,.85,.49,.66,.6,.75,.89,.55,.64,.03,.31,.33,.88,.71,.49,.96,.61,.45,.08,.31,.58,.1,.91,.62,.05,.84,.42,.52,.34,.02,.73,.16,.88,.29,.99,.75,.51,.77,.39,.06,.91,.1,.59,.05,.77,.11,.56,.87,.01,.92,.75,.14,.87,.56,.01,.84,.31,.16,.42,.69,.05,.96,.24,.67,.41,.18,.64,.05,.73,.34,.64,.93,.09,.51,.98,.29,.8,.06,.89,.45,.01,.55,.12,.75,.7,.27,.18,.69,.05,.62,.81,.34,.47,.16,.5,.93,.55,.8,.65,.36,.51,.24,.79,.84,.65,.46,.25,.35,.46,.89,.71,.92,.2,.45,.39,.04,.82,.91,.22,.53,.85,.07,.73,.09,.58,.51,.73,.02,.37,.99,.3,.06,.35,.45,.14,.43,.36,.1,.53,.62,.78,.23,.85,.16,.69,.89,.21,1,.83,.38,.75,.45,.31,.18,.64,.8,.16,.54,.39,.6,.09,.49,.64,.14,.2,.86,.55,.25,.76,.28,.36,.16,.91,.26,.35,.78,.69,.23,.6,.32,.66,.42,1,.22,.47,.78,.1,.25,.33,.42,.16,.75,.53,.33,.99,.25,.39,.91,.01,.8,.41,.19,.88,.33,.71,.41,.54,.27,.73,.64,.25,.94,.62,.84,.99,.4,.29,.12,.96,.64,.92,.59,.73,.09,.42,.2,.91,.06,.86,.11,.4,.53,.32,.12,.91,.72,.62,.13,.33,.65,.03,.97,.72,.53,.16,.35,.72,.12,.95,.29,.48,.88,.81,.19,.32,.63,.07,.69,.2,.81,.87,.23,.72,.8,.91,.76,.45,.16,.06,.43,.58,.3,.38,.79,.02,.34,.69,.23,0,.96,.56,.73,.87,.09,.95,.3,.85,.94,.24,.7,.83,.35,.59,.08,.32,.69,.98,.66,.83,.45,.69,.6,.42,.51,.07,.47,.54,.95,.08,.28,.7,.08,.58,.54,.95,.71,.81,.62,.89,.28,.8,.01,.45,.83,.52,.6,.7,.31,.45,.75,.64,.03,.13,.61,.92,.34,.87,.8,.08,.41,.15,.35,.55,.78,.89,.73,.53,.21,.09,.37,.25,.31,.84,.48,.71,.29,.56,.96,.62,.03,.93,.78,.37,.06,.86,.21,.42,.84,.57,.27,.12,.9,.62,.44,.78,.02,.4,.59,.23,.43,.34,.09,.95,.81,.53,.91,.42,.61,.52,.95,.08,.31,.58,.2,.92,.85,.64,1,0,.75,.11,.51,.63,.48,.16,.9,.52,.13,.37,.25,.47,.23,.63,.7,.45,.11,.56,.39,.01,.25,.95,.42,.9,.49,.01,.4,.22,.54,.95,.02,.21,.97,.14,.82,.36,.18,.83,.49,.91,.75,.34,.87,.19,.01,.59,.49,.1,.96,.62,.12,.7,.77,.1,.2,.14,.99,.08,.23,.56,.48,.95,.22,.65,.09,.18,.49,.29,.89,.53,.01,.22,.09,.49,.17,.27,.42,.88,.8,.66,.98,.02,.6,.14,.43,.75,.2,.27,.49,.71,.2,.52,.27,.8,.55,.97,.08,.38,.78,.69,.47,.25,.99,.31,.67,.9,.78,.16,.94,.64,.77,.26,.45,.11,.25,.77,0,.16,.38,.64,.02,.5,.24,.68,.27,.35,.5,.22,.86,.93,.25,.74,.96,.31,.6,.78,.64,.84,.93,.04,.41,.76,.08,.26,.78,.17,.93,.88,.5,.73,.79,.18,.64,.14,.56,.89,.11,.31,.73,.86,.64,.28,.9,.76,0,.62,.37,.16,.25,.44,.65,.41,.28,.94,.2,.38,.47,.24,.91,.42,.27,.95,.37,.48,.57,.83,.91,.37,.8,.42,.84,.31,.55,1,.67,.44,.59,.96,.72,.63,.34,.94,.67,.56,.75,.01,.49,.14,.45,.77,.27,.95,.05,.82,.67,.36,.84,.09,.59,.98,.65,.44,.16,.7,.49,.62,.16,.33,.02,.84,.09,.55,.19,.51,.06,.69,.53,.01,.4,.58,.69,.85,.33,.48,.98,.29,.72,.83,.34,.96,.73,.4,.09,.55,.84,.67,.45,.58,.4,.19,.05,.86,.42,.21,.08,.31,.7,.58,.99,.53,.87,.36,.49,.73,.33,.64,.12,.22,.04,.38,.28,.85,.76,.45,.25,.67,.17,.47,.35,.71,.59,.44,.25,.72,.97,.58,.02,.81,.13,.91,.73,.42,.84,.05,.71,.86,.2,.55,.06,.62,.87,.78,.67,.32,.02,.7,.27,.16,.05,.75,.4,.07,.82,.2,.1,.28,.78,.44,.89,.05,.38,.1,.97,.34,.62,.92,.18,.36,.88,.66,.39,.49,.12,.91,.42,.78,.25,.31,.02,.9,.09,.28,.78,.24,.97,.87,.52,.39,.66,.79,.45,.95,.31,.24,.61,.84,.09,.89,.17,.37,.74,.09,.67,.44,.85,.55,.48,.14,.8,.62,.04,.94,.18,.29,.08,.15,.66,.83,.53,.12,.69,.45,.9,.15,.5,.12,.33,.19,.67,.01,.97,.63,.08,.44,.55,.84,.67,.99,.53,.71,.33,.04,.99,.8,.4,.54,.04,.23,.09,.94,.12,.33,.45,.86,.69,.53,.33,.04,.61,.15,.53,.78,.02,.38,.64,1,.35,.71,.05,.26,.11,.42,.19,.64,.98,.55,.69,.9,.51,.25,.63,.75,.91,.36,.16,.85,.26,.6,.8,.45,.86,.22,.71,.3,.56,.73,.13,.53,.2,.33,1,.03,.62,.16,.89,.47,.76,.62,.35,.93,.45,.04,.59,.44,.74,.18,.92,.27,.13,.85,.37,.75,.97,.3,.21,.52,1,.05,.59,.91,.54,.12,.27,.2,.08,.89,.31,.44,.91,.77,.38,.72,.89,.97,.33,.77,.36,.27,.78,.98,.56,.37,.75,.81,.24,.84,.44,.56,.2,.83,.25,.39,.95,.31,.6,.42,.07,.94,.2,.65,.49,.61,.12,.86,.75,.98,.46,.66,.53,.81,.22,.09,.28,.95,.77,.56,.99,.26,.65,.33,.57,.29,.12,.79,.51,.16,.45,.89,.95,.58,.5,.88,.11,.33,.45,.21,.95,.13,.34,.55,.01,.49,.66,.08,.53,.2,.72,.31,.16,.54,.08,.82,.05,.47,.94,.25,.69,.8,.58,.24,.71,.37,.55,.12,.82,.22,.56,.84,.67,.15,.89,.29,.07,.71,.35,.01,.71,.58,.05,.48,.12,.43,.71,.35,.78,.45,.28,.18,.83,.34,.95,.78,.58,.67,.17,.52,.25,.13,.58,.46,.24,.53,.02,.46,.93,.62,.15,.34,.04,.86,.42,.64,.04,.72,.92,.12,.3,.72,.89,.05,.75,.19,.1,.8,.25,.47,.13,.88,.36,.24,.95,.31,.42,.78,.18,.38,.84,.05,.62,.75,.38,.17,.47,.22,.34,.81,.11,.95,.89,.45,.75,.04,.9,.58,.65,.2,.36,.73,.07,.77,.4,.8,.59,.01,.66,.83,.44,.96,.71,.33,.58,.99,.75,.43,.93,.01,.67,.88,.42,.98,.42,.63,.83,0,.44,.87,.07,.46,.93,.66,.29,.96,.4,.51,.02,.28,.39,.72,.51,.22,.8,.55,.98,.48,.6,.89,.19,.67,.9,.79,.6,.06,.65,.23,.94,.7,.42,.62,.02,.72,.39,1,.05,.87,.7,.35,.82,.06,.63,.82,.69,.2,.87,.07,.52,.73,.22,.61,.11,.96,.27,.55,.37,.8,.47,.52,.15,.6,.82,.48,.37,.91,.61,.68,.55,.78,.03,.7,.17,.64,.08,.61,.25,.9,.51,.3,1,.43,.58,.84,.66,.08,.45,.85,.5,.19,.43,.61,.83,.23,.31,.42,.1,.82,.52,.85,.3,.23,.64,.17,.89,.28,.71,.37,.05,.2,.82,.88,.23,.05,.33,.13,.49,.78,.36,.58,.21,.76,.25,.13,.35,.6,.75,.15,.63,.31,.19,.77,.03,.85,.14,.71,.78,.17,.99,.32,.64,.92,.47,.15,.83,.22,.41,.29,.8,.53,.04,.27,.15,.87,.53,.83,.12,.47,.06,.91,.5,.27,.47,.35,.22,.59,.48,.96,.19,.92,.44,.35,.11,.58,.25,.44,.67,.84,.29,.91,.2,.34,.49,.76,.08,.23,.99,.05,.69,.43,.28,.89,.21,.73,0,.32,.4,.96,.3,.46,.84,.53,.92,.34,.05,.71,.15,.67,.24,.89,.02,.13,.78,.91,.63,0,.29,.74,.06,.15,.36,.53,.67,.96,.76,.28,.04,.15,.45,.96,.5,.93,.11,.41,.79,.5,.59,.29,.12,.41,.48,.64,.9,.84,.61,.27,.95,.12,.31,.67,.53,.91,.18,.97,.29,.39,.94,.81,.07,.45,.58,.24,.63,.31,.91,.47,.55,.09,.01,.37,.65,.31,.05,.75,.07,.95,.16,.35,.42,.98,.74,.31,.41,.02,.77,.57,.31,.77,.15,.86,.09,.75,.82,.41,.01,.67,.11,.27,.73,.16,.78,.91,.39,.75,.97,.01,.36,.78,.53,.69,.83,.15,.65,.61,.39,.85,.32,.95,.03,.65,.55,.44,.86,.18,.84,.08,.58,.76,.38,.13,.69,.43,.81,.56,.41,.09,.49,.82,.56,.31,.27,.4,.72,.35,.56,.91,.23,.69,.98,.11,.86,.16,.5,.69,.63,.89,.58,.67,.01,.35,.53,.23,.97,.16,.91,.76,.65,.95,.16,.8,.28,.55,.18,.05,.69,.47,.84,.02,.73,.37,.8,.64,.51,.11,.69,.53,.89,.35,.5,.74,.95,.37,.06,.67,.86,.75,.81,.23,.97,.58,.89,.53,.69,.47,.65,.84,.59,.5,.66,.19,.47,.91,.27,.68,.98,.22,.38,.64,.93,.53,.92,.14,.72,.38,.85,.55,.9,.48,.65,.31,.55,.16,.11,.58,.48,.66,.14,.97,.03,.43,.95,.29,.74,.19,.78,.56,.4,.15,.79,.09,1,.24,.66,.52,.2,.94,.02,.25,.84,.5,.2,.97,.86,.76,.35,.19,.64,.97,.52,.08,.99,.22,.8,.66,.36,.5,.78,.45,.61,0,.37,.22,1,.4,.34,.13,.75,.83,.62,.67,.05,.47,.2,.55,.31,.5,0,.7,.37,.07,.46,.91,.38,.8,.16,.95,.58,.1,.44,.06,.89,.22,.37,.25,.72,.15,.87,.01,.41,.54,.15,.28,.22,.42,.53,.12,.71,.19,.44,.35,.13,.89,.27,.05,.22,.11,.82,.05,.96,.6,.37,.11,.44,.81,.6,.3,.05,.2,.62,.27,.78,.31,.46,.6,.24,.01,1,.05,.84,.34,.8,.26,.92,.06,.41,.24,.33,.56,.9,0,.52,.11,.48,.24,.71,.92,.29,.48,.59,.35,.74,.44,.88,.31,.68,.55,.98,.09,.3,.63,0,.25,.94,.71,.04,.44,.75,.6,.16,.45,.12,.86,.56,.03,.19,.27,.34,.89,.56,.84,.08,.78,.2,.86,.27,.45,.16,.88,.3,.84,.69,.39,.08,.84,.56,.22,.98,.74,.85,.65,.25,.55,.34,.27,.44,.23,.7,.31,.77,.56,.84,.03,.62,.3,.99,.2,.69,.82,.93,.46,.62,.98,.3,.89,.46,.05,.64,.99,.21,.78,.58,.93,.76,.89,.34,.54,.69,.24,.87,.17,.54,0,.88,.73,.51,.42,.37,.07,.52,.98,.15,.09,.77,.37,.42,.2,.72,.48,.63,.86,.18,.7,.83,.62,.75,.22,.8,.35,.64,.84,.98,.06,.62,.83,.4,.2,.69,.05,.82,.11,.15,.61,.8,.29,.74,.38,.15,.68,.53,.44,.61,.15,.88,.35,.22,.83,.67,.89,.52,.31,.95,.88,.73,.93,.64,.73,.19,.43,.53,.03,.66,.59,.98,.04,.75,.51,.36,.01,.81,.99,.26,.77,.93,.42,.11,.52,.33,.12,1,.05,.62,.74,.92,.84,.6,1,.15,.45,.75,.96,.44,.51,.66,.1,.25,.59,.16,.8,.71,.04,.17,.58,.76,.85,.29,.73,.51,.01,.31,.4,.52,.43,.29,.79,.14,.43,.75,.64,.96,.47,.24,.14,.98,.81,.87,.69,.91,.22,.82,.72,.93,.53,.82,.6,.1,.95,.04,.44,.3,.58,.36,.91,.06,.5,.7,.12,.41,.27,.67,.33,.17,.53,.02,.88,.94,.55,.29,.97,.5,.39,.05,.46,.05,.64,.78,.92,.23,.06,.83,.31,.55,.11,.91,.29,.01,.35,.73,.08,.66,.15,.55,.4,.05,.13,.96,.29,.72,.92,.47,.31,.53,.4,.13,.96,.61,.58,.44,.16,.12,.62,.36,.18,.67,.8,.28,.6,.42,.69,.83,.13,.51,.05,.27,.4,.02,.64,.28,.11,.18,.81,.76,.33,.47,.73,.39,.09,.33,.84,.39,.67,.24,.36,.07,.4,.81,.63,.18,.72,.07,.17,.64,.99,.01,.51,.31,.08,.74,.34,.42,.69,.08,.31,.59,0,.45,.58,.4,.04,.33,.67,.16,.92,.41,.23,.53,.75,.98,.01,.51,.16,.94,.27,.58,1,.17,.53,.8,.89,.42,.75,.23,.65,.13,.45,.23,.64,.91,.73,.19,.95,.88,.5,.35,.89,.41,.74,.38,.96,.68,.78,.48,.39,.55,.94,.22,.42,.27,.84,.36,.24,.51,.66,.85,.57,.36,.16,.89,.07,.24,.81,.73,.28,.09,.23,.91,.52,.72,.47,.29,.9,.56,.03,.95,.2,.87,.08,.33,.37,.18,.66,.83,.53,.92,.88,.33,.58,.92,.05,.36,.91,.83,.02,.97,.24,.52,.59,.94,.02,.45,.98,.6,.16,.93,.45,.85,.98,.67,.82,.25,.6,.37,.84,.94,.26,.61,.2,.91,.76,.55,.22,.75,.28,.13,.33,.65,.26,.49,.14,.27,.77,.73,.33,.67,.15,.8,.23,.66,.4,.76,.45,.03,.85,.72,.09,.38,.03,.58,.99,.31,.81,.37,.77,.71,0,.36,.25,.82,.59,.22,.14,.56,.03,.19,.67,.13,.47,.2,.04,.65,.71,.14,.81,.61,.48,.76,.08,.61,.99,.76,.47,.22,.01,.62,.25,.69,.77,.61,.93,.45,.53,.85,.76,.33,.67,.95,.02,.82,.08,.48,.37,.72,.45,.78,.53,.95,.47,.89,.76,.31,.11,.7,.5,.22,.67,.47,.55,.23,.62,.15,.52,.64,.89,.75,.13,.28,.8,.17,.71,.87,.55,.24,.08,.36,.26,.55,.03,.47,.91,.72,.19,.56,.05,.83,.52,.11,.86,.16,.39,1,.81,.68,.87,.95,.75,.84,.98,.45,0,.57,.09,.85,.36,.45,.58,.87,.09,.66,.22,.36,.64,.31,.51,.96,.22,.7,.11,.49,.59,.07,.53,.16,.86,.56,.11,.69,.34,.43,.7,.28,.99,.6,.83,.25,.58,.93,.33,.18,.99,.27,.04,.86,.18,.32,.57,.03,.88,.3,.09,.41,.89,.8,.46,.41,.12,.34,.19,0,.67,.14,.42,.05,.22,.37,.6,.25,.69,1,.22,.65,.05,.34,.14,.65,.22,.01,.58,.44,.25,.15,.8,.08,.84,.29,.73,.09,.44,.96,.21,.33,.42,.17,.48,.93,.63,.33,.52,.11,.29,.67,.73,.6,.14,.87,.41,.76,.31,.11,.45,.71,.4,.99,.44,.3,.6,.47,.64,.44,.1,.51,.18,.02,.44,.09,.62,.35,.88,.49,.94,.2,.96,.07,.73,.26,.33,.97,.83,.58,.9,.24,.75,.61,.8,.29,.41,.91,.19,.87,1,.41,.3,.94,.45,.49,.97,0,.78,.85,.36,.1,.49,.9,.02,.74,.55,.81,.47,.37,.69,.52,.98,.71,.93,.45,.18,.69,.6,.95,.75,.09,.52,1,.84,.66,.5,.89,.38,.8,.5,1,.8,.13,.44,.86,.77,.12,.42,.85,.91,.26,.56,.85,.71,.29,.94,.55,.96,.36,.6,.4,1,.14,.91,.8,.29,.69,.56,.05,.81,.67,.06,.56,.42,.07,.84,.77,.37,.47,.9,.79,.32,.51,.94,.2,.06,.62,.89,.25,.78,.14,.73,0,.68,.95,.05,.24,.92,.35,.62,.37,.55,.22,.7,.19,.65,.25,.6,.43,.29,.63,.12,.91,.54,.18,0,.49,.14,.06,.46,.35,.16,.65,.85,0,.67,.35,.25,.58,.66,.05,.88,.17,.75,.08,.64,.45,.54,.76,.31,.71,.42,.37,.88,.08,.62,.91,.3,.1,.41,.64,.12,.25,.55,.84,.16,.34,.54,.19,.29,.02,.56,.25,.96,.06,.3,.62,.25,.69,.58,.93,.53,.18,.33,.53,.58,.16,.78,.38,.98,.08,.42,.79,.16,.04,.85,.73,.28,.52,0,.64,.39,.51,.05,.77,.88,.47,1,.36,.79,.22,.71,.96,.25,.16,1,.01,.19,.45,.04,.71,.65,.34,.58,.97,.51,.33,.07,.59,.36,.89,.2,.34,.77,.58,.83,.48,.75,.88,.28,.79,.94,.42,.05,.8,.16,.72,.55,.78,.48,.82,.44,.62,.75,.4,.8,1,.7,.04,.93,.49,.56,.24,.44,.75,.12,.8,.09,.76,.24,.61,.33,.91,.25,.21,.15,.92,.06,.22,.17,.64,.28,.13,.22,.73,.55,.85,.22,.47,.88,.39,.77,.48,.05,.42,.64,.85,.73,.92,.17,.39,.75,.58,.8,.94,.1,.35,.04,.3,.64,.73,.01,.92,.28,.08,.48,.7,.03,.61,.52,.35,.69,.65,.45,.07,.89,.66,.77,.25,.55,.18,.94,.35,.14,.27,.11,.63,.29,.92,.03,.61,.45,.69,.59,.81,.29,.63,.98,.16,.25,.84,.78,.12,.42,.83,.65,.95,.27,.45,.8,.53,.14,.7,.02,.22,.14,.98,.7,.06,.53,.34,.75,1,.09,.34,.88,.02,.24,.37,.05,.29,.95,.25,.67,.41,.53,.21,.84,.37,.09,.78,.63,.93,.52,.91,.47,.34,.55,.82,.38,.48,.59,.96,.4,.68,.61,.84,.99,.78,.53,.68,.93,.4,.16,.04,.78,.53,.72,.01,.98,.27,.92,.79,.23,.05,.6,.32,.78,.64,.08,.45,.2,.16,.53,.77,.45,.83,.09,.39,.69,.45,.83,.64,.72,.24,.31,.89,.23,.11,1,.22,.34,.56,.12,.18,.36,.95,.11,.83,.62,.41,.56,.67,.85,.4,.15,.48,.86,.35,.21,.49,.12,.36,.73,.52,.84,.07,.53,.45,0,.28,.73,.19,.48,.11,.56,.85,.07,.41,.28,.97,.36,.65,.43,.1,.58,.47,.16,.91,.58,.44,.52,.84,.4,.17,.99,.67,.87,.72,.56,.09,.18,.88,.31,.75,.27,.63,1,.33,.15,.05,.28,.39,.19,.64,.99,.14,.05,.87,.71,.02,.82,.28,.37,.55,.44,.07,.34,.83,.02,.49,.97,.64,.27,.19,.33,.11,.62,.68,.12,.58,.98,.44,.38,.12,.47,.87,.25,.51,.85,.67,.42,.9,.23,.98,.61,.25,.89,.2,.97,.36,.13,.54,.95,.43,.77,.84,.51,.37,.94,.82,.45,.86,.5,.69,.31,.47,.02,.73,.95,.2,.51,.78,.7,.56,.09,.66,.78,.95,.88,.07,.92,.22,.41,.33,.76,.9,.38,.98,.63,.05,.93,.3,.76,.16,.61,.67,.89,.46,.56,.85,.78,.23,.35,.87,.64,.25,.11,.2,.69,.25,.64,.74,.59,.5,.15,.22,.46,.91,.35,.6,.06,.81,.47,.05,.72,.42,.89,.56,.67,.84,.01,.73,.27,.44,.65,.17,.33,.78,.1,.52,.73,.03,.2,.94,.42,.59,.26,.66,.76,.38,.91,.95,.6,.84,.22,.41,.36,.52,.17,.76,.88,.53,.23,.97,.03,.71,.36,.95,.02,.32,.72,.15,.49,.76,.11,.56,.03,.44,.78,.86,.18,.66,.06,.27,.59,.01,.75,.16,.28,.94,.04,.6,.77,.9,.23,.83,.3,.09,.89,0,.24,.97,.82,.27,.03,.42,.3,.64,.45,.13,.69,.97,.6,.19,.66,.22,.52,.87,.42,.69,.39,.99,.3,.06,.75,.18,.1,.3,.49,.95,.71,.02,.81,.4,.73,.86,.05,.95,.11,.42,.29,.08,.93,.41,.83,0,.76,.52,.98,.13,.58,.89,.19,.53,.82,.33,.22,.76,.52,.95,.09,.78,.91,.56,.29,.47,.64,.95,.18,.88,.72,.63,.12,.9,.2,.33,.08,.45,.11,.68,.42,.53,.79,.9,.71,.02,.84,.27,.04,.69,.83,.57,.31,.75,.12,.25,.78,.63,.55,.05,.42,.87,.33,.52,.71,.24,.61,.3,.02,.57,.74,.47,.87,.09,.66,.51,.71,.56,.08,.4,.16,.53,.12,.6,.41,.68,.45,.31,.63,.36,.44,.18,.59,.7,.23,.53,.77,.86,.27,.05,.5,.09,.31,.78,.11,.34,.8,.02,.21,.64,.49,.92,.24,.82,.62,.03,.89,.17,.61,.22,.53,.95,.34,.63,.48,.36,.55,.82,.89,.25,.76,.56,.65,.27,.71,.45,.22,.34,.69,.4,.11,.25,.66,.08,.95,.42,.16,.33,.6,.5,.22,.76,.98,.16,.85,.24,.42,.33,.49,.28,.76,.53,.86,.72,.56,.8,.23,.77,.07,.29,.16,.1,.96,.6,.32,.64,.92,.35,.07,.19,.39,.95,.59,.49,.19,.37,.81,.27,.94,.64,.18,.82,.91,.09,.98,.47,.41,.92,.35,.25,.96,.34,.78,.11,.37,.23,.82,.96,.27,.87,.35,.7,.49,.17,.8,.93,.56,.06,.75,.94,.49,.84,.99,.15,.04,.59,.37,.8,.9,.42,.71,.94,.48,.58,.25,.9,.55,.12,.78,.36,.44,.55,.99,.39,.66,.46,.12,.75,.44,.06,.18,.78,.28,.9,.2,.06,.7,.36,.61,.07,.33,.18,.95,.06,.64,.85,.28,.78,.97,.47,.73,.04,.47,.61,.86,.25,.7,.36,.04,.42,.09,.58,.37,.05,.67,.78,.89,.09,.36,.05,.42,.94,.02,.51,.86,.27,.63,.99,.55,.44,.25,.75,.46,.15,.43,.5,.61,.8,.46,.85,.56,.07,.86,1,.51,.11,.74,.46,.02,.6,.38,.15,.75,.65,.22,.8,.15,.69,.42,.17,.87,.44,.61,.91,.32,.64,.67,.45,.09,1,.89,.03,.27,.73,.14,.22,.87,.52,.13,.06,.35,.67,.42,.95,.2,.64,.24,.56,.03,.83,.17,.66,.05,.73,.45,.86,.27,0,.69,.13,.33,.71,.27,.77,.37,.31,.91,.67,.59,.93,.11,.75,.6,.42,.95,.5,.16,1,.85,.6,.38,.82,.17,.94,.53,.02,.61,.36,.88,.3,.8,.12,.55,.91,.07,.81,.63,.89,.69,.49,.71,.94,.54,0,.59,.24,1,.68,.17,.63,.29,.38,.15,.92,.37,0,.83,.67,.4,.06,.87,.2,1,.78,.24,.93,.05,.14,.28,.68,.43,.7,.16,.6,.36,.23,.97,.29,.69,.45,.34,.88,.08,.84,.54,0,.63,.58,.27,.99,.03,.75,.15,.5,0,.55,.76,.21,.62,.54,.85,.41,.49,.8,.31,.66,.25,.38,.6,.91,.3,.51,.71,.12,.31,.99,.63,.38,.27,.89,.42,.33,1,.19,.61,.94,.75,.57,.22,.92,.08,.55,1,.83,.1,.48,.25,.4,.01,.52,.68,.22,.1,.78,.4,.73,.45,.12,.52,.75,.49,.11,.45,.2,.84,.13,.58,.24,.98,.36,.66,.2,.45,.97,.16,.27,.85,.3,.19,.81,.37,.16,.45,.84,.56,.8,.47,.22,.97,.69,.6,.21,.71,.5,.78,.19,.94,.53,.81,.69,.55,.13,.28,.66,.38,.74,.98,.33,.24,0,.3,.91,.86,.58,.76,.12,.83,.55,.05,.27,.57,.44,.29,.75,.92,.09,.5,.72,.23,.54,.42,.87,.17,.82,.31,.05,.42,.33,.11,.6,.98,.07,.62,.42,.89,.7,.82,.21,.79,.07,.41,.87,.76,.45,.2,.09,.96,.55,.77,.14,.69,.39,.56,.11,.39,.8,.05,.87,.45,.69,.02,.62,.2,.75,.86,.69,.47,.99,.34,.85,.28,.57,.01,.21,.27,.91,.04,.31,.24,.62,.79,.33,.93,.39,.7,.18,.49,.72,0,.27,.77,.5,.35,.56,.03,.44,.08,.62,.27,.97,.73,.33,.11,.27,.72,.34,.83,.06,.46,.09,.81,.33,.12,.28,.63,.09,.36,.3,.01,.41,.89,.49,.56,.21,.61,.78,.89,.58,.75,.47,.17,.06,.5,.41,.96,.2,.79,.92,.73,.11,.98,.33,.83,.19,.67,.37,.81,.27,.06,.99,.71,.37,.94,.65,.79,.95,.19,.7,.35,.23,.91,.03,.17,.53,.02,.47,.15,.59,.93,.02,.53,.15,.84,.73,.51,.22,.01,.82,.49,.05,.26,.84,.47,.3,.52,.6,.16,.23,.4,.51,.95,.36,.04,.31,.82,.17,.09,.93,.64,.53,.89,.82,.63,.77,.68,.95,.87,.4,.72,.05,.65,.53,.92,.05,.8,.33,.6,.95,.43,.06,.73,.62,.95,.78,.91,.53,.11,.88,.68,.19,.41,.94,.03,.58,.13,.89,.55,.96,.61,.41,.94,.84,.47,.22,.97,.65,.83,.71,.18,.95,.03,.82,.11,.45,.09,.52,.79,.4,.67,.33,.89,.65,.01,.31,.62,.51,.38,.19,.61,.47,.23,.41,.88,.04,.95,.57,.64,.36,.26,.53,.12,.5,.27,.71,.46,.07,.84,.58,.46,.73,.98,.33,.85,.25,.95,.66,.37,.22,.68,.28,.43,.65,.34,.6,.94,.31,.62,.9,.69,.94,.16,.66,.96,.35,.78,.94,.72,.29,.16,.58,.91,.64,.22,.55,.4,.75,.44,.2,.69,.32,.08,.44,.36,.18,.58,.14,.99,.5,.25,.09,.29,.64,.44,.92,.13,.84,.64,.22,.86,.13,.36,.25,.69,.32,.42,.55,.06,.5,.62,.91,.66,.51,.8,.42,.31,.77,.13,.23,.7,.56,.01,.78,.44,.15,.5,.26,.61,.44,.33,.93,.5,.37,.2,.96,.25,.04,1,.22,.78,.44,.73,.16,.87,.42,.04,.78,.89,.05,.77,.56,.31,.47,.13,.7,.44,.84,.1,.61,.8,.17,.08,.88,.53,.92,.15,.3,.8,.39,.12,.65,.44,.56,.74,.3,.5,.82,.59,.91,.96,.02,.81,.11,.45,.4,.19,.78,.44,.33,.2,.02,.74,.25,.09,.49,.05,.88,.8,.43,.11,.49,.77,.86,.61,.03,.26,.12,.99,.46,.56,.15,.86,.51,.05,.83,.35,.18,.76,.86,.39,.8,.2,.24,.56,.37,.16,.48,.32,.69,.45,.17,.84,.02,.73,.24,.82,.3,.76,.17,.25,.39,.19,.67,.27,.64,.51,.07,.73,.34,.64,.89,.7,.57,.06,.9,.77,.08,.7,.24,.66,.86,.71,.33,.65,.13,.71,.6,.09,.25,.36,.59,.97,.67,.25,.55,.27,.69,.13,.97,.62,.8,.25,.9,.18,.01,.74,.91,.41,.96,.56,.35,.25,.41,.66,.01,.52,.19,.6,.76,.07,.39,.1,.89,.16,.1,.38,.06,.49,.17,.26,.87,.71,1,.11,.54,.04,.6,.8,.55,.87,.42,.58,.84,.63,.33,.55,.67,.25,.99,.03,.29,.47,.95,.8,.37,.86,.07,.65,.95,.27,.75,.45,.29,.62,.91,.56,.67,.13,.99,.53,.69,.05,.89,.72,1,.81,.08,.93,.55,.6,.98,.49,.89,.36,.97,0,.47,.88,.08,1,.83,.03,.92,.87,.42,1,.18,.11,.3,.19,.38,.99,.34,.2,.53,.87,.16,.59,.28,.02,.55,.86,.49,.4,.88,.53,.95,.82,.48,.07,.14,.82,.94,.43,.5,.37,.19,.72,.01,.53,.38,.77,.56,.49,.22,.28,.68,.64,.02,.78,.74,.6,.98,.86,.69,.26,.87,.94,.2,.69,.45,.98,.79,.72,.64,.32,.76,.53,.66,.06,.57,.31,.85,.27,.72,.39,.99,.06,.67,.15,.38,.22,.95,.07,.19,.74,.43,.35,.13,.7,.19,.53,.58,.73,.24,.39,.73,.02,.87,.64,.22,.7,.02,.44,.22,.35,.74,.06,.33,.76,.47,.27,.02,.58,.42,.75,.06,.34,.14,.27,.62,.09,.67,.41,.59,.73,.33,.55,.49,.37,.57,.33,.27,.79,.52,.4,.93,.5,.81,.09,.47,.69,.38,.8,.42,.1,.99,.8,.44,.16,.93,.29,.33,.18,.02,.67,.22,.3,.52,.34,.63,0,.75,.84,.25,.94,.43,.09,.98,.33,.64,.94,.35,.05,.83,.47,.22,.94,.12,.44,.31,.08,.41,.15,.46,.31,.81,.61,.03,.53,.27,.47,.22,.84,.92,.44,.36,.23,.77,.16,.66,.92,.11,.18,.47,.3,.52,.91,.05,.75,.47,.37,.85,.9,.6,.55,.83,.89,.33,.64,.03,.29,.94,.5,.18,.6,.35,.1,.95,.8,.47,.09,.95,.61,.44,.58,.91,.41,.61,.2,.36,.64,.25,.89,.28,.81,.71,.42,.8,.18,.53,.27,.93,.21,.8,.65,.09,.16,.78,.12,.65,.01,.61,.85,.71,.04,.62,.75,.88,.56,.01,.28,.91,.5,.67,.36,.22,.75,.05,.8,.55,.73,.64,.37,.93,.76,.88,.7,.16,.22,.9,.58,.15,.53,.84,.67,.6,.16,.25,.86,.14,.55,.76,.14,.52,.85,.28,.17,.48,.77,.91,.55,.01,.65,.48,.24,.34,.67,.14,.9,.01,.56,.11,.14,.83,.95,.45,.88,.4,.49,.83,.64,.78,.24,.84,.6,.8,.27,.58,.71,0,.29,.14,.23,.69,.41,.09,1,.45,.13,.63,.81,.29,.98,.55,.4,.14,.51,.33,.89,.27,.78,0,.2,.83,.12,.53,.96,.8,.13,.5,.19,.63,.46,.9,.06,.51,.92,.74,.83,.14,.05,.43,.94,.25,.71,.95,.2,.38,.94,.47,.24,.16,.55,.31,.28,.13,.16,.96,.74,.61,.21,.06,.53,.96,.6,.67,.09,.47,.99,.12,.83,.43,.58,.04,.42,1,.31,.47,.09,.34,.65,.29,.21,.81,.45,.05,.79,.67,.41,.99,.33,.71,.37,.56,.67,.84,.25,.63,.35,.98,.77,.11,.88,.95,.78,.51,.4,.75,.61,.29,.71,.49,.01,.28,.6,.05,.23,.58,.36,.01,.95,.12,.34,.44,.97,.13,.89,.51,.63,.8,.99,.03,.49,.26,.78,.87,.35,.71,.05,.44,.08,.78,.67,.24,.98,.73,.16,.51,.67,.97,.39,.24,.88,.05,.73,.44,.85,.7,.98,0,.54,.21,.67,.33,.03,.25,.47,.36,.67,.52,.29,.87,.42,.49,.55,.71,.82,.07,.34,.7,.89,.45,.94,.66,.41,.52,.09,.34,.77,.25,.88,.11,.32,.41,.19,.89,.25,.31,.51,.19,.09,.24,.66,.53,.78,.69,.92,.82,.49,.05,.73,.36,.95,.52,.59,.19,.89,.07,.25,.64,.01,.9,.09,1,.03,.72,.19,.83,.38,.17,.58,.39,.04,.85,.18,.99,.34,.8,.9,.21,.64,.75,.13,.79,.99,.08,.91,.42,.65,.54,.74,.03,.19,.67,.35,.25,.43,.11,.33,.76,.62,.15,.72,.51,.21,.56,.84,.91,.49,.31,.86,.61,.08,.6,.41,.72,.11,.3,.44,.65,.71,.35,.29,.61,.09,.4,.33,.75,.13,.95,.84,.6,.44,.99,.63,.91,.61,.83,.16,0,.63,.08,.89,.15,.29,.56,.75,.96,0,.22,.53,.82,.71,.23,.84,.55,.96,.62,.44,.72,.47,.84,.56,.73,.64,0,.8,.69,.95,.87,.47,.12,.37,.03,.25,.41,.98,.13,.91,.57,0,.72,.29,.35,.47,.58,.81,.92,.49,.75,.34,.39,.47,.54,.3,.05,.69,.45,.74,.2,.62,.29,.69,.08,.23,.47,.41,.07,.53,.92,.37,.43,.69,.28,.51,.73,.18,.27,.87,.49,.61,.82,.05,.96,.72,.46,.87,.57,.37,.96,.29,.09,.94,.42,.13,.25,.73,.18,.02,.45,.36,.82,.05,.23,.56,.84,.78,.54,.09,.49,.92,.16,.24,.9,.47,.84,.44,.25,.36,.15,.78,.11,.31,.04,.17,.37,.97,.67,.32,.8,.25,.44,.93,.19,.49,.39,.63,.77,.08,.35,.04,.94,.45,.15,.01,.37,.18,.83,.03,.95,.35,.08,.42,.89,.55,.36,.58,.28,.81,.19,.87,.6,.7,.19,.58,.68,.33,.19,.42,.92,.1,.84,.73,.16,.42,.23,.11,.55,.18,.61,.86,.14,.95,.58,.93,.28,.07,.98,.47,.13,.45,.53,.88,.15,.66,.98,.33,.23,.84,.17,.65,.87,.13,.58,1,.36,.08,.92,.4,.3,.53,.83,.16,.65,.27,.2,.03,.83,.66,.49,0,.75,.67,.33,.59,.95,.58,.92,.28,.78,.99,.48,.89,.15,.04,.99,.22,.81,.41,.67,.77,.05,.58,.18,.64,.04,.72,.89,.67,.42,.81,.55,.73,.25,.51,.77,.18]),Ql=Math.exp,Jl="blue",tc="color-point-arrays",ec=["black-white","monochrome-4","monochrome-8","monochrome-16"],ic="hex-grid",nc="monochrome-16",sc="monochrome-4",rc="monochrome-8",oc="points-array",ac="random-points",lc="source-alpha",cc="unset",hc=new Float32Array([0,.5,.13,.63,.03,.53,.16,.66,.75,.25,.88,.38,.78,.28,.91,.41,.19,.69,.06,.56,.22,.72,.09,.59,.94,.44,.81,.31,.97,.47,.84,.34,.05,.55,.17,.67,.02,.52,.14,.64,.8,.3,.92,.42,.77,.27,.89,.39,.23,.73,.11,.61,.2,.7,.08,.58,.98,.48,.86,.36,.95,.45,.83,.33]),uc=[new Uint8Array([0,0,0,0]),new Uint8Array([0,0,0,180]),new Uint8Array([180,0,0,0]),new Uint8Array([180,0,0,180]),new Uint8Array([0,180,180,180]),new Uint8Array([180,180,180,0]),new Uint8Array([180,180,180,180]),new Uint8Array([180,180,180,255]),new Uint8Array([255,180,180,180]),new Uint8Array([255,180,180,255]),new Uint8Array([180,255,255,255]),new Uint8Array([255,255,255,180]),new Uint8Array([255,255,255,255])],dc={[Jt]:[255,0],[sc]:[255,187,102,0],[rc]:[255,221,187,153,119,85,51,0],[nc]:[255,238,221,204,187,170,153,136,119,102,85,68,51,34,17,0]},fc=new Uint8Array([0,255,0]),pc=new Uint8Array([0,255,255]),gc=_l({name:"SC-core-color-engine"});let mc="black-white";const yc=t=>mc=t,bc=()=>mc,FilterEngine=function(){return this.cache=null,this.actions=[],this},Sc=FilterEngine.prototype=Ar();Sc.type="FilterEngine",Sc.action=function(t){const{identifier:e,filters:i,image:n}=t,{actions:s,theBigActionsObject:r}=this;let o,a,l,c;const h=Na(e);if(h)return h;for(s.length=0,o=0,a=i.length;o<a;o++)s.push(...i[o].actions);const u=s.length;if(u){for(this.unknit(n),o=0;o<u;o++)l=s[o],c=r[l.action],c&&c.call(this,l);return e&&za(e,this.cache.work),this.cache.work}return n},Sc.unknit=function(t){this.cache={};const e=this.cache,{width:i,height:n,data:s}=t;e.source=new ImageData(s,i,n),e.work=new ImageData(s,i,n)},Sc.getAlphaData=function(t){const{width:e,height:i,data:n}=t,s=n.length,r=new ImageData(e,i),o=r.data;let a,l;for(l=0;l<s;l+=4)a=n[l+3],o[l]=0,o[l+1]=0,o[l+2]=0,o[l+3]=a>0?255:0;return r},Sc.buildImageGrid=function(t){const{cache:e}=this;t||(t=e.source);const{width:i,height:n}=t;if(i&&n){const t=`grid-${i}-${n}`,e=Na(t);if(e)return e;const s=[];let r,o,a,l=0;for(a=0;a<n;a++){for(r=[],o=0;o<i;o++)r.push(l),l++;s.push(r)}return za(t,s),s}return!1},Sc.getRandomNumbers=function(t={}){const{seed:e=we,length:i=0,imgWidth:n=0,type:s=un}=t,r=`random-${e}-${i}-${s}`,o=Na(r);if(o)return o;const a=lo();let l,c,h,u,d;if(s===ne&&n){const t=ql.length,e=xt(t),s=i/n,r=lo();for(l=0;l<t;l+=e)u=ql.slice(l,l+e),r.push(u);for(l=s;l>0;l-=e)for(c=0;c<e;c++)for(d=r[c],h=n;h>0;h-=e)h<e?a.push(...d.slice(0,h)):a.push(...d);co(r)}else if("ordered"===s&&n){const t=hc.length,e=xt(t),s=i/n,r=lo();for(l=0;l<t;l+=e)u=hc.slice(l,l+e),r.push(u);for(l=s;l>0;l-=e)for(c=0;c<e;c++)for(d=r[c],h=n;h>0;h-=e)h<e?a.push(...d.slice(0,h)):a.push(...d);co(r)}else{const t=La(e);for(l=0;l<i;l++)a.push(t.random())}const f=new Float32Array(a);return co(a),za(r,f),f},Sc.buildImageCoordinateLookup=function(t){const{cache:e}=this;t||(t=e.source);const{width:i,height:n}=t;if(i&&n){const t=`coords-lookup-${i}-${n}`,e=Na(t);if(e)return e;const s=[];for(let t=0;t<n;t++)for(let e=0;e<i;e++)s.push([e,t]);return za(t,s),s}return!1},Sc.buildAlphaTileSets=function(t,e,i,n,s,r,o,a){const{cache:l}=this;a||(a=l.source);const{width:c,height:h}=a;if(c&&h){(t=dt(t)?t:1)<1&&(t=1),(e=dt(e)?e:1)<1&&(e=1),t+(i=dt(i)?i:1)>=c&&(t=c-i-1),e+(n=dt(n)?n:1)>=h&&(e=h-n-1),t<1&&(t=1),e<1&&(e=1),t+i>=c&&(i=c-t-1),e+n>=h&&(n=h-e-1);const o=t+i,a=e+n;(s=dt(s)?s:0)<0&&(s=0),s>=o&&(s=o-1),(r=dt(r)?r:0)<0&&(r=0),r>=a&&(r=a-1);const l=`alphatileset-${c}-${h}-${t}-${e}-${i}-${n}-${s}-${r}`,u=Na(l);if(u)return u;const d=[];let f,p,g,m,y,b,S,A,C;for(m=r-a,y=h;m<y;m+=a)for(p=s-o,g=c;p<g;p+=o){for(f=[],A=m,C=m+e;A<C;A++)if(A>=0&&A<h)for(b=p,S=p+t;b<S;b++)b>=0&&b<c&&f.push(4*(A*c+b)+3);for(d.push([].concat(f)),f=[],A=m+e,C=m+e+n;A<C;A++)if(A>=0&&A<h)for(let e=p,i=p+t;e<i;e++)e>=0&&e<c&&f.push(4*(A*c+e)+3);for(d.push([].concat(f)),f=[],A=m,C=m+e;A<C;A++)if(A>=0&&A<h)for(let e=p+t,n=p+t+i;e<n;e++)e>=0&&e<c&&f.push(4*(A*c+e)+3);for(d.push([].concat(f)),f=[],A=m+e,C=m+e+n;A<C;A++)if(A>=0&&A<h)for(let e=p+t,n=p+t+i;e<n;e++)e>=0&&e<c&&f.push(4*(A*c+e)+3);d.push([].concat(f))}return za(l,d),d}return!1},Sc.buildImageTileSets=function(t,e,i,n,s){const{cache:r}=this;s||(s=r.source);const{width:o,height:a}=s;if(o&&a){(t=dt(t)?t:1)<1&&(t=1),t>=o&&(t=o-1),(e=dt(e)?e:1)<1&&(e=1),e>=a&&(e=a-1),(i=dt(i)?i:0)<0&&(i=0),i>=t&&(i=t-1),(n=dt(n)?n:0)<0&&(n=0),n>=e&&(n=e-1);const s=`simple-tileset-${o}-${a}-${t}-${e}-${i}-${n}`,r=Na(s);if(r)return r;const l=[];let c,h,u,d,f,p,g,m,y;for(u=n-e,d=a;u<d;u+=e)for(c=i-t,h=o;c<h;c+=t){for(y=[],g=u,m=u+e;g<m;g++)if(g>=0&&g<a)for(f=c,p=c+t;f<p;f++)f>=0&&f<o&&y.push(4*(g*o+f));y.length&&l.push(y)}return za(s,l),l}return!1},Sc.buildGeneralTileSets=function(t,e,i,n,s,r,o,a,l){const{cache:c}=this;l||(l=c.source);const{width:h,height:u}=l;if(h&&u){let l=1,c=1,d=1,f=0,p=0,g=0,m=cc;if(t.substring?m=t:ut(t)?m=oc:dt(t)&&(m=ac),m===cc)return[];e.substring?l=vt(parseFloat(e)/100*h):dt(e)&&(l=e),l<1&&(l=1),i.substring?c=vt(parseFloat(i)/100*u):dt(i)&&(c=i),c<1&&(c=1),n.substring?d=vt(parseFloat(n)/100*h):dt(n)&&(d=n),d<1&&(d=1),s.substring?f=vt(parseFloat(s)/100*h):dt(s)&&(f=s),f<0?f=0:f>=h&&(f=h-1),r.substring?p=vt(parseFloat(r)/100*u):dt(r)&&(p=r),p<0?p=0:p>=u&&(p=u-1),dt(o)&&(g=o);let y=`${m}-tileset-${h}-${u}-${l}-${c}-${d}-${f}-${p}-${g}`;m===oc?y+=`-${t.join(zt)}`:m===ac&&(y+=`-${t}-${a}`);const b=Na(y);if(b)return b;if(m===fn&&1===l&&1===c)return ja(y);const S=rl(),A=[f,p],C=[0,0];let k,v=[];const P=[],O=[];let x,D,w,F,R,T,E,H,I=Ys;m===ic&&c/d<1.05&&(c=1.05*d);const L=ct(l/2),B=ct(c/2),$=2*d,M=vt(c/d*d);let X,Y,G,N,z,j,V,W,U,Z=0,K=0;switch(m){case fn:if(I=`rect-grid-points-${h}-${u}-${l}-${c}-${f}-${p}`,k=Na(I),!k){const t=[];for(E=p-2*u+B,H=p+2*u+B;E<H;E+=c)for(R=f-2*h+L,T=f+2*h+L;R<T;R+=l)t.push(R,E);k=ja(I,t)}break;case ic:if(I=`hex-grid-points-${h}-${u}-${d}-${f}-${p}`,k=Na(I),!k){const t=[];for(Z=0,E=p-2*u+d,H=p+2*u+d;E<H;E+=M){for(K=Z%2==0?d:0,R=f-2*h+d+K,T=f+2*h+d;R<T;R+=$)t.push(R,E);Z++}k=ja(I,t)}l=2*$,c=2*M;break;case ac:if(I=`random-points-${h}-${u}-${d}-${f}-${p}-${k}-${a}`,k=Na(I),!k){const e=[],i=this.getRandomNumbers({seed:a,length:3*t});let n=-1;for(X=0;X<t;X++)S.zero().add([i[++n],i[++n]]).rotate(360*i[++n]).rotate(g).scalarMultiply(d),[R,E]=S,e.push(vt(R),vt(E));k=ja(I,e)}l=d,c=d;break;case oc:if(I=`defined-points-${h}-${u}-${d}-${t}`,k=Na(I),!k){const e=[...t];k=ja(I,e)}l=d,c=d}for(Z=0,X=0,Y=k.length;X<Y;X+=2)if(C[0]=k[X],C[1]=k[X+1],S.zero().add(C).rotate(g).add(A),[R,E]=S,R=vt(R),E=vt(E),R>-l&&R<h+l&&E>-c&&E<u+c){for(G=2*h*(2*u)+(E+ct(u/2))*h+(R+ct(h/2)),P[Z]=[R,E,G],v[G]=[],x=E-c,D=E+c;x<D;x++)for(w=R-l,F=R+l;w<F;w++)if(w>=0&&w<h&&x>=0&&x<u){if(m===ac&&S.zero().subtract(A).add([w,x]).getMagnitude()>d)continue;N=x*h+w,O[N]||(O[N]=[]),O[N].push(Z)}Z++}if(!P.length)return P;for(x=0;x<u;x++)for(w=0;w<h;w++)V=x*h+w,C[0]=w,C[1]=x,W=O[V],z=-1,j=0,W&&W.forEach((t=>{[R,E,G]=P[t],U=S.zero().add(C).subtract([R,E]).getMagnitude(),(z<0||U<j)&&(z=G,j=U)})),z>=0&&v[z].push(V);return ol(S),v=v.filter((t=>null!=t)),za(y,v),v}return[]},Sc.buildHorizontalBlur=function(t,e){dt(e)||(e=0);const i=t.length,n=t[0].length,s=`blur-h-${n}-${i}-${e}`,r=Na(s);if(r)return r;const o=[];let a,l,c,h,u;for(l=0;l<i;l++)for(a=0;a<n;a++){for(u=[],c=a-e,h=a+e+1;c<h;c++)c>=0&&c<n&&u.push(4*t[l][c]);o[l*n+a]=u}return za(s,o),o},Sc.buildVerticalBlur=function(t,e){dt(e)||(e=0);const i=t.length,n=t[0].length,s=`blur-v-${n}-${i}-${e}`,r=Na(s);if(r)return r;const o=[];let a,l,c,h,u;for(a=0;a<n;a++)for(l=0;l<i;l++){for(u=[],c=l-e,h=l+e+1;c<h;c++)c>=0&&c<i&&u.push(4*t[c][a]);o[l*n+a]=u}return za(s,o),o},Sc.buildMatrixGrid=function(t,e,i,n,s){const{cache:r}=this;s||(s=r.source);const{width:o,height:a,data:l}=s;(null==t||t<1)&&(t=1),(null==e||e<1)&&(e=1),null==i||i<0?i=0:i>=t&&(i=t-1),null==n||n<0?n=0:n>=e&&(n=e-1);const c=`matrix-${o}-${a}-${t}-${e}-${i}-${n}`,h=Na(c);if(h)return h;const u=l.length,d=[],f=[];let p,g,m,y,b,S,A,C,k;for(m=-n,y=e-n;m<y;m++)for(p=-i,g=t-i;p<g;p++)d.push(4*(m*o+p));for(m=0;m<a;m++)for(p=0;p<o;p++){for(A=4*(m*o+p),C=[],b=0,S=d.length;b<S;b++)k=A+d[b],k<0?k+=u:k>=u&&(k-=u),C.push(k);f.push(C)}return za(c,f),f},Sc.checkChannelLevelsParameters=function(t){const e=function(t,e=!1){if(t.toFixed)return t<0?[fc]:t>255?[pc]:dt(t)?[[0,255,t]]:e?[pc]:[fc];if(t.substring&&(t=t.split(zt)),ut(t)){if(!t.length)return t;if(ut(t[0]))return t;if((t=t.map((t=>parseInt(t,10)))).sort(((t,e)=>t-e)),1==t.length)return[[0,255,t[0]]];const e=[];let i,n,s,r;for(s=0,r=t.length;s<r;s++)i=0,n=255,0!==s&&(i=st(t[s-1]+(t[s]-t[s-1])/2)),s!==r-1&&(n=ct(t[s]+(t[s+1]-t[s])/2)),e.push([i,n,t[s]]);return e}return e?[pc]:[fc]};t.red=e(t.red),t.green=e(t.green),t.blue=e(t.blue),t.alpha=e(t.alpha,!0)},Sc.cacheOutput=function(t,e){this.cache[t]=e},Sc.getInputAndOutputLines=function(t){const{cache:e}=this,i=e.source;let n,s=e.work,r=!1,o=!1;return t.lineIn!==lc&&t.lineMix!==lc||(o=this.getAlphaData(i)),t.lineIn&&(t.lineIn===Fn?s=i:t.lineIn===lc?s=o:e[t.lineIn]&&(s=e[t.lineIn])),t.lineMix&&(t.lineMix===Fn?r=i:t.lineMix===lc?r=o:"current"===t.lineMix?r=e.work:e[t.lineMix]&&(r=e[t.lineMix])),t.lineOut&&e[t.lineOut]?n=e[t.lineOut]:(n=new ImageData(s.width,s.height),t.lineOut&&(e[t.lineOut]=n)),[s,n,r]},Sc.getGrayscaleValue=function(t,e,i){return ct(.2126*t+.7152*e+.0722*i)},Sc.retrieveColorPointLibraries=function(){return Ga(tc)||za(tc,{labColorLib:[],lchColorLib:[],rgbColorLib:[]}),Na(tc)},Sc.getOkColorVals=function(t,e,i,n){const s=n.rgbColorLib;return s[t]&&s[t][e]&&null!=s[t][e][i]?s[t][e][i]:this.setOkColorVals(t,e,i,n)},Sc.getRegularColorVals=function(t,e,i,n,s=!1){const{labColorLib:r,lchColorLib:o}=n;let a,l,c,h;return s?([a,l,c]=this.getColorLchIndices(t,e,i),o[a]&&o[a][l]&&null!=o[a][l][c]?o[a][l][c]:(h=gc.convertOKLABtoRGB(...gc.convertOKLCHtoOKLAB(t,e,i)),this.memoizeLch(t,e,i,h,o),h)):([a,l,c]=this.getColorLabIndices(t,e,i),r[a]&&r[a][l]&&null!=r[a][l][c]?r[a][l][c]:(h=gc.convertOKLABtoRGB(t,e,i),this.memoizeLab(t,e,i,h,r),h))},Sc.setOkColorVals=function(t,e,i,n){const{rgbColorLib:s,labColorLib:r,lchColorLib:o}=n;s[t]||(s[t]=[]),s[t][e]||(s[t][e]=[]);const a=[],l=[t,e,i],c=gc.convertRGBtoOKLAB(...l),h=gc.convertOKLABtoOKLCH(...c);return a.push(...c,h[1],h[2]),s[t][e][i]=a,this.memoizeLab(...c,l,r),this.memoizeLch(...h,l,o),a},Sc.memoizeLab=function(t,e,i,n,s){const[r,o,a]=this.getColorLabIndices(t,e,i);s[r]||(s[r]=[]),s[r][o]||(s[r][o]=[]),s[r][o][a]=n},Sc.memoizeLch=function(t,e,i,n,s){const[r,o,a]=this.getColorLchIndices(t,e,i);s[r]||(s[r]=[]),s[r][o]||(s[r][o]=[]),s[r][o][a]=n},Sc.getColorLabIndices=function(t,e,i){return[ct(500*t),ct(625*(e+.4)),ct(625*(i+.4))]},Sc.getColorLchIndices=function(t,e,i){return[ct(500*t),ct(1250*e),ct(3*i)]},Sc.processResults=function(t,e,i){const n=t.data,s=e.data;let r,o,a;if(1===i)for(o=0,a=n.length;o<a;o++)n[o]=s[o];else if(i>0)for(r=1-i,o=0,a=n.length;o<a;o++)n[o]=n[o]*r+s[o]*i},Sc.getGradientData=function(t){const e=`gradient-data-${t.name}`,i=Na(e);if(!i||t.dirtyFilterIdentifier||t.animateByDelta){const i=el(),{engine:n,element:s}=i;s.width=256,s.height=1;const r=n.createLinearGradient(0,0,255,0);t.addStopsToGradient(r,t.paletteStart,t.paletteEnd,t.cyclePalette),n.fillStyle=r,n.fillRect(0,0,256,1);const o=n.getImageData(0,0,256,1).data;return il(i),function(t,e=[]){return Ba[t]=e,$a[t]=mt(),Ba[t]}(e,o)}return i||[]},Sc.transferDataUnchanged=function(t,e,i){let n,s,r,o,a;for(a=0;a<i;a+=4)n=a,s=n+1,r=s+1,o=r+1,t[n]=e[n],t[s]=e[s],t[r]=e[r],t[o]=e[o]},Sc.theBigActionsObject={[Bt]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,excludeRed:h=!0,excludeGreen:u=!0,excludeBlue:d=!0,lineOut:f}=t;let p,g,m,y,b,S;for(S=0;S<r;S+=4)p=S,g=p+1,m=g+1,y=m+1,b=n[y],b&&(s[p]=a?b:h?0:n[p],s[g]=l?b:u?0:n[g],s[m]=c?b:d?0:n[m],s[y]=255);f?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[$t]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t,l=this.retrieveColorPointLibraries();let c,h,u,d,f,p,g,m,y,b;for(f=0;f<r;f+=4)c=f,h=c+1,u=h+1,d=u+1,b=n[d],b?(p=b/256,p>1?p=1:p<0&&(p=0),[g,m,y]=this.getRegularColorVals(p,0,0,l),s[c]=g,s[h]=m,s[u]=y,s[d]=255):(s[c]=n[c],s[h]=n[h],s[u]=n[u],s[d]=0);a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Nt]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,tileWidth:a=1,tileHeight:l=1,offsetX:c=0,offsetY:h=0,gutterWidth:u=1,gutterHeight:d=1,areaAlphaLevels:f=[255,0,0,0],lineOut:p}=t,g=this.buildAlphaTileSets(a,l,u,d,c,h,f);let m,y,b,S;this.transferDataUnchanged(s,n,r),g.forEach(((t,e)=>{for(m=f[e%4],y=0,b=t.length;y<b;y++)S=t[y],n[S]&&(s[S]=m)})),p?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[_t]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,excludeRed:h=!1,excludeGreen:u=!1,excludeBlue:d=!1,lineOut:f}=t;let p,g,m,y,b,S,A=0;for(a&&A++,l&&A++,c&&A++,p=0;p<r;p+=4)m=p,y=m+1,b=y+1,S=b+1,n[S]?A?(g=0,a&&(g+=n[m]),l&&(g+=n[y]),c&&(g+=n[b]),g=ct(g/A),s[m]=h?0:g,s[y]=u?0:g,s[b]=d?0:g,s[S]=n[S]):(s[m]=h?0:n[m],s[y]=u?0:n[y],s[b]=d?0:n[b],s[S]=n[S]):(s[m]=n[m],s[y]=n[y],s[b]=n[b],s[S]=n[S]);f?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ee]:function(t){const e=function(t,e,i){const n=t+1,s=n+1,r=s+1,o=e+1,a=o+1,l=a+1;u[e]=i[t],u[o]=i[n],u[a]=i[s],u[l]=i[r]},i=function(t,e){const i=t-y,n=e-b;let s=-1;return i>=0&&i<d&&n>=0&&n<f&&(s=4*(n*d+i)),[4*(e*l+t),s]},n=function(t,e){const i=t+1,n=i+1,s=n+1,r=e+1,o=r+1,a=o+1;return[h[t]/255,h[i]/255,h[n]/255,h[s]/255,p[e]/255,p[r]/255,p[o]/255,p[a]/255]},s=(t,e)=>255*(t+e*(1-t)),[r,o,a]=this.getInputAndOutputLines(t),{width:l,height:c,data:h}=r,{data:u}=o,{width:d,height:f,data:p}=a,{opacity:g=1,blend:m=Ys,offsetX:y=0,offsetY:b=0,lineOut:S}=t,A=(t,e)=>1===e?255:0===t?0:255*(1-gt(1,(1-e)/t)),C=(t,e)=>0===e?0:1===t?255:255*gt(1,e/(1-t)),k=(t,e)=>t<e?t:e,v=(t,e)=>255*et(t-e),P=(t,e)=>255*(t+e-2*e*t),O=(t,e)=>t<=.5?t*e*255:255*(e+(t-e*t)),x=(t,e)=>t>e?t:e,D=(t,e)=>255*(t+e),w=(t,e)=>t*e*255,F=(t,e)=>t>=.5?t*e*255:255*(e+(t-e*t)),R=(t,e)=>255*(e+(t-e*t)),T=(t,e)=>{const i=e<=.25?((16*e-12)*e+4)*e:xt(e);return t<=.5?255*(e-(1-2*t)*e*(1-e)):255*(e+(2*t-1)*(i-e))},E=(t,e,i,n)=>e*t+n*i*(1-e),H=this.retrieveColorPointLibraries();let I,L,B,$,M,X,Y,G,N,z,j,V,W,U,Z,K,_,q,Q,J,tt,it,nt,st,rt,ot,at;switch(m){case"color-burn":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,q=Z+3,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=A(B,Y),u[V]=A($,G),u[W]=A(M,N),u[U]=s(X,z)):e(j,j,h):e(Z,j,p));break;case"color-dodge":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,q=Z+3,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=C(B,Y),u[V]=C($,G),u[W]=C(M,N),u[U]=s(X,z)):e(j,j,h):e(Z,j,p));break;case"darken":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,q=Z+3,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?(V=j+1,W=V+1,K=Z+1,_=K+1,u[j]=k(h[j],p[Z]),u[V]=k(h[V],p[K]),u[W]=k(h[W],p[_]),u[U]=s(h[U]/255,p[q]/255)):e(j,j,h):e(Z,j,p));break;case"difference":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=v(B,Y),u[V]=v($,G),u[W]=v(M,N),u[U]=s(X,z)):e(Z,j,p));break;case"exclusion":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=P(B,Y),u[V]=P($,G),u[W]=P(M,N),u[U]=s(X,z)):e(Z,j,p));break;case"hard-light":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=O(B,Y),u[V]=O($,G),u[W]=O(M,N),u[U]=s(X,z)):e(Z,j,p));break;case"lighten":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[j]?(V=j+1,W=V+1,K=Z+1,_=K+1,q=_+1,u[j]=x(h[j],p[Z]),u[V]=x(h[V],p[K]),u[W]=x(h[W],p[_]),u[U]=s(h[U]/255,p[q]/255)):e(Z,j,p));break;case"lighter":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=D(B,Y),u[V]=D($,G),u[W]=D(M,N),u[U]=s(X,z)):e(Z,j,p));break;case Bi:for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,q=Z+3,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=w(B,Y),u[V]=w($,G),u[W]=w(M,N),u[U]=s(X,z)):e(j,j,h):e(Z,j,p));break;case"overlay":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=F(B,Y),u[V]=F($,G),u[W]=F(M,N),u[U]=s(X,z)):e(Z,j,p));break;case"screen":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=R(B,Y),u[V]=R($,G),u[W]=R(M,N),u[U]=s(X,z)):e(Z,j,p));break;case"soft-light":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,q=Z+3,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([B,$,M,X,Y,G,N,z]=n(j,Z),V=j+1,W=V+1,u[j]=T(B,Y),u[V]=T($,G),u[W]=T(M,N),u[U]=s(X,z)):e(j,j,h):e(Z,j,p));break;case ye:for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),V=j+1,W=V+1,U=W+1,K=Z+1,_=K+1,q=_+1,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[j],h[V],h[W],H),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[K],p[_],H),[Q,J,tt]=this.getRegularColorVals(rt,nt,st,H,!0),u[j]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(j,j,h):e(Z,j,p));break;case"hue":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),V=j+1,W=V+1,U=W+1,K=Z+1,_=K+1,q=_+1,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[j],h[V],h[W],H),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[K],p[_],H),[Q,J,tt]=this.getRegularColorVals(rt,ot,st,H,!0),u[j]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(j,j,h):e(Z,j,p));break;case"luminosity":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),V=j+1,W=V+1,U=W+1,K=Z+1,_=K+1,q=_+1,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[j],h[V],h[W],H),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[K],p[_],H),[Q,J,tt]=this.getRegularColorVals(it,ot,at,H,!0),u[j]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(j,j,h):e(Z,j,p));break;case"saturation":for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),V=j+1,W=V+1,U=W+1,K=Z+1,_=K+1,q=_+1,h[U]&&(Z<0?e(j,j,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[j],h[V],h[W],H),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[K],p[_],H),[Q,J,tt]=this.getRegularColorVals(rt,nt,at,H,!0),u[j]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(j,j,h):e(Z,j,p));break;default:for(L=0;L<c;L++)for(I=0;I<l;I++)[j,Z]=i(I,L),U=j+3,h[U]&&(Z<0?e(j,j,h):h[U]?(V=j+1,W=V+1,K=Z+1,_=K+1,q=_+1,X=h[U]/255,z=p[q]/255,u[j]=E(h[j],X,p[Z],z),u[V]=E(h[V],X,p[K],z),u[W]=E(h[W],X,p[_],z),u[U]=s(X,z)):e(Z,j,p))}S?this.processResults(o,r,1-g):this.processResults(this.cache.work,o,g)},[se]:function(t){const e=function(t,e,i,n,s,r){if(t){const t=e[i];if(null!=t){const e=t.length;let i,o,a=0,l=0;for(o=0;o<e;o+=r)i=t[o]+s,l+=n[i],a++;return l/a}}return n[4*i+s]},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,a=ct(o/4),{opacity:l=1,processVertical:c=!0,radiusVertical:h=0,passesVertical:u=1,stepVertical:d=1,processHorizontal:f=!0,radiusHorizontal:p=0,passesHorizontal:g=1,stepHorizontal:m=1,includeRed:y=!0,includeGreen:b=!0,includeBlue:S=!0,includeAlpha:A=!1,excludeTransparentPixels:C=!1,lineOut:k}=t;let v,P;if(f||c){const t=this.buildImageGrid(i);f&&(v=this.buildHorizontalBlur(t,p)),c&&(P=this.buildVerticalBlur(t,h))}r.set(s);const O=new Uint8ClampedArray(s),x=C?function(t,e,i,n,s,r){if(t){const t=e[i];if(null!=t){const e=t.length;let i,o,a,l,c=0,h=0;for(o=0;o<e;o+=r)l=t[o],a=l+3,n[a]&&(i=l+s,h+=n[i],c++);if(c)return h/c}}return n[4*i+s]}:e;let D,w,F,R,T,E;if(f)for(E=0;E<g;E++){for(D=0;D<a;D++)w=4*D,F=w+1,R=F+1,T=R+1,(A||O[T])&&(r[w]=x(y,v,D,O,0,m),r[F]=x(b,v,D,O,1,m),r[R]=x(S,v,D,O,2,m),r[T]=e(A,v,D,O,3,m));(c||E<g-1)&&O.set(r)}if(c)for(E=0;E<u;E++){for(D=0;D<a;D++)w=4*D,F=w+1,R=F+1,T=R+1,(A||O[T])&&(r[w]=x(y,P,D,O,0,d),r[F]=x(b,P,D,O,1,d),r[R]=x(S,P,D,O,2,d),r[T]=e(A,P,D,O,3,d));E<u-1&&O.set(r)}k?this.processResults(n,i,1-l):this.processResults(this.cache.work,n,l)},[he]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,lineOut:h}=t;let u,d,f,p,g,m,y,b,S,A=0;for(a&&A++,l&&A++,c&&A++,b=0;b<r;b+=4)u=b,d=u+1,f=d+1,p=f+1,g=n[u],m=n[d],y=n[f],s[u]=g,s[d]=m,s[f]=y,A?(S=0,a&&(S+=g),l&&(S+=m),c&&(S+=y),s[p]=ct(S/A)):s[p]=n[p];h?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ue]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,ranges:a=[],lineOut:l}=t;let c,h,u,d,f,p,g,m,y,b,S;for(b=0;b<r;b+=4){for(S=!1,c=b,h=c+1,u=h+1,d=u+1,f=n[c],p=n[h],g=n[u],m=0,y=a.length;m<y;m++){const[t,e,i,n,s,r]=a[m];if(f>=t&&f<=n&&p>=e&&p<=s&&g>=i&&g<=r){S=!0;break}}s[c]=f,s[h]=p,s[u]=g,s[d]=S?0:n[d]}l?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[de]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lowRed:a=0,lowGreen:l=0,lowBlue:c=0,highRed:h=255,highGreen:u=255,highBlue:d=255,lineOut:f}=t,p=h-a,g=u-l,m=d-c;let y,b,S,A,C,k,v,P,O;for(O=0;O<r;O+=4)y=O,b=y+1,S=b+1,A=S+1,C=n[y],k=n[b],v=n[S],P=n[A],P?(C/=255,k/=255,v/=255,s[y]=a+C*p,s[b]=l+k*g,s[S]=c+v*m):(s[y]=C,s[b]=k,s[S]=v),s[A]=P;f?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[be]:function(t){const e=function(t,e,i){const n=(et(l-t)+et(c-e)+et(h-i))/3;return n<g?0:n>m?255:(n-g)/y*255},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,red:l=0,green:c=255,blue:h=0,opaqueAt:u=1,transparentAt:d=0,lineOut:f}=t,p=pt((l+c+h)/3,(255-l+(255-c)+(255-h))/3),g=d*p,m=u*p,y=m-g;let b,S,A,C,k,v,P,O;for(O=0;O<o;O+=4)b=O,S=b+1,A=S+1,C=A+1,s[C]&&(k=s[b],v=s[S],P=s[A],r[b]=k,r[S]=v,r[A]=P,r[C]=e(k,v,P));f?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Se]:function(t){const e=function(t,e,i){const n=t+1,s=n+1,r=s+1,o=e+1,a=o+1,l=a+1;c[e]=i[t],c[o]=i[n],c[a]=i[s],c[l]=i[r]},i=function(t,e){const i=t-g,n=e-m;let s=-1;return i>=0&&i<h&&n>=0&&n<u&&(s=4*(n*h+i)),[4*(e*o+t),s]},[n,s,r]=this.getInputAndOutputLines(t),{width:o,height:a,data:l}=n,{data:c}=s,{width:h,height:u,data:d}=r,{opacity:f=1,compose:p=Ys,offsetX:g=0,offsetY:m=0,lineOut:y}=t,b=(t,e,i,n)=>e*t*n+n*i*(1-e),S=(t,e,i)=>e*t*i,A=(t,e,i)=>e*t*(1-i),C=(t,e,i,n)=>e*t*(1-n)+n*i*e,k=(t,e,i,n)=>e*t*(1-n)+n*i,v=(t,e,i)=>e*t*i,P=(t,e,i)=>i*t*(1-e),O=(t,e,i,n)=>e*t*(1-n)+n*i*(1-e),x=(t,e,i,n)=>e*t+n*i*(1-e);let D,w,F,R,T,E,H,I,L,B,$,M;switch(p){case"source-only":s.data.set(l);break;case"source-atop":for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T>=0&&(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=b(l[D],$,d[T],M),c[w]=b(l[w],$,d[E],M),c[F]=b(l[F],$,d[H],M),c[R]=255*($*M+M*(1-$)));break;case Rn:for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T>=0&&(w=D+1,F=w+1,R=F+1,I=T+3,$=l[R]/255,M=d[I]/255,c[D]=S(l[D],$,M),c[w]=S(l[w],$,M),c[F]=S(l[F],$,M),c[R]=$*M*255);break;case Tn:for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T<0?e(D,D,l):(w=D+1,F=w+1,R=F+1,I=T+3,$=l[R]/255,M=d[I]/255,c[D]=A(l[D],$,M),c[w]=A(l[w],$,M),c[F]=A(l[F],$,M),c[R]=$*(1-M)*255);break;case"destination-only":for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T>=0&&e(T,D,d);break;case"destination-atop":for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T<0?e(D,D,l):(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=C(l[D],$,d[T],M),c[w]=C(l[w],$,d[E],M),c[F]=C(l[F],$,d[H],M),c[R]=255*($*(1-M)+M*$));break;case Te:for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T<0?e(D,D,l):(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=k(l[D],$,d[T],M),c[w]=k(l[w],$,d[E],M),c[F]=k(l[F],$,d[H],M),c[R]=255*($*(1-M)+M));break;case"destination-in":for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T>=0&&(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=v(d[T],$,M),c[w]=v(d[E],$,M),c[F]=v(d[H],$,M),c[R]=$*M*255);break;case Re:for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T>=0&&(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=P(d[T],$,M),c[w]=P(d[E],$,M),c[F]=P(d[H],$,M),c[R]=M*(1-$)*255);break;case fe:break;case"xor":for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T<0?e(D,D,l):(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=O(l[D],$,d[T],M),c[w]=O(l[w],$,d[E],M),c[F]=O(l[F],$,d[H],M),c[R]=255*($*(1-M)+M*(1-$)));break;default:for(B=0;B<a;B++)for(L=0;L<o;L++)[D,T]=i(L,B),T<0?e(D,D,l):(w=D+1,F=w+1,R=F+1,E=T+1,H=E+1,I=H+1,$=l[R]/255,M=d[I]/255,c[D]=x(l[D],$,d[T],M),c[w]=x(l[w],$,d[E],M),c[F]=x(l[F],$,d[H],M),c[R]=255*($+M*(1-$)))}y?this.processResults(s,n,1-f):this.processResults(this.cache.work,s,f)},[Pe]:function(t){const e=function(t,e,i){let n,s,r=0,o=255;const a=e.length;for(s=0;s<a;s++)n=t[e[s]+i],n<o?o=n:n>r&&(r=n);switch(d){case"lowest":return o;case"highest":return r;default:return ct(o+(r-o)/2)}},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,includeRed:l=!1,includeGreen:c=!1,includeBlue:h=!1,includeAlpha:u=!0,operation:d=vi,lineOut:f}=t;let p=t.width;(!dt(p)||p<1)&&(p=3),p=ct(p);let g=t.height;(!dt(g)||g<1)&&(g=3),g=ct(g);let m=t.offsetX;(!dt(m)||m<1)&&(m=1),m=ct(m);let y=t.offsetY;(!dt(y)||y<1)&&(y=1),y=ct(y);const b=this.buildMatrixGrid(p,g,m,y,i),S=ct(o/4);let A,C,k,v,P;for(P=0;P<S;P++)A=4*P,C=A+1,k=C+1,v=k+1,r[A]=l?e(s,b[P],0):s[A],r[C]=c?e(s,b[P],1):s[C],r[k]=h?e(s,b[P],2):s[k],r[v]=u?e(s,b[P],3):s[v];f?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Ie]:function(t){const e=function(t,e,i){t<0?c[e+3]=0:(c[e]=i[t],t++,e++,c[e]=i[t],t++,e++,c[e]=i[t],t++,e++,c[e]=i[t])},i=function(t,e){const i=t+b,n=e+S;let s=-1;return i>=0&&i<h&&n>=0&&n<u&&(s=4*(n*h+i)),[4*(e*o+t),s]},[n,s,r]=this.getInputAndOutputLines(t),{width:o,height:a,data:l}=n,{data:c}=s,{width:h,height:u,data:d}=r,{opacity:f=1,channelX:p=gn,channelY:g=si,scaleX:m=1,scaleY:y=1,offsetX:b=0,offsetY:S=0,transparentEdges:A=!1,lineOut:C}=t;let k=3;p===gn?k=0:p===si?k=1:p===Jl&&(k=2);let v,P,O,x,D,w,F,R=3;for(g===gn?R=0:g===si?R=1:g===Jl&&(R=2),P=0;P<a;P++)for(v=0;v<o;v++)[w,F]=i(v,P),F>=0?(O=ct(v+(127-d[F+k])/127*m),x=ct(P+(127-d[F+R])/127*y),A?D=O<0||O>=o||x<0||x>=a?-1:4*(x*o+O):(O<0&&(O=0),O>=o&&(O=o-1),x<0&&(x=0),x>=a&&(x=a-1),D=4*(x*o+O)),e(D,w,l)):e(w,w,l);C?this.processResults(s,n,1-f):this.processResults(this.cache.work,s,f)},[Ye]:function(t){const e=function(t,e,i){let n=0;for(let s=0,r=e.length;s<r;s++)m[s]&&(n+=t[e[s]+i]*m[s]);return n},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,tolerance:l=0,keepOnlyChangedAreas:c=!1,postProcessResults:h=!1,lineOut:u}=t,d=et(t.strength||1),f=Ks(t.angle||0),p=ct(f/45),g=f%45/45*d,m=new Array(9);m.fill(0,0,9),m[4]=1,0===p?(m[5]=d-g,m[8]=g,m[3]=-m[5],m[0]=-m[8]):1===p?(m[8]=d-g,m[7]=g,m[0]=-m[8],m[1]=-m[7]):2===p?(m[7]=d-g,m[6]=g,m[1]=-m[7],m[2]=-m[6]):3===p?(m[6]=d-g,m[3]=g,m[2]=-m[6],m[5]=-m[3]):4===p?(m[3]=d-g,m[0]=g,m[5]=-m[3],m[8]=-m[0]):5===p?(m[0]=d-g,m[1]=g,m[8]=-m[0],m[7]=-m[1]):6===p?(m[1]=d-g,m[2]=g,m[7]=-m[1],m[6]=-m[2]):(m[2]=d-g,m[5]=g,m[6]=-m[2],m[3]=-m[5]);const y=this.buildMatrixGrid(3,3,1,1,i);let b,S,A,C,k,v,P,O,x,D,w,F,R;for(b=0;b<o;b+=4)S=b,A=S+1,C=A+1,k=C+1,v=s[S],P=s[A],O=s[C],x=s[k],x&&(R=ct(b/4),r[S]=e(s,y[R],0),r[A]=e(s,y[R],1),r[C]=e(s,y[R],2),r[k]=s[k],h&&(D=r[S],w=r[A],F=r[C],D>=v-l&&D<=v+l&&w>=P-l&&w<=P+l&&F>=O-l&&F<=O+l&&(c?r[k]=0:(r[S]=127,r[A]=127,r[C]=127))));u?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Ze]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,red:a=0,green:l=0,blue:c=0,alpha:h=255,excludeAlpha:u=!1,lineOut:d}=t;let f,p,g;for(f=0;f<r;f+=4)g=f+3,n[g]&&(p=f,s[p]=a,p++,s[p]=l,p++,s[p]=c,p++,s[p]=u?n[g]:h);d?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ti]:function(t){let e,i,n,s,r,o,a,l;const c=function(t){t<.5&&(t=.5);const c=Ql(.527076)/t,h=Ql(-c),u=Ql(-2*c),d=(1-h)*(1-h)/(1+2*c*h-u);return e=d,i=d*(c-1)*h,n=d*(c+1)*h,s=-d*u,r=2*h,o=-u,a=(e+i)/(1-r-o),l=(n+s)/(1-r-o),new Float32Array([e,i,n,s,r,o,a,l])},h=function(t,e,i,n,s,r){let o,a,l,c,h,u,d,f,p,g,m,y,b,S,A,C,k,v,P,O,x,D,w,F,R,T,E,H,I,L;for(R=0;R<r;R++){for(D=R*s,w=R,F=0,o=t[D],a=255&o,l=o>>8&255,c=o>>16&255,h=o>>24&255,v=a*n[6],P=l*n[6],O=c*n[6],x=h*n[6],S=v,A=P,C=O,k=x,E=n[0],H=n[1],I=n[4],L=n[5],T=0;T<s;T++)o=t[D],u=255&o,d=o>>8&255,f=o>>16&255,p=o>>24&255,g=u*E+a*H+S*I+v*L,m=d*E+l*H+A*I+P*L,y=f*E+c*H+C*I+O*L,b=p*E+h*H+k*I+x*L,v=S,P=A,O=C,x=k,S=g,A=m,C=y,k=b,a=u,l=d,c=f,h=p,i[F]=S,i[F+1]=A,i[F+2]=C,i[F+3]=k,F+=4,D++;for(D--,F-=4,w+=r*(s-1),o=t[D],a=255&o,l=o>>8&255,c=o>>16&255,h=o>>24&255,v=a*n[7],P=l*n[7],O=c*n[7],x=h*n[7],S=v,A=P,C=O,k=x,u=a,d=l,f=c,p=h,E=n[2],H=n[3],T=s-1;T>=0;T--)g=u*E+a*H+S*I+v*L,m=d*E+l*H+A*I+P*L,y=f*E+c*H+C*I+O*L,b=p*E+h*H+k*I+x*L,v=S,P=A,O=C,x=k,S=g,A=m,C=y,k=b,a=u,l=d,c=f,h=p,o=t[D],u=255&o,d=o>>8&255,f=o>>16&255,p=o>>24&255,o=(i[F]+S|0)+(i[F+1]+A<<8)+(i[F+2]+C<<16)+(i[F+3]+k<<24),e[w]=o,D--,F-=4,w-=r}},[u,d]=this.getInputAndOutputLines(t),f=u.data,p=d.data,{width:g,height:m}=u,{opacity:y=1,radiusHorizontal:b=1,radiusVertical:S=1,includeRed:A=!0,includeGreen:C=!0,includeBlue:k=!0,includeAlpha:v=!0,excludeTransparentPixels:P=!1,lineOut:O}=t,x=new Uint8ClampedArray(f),D=new Uint32Array(x.buffer),w=new Uint32Array(D.length),F=new Float32Array(4*pt(g,m)),R=c(b),T=c(S);let E,H,I,L,B,$;if(h(D,w,F,R,g,m),h(w,D,F,T,m,g),P)for(B=0,$=f.length;B<$;B+=4)E=B,H=E+1,I=H+1,L=I+1,f[L]?(p[E]=A?x[E]:f[E],p[H]=C?x[H]:f[H],p[I]=k?x[I]:f[I],p[L]=v?x[L]:f[L]):(p[E]=f[E],p[H]=f[H],p[I]=f[I],p[L]=f[L]);else for(B=0,$=f.length;B<$;B+=4)E=B,H=E+1,I=H+1,L=I+1,p[E]=A?x[E]:f[E],p[H]=C?x[H]:f[H],p[I]=k?x[I]:f[I],p[L]=v?x[L]:f[L];O?this.processResults(d,u,1-y):this.processResults(this.cache.work,d,y)},[ei]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,o=e.width,a=e.height,{opacity:l=1,useMixedChannel:c=!0,seed:h=we,level:u=0,offsetMin:d=0,offsetMax:f=0,offsetRedMin:p=0,offsetRedMax:g=0,offsetGreenMin:m=0,offsetGreenMax:y=0,offsetBlueMin:b=0,offsetBlueMax:S=0,offsetAlphaMin:A=0,offsetAlphaMax:C=0,transparentEdges:k=!1,lineOut:v}=t;let P=ct(t.step);P<1&&(P=1);const O=this.getRandomNumbers({seed:h,length:5*a}),x=f-d,D=g-p,w=y-m,F=S-b,R=C-A;let T=-1;const E=[];let H,I,L,B,$,M,X,Y,G,N,z,j,V,W,U,Z,K,_,q,Q,J,tt,et,it,nt;for(H=0;H<a;H+=P)if(L=O[++T]<u,L)if(c)for(B=4*(d+ct(O[++T]*x)),I=0;I<P;I++)E.push(B,B,B,B);else for($=4*(p+ct(O[++T]*D)),M=4*(m+ct(O[++T]*w)),X=4*(b+ct(O[++T]*F)),Y=4*(A+ct(O[++T]*R)),I=0;I<P;I++)E.push($,M,X,Y);else for(I=0;I<P;I++)E.push(0,0,0,0);for(H=0;H<r;H+=4)G=H,N=G+1,z=N+1,j=z+1,V=4*o,W=ct(H/V),K=4*W,_=E[K],q=E[++K],Q=E[++K],J=E[++K],tt=G+_,et=N+q,it=z+Q,nt=j+J,s[G]=n[tt],s[N]=n[et],s[z]=n[it],k?(U=W*V,Z=U+V,s[j]=tt<U||tt>Z||et<U||et>Z||it<U||it>Z||nt<U||nt>Z?0:n[nt]):s[j]=n[nt];v?this.processResults(i,e,1-l):this.processResults(this.cache.work,i,l)},[ni]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t,l=this.getGrayscaleValue;let c,h,u,d,f,p;for(f=0;f<r;f+=4)c=f,h=c+1,u=h+1,d=u+1,p=l(n[c],n[h],n[u]),s[c]=p,s[h]=p,s[u]=p,s[d]=n[d];a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[fi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,includeAlpha:h=!1,lineOut:u}=t;let d,f,p,g,m;for(m=0;m<r;m+=4)d=m,f=d+1,p=f+1,g=p+1,s[d]=a?255-n[d]:n[d],s[f]=l?255-n[f]:n[f],s[p]=c?255-n[p]:n[p],s[g]=h?255-n[g]:n[g];u?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[bi]:function(t){const e=function(t,e){if(!e.length)return t;for(let i=0,n=e.length;i<n;i++){const[n,s,r]=e[i];if(t>=n&&t<=s)return r}};this.checkChannelLevelsParameters(t);const[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,red:l=[0],green:c=[0],blue:h=[0],alpha:u=[255],lineOut:d}=t;let f,p,g,m,y;for(y=0;y<o;y+=4)f=y,p=f+1,g=p+1,m=g+1,r[f]=e(s[f],l),r[p]=e(s[p],c),r[g]=e(s[g],h),r[m]=e(s[m],u);d?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Ai]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t,l=this.retrieveColorPointLibraries();let c,h,u,d,f,p;for(f=0;f<r;f+=4)c=f,h=c+1,u=h+1,d=u+1,[p]=this.getOkColorVals(n[c],n[h],n[u],l),s[c]=0,s[h]=0,s[u]=0,s[d]=ct(256*p);a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Ci]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,useNaturalGrayscale:a=!1,gradient:l=!1,lineOut:c}=t;if(l){let t,e,i,o,c,h,u;const d=this.getGradientData(l);if(d.length){const l=this.getGrayscaleValue;for(t=0;t<r;t+=4)i=t,o=i+1,c=o+1,h=c+1,n[h]&&(e=a?l(n[i],n[o],n[c]):ct(.3333*n[i]+.3333*n[o]+.3333*n[c]),u=4*e,s[i]=d[u],u++,s[o]=d[u],u++,s[c]=d[u],u++,s[h]=d[u])}else this.transferDataUnchanged(s,n,r)}else this.transferDataUnchanged(s,n,r);c?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ki]:function(t){const e=function(t,e,i){let n,s=0;for(let r=0,o=e.length;r<o;r++)y[r]&&(n=e[r]+i,s+=t[n]*y[r]);return s},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,includeRed:l=!0,includeGreen:c=!0,includeBlue:h=!0,includeAlpha:u=!1,offsetX:d=1,offsetY:f=1,lineOut:p}=t;let g=t.width;(!dt(g)||g<1)&&(g=3),g=ct(g);let m=t.height;(!dt(m)||m<1)&&(m=3),m=ct(m);let y=t.weights;y&&y.length===g*m||(y=[].fill(0,0,g*m-1),y[ct(y.length/2)+1]=1);const b=this.buildMatrixGrid(g,m,d,f,i);let S,A,C,k,v;const P=ct(o/4);for(v=0;v<P;v++)S=4*v,A=S+1,C=A+1,k=C+1,s[k]&&(r[S]=l?e(s,b[v],0):s[S],r[A]=c?e(s,b[v],1):s[A],r[C]=h?e(s,b[v],2):s[C],r[k]=u?e(s,b[v],3):s[k]);p?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[xi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,channelA:a=0,channelB:l=0,channelL:c=0,lineOut:h}=t,u=this.retrieveColorPointLibraries();let d,f,p,g,m,y,b,S,A,C,k;for(m=0;m<r;m+=4)d=m,f=d+1,p=f+1,g=p+1,n[g]?([y,b,S]=this.getOkColorVals(n[d],n[f],n[p],u),y+=c,y>1?y=1:y<0&&(y=0),b+=a,b>.4?b=.4:b<-.4&&(b=-.4),S+=l,S>.4?S=.4:S<-.4&&(S=-.4),[A,C,k]=this.getRegularColorVals(y,b,S,u),s[d]=A,s[f]=C,s[p]=k,s[g]=n[g]):(s[d]=n[d],s[f]=n[f],s[p]=n[p],s[g]=n[g]);h?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Di]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,red:a=1,green:l=1,blue:c=1,alpha:h=1,saturation:u=!1,lineOut:d}=t;let f,p,g,m,y,b,S,A,C;if(u){const t=this.getGrayscaleValue;for(C=0;C<r;C+=4)f=C,p=f+1,g=p+1,m=g+1,b=n[f],S=n[p],A=n[g],y=t(b,S,A),s[f]=y+(b-y)*a,s[p]=y+(S-y)*l,s[g]=y+(A-y)*c,s[m]=n[m]*h}else for(C=0;C<r;C+=4)f=C,p=f+1,g=p+1,m=g+1,s[f]=n[f]*a,s[p]=n[p]*l,s[g]=n[g]*c,s[m]=n[m]*h;d?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[wi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,channelA:a=1,channelB:l=1,channelL:c=1,lineOut:h}=t,u=this.retrieveColorPointLibraries();let d,f,p,g,m,y,b,S,A,C,k;for(m=0;m<r;m+=4)d=m,f=d+1,p=f+1,g=p+1,n[g]?([y,b,S]=this.getOkColorVals(n[d],n[f],n[p],u),y*=c,y>1?y=1:y<0&&(y=0),b*=a,b>.4?b=.4:b<-.4&&(b=-.4),S*=l,S>.4?S=.4:S<-.4&&(S=-.4),[A,C,k]=this.getRegularColorVals(y,b,S,u),s[d]=A,s[f]=C,s[p]=k,s[g]=n[g]):(s[d]=n[d],s[f]=n[f],s[p]=n[p],s[g]=n[g]);h?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Mi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t,l=this.retrieveColorPointLibraries();let c,h,u,d,f,p,g,m,y,b,S;for(f=0;f<r;f+=4)c=f,h=c+1,u=h+1,d=u+1,n[d]?([p,,,g,m]=this.getOkColorVals(n[c],n[h],n[u],l),p=1-p,m+=180,[y,b,S]=this.getRegularColorVals(p,g,m,l,!0),s[c]=y,s[h]=b,s[u]=S,s[d]=n[d]):(s[c]=n[c],s[h]=n[h],s[u]=n[u],s[d]=n[d]);a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Xi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,{opacity:r=1,lineOut:o}=t;let a=ct(t.width||1);a<1&&(a=1);const l=2*a,c=this.buildImageTileSets(l,l,0,0),h=this.getGrayscaleValue,u=uc,d=[],f=[];c.forEach((t=>function(t,e,i){d.length=0,f.length=0;let n,s,r,o,l,c,p=0;const g=i.length;for(n=0;n<g;n++)s=i[n],r=s+1,o=r+1,c=h(t[s],t[r],t[o]),p+=c;p/=g;const m=u[ct(p/255*13)];if(1===a)d.push(...m);else{for(c=m[0],n=0;n<a;n++)f.push(c);for(c=m[1],n=0;n<a;n++)f.push(c);for(n=0;n<a;n++)d.push(...f);for(c=m[2],f.length=0,n=0;n<a;n++)f.push(c);for(c=m[3],n=0;n<a;n++)f.push(c);for(n=0;n<a;n++)d.push(...f)}for(n=0;n<g;n++)c=d[n],s=i[n],r=s+1,o=r+1,l=o+1,e[s]=c,e[r]=c,e[o]=c,e[l]=t[l]}(n,s,t))),o?this.processResults(i,e,1-r):this.processResults(this.cache.work,i,r)},[Ni]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,{opacity:r=1,offsetRedX:o=0,offsetRedY:a=0,offsetGreenX:l=0,offsetGreenY:c=0,offsetBlueX:h=0,offsetBlueY:u=0,offsetAlphaX:d=0,offsetAlphaY:f=0,lineOut:p}=t;if(o||l||h||d||a||c||u||f){let t=!1;o===l&&o===h&&o===d&&a===c&&a===u&&a===f&&(t=!0);const i=this.buildImageGrid(e),r=i[0].length,p=i.length;let g,m,y,b,S,A,C,k,v,P;for(let e=0;e<p;e++)for(let O=0;O<r;O++)v=4*i[e][O],t?(g=O+o,m=e+a,g>=0&&g<r&&m>=0&&m<p&&(P=4*i[m][g],s[P]=n[v],s[P+1]=n[v+1],s[P+2]=n[v+2],s[P+3]=n[v+3])):(g=O+o,m=e+a,y=O+l,b=e+c,S=O+h,A=e+u,C=O+d,k=e+f,g>=0&&g<r&&m>=0&&m<p&&(P=4*i[m][g],s[P]=n[v]),y>=0&&y<r&&b>=0&&b<p&&(P=4*i[b][y],s[P+1]=n[v+1]),S>=0&&S<r&&A>=0&&A<p&&(P=4*i[A][S],s[P+2]=n[v+2]),C>=0&&C<r&&k>=0&&k<p&&(P=4*i[k][C],s[P+3]=n[v+3]))}p?this.processResults(i,e,1-r):this.processResults(this.cache.work,i,r)},[qi]:function(t){const e=function(t,e,i,n){let s=i.reduce(((e,i)=>e+t[i+n]),0);s=ct(s/i.length);for(let t=0,r=i.length;t<r;t++)e[i[t]+n]=s},i=function(t,e,i,n){let s;for(let r=0,o=i.length;r<o;r++)s=i[r],e[s+n]=t[s+n]},[n,s]=this.getInputAndOutputLines(t),r=n.data,o=s.data,{opacity:a=1,tileWidth:l=1,tileHeight:c=1,offsetX:h=0,offsetY:u=0,includeRed:d=!0,includeGreen:f=!0,includeBlue:p=!0,includeAlpha:g=!1,lineOut:m}=t;this.buildImageTileSets(l,c,h,u).forEach((t=>{d?e(r,o,t,0):i(r,o,t,0),f?e(r,o,t,1):i(r,o,t,1),p?e(r,o,t,2):i(r,o,t,2),g?e(r,o,t,3):i(r,o,t,3)})),m?this.processResults(s,n,1-a):this.processResults(this.cache.work,s,a)},[rn]:function(t){const{identifier:e,lineOut:i}=t;if(i&&i.substring&&i.length){const t=Na(e);let n=t?t.width:1,s=t?t.height:1,r=t?t.data:new Uint8ClampedArray(4);if(n&&s&&r){const{width:t,height:e}=this.cache.source;if(t!==n||e!==s){const i=new ImageData(t,e).data;let o,a,l,c,h=(t-n)/2,u=(e-s)/2;for(h<0&&(h=0),u<0&&(u=0),a=0;a<e;a++)for(o=0;o<t;o++)o<n&&a<s&&(l=4*((a+u)*t+(o+h)),c=4*(a*n+o),i[l]=r[c],l++,c++,i[l]=r[c],l++,c++,i[l]=r[c],l++,c++,i[l]=r[c]);r=i,n=t,s=e}this.cache[i]=new ImageData(r,n,s)}}},[dn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,o=e.width,{opacity:a=1,width:l=1,height:c=1,level:h=.5,seed:u=we,noiseType:d=un,noWrap:f=!1,includeRed:p=!0,includeGreen:g=!0,includeBlue:m=!0,includeAlpha:y=!0,excludeTransparentPixels:b=!0,lineOut:S}=t,A=this.getRandomNumbers({seed:u,length:st(r/4*3),imgWidth:o,type:d});let C,k,v,P,O,x,D,w,F,R,T,E=-1;const H=l/2,I=c/2;for(w=0;w<r;w+=4){if(P=w,O=P+1,x=O+1,D=x+1,d===un)C=A[++E],k=A[++E],v=A[++E];else{const t=A[++E];C=t,k=t,v=t}C<h?(F=ct(k*l-H),R=ct(v*c-I),T=w+4*(R*o+F),f&&(T<0||T>=r)?(s[P]=n[P],s[O]=n[O],s[x]=n[x],s[D]=n[D]):(T<0?T+=r:T>=r&&(T-=r),!b||n[D]&&n[T+3]?(s[P]=p?n[T]:n[P],T++,s[O]=g?n[T]:n[O],T++,s[x]=m?n[T]:n[x],T++,s[D]=y?n[T]:n[D]):(s[P]=n[P],s[O]=n[O],s[x]=n[x],s[D]=n[D]))):(s[P]=n[P],s[O]=n[O],s[x]=n[x],s[D]=n[D])}S?this.processResults(i,e,1-a):this.processResults(this.cache.work,i,a)},[mn]:function(t){const e=(t,e,i)=>65536*t+256*e+i,[i,n]=this.getInputAndOutputLines(t),s=i.data,r=i.width,o=n.data,a=s.length,{opacity:l=1,seed:c=we,useBluenoise:h=!1,minimumColorDistance:u=500,lineOut:d}=t;let{palette:f=Jt}=t;const p=h?ne:t.noiseType||un,g=this.retrieveColorPointLibraries(),m=this.getRandomNumbers({seed:c,length:a/4,imgWidth:r,type:p});let y=-1;(null==f||f.substring&&!dc[f]||ut(f)&&f.length<2||f.toFixed&&(f<2||f>256))&&(f=Jt);const b=ec.includes(f),S=ut(f),A=[];let C,k,v,P,O,x,D,w,F,R,T,E,H,I,L,B,$,M,X,Y,G,N,z,j,V,W,U,Z,K,_,q;if(b){const{getGrayscaleValue:t}=this;let e,i;for(C=dc[f],k=C.length,v=0;v<a;v+=4)if(x=v,D=x+1,w=D+1,F=w+1,s[F]){for(i=t(s[x],s[D],s[w]),A.length=0,O=0;O<k&&(e=C[O],I=et(e-i),A.push([e,I]),!(O&&I>=A[O-1][1]));O++);A.sort(((t,e)=>t[1]-e[1])),[$,L]=A[0],[M,B]=A[1],X=L+B,Y=X-L,G=m[++y]*X,N=G<Y?$:M,o[x]=N,o[D]=N,o[w]=N,o[F]=s[F]}else++y,o[x]=s[x],o[D]=s[D],o[w]=s[w],o[F]=s[F];yc(f)}else if(S){const t=f.join(zt);if(dc[t])C=dc[t];else{let e,i,n;for(C=[],v=0,P=f.length;v<P;v++)[e,i,n]=gc.getColorFromCanvas(f[v].trim()),H=this.getOkColorVals(e,i,n,g),C.push([e,i,n,...H]);dc[t]=C}for(k=C.length,v=0;v<a;v+=4)if(x=v,D=x+1,w=D+1,F=w+1,s[F]){for(A.length=0,[z,j,V]=this.getOkColorVals(s[x],s[D],s[w],g),O=0;O<k;O++)[,,,W,U,Z]=C[O],K=100*z-100*W,_=125*(j+.4)-125*(U+.4),q=125*(V+.4)-125*(Z+.4),I=xt(K*K+_*_+q*q),A.push([O,I]);A.sort(((t,e)=>t[1]-e[1])),[$,L]=A[0],[M,B]=A[1],X=L+B,Y=X-L,G=m[++y]*X,N=G<Y?C[$]:C[M],[R,T,E]=N,o[x]=R,o[D]=T,o[w]=E,o[F]=s[F]}else++y,o[x]=s[x],o[D]=s[D],o[w]=s[w],o[F]=s[F];yc(f)}else{const t=Array(16777216);let i,n,r;for(v=0;v<a;v+=4)x=v,D=x+1,w=D+1,F=w+1,R=s[x],T=s[D],E=s[w],s[F]&&(i=e(R,T,E),t[i]?t[i][0]+=1:([K,_,q]=this.getOkColorVals(R,T,E,g),K*=100,_=125*(_+.4),q=125*(q+.4),t[i]=[1,R,T,E,K,_,q]));const l=t.filter((t=>null!=t));l.sort(((t,e)=>e[0]-t[0])),C=[[...l[0]]];const c=[];for(v=1,P=l.length;v<P;v++){for([,,,,z,j,V]=l[v],c.length=0,n=0,r=C.length;n<r;n++)[,,,,W,U,Z]=C[n],K=100*z-100*W,_=125*(j+.4)-125*(U+.4),q=125*(V+.4)-125*(Z+.4),I=xt(K*K+_*_+q*q),c.push(I);if(c.sort(((t,e)=>t-e)),c[0]>u&&C.push([...l[v]]),C.length>=f)break}for(k=C.length,yc(C.map((t=>`rgb(${t[1]} ${t[2]} ${t[3]})`))),t.forEach((t=>{for([,,,,z,j,V]=t,A.length=0,O=0;O<k;O++)[,,,,W,U,Z]=C[O],K=100*z-100*W,_=125*(j+.4)-125*(U+.4),q=125*(V+.4)-125*(Z+.4),I=xt(K*K+_*_+q*q),A.push([O,I]);A.sort(((t,e)=>t[1]-e[1])),[$,L]=A[0],[M,B]=A[1],X=L+B,Y=X-L,t.length=0,t.push(X,Y,C[$],C[M])})),v=0;v<a;v+=4)x=v,D=x+1,w=D+1,F=w+1,s[F]?(i=e(s[x],s[D],s[w]),[X,Y,$,M]=t[i],G=m[++y]*X,N=G<Y?$:M,[,R,T,E]=N,o[x]=R,o[D]=T,o[w]=E,o[F]=s[F]):(++y,o[x]=s[x],o[D]=s[D],o[w]=s[w],o[F]=s[F])}d?this.processResults(n,i,1-l):this.processResults(this.cache.work,n,l)},[xn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,angle:a=0,lineOut:l}=t;if(a){const t=this.retrieveColorPointLibraries();let e,i,o,l,c,h,u,d,f,p,g;for(c=0;c<r;c+=4)e=c,i=e+1,o=i+1,l=o+1,n[l]?([h,,,u,d]=this.getOkColorVals(n[e],n[i],n[o],t),d+=a,[f,p,g]=this.getRegularColorVals(h,u,d,t,!0),s[e]=f,s[i]=p,s[o]=g,s[l]=n[l]):(s[e]=n[e],s[i]=n[i],s[o]=n[o],s[l]=n[l])}else this.transferDataUnchanged(s,n,r);l?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[wn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!1,includeGreen:l=!1,includeBlue:c=!1,includeAlpha:h=!1,level:u=0,lineOut:d}=t;let f,p,g,m,y;for(y=0;y<r;y+=4)f=y,p=f+1,g=p+1,m=g+1,s[f]=a?u:n[f],s[p]=l?u:n[p],s[g]=c?u:n[g],s[m]=h?u:n[m];d?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Yn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,red:a=1,green:l=1,blue:c=1,clamp:h=$e,lineOut:u}=t;let d,f,p,g,m;for(m=0;m<r;m+=4){switch(d=m,f=d+1,p=f+1,g=p+1,h){case Ts:s[d]=st(n[d]/a)*a,s[f]=st(n[f]/l)*l,s[p]=st(n[p]/c)*c;break;case Dn:s[d]=vt(n[d]/a)*a,s[f]=vt(n[f]/l)*l,s[p]=vt(n[p]/c)*c;break;default:s[d]=ct(n[d]/a)*a,s[f]=ct(n[f]/l)*l,s[p]=ct(n[p]/c)*c}s[g]=n[g]}u?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[zn]:function(t){const e=function(t,e){return t.substring?ct(parseFloat(t)/100*e):t},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,a=i.width,l=i.height,c=new ImageData(a,l),h=c.data,u=c.width,d=c.height,{opacity:f=1,swirls:p=[],lineOut:g}=t;let m,y,b,S,A,C,k,v,P,O,x,D,w,F,R,T,E,H,I,L,B;for(D=0;D<o;D+=4)m=D,y=m+1,b=y+1,S=b+1,h[m]=s[m],h[y]=s[y],h[b]=s[b],h[S]=s[S],r[m]=s[m],r[y]=s[y],r[b]=s[b],r[S]=s[S];if(ut(p)&&p.length){const t=this.buildImageGrid(i);for(A=0,C=p.length;A<C;A++){const[i,n,s,o,c,f]=p[A],g=e(i,a),C=e(n,l);let $=e(o,a),M=e(s,a);if(M>$){const t=M;M=$,$=t}let X=$-M;if(0===X&&(X=.1),v=g-$,v<0&&(v=0),O=g+$,O>u&&(O=u),P=C-$,P<0&&(P=0),x=C+$,x>=d&&(x=d),v<O&&P<x&&v<u&&O>0&&P<d&&x>0){let e=f,u=f;ar(e)?u=`ude-${e(0)}-${e(.1)}-${e(.2)}-${e(.3)}-${e(.4)}-${e(.5)}-${e(.6)}-${e(.7)}-${e(.8)}-${e(.9)}-${e(1)}`:e=null!=Sr[e]?Sr[e]:Sr.linear;const d=ja(`swirl-${i}-${n}-${s}-${o}-${c}-${u}-${a}-${l}`);if(!d.length){const i=rl(),n=rl();for(i.setFromArray([g,C]),D=P;D<x;D++)for(w=v;w<O;w++)k=[w,D],m=4*t[D][w],F=n.set(k).subtract(i).getMagnitude(),F>$?R=m:F<M?(n.rotate(c).add(i),I=ct(n[0]),L=ct(n[1]),I<0?I+=a:I>=a&&(I-=a),L<0?L+=l:L>=l&&(L-=l),R=4*t[L][I]):(B=1-(F-M)/X,B=e(B),n.rotate(c*B).add(i),I=ct(n[0]),L=ct(n[1]),I<0?I+=a:I>=a&&(I-=a),L<0?L+=l:L>=l&&(L-=l),R=4*t[L][I]),d.push(R);ol(n,i)}let p=-1;for(D=P;D<x;D++)for(w=v;w<O;w++)m=4*t[D][w],y=m+1,b=y+1,S=b+1,R=d[++p],T=R+1,E=T+1,H=E+1,r[m]=h[R],r[y]=h[T],r[b]=h[E],r[S]=h[H];for(D=P;D<x;D++)for(w=v;w<O;w++)m=4*t[D][w],y=m+1,b=y+1,S=b+1,h[m]=r[m],h[y]=r[y],h[b]=r[b],h[S]=r[S]}}}g?this.processResults(n,i,1-f):this.processResults(this.cache.work,n,f)},[bs]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,low:a=[0,0,0,0],high:l=[255,255,255,255],level:c=128,red:h=128,green:u=128,blue:d=128,alpha:f=128,includeRed:p=!0,includeGreen:g=!0,includeBlue:m=!0,includeAlpha:y=!1,useMixedChannel:b=!0,lineOut:S}=t,[A,C,k,v]=a,[P,O,x,D]=l,w=this.getGrayscaleValue;let F,R,T,E,H,I,L,B,$,M;for(H=0;H<r;H+=4)F=H,R=F+1,T=R+1,E=T+1,I=n[F],L=n[R],B=n[T],$=n[E],b?(M=w(I,L,B),M<c?(s[F]=p?A:I,s[R]=g?C:L,s[T]=m?k:B,s[E]=y?v:$):(s[F]=p?P:I,s[R]=g?O:L,s[T]=m?x:B,s[E]=y?D:$)):(s[F]=p?I<h?A:P:I,s[R]=g?L<u?C:O:L,s[T]=m?B<d?k:x:B,s[E]=y?$<f?v:D:$);S?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Ss]:function(t){const e=function(t,e,i,n){let s=i.reduce(((e,i)=>e+t[4*i+n]),0);s=ct(s/i.length);for(let t=0,r=i.length;t<r;t++)e[4*i[t]+n]=s},i=function(t,e,i,n){let s;for(let r=0,o=i.length;r<o;r++)s=4*i[r]+n,e[s]=t[s]},[n,s]=this.getInputAndOutputLines(t),r=n.data,o=s.data,a=r.length,{opacity:l=1,tileWidth:c=1,tileHeight:h=1,tileRadius:u=1,offsetX:d=0,offsetY:f=0,angle:p=0,points:g=fn,seed:m=we,includeRed:y=!0,includeGreen:b=!0,includeBlue:S=!0,includeAlpha:A=!1,lineOut:C}=t,k=this.buildGeneralTileSets(g,c,h,u,d,f,p,m);k.length?k.forEach((t=>{y?e(r,o,t,0):i(r,o,t,0),b?e(r,o,t,1):i(r,o,t,1),S?e(r,o,t,2):i(r,o,t,2),A?e(r,o,t,3):i(r,o,t,3)})):this.transferDataUnchanged(o,r,a),C?this.processResults(s,n,1-l):this.processResults(this.cache.work,s,l)},[As]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,redInRed:a=1,redInGreen:l=0,redInBlue:c=0,greenInRed:h=0,greenInGreen:u=1,greenInBlue:d=0,blueInRed:f=0,blueInGreen:p=0,blueInBlue:g=1,lineOut:m}=t;let y,b,S,A,C,k,v,P;for(C=0;C<r;C+=4)y=C,b=y+1,S=b+1,A=S+1,k=n[y],v=n[b],P=n[S],s[y]=ct(k*a+v*h+P*f),s[b]=ct(k*l+v*u+P*p),s[S]=ct(k*c+v*d+P*g),s[A]=n[A];m?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Hs]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t;this.transferDataUnchanged(s,n,r),a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Ls]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,weights:a=[],useMixedChannel:l=!0,lineOut:c}=t;1024!==a.length&&(a.length=1024,a.fill(0));const h=this.getGrayscaleValue;let u,d,f,p,g,m,y,b,S,A,C,k,v,P;for(u=0;u<r;u+=4)d=u,f=d+1,p=f+1,g=p+1,m=n[d],y=n[f],b=n[p],S=n[g],l?(A=h(m,y,b),C=a[4*A+3],k=.2126*C,v=.7152*C,P=.0722*C,s[d]=m+k,s[f]=y+v,s[p]=b+P,s[g]=n[g]):(s[d]=m+a[4*m],s[f]=y+a[4*y+1],s[p]=b+a[4*b+2],s[g]=S+a[4*S+3]);c?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)}},Eo({name:"SC-core-filters-cleanup-action",order:999,fn:function(){S.forEach((t=>{const e=b[t];e&&(e.dirtyFilterIdentifier=!1)})),B.forEach((t=>{const e=L[t];e&&(e.dirtyFilterIdentifier=!1)}))}}),J.FilterEngine=FilterEngine;const Ac=new FilterEngine;function Cc(t=tr){t.defs=ur(t.defs,{sourceLoaded:!1,source:null,subscribers:null}),t.packetExclusions=fr(t.packetExclusions,["sourceLoaded","source","subscribers"]),t.finalizePacketOut=function(t){return this.subscribers&&this.subscribers.length&&(t.subscribers=this.subscribers.map((t=>t.name))),t},t.kill=function(t=!1){return t&&this.source&&this.source.remove(),this.deregister()};const e=t.setters;e.source=function(t){t&&this.sourceLoaded&&this.notifySubscribers()},e.subscribers=qs,t.assetConstructor=function(t){return this.makeName(t.name),this.register(),this.subscribers=[],this.set(this.defs),this.source=null,this.currentSrc=null,this.currentFile=null,this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this},t.subscribe=function(t){if(t&&t.name){const e=t.name;this.subscribers.every((t=>t.name!==e))&&this.subscribeAction(t)}},t.subscribeAction=function(t){t&&(this.subscribers.push(t),t.asset=this,t.source=this.source,this.notifySubscriber(t))},t.unsubscribe=function(t){if(t&&t.name){const e=t.name,i=this.subscribers.findIndex((t=>t.name===e));i>=0&&(t.source=null,t.asset=null,t.sourceNaturalHeight=0,t.sourceNaturalWidth=0,t.sourceLoaded=!1,this.subscribers.splice(i,1))}},t.notifySubscribers=function(){this.subscribers.forEach((t=>this.notifySubscriber(t)),this)},t.notifySubscriber=function(t){t.sourceNaturalWidth=this.sourceNaturalWidth,t.sourceNaturalHeight=this.sourceNaturalHeight,t.sourceLoaded=this.sourceLoaded,t.source=this.source,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0,t.dirtyImageSubscribers=!0,t.dirtyFilterIdentifier=!0}}const kc=["IMG","PICTURE"],vc="intrinsic",Pc="zero",ImageAsset=function(t=tr){return this.assetConstructor(t)},Oc=ImageAsset.prototype=Ar();Oc.type=Jn,Oc.lib=Wt,Oc.isArtefact=!1,Oc.isAsset=!0,Ro(Oc),Cc(Oc);Oc.defs=ur(Oc.defs,{intrinsicDimensions:null}),Oc.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},Oc.stringifyFunction=qs,Oc.processPacketOut=qs,Oc.finalizePacketOut=qs,Oc.clone=Js;const xc=Oc.getters,Dc=Oc.setters;xc.width=function(){return this.sourceNaturalWidth||this.source.naturalWidth||0},xc.height=function(){return this.sourceNaturalHeight||this.source.naturalHeight||0},Dc.source=function(t){t&&(kc.includes(t.tagName.toUpperCase())&&(this.source=t,this.sourceNaturalWidth=t.naturalWidth,this.sourceNaturalHeight=t.naturalHeight,this.sourceLoaded=t.complete),this.sourceLoaded&&this.notifySubscribers())},Dc.currentSrc=function(t){this.currentSrc=t,this.currentFile=this.currentSrc.split("/").pop()},Oc.checkSource=function(t,e){const i=this.source;let n=Xe;if(this.sourceLoaded){let s=this.intrinsicDimensions[this.currentFile];switch(this.currentSrc!==i.currentSrc?(this.set({currentSrc:i.currentSrc}),s=this.intrinsicDimensions[this.currentFile],n=s?vc:Pc):s&&(n=vc),n){case Pc:this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.notifySubscribers();break;case vc:this.sourceNaturalWidth===s[0]&&this.sourceNaturalHeight===s[1]||(this.sourceNaturalWidth=s[0],this.sourceNaturalHeight=s[1],this.notifySubscribers());break;default:this.sourceNaturalWidth===i.naturalWidth&&this.sourceNaturalHeight===i.naturalHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.naturalWidth,this.sourceNaturalHeight=i.naturalHeight,this.notifySubscribers())}}};const wc=[],Fc=[],Rc=function(...t){const e=[];return t.forEach((t=>{let i,n,s,r,o=!1,a=!1;if(t.substring){const e=Ut.exec(t);i=e&&e[1]?e[1]:Ys,n=t,s=Ys,r=!1,a=!0}else(t=!!cr(t)&&t)&&t.src&&(i=t.name||Ys,n=t.src,s=t.className||Ys,r=t.visibility||!1,t.parent&&(o=document.querySelector(t.parent)),a=!0);if(a){const t=Lc({name:i,intrinsicDimensions:{}}),a=document.createElement(ui);a.name=i,a.className=s,a.crossorigin=Gt,a.style.display=r?ie:Yi,o&&o.appendChild(a),a.onload=()=>{t.set({source:a})},a.src=n,t.set({source:a}),e.push(i)}else e.push(!1)})),e},Tc=function(t){document.querySelectorAll(t).forEach((t=>{let e;if(kc.includes(t.tagName.toUpperCase())){if(t.id||t.name)e=t.id||t.name;else{const i=Ut.exec(t.src);e=i&&i[1]?i[1]:Ys}let i=t.dataset.dimensions||{};i.substring&&(i=yt(i));const n=Lc({name:e,source:t,intrinsicDimensions:i,currentSrc:t.currentSrc});t.onload=()=>{n.set({source:t})}}}))},Ec=function(t,e=!1){let i=t.substring?d[t]||h[t]:t;i.type===Wn&&(i=i.base),i.type===Un&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=e))},Hc=function(t,e=!1){let i;t&&!t.substring?t.type===Qn?i=t:t.type===Un?i=k[t.name]:t.type===Wn&&(i=k[t.base.name]):t&&t.substring&&(i=k[t]),i&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=e))},Ic=function(t,e=!1){const i=t.substring?o[t]:t;i.isArtefact&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=e))},Lc=function(t){return!!t&&new ImageAsset(t)};function Bc(t=tr){t.defs=ur(t.defs,{filters:null,isStencil:!1,memoizeFilterOutput:!1});const e=t.setters;e.filters=function(t){t&&(this.filters.length=0,ut(t)||(t=[t]),t.forEach((t=>{t.substring?this.filters.push(t):t.type===qn&&this.filters.push(t.name)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},e.memoizeFilterOutput=function(t){this.memoizeFilterOutput=t,this.updateFilterIdentifier(!!t)},t.updateFilterIdentifier=function(t){this.dirtyFilterIdentifier=!1,this.state&&(this.state.dirtyFilterIdentifier=!1),this.memoizeFilterOutput&&t?this.filterIdentifier=er():this.filterIdentifier=Ys},t.cleanFilters=function(){this.dirtyFilters=!1,this.dirtyFiltersCache=!0;const{filters:t,currentFilters:e}=this;e.length=0,t.forEach((t=>{if(t.substring){const i=b[t];i&&e.push(i)}else t&&t.type&&t.type===qn&&e.push(t)}))},t.addFilters=function(...t){return t.forEach((t=>{t&&t.type===qn&&(t=t.name),this.filters.push(t)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.removeFilters=function(...t){return t.forEach((t=>{t&&t.type===qn&&(t=t.name),pr(this.filters,t)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.clearFilters=function(){return this.filters.length=0,this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.hasFilters=function(){return!!this.filters.length},t.preprocessFilters=function(t,e,i){for(let n,s=0,r=t.length;s<r;s++){n=t[s];for(let t,s=0,r=n.actions.length;s<r;s++)if(t=n.actions[s],t.action===rn){const n=l[t.asset];if(n){let s,r,o,a,l,c,h,u,d,f;if(Jn!==n.type&&(n.checkSource(),t.identifier=`user-image-${t.asset}-${er()}`,this.dirtyFilterIdentifier=!0),!Ga(t.identifier)&&(s=n.sourceNaturalWidth,r=n.sourceNaturalHeight,o=n.sourceNaturalDimensions,a=n.currentDimensions,s&&r||(o&&o[0]&&o[1]?(s=s||o[0],r=r||o[1]):a&&a[0]&&a[1]&&(s=s||a[0],r=r||a[1])),s&&r)){l=t.copyX||0,c=t.copyY||0,h=t.copyWidth||1,u=t.copyHeight||1,l.substring&&(l=parseFloat(l)/100*s),c.substring&&(c=parseFloat(c)/100*r),h.substring&&(h=parseFloat(h)/100*s),u.substring&&(u=parseFloat(u)/100*r),l=ct(et(l)),c=ct(et(c)),h=ct(et(h)),u=ct(et(u)),l>=s&&(l=s-1,h=1),h>s&&(h=s,l=0),l+h>s&&(l=s-h),c>=r&&(c=r-1,u=1),u>r&&(u=r,c=0),c+u>r&&(c=r-u);const o=el(),a=o.engine,p=o.element,g=e/h,m=i/u;if(d=h,f=u,g<1||m<1)if(g<1&&m<1){const t=pt(g,m);d=h*t,f=u*t}else g<1?(d=h*g,f=i):(d=e,f=u*m);p.width=d,p.height=f,a.setTransform(1,0,0,1,0,0),a.globalCompositeOperation=En,a.globalAlpha=1;const y=n.source||n.element;a.drawImage(y,l,c,h,u,0,0,d,f),za(t.identifier,a.getImageData(0,0,d,f)),il(o)}}}n.dirtyFilterIdentifier&&(this.dirtyFilterIdentifier=!0)}const n=this.state;if(n)if(n.dirtyFilterIdentifier)this.dirtyFilterIdentifier=!0;else{const{fillStyle:t,strokeStyle:e}=n;(L[t]&&L[t].dirtyFilterIdentifier||L[e]&&L[e].dirtyFilterIdentifier)&&(this.dirtyFilterIdentifier=!0)}(this.dirtyFilterIdentifier||this.state&&this.state.dirtyFilterIdentifier)&&this.updateFilterIdentifier(!0)}}J.ImageAsset=ImageAsset;const $c=["Cell","Stack"],Group=function(t=tr){return this.makeName(t.name),this.register(),this.artefacts=[],this.artefactCalculateBuckets=[],this.artefactStampBuckets=[],this.set(this.defs),this.onEntityHover=qs,this.onEntityNoHover=qs,this.isHovering=null,this.currentHost=null,this.dirtyFilters=!0,this.dirtyFiltersCache=!0,this.filters=[],this.currentFilters=[],this.batchResort=!0,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.dirtyImageSubscribers=!0,this.set(t),this},Mc=Group.prototype=Ar();Mc.type=Qn,Mc.lib="group",Mc.isArtefact=!1,Mc.isAsset=!1,Ro(Mc),Bc(Mc);Mc.defs=ur(Mc.defs,{artefacts:null,order:0,visibility:!0,checkForEntityHover:!1,onEntityHover:null,onEntityNoHover:null}),Mc.packetExclusions=fr(Mc.packetExclusions,["artefactCalculateBuckets","artefactStampBuckets","batchResort"]),Mc.packetFunctions=fr(Mc.packetFunctions,["onEntityHover","onEntityNoHover"]),Mc.postCloneAction=function(t,e){let i;return e.host?e.host.substring?i=o[e.host]:e.host.type&&$c.includes(e.host.type)&&(i=e.host):this.currentHost?i=this.currentHost:this.host&&(this.host.substring?i=o[this.host]:this.host.type&&$c.includes(this.host.type)&&(i=this.host)),i&&(i.addGroups(t.name),t.host||(t.host=i.name)),t},Mc.kill=function(t=!1,e=!1){t&&this.artefactCalculateBuckets.forEach((t=>t.kill(e)));const i=this.name;return wt(o).forEach((t=>{ut(t.groups)&&t.groups.includes(i)&&(pr(t.groups,i),t.batchResort=!0)})),wt(d).forEach((t=>{ut(t.groups)&&t.groups.includes(i)&&(pr(t.groups,i),t.batchResort=!0)})),this.deregister()},Mc.killArtefacts=function(t=!1){return this.artefactCalculateBuckets.forEach((e=>e.kill(t))),this};const Xc=Mc.getters,Yc=Mc.setters;Xc.artefacts=function(){return[].concat(this.artefacts)},Yc.artefacts=function(t){this.artefacts||(this.artefacts=[]),this.artefacts.length=0,this.addArtefacts(t)},Yc.host=function(t){const e=this.getHost(t);e&&e.addGroups&&(this.host=t,e.addGroups(this.name),this.dirtyHost=!0)},Yc.order=function(t){const e=this.getHost(this.host);this.order=t,e&&e.set({batchResort:!0})},Yc.noFilters=function(t){this.noFilters=t,this.dirtyFilterIdentifier=!0},Mc.getArtefactNames=function(){return[...this.artefacts]},Mc.getHost=function(t){if(t){if(t.type&&$c.includes(t.type))return t;if(t.substring)return o[t]||d[t]}const e=this.currentHost;return e&&e.substring?o[e]||d[e]:e},Mc.forceStamp=function(){const t=this.visibility;this.visibility=!0,this.stamp(),this.visibility=t},Mc.stamp=function(){if(this.dirtyHost||!this.currentHost){this.dirtyHost=!1;const t=this.getHost(this.host);t?this.currentHost=t:this.dirtyHost=!0}if(this.visibility){const{currentHost:t,stashOutput:e,noFilters:i,filters:n}=this;if(t){this.sortArtefacts();let s=null;e||!i&&n&&n.length?s=el(t.element.width,t.element.height):t.engine&&t.engine.save(),this.prepareStamp(s),this.stampAction(s),s?il(s):t.engine&&(t.engine.restore(),t.setEngineFromState(t.engine))}}},Mc.sortArtefacts=function(){if(this.batchResort){this.batchResort=!1;const t=lo(),e=lo(),{artefacts:i,artefactCalculateBuckets:n,artefactStampBuckets:s}=this;let r,a,l,c,h,u;for(l=0,c=i.length;l<c;l++)h=i[l],r=o[h],r&&(a=ct(r.calculateOrder),t[a]||(t[a]=lo()),t[a].push(r),a=ct(r.stampOrder),e[a]||(e[a]=lo()),e[a].push(r));for(n.length=0,l=0,c=t.length;l<c;l++)u=t[l],u&&(n.push(...u),co(u));for(co(t),s.length=0,l=0,c=e.length;l<c;l++)u=e[l],u&&(s.push(...u),co(u));co(e)}},Mc.prepareStamp=function(t){let e=this.currentHost;t&&(e=t),this.artefactCalculateBuckets.forEach((i=>{i.lib===je&&(i.currentHost&&i.currentHost.name===e.name||(i.currentHost=e,t||(i.dirtyHost=!0))),i.noDeltaUpdates||i.updateByDelta(),i.prepareStamp()}))},Mc.stampAction=function(t){const{dirtyFilters:e,currentFilters:i,artefactStampBuckets:n,noFilters:s,filters:r,stashOutput:o,currentHost:a}=this;if(!e&&i||this.cleanFilters(),n.forEach((t=>{t&&t.stamp&&t.stamp()})),t)if(!s&&r&&r.length){const e=this.applyFilters(t);o&&this.stashAction(e)}else if(o){const e=t.element,i=t.engine,n=!(!a||!a.engine)&&a.engine;if(n){n.save(),n.globalCompositeOperation=En,n.globalAlpha=1,n.setTransform(1,0,0,1,0,0),n.drawImage(e,0,0),n.restore();const t=i.getImageData(0,0,e.width,e.height);this.stashAction(t)}}},Mc.applyFilters=function(t){const e=this.currentHost,i=Vo();if(!e||!t)return!1;const n=e.element,s=e.engine,r=t.element,o=t.engine;this.isStencil&&(o.save(),o.globalCompositeOperation=Rn,o.globalAlpha=1,o.setTransform(1,0,0,1,0,0),o.drawImage(n,0,0),o.restore(),this.dirtyFilterIdentifier=!0),o.setTransform(1,0,0,1,0,0);const a=o.getImageData(0,0,r.width,r.height);this.preprocessFilters(this.currentFilters,r.width,r.height);const l=Ac.action({identifier:this.filterIdentifier,image:a,filters:this.currentFilters});return l&&(o.globalCompositeOperation=En,o.globalAlpha=1,o.setTransform(i,0,0,i,0,0),o.putImageData(l,0,0)),s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,0,0),s.restore(),l},Mc.stashAction=function(t){if(!t)return!1;if(this.stashOutput){this.stashOutput=!1;const[e,i,n,s]=this.getCellCoverage(t),r=el(),o=r.engine,a=r.element;if(a.width=n,a.height=s,o.putImageData(t,-e,-i),this.stashedImageData=o.getImageData(0,0,n,s),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-groupimage`;if(this.stashOutputAsAsset=!1,this.stashedImage)this.stashedImage.src=a.toDataURL();else{const e=this.currentHost,i=e?e.getController():null;if(i){const e=this,n=document.createElement(ui);n.id=t,n.alt=`A cached image of the ${this.name} Group of entitys`,n.onload=function(){i.canvasHold.appendChild(n),e.stashedImage=n,Tc(`#${t}`)},n.src=a.toDataURL()}}}il(r)}},Mc.getCellCoverage=function(t){const{width:e,height:i,data:n}=t;let s,r,o,a,l=0,c=0,h=e,u=i,d=3;for(o=0,a=e*i;o<a;o++)n[d]&&(r=ct(o/e),s=o-r*e,h>s&&(h=s),l<s&&(l=s),u>r&&(u=r),c<r&&(c=r)),d+=4;return h<l&&u<c?[h,u,l-h,c-u]:[0,0,e,i]},Mc.addArtefacts=function(...t){return t&&ut(t[0])&&(t=t[0]),t.forEach((t=>{t&&(t.substring?fr(this.artefacts,t):t.name&&fr(this.artefacts,t.name))}),this),this.batchResort=!0,this},Mc.getArtefact=function(t){return this.artefacts.includes(t)&&o[t]||!1},Mc.removeArtefacts=function(...t){return t.forEach((t=>{t&&(t.substring?pr(this.artefacts,t):t.name&&pr(this.artefacts,t.name))}),this),this.batchResort=!0,this},Mc.moveArtefactsIntoGroup=function(...t){let e,i;return t.forEach((t=>{t&&(i=t.substring?o[t]:t,i&&i.isArtefact&&(e=i.group?i.group:!!i.host&&k[i.host]),e&&(e.removeArtefacts(t),e.batchResort=!0),fr(this.artefacts,t))}),this),this.batchResort=!0,this},Mc.clearArtefacts=function(){return this.artefacts.length=0,this.artefactCalculateBuckets.length=0,this.artefactStampBuckets.length=0,this.batchResort=!0,this},Mc.updateArtefacts=function(t){return this.cascadeAction(t,"setDelta"),this},Mc.setArtefacts=function(t){return this.cascadeAction(t,"set"),this},Mc.updateByDelta=function(){return this.cascadeAction(!1,Es),this},Mc.reverseByDelta=function(){return this.cascadeAction(!1,Cn),this},Mc.addArtefactClasses=function(t){return this.cascadeAction(t,"addClasses"),this},Mc.removeArtefactClasses=function(t){return this.cascadeAction(t,"removeClasses"),this},Mc.cascadeAction=function(t,e){let i;return this.artefacts.forEach((n=>{i=o[n],i&&i[e]&&i[e](t)})),this},Mc.setDeltaValues=function(t=tr){return this.artefactCalculateBuckets.forEach((e=>e.setDeltaValues(t))),this},Mc.addFiltersToEntitys=function(...t){let e;return this.artefacts.forEach((i=>{e=m[i],e&&e.addFilters&&e.addFilters(t)})),this},Mc.removeFiltersFromEntitys=function(...t){let e;return this.artefacts.forEach((i=>{e=m[i],e&&e.removeFilters&&e.removeFilters(t)})),this},Mc.clearFiltersFromEntitys=function(){let t;return this.artefacts.forEach((e=>{t=m[e],t&&t.clearFilters&&t.clearFilters()})),this},Mc.recalculateFonts=function(){let t;return this.artefacts.forEach((e=>{t=m[e],t&&t.recalculateFont&&t.recalculateFont()})),this},Mc.getArtefactAt=function(t){this.sortArtefacts();const e=this.artefactStampBuckets;let i,n;for(let s=e.length-1;s>=0;s--)if(i=e[s],i&&(n=i.checkHit(t),n))return n;return!1},Mc.getAllArtefactsAt=function(t){this.sortArtefacts();const e=this.artefactStampBuckets,i=lo(),n=[];let s,r,o;for(let a=e.length-1;a>=0;a--)s=e[a],s&&(r=s.checkHit(t),r&&r.artefact&&(o=r.artefact,i.includes(o.name)||(i.push(o.name),n.push(r))));if(co(i),this.checkForEntityHover){const t=!!n.length;this.isHovering!==t&&(this.isHovering=t,t?this.onEntityHover():this.onEntityNoHover())}return n};const Gc=function(t){return!!t&&new Group(t)};J.Group=Group;const Nc="handle",zc="lockTo",jc="startX",Vc="startY";function Wc(t=tr){t.defs=ur(t.defs,{group:null,visibility:!0,calculateOrder:0,stampOrder:0,start:null,handle:null,offset:null,dimensions:null,pivoted:null,mimicked:null,particle:null,lockTo:null,bringToFrontOnDrag:!0,ignoreDragForX:!1,ignoreDragForY:!1,scale:1,roll:0,noUserInteraction:!1,noPositionDependencies:!1,noCanvasEngineUpdates:!1,noFilters:!1,noPathUpdates:!1,purge:null}),t.packetExclusions=fr(t.packetExclusions,["pathObject","mimicked","pivoted"]),t.packetExclusionsByRegex=fr(t.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),t.packetCoordinates=fr(t.packetCoordinates,["start","handle","offset"]),t.packetObjects=fr(t.packetObjects,["group"]),t.processPacketOut=function(t,e,i){let n=!0;if(t===zc)e[0]===Ln&&e[1]===Ln&&(n=!!i.includes(zc));else this.lib===je?n=this.processEntityPacketOut(t,e,i):this.isArtefact&&(n=this.processDOMPacketOut(t,e,i));return n},t.handlePacketAnchor=function(t,e){if(this.anchor){const i=yt(this.anchor.saveAsPacket(e))[3];t.anchor=i}if(this.button){const i=yt(this.button.saveAsPacket(e))[3];t.button=i}return t},t.kill=function(t=!1,e=!1){const i=this.name;return wt(k).forEach((t=>{t.artefacts.includes(i)&&t.removeArtefacts(i)})),this.anchor&&this.demolishAnchor(),this.button&&this.demolishButton(),wt(o).forEach((t=>{t.name!==i&&(t.pivot&&t.pivot.name===i&&t.set({pivot:!1}),t.mimic&&t.mimic.name===i&&t.set({mimic:!1}),t.path&&t.path.name===i&&t.set({path:!1}),t.generateAlongPath&&t.generateAlongPath.name===i&&t.set({generateAlongPath:!1}),t.generateInArea&&t.generateInArea.name===i&&t.set({generateInArea:!1}),t.artefact&&t.artefact.name===i&&t.set({artefact:!1}),ut(t.pins)&&t.pins.forEach(((e,n)=>{cr(e)&&e.name===i&&t.removePinAt(n)})))})),wt(H).forEach((t=>{t.checkForTarget(i)&&t.removeFromTargets(this)})),this.factoryKill(t,e),this.deregister(),this},t.factoryKill=qs;const e=t.getters,i=t.setters,n=t.deltaSetters;e.positionX=function(){return this.currentStampPosition[0]},e.positionY=function(){return this.currentStampPosition[1]},e.position=function(){return[].concat(this.currentStampPosition)},e.startX=function(){return this.currentStart[0]},e.startY=function(){return this.currentStart[1]},e.start=function(){return[].concat(this.currentStart)},i.startX=function(t){null!=t&&(this.start[0]=t,this.dirtyStart=!0)},i.startY=function(t){null!=t&&(this.start[1]=t,this.dirtyStart=!0)},i.start=function(t,e){this.setCoordinateHelper(Ln,t,e),this.dirtyStart=!0},n.startX=function(t){const e=this.start;e[0]=Ws(e[0],t),this.dirtyStart=!0},n.startY=function(t){const e=this.start;e[1]=Ws(e[1],t),this.dirtyStart=!0},n.start=function(t,e){this.setDeltaCoordinateHelper(Ln,t,e),this.dirtyStart=!0},e.handleX=function(){return this.currentHandle[0]},e.handleY=function(){return this.currentHandle[1]},e.handle=function(){return[].concat(this.currentHandle)},i.handleX=function(t){null!=t&&(this.handle[0]=t,this.dirtyHandle=!0)},i.handleY=function(t){null!=t&&(this.handle[1]=t,this.dirtyHandle=!0)},i.handle=function(t,e){this.setCoordinateHelper(Nc,t,e),this.dirtyHandle=!0},n.handleX=function(t){const e=this.handle;e[0]=Ws(e[0],t),this.dirtyHandle=!0},n.handleY=function(t){const e=this.handle;e[1]=Ws(e[1],t),this.dirtyHandle=!0},n.handle=function(t,e){this.setDeltaCoordinateHelper(Nc,t,e),this.dirtyHandle=!0},e.offsetX=function(){return this.currentOffset[0]},e.offsetY=function(){return this.currentOffset[1]},e.offset=function(){return[].concat(this.currentOffset)},i.offsetX=function(t){null!=t&&(this.offset[0]=t,this.dirtyOffset=!0)},i.offsetY=function(t){null!=t&&(this.offset[1]=t,this.dirtyOffset=!0)},i.offset=function(t,e){this.setCoordinateHelper(Ni,t,e),this.dirtyOffset=!0},n.offsetX=function(t){const e=this.offset;e[0]=Ws(e[0],t),this.dirtyOffset=!0},n.offsetY=function(t){const e=this.offset;e[1]=Ws(e[1],t),this.dirtyOffset=!0},n.offset=function(t,e){this.setDeltaCoordinateHelper(Ni,t,e),this.dirtyOffset=!0},e.width=function(){return this.currentDimensions[0]},e.height=function(){return this.currentDimensions[1]},e.dimensions=function(){return[].concat(this.currentDimensions)},i.width=function(t){null!=t&&(this.dimensions[0]=t,this.dirtyDimensions=!0)},i.height=function(t){null!=t&&(this.dimensions[1]=t,this.dirtyDimensions=!0)},i.dimensions=function(t,e){this.setCoordinateHelper(Ee,t,e),this.dirtyDimensions=!0},n.width=function(t){const e=this.dimensions;e[0]=Ws(e[0],t),this.dirtyDimensions=!0},n.height=function(t){const e=this.dimensions;e[1]=Ws(e[1],t),this.dirtyDimensions=!0},n.dimensions=function(t,e){this.setDeltaCoordinateHelper(Ee,t,e),this.dirtyDimensions=!0},e.order=function(){return this.stampOrder},i.order=function(t){this.calculateOrder=t,this.stampOrder=t},i.particle=function(t){sr(t)&&!t?(this.particle=null,this.lockTo[0]===zi&&(this.lockTo[0]=Ln),this.lockTo[1]===zi&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0):(this.particle=t,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)},i.lockTo=function(t){ut(t)?(this.lockTo[0]=t[0],this.lockTo[1]=t[1]):(this.lockTo[0]=t,this.lockTo[1]=t),this.dirtyLock=!0,this.dirtyStampPositions=!0},i.lockXTo=function(t){this.lockTo[0]=t,this.dirtyLock=!0,this.dirtyStampPositions=!0},i.lockYTo=function(t){this.lockTo[1]=t,this.dirtyLock=!0,this.dirtyStampPositions=!0},e.roll=function(){return this.currentRotation},i.roll=function(t){this.roll=t,this.dirtyRotation=!0},n.roll=function(t){this.roll+=t,this.dirtyRotation=!0},e.scale=function(){return this.currentScale},i.scale=function(t){this.scale=t,this.dirtyScale=!0},n.scale=function(t){this.scale+=t,this.dirtyScale=!0},i.host=function(t){if(t){const e=o[t];e&&e.here?this.host=e.name:this.host=t}else this.host=Ys;this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyStart=!0,this.dirtyOffset=!0},i.group=function(t){if(t)if(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring){const e=k[t];this.group=e||t}else if(t.type===Un){const e=k[t.name];this.group=e||t}else this.group=t;this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},i.noFilters=function(t){this.noFilters=t,this.dirtyFilterIdentifier=!0},t.purgeArtefact=function(t){return t.substring&&(t="all"===t?[_i,Pi,ji,Ue]:[t]),ut(t)&&t.forEach((t=>function(t,e){switch(e){case _i:delete t.pivot,delete t.pivotCorner,delete t.pivotPin,delete t.pivotIndex,delete t.addPivotHandle,delete t.addPivotOffset,delete t.addPivotRotation;break;case Pi:delete t.mimic,delete t.useMimicDimensions,delete t.useMimicScale,delete t.useMimicStart,delete t.useMimicHandle,delete t.useMimicOffset,delete t.useMimicRotation,delete t.useMimicFlip,delete t.addOwnDimensionsToMimic,delete t.addOwnScaleToMimic,delete t.addOwnStartToMimic,delete t.addOwnHandleToMimic,delete t.addOwnOffsetToMimic,delete t.addOwnRotationToMimic;break;case ji:delete t.path,delete t.pathPosition,delete t.addPathHandle,delete t.addPathOffset,delete t.addPathRotation;break;case Ue:delete t.filter,delete t.filters,delete t.isStencil}}(this,t))),this},t.initializePositions=function(){this.dimensions=al(),this.start=al(),this.handle=al(),this.offset=al(),this.currentDimensions=al(),this.currentStart=al(),this.currentHandle=al(),this.currentOffset=al(),this.currentDragOffset=al(),this.currentDragCache=al(),this.currentStartCache=al(),this.currentStampPosition=al(),this.currentStampHandlePosition=al(),this.delta={},this.deltaConstraints={},this.lockTo=[Ln,Ln],this.pivot=null,this.pivoted=[],this.mimic=null,this.mimicked=[],this.relativeCoordinates=[],this.dirtyDimensions=!0,this.dirtyLock=!0,this.dirtyStart=!0,this.dirtyOffset=!0,this.dirtyHandle=!0,this.pathObject=null,this.dirtyPathObject=!0,this.currentHost=null,this.dirtyHost=!0,this.currentScale=1,this.dirtyScale=!0,this.currentRotation=0,this.dirtyRotation=!0,this.dirtyPositionSubscribers=!0,this.dirtyMimicScale=!1,this.dirtyMimicDimensions=!1,this.dirtyMimicOffset=!1,this.dirtyMimicHandle=!1,this.dirtyMimicRotation=!1,this.isBeingDragged=!1,this.initializeDomPositions()},t.initializeDomPositions=qs,t.setCoordinateHelper=function(t,e,i){const n=this[t];ut(e)?(n[0]=e[0],n[1]=e[1]):cr(e)?br(e.x,e.y)?(n[0]=yr(e.x,n[0]),n[1]=yr(e.y,n[1])):(n[0]=yr(e.width,e.w,n[0]),n[1]=yr(e.height,e.h,n[1])):(n[0]=e,n[1]=i)},t.setDeltaCoordinateHelper=function(t,e,i){const n=this[t],s=n[0],r=n[1];ut(e)?(n[0]=Ws(s,e[0]),n[1]=Ws(r,e[1])):cr(e)?br(e.x,e.y)?(n[0]=Ws(s,yr(e.x,0)),n[1]=Ws(r,yr(e.y,0))):(n[0]=Ws(s,yr(e.width,e.w,0)),n[1]=Ws(r,yr(e.height,e.h,0))):(n[0]=Ws(s,e),n[1]=Ws(r,i))},t.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=o[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return Bo},t.getHere=function(){const t=this.getHost();if(t){if(t.here&&ft(t.here))return t.here;if(t.currentDimensions){const e=t.currentDimensions;if(e)return{w:e[0],h:e[1]}}}return Bo},t.cleanPosition=function(t,e,i){for(let n=0;n<2;n++){const s=e[n],r=i[n];s.toFixed?t[n]=s:s===gi||s===Cs?t[n]=0:s===vn||s===ae?t[n]=r:s===ce?t[n]=r/2:dt(parseFloat(s))?t[n]=parseFloat(s)/100*r:t[n]=0}this.dirtyFilterIdentifier=!0},t.cleanScale=function(){this.dirtyScale=!1;const t=this.scale,e=this.mimic,i=this.currentScale;let n=0;e&&this.useMimicScale?e.currentScale?(n=e.currentScale,this.addOwnScaleToMimic&&(n+=t)):(n=t,this.dirtyMimicScale=!0):n=t,this.currentScale=n,this.dirtyDimensions=!0,this.dirtyHandle=!0,i!==this.currentScale&&(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicScale=!0),this.dirtyFilterIdentifier=!0},t.cleanDimensions=function(){this.dirtyDimensions=!1;const t=this.getHost(),e=this.currentDimensions;if(t){let i,n,s;i=t.currentDimensions?t.currentDimensions:[t.w,t.h],[n,s]=this.dimensions;const[r,o]=e;n.substring&&(n=parseFloat(n)/100*i[0]),s.substring&&(s=s===Zt?0:parseFloat(s)/100*i[1]);const a=this.mimic;i=a&&a.name&&this.useMimicDimensions?a.currentDimensions:null,i?(e[0]=this.addOwnDimensionsToMimic?i[0]+n:i[0],e[1]=this.addOwnDimensionsToMimic?i[1]+s:i[1]):(e[0]=n,e[1]=s),this.cleanDimensionsAdditionalActions(),this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,r===e[0]&&o===e[1]||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0),this.dirtyFilterIdentifier=!0}else this.dirtyDimensions=!0},t.cleanDimensionsAdditionalActions=qs,t.cleanLock=function(){this.dirtyLock=!1,this.dirtyStart=!0,this.dirtyHandle=!0},t.cleanStart=function(){const t=this.getHost();let e=0,i=0;t&&(this.dirtyStart=!1,mr(t.w,t.h)?(e=t.w,i=t.h):t.currentDimensions?[e,i]=t.currentDimensions:this.dirtyStart=!0),this.dirtyStart||(this.cleanPosition(this.currentStart,this.start,[e,i]),this.dirtyStampPositions=!0)},t.cleanOffset=function(){const t=this.getHost();let e=0,i=0;t&&(this.dirtyOffset=!1,mr(t.w,t.h)?(e=t.w,i=t.h):t.currentDimensions?[e,i]=t.currentDimensions:this.dirtyOffset=!0),this.dirtyOffset||(this.cleanPosition(this.currentOffset,this.offset,[e,i]),this.dirtyStampPositions=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicOffset=!0))},t.cleanHandle=function(){this.dirtyHandle=!1,this.cleanPosition(this.currentHandle,this.handle,this.currentDimensions),this.dirtyStampHandlePositions=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicHandle=!0)},t.cleanRotation=function(){this.dirtyRotation=!1;const t=this.roll,e=this.currentRotation,i=this.path,n=this.mimic,s=this.pivot,r=this.lockTo;let o=0;if(i&&r.includes(ji)){if(o=t,this.addPathRotation){const t=this.getPathData();t&&(o+=t.angle)}}else n&&this.useMimicRotation&&r.includes(Pi)?gr(n.currentRotation)?(o=n.currentRotation,this.addOwnRotationToMimic&&(o+=t)):this.dirtyMimicRotation=!0:(o=t,s&&this.addPivotRotation&&r.includes(_i)&&(s.type===_n?o+=s.getUnitAlignment(this.pivotIndex):gr(s.currentRotation)?o+=s.currentRotation:this.dirtyPivotRotation=!0));this.currentRotation=o,o!==e&&(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicRotation=!0),this.dirtyFilterIdentifier=!0},t.cleanStampPositions=function(){this.dirtyStampPositions=!1;const{currentDragOffset:t,currentOffset:e,currentStampPosition:i,currentStart:n,currentStartCache:s}=this,[r,o]=i;if(this.noPositionDependencies)i[0]=n[0],i[1]=n[1];else{const{addOwnOffsetToMimic:r,addOwnStartToMimic:o,addPathOffset:a,addPivotOffset:l,ignoreDragForX:c,ignoreDragForY:h,isBeingDragged:u,lockTo:d,pivotCorner:f,pivotPin:p,pivotIndex:g,useMimicOffset:m,useMimicStart:y}=this;let b,{mimic:S,path:A,pivot:C}=this,k=this.particle;C&&C.substring&&(this.set({pivot:C}),C=this.pivot),S&&S.substring&&(this.set({mimic:S}),S=this.mimic),A&&A.substring&&(this.set({path:A}),A=this.path);const v=function(t){return(t!==_i||C)&&(t!==ji||A)&&(t!==Pi||S)&&(t!==zi||P)?t:Ln},O={[Ln]:function(t){t.setFromArray(n).add(e)},[ji]:function(t){F?(t.setFromVector(F),a||t.subtract(A.currentOffset)):t.setFromArray(n).add(e)},[_i]:function(t){f&&C.getCornerCoordinate?t.setFromArray(C.getCornerCoordinate(f)):C.type===rs?t.setFromArray(C.getPinAt(p)):C.type===_n?g<0?t.setFromArray(C.layoutTemplate.currentStampPosition):(b=C.getUnitStartAt(g),null!=b?t.setFromArray(b):t.setFromArray(n).add(e)):t.setFromArray(C.currentStampPosition),l||t.subtract(C.currentOffset),t.add(e)},[Pi]:function(t){y||m?(t.setFromArray(S.currentStampPosition),y&&o&&t.add(n),m&&r&&t.add(e),y||t.subtract(S.currentStart).add(n),m||t.subtract(S.currentOffset).add(e)):t.setFromArray(n).add(e)},[zi]:function(t){k.substring&&(k=P[k]),k?t.setFromVector(k.position):t.setFromArray(n).add(e)},[Fi]:function(i){i.setFromVector(w),u&&(s.setFromArray(i),i.add(t)),i.add(e)}},x=rl();let D,w,F,R=!1;if(u)x[0]=c?v(d[0]):Fi,x[1]=h?v(d[1]):Fi,R=!0,this.getCornerCoordinate&&this.cleanPathObject();else for(let t=0;t<2;t++)D=v(d[t]),D===Fi&&(R=!0),Ln!==D&&(this.dirtyFilterIdentifier=!0),x[t]=D;R&&(w=this.getHere()),x.includes(ji)&&(F=this.getPathData());const[T,E]=x,H=rl(),I=rl();O[T](H),T===E?I.setFromArray(H):O[E](I),i[0]=H[0],i[1]=I[1],ol(x,H,I)}r===i[0]&&o===i[1]||(this.dirtyPositionSubscribers=!0)},t.cleanStampHandlePositions=function(){this.dirtyStampHandlePositions=!1;const t=this.currentStampHandlePosition,e=this.currentHandle,[i,n]=t;if(this.noPositionDependencies)t[0]=e[0],t[1]=e[1];else{const i=this.lockTo,n=this.pivot,s=this.path,r=this.mimic;let o,a;for(let l=0;l<2;l++){switch(o=i[l],o!==_i||n||(o=Ln),o!==ji||s||(o=Ln),o!==Pi||r||(o=Ln),a=e[l],Ln!==o&&(this.dirtyFilterIdentifier=!0),o){case _i:this.addPivotHandle&&(a+=n.currentHandle[l]);break;case ji:this.addPathHandle&&(a+=s.currentHandle[l]);break;case Pi:this.useMimicHandle&&(a=r.currentHandle[l],this.addOwnHandleToMimic&&(a+=e[l]))}t[l]=a}}this.cleanStampHandlePositionsAdditionalActions(),i===t[0]&&n===t[1]||(this.dirtyPositionSubscribers=!0)},t.cleanStampHandlePositionsAdditionalActions=qs,t.checkHit=function(t=[]){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const e=ut(t)?t:[t];let i=0,n=0;const s=el(),r=s.engine,o=this.currentStampPosition,a=this.pathObject,l=this.winding;return e.some((t=>{if(ut(t))i=t[0],n=t[1];else{if(!mr(t,t.x,t.y))return!1;i=t.x,n=t.y}return!(!dt(i)||!dt(n))&&(s.rotateDestination(r,...o,this),r.isPointInPath(a,i,n,l))}),this)?(il(s),this.checkHitReturn(i,n)):(il(s),!1)},t.checkHitReturn=function(t,e){return{x:t,y:e,artefact:this}},t.pickupArtefact=function(t=tr){const{x:e,y:i}=t;if(mr(e,i)){const{bringToFrontOnDrag:t,currentDragOffset:n,currentStart:s,group:r,lockTo:o,mimic:a,pivot:l}=this;this.isBeingDragged=!0,this.currentDragCache.set(this.currentDragOffset),this.relativeCoordinates=[...this.start],o[0]===Ln?n[0]=s[0]-e:o[0]===_i&&l?n[0]=l.get(jc)-e:o[0]===Pi&&a&&(n[0]=a.get(jc)-e),o[1]===Ln?n[1]=s[1]-i:o[1]===_i&&l?n[1]=l.get(Vc)-i:o[1]===Pi&&a&&(n[1]=a.get(Vc)-i),t&&(this.stampOrder+=9999,gr(this.dirtyStampOrder)&&(this.dirtyStampOrder=!0),r.batchResort=!0),gr(this.dirtyPathObject)&&(this.dirtyPathObject=!0)}return this},t.dropArtefact=function(){const{bringToFrontOnDrag:t,currentDragCache:e,currentDragOffset:i,currentHost:n,currentStartCache:s,group:r,ignoreDragForX:o,ignoreDragForY:a,relativeCoordinates:l,start:c}=this;let h,u,d,f,p,g;return o||(c[0]=s[0]+i[0]),a||(c[1]=s[1]+i[1]),this.dirtyStart=!0,n&&([d,f]=n.get(Ee),[h,u]=c,[p,g]=l,!o&&p.substring&&(c[0]=h/d*100+"%"),!a&&g.substring&&(c[1]=u/f*100+"%")),this.relativeCoordinates.length=0,i.set(e),t&&(this.stampOrder-=9999,this.stampOrder<0&&(this.stampOrder=0),gr(this.dirtyStampOrder)&&(this.dirtyStampOrder=!0),r.batchResort=!0),gr(this.dirtyPathObject)&&(this.dirtyPathObject=!0),this.isBeingDragged=!1,this},t.updatePositionSubscribers=function(){this.dirtyPositionSubscribers=!1,this.pivoted&&this.pivoted.length&&this.updatePivotSubscribers(),this.mimicked&&this.mimicked.length&&this.updateMimicSubscribers(),this.pathed&&this.pathed.length&&this.updatePathSubscribers()},t.updatePivotSubscribers=qs,t.updateMimicSubscribers=qs,t.updatePathSubscribers=qs,t.updateImageSubscribers=qs}const Uc=["startX","startY","handleX","handleY","offsetX","offsetY","width","height"],Zc="loop",Kc="reverse",_c=["startY","handleY","offsetY","height"];function qc(t=tr){t.defs=ur(t.defs,{delta:null,noDeltaUpdates:!1,deltaConstraints:null,checkDeltaConstraints:!1,performDeltaChecks:!1});const e=t.setters;e.delta=function(t=tr){t&&(this.delta=dr(this.delta,t))},e.deltaConstraints=function(t=tr){t&&(this.deltaConstraints=dr(this.deltaConstraints,t))},t.updateByDelta=function(){return this.setDelta(this.delta),this.checkDeltaConstraints&&this.performDeltaConstraintsChecks(),this},t.reverseByDelta=function(){const t={},e=this.delta,i=ft(e),n=i.length;let s,r,o;for(s=0;s<n;s++)r=i[s],o=e[r],o=o.substring?-parseFloat(o)+Vi:-o,t[r]=o;return this.setDelta(t),this.checkDeltaConstraints&&this.performDeltaConstraintsChecks(),this},t.performDeltaConstraintsChecks=function(){const{delta:t,deltaConstraints:e}=this;if(this.performDeltaChecks){const i=ft(e),n=i.length;let s,r,o,a,l,c,h,u,d,f,p,g,m,y,b;for(g=0;g<n;g++)if(s=i[g],o=e[s],ut(o)&&3===o.length)if([a,l,c]=e[s],a.substring){if(r=Uc.indexOf(s),d=!1,f=0,r>=0?(r<2?d=this.start:r<4?d=this.handle:r<6?d=this.offset:r<8&&(d=this.dimensions),_c.includes(s)&&(f=1),p=d[f]):p=this.get(s),m=parseFloat(a),y=parseFloat(l),b=parseFloat(p),h=Ys,b<m?(h=c,u=0):b>y&&(h=c,u=1),h)switch(h){case Kc:t[s]=-parseFloat(t[s])+Vi,this.set({[s]:b+parseFloat(t[s])+Vi});break;case Zc:u?this.set({[s]:b-(y-m)+Vi}):this.set({[s]:b+(y-m)+Vi})}}else if(p=this.get(s),h=Ys,p<a?(h=c,u=0):p>l&&(h=c,u=1),h)switch(h){case Kc:t[s]=-t[s],this.set({[s]:p+t[s]});break;case Zc:u?this.set({[s]:p-(l-a)}):this.set({[s]:p+(l-a)})}}else this.performDeltaChecks=!0},t.setDeltaValues=function(t=tr){const e=this.delta,i=ft(t),n=i.length;let s,r,o,a,l,c;for(s=0;s<n;s++)switch(r=i[s],o=t[r],c=e[r],o.includes(":")?[a,l]=o.split(":"):(a=o,l=!1),a){case"newString":null!=l&&(e[r]=l);break;case"newNumber":null!=l&&(e[r]=parseFloat(l));break;case"remove":delete e[r];break;case"update":null!=l&&(e[r]=c.substring?l:parseFloat(l));break;case Kc:l=c.substring?-parseFloat(c)+Vi:-c,e[r]=l;break;case"add":c.substring?l=parseFloat(c)+parseFloat(l)+Vi:l+=c,e[r]=l;break;case Bi:c.substring?l=parseFloat(c)*parseFloat(l)+Vi:l*=c,e[r]=l}return this}}function Qc(t=tr){const e={pivot:Ys,pivotCorner:Ys,pivotPin:0,pivotIndex:-1,addPivotHandle:!1,addPivotOffset:!0,addPivotRotation:!1};t.defs=ur(t.defs,e),t.packetObjects=fr(t.packetObjects,["pivot"]);const i=t.setters;i.pivot=function(t){if(sr(t)&&!t)this.pivot=null,this.lockTo[0]===_i&&(this.lockTo[0]=Ln),this.lockTo[1]===_i&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.pivot,i=this.name;let n=t.substring?o[t]:t;n||(n=l[t],n&&n.type!==Un&&(n=!1)),n&&n.name?(e&&e.name!==n.name&&pr(e.pivoted,i),fr(n.pivoted,i),this.pivot=n,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0):null==n&&(this.pivot=t)}},i.pivotCorner=function(t){ke.includes(t)&&(this.pivotCorner=t),this.dirtyStart=!0},i.pivotIndex=function(t){this.pivotIndex=t,this.dirtyStart=!0},i.addPivotHandle=function(t){this.addPivotHandle=t,this.dirtyHandle=!0},i.addPivotOffset=function(t){this.addPivotOffset=t,this.dirtyOffset=!0},i.addPivotRotation=function(t){this.addPivotRotation=t,this.dirtyRotation=!0},t.updatePivotSubscribers=function(){let t;this.pivoted.forEach((e=>{t=o[e],t||(t=l[e],t&&t.type===Un||(t=!1)),t&&(t.dirtyStart=!0,t.addPivotHandle&&(t.dirtyHandle=!0),t.addPivotOffset&&(t.dirtyOffset=!0),t.addPivotRotation&&(t.dirtyRotation=!0),t.type===rs?t.dirtyPins=!0:t.type!==es&&t.type!==os&&t.type!==Vn||t.dirtyPins.push(this.name))}),this)}}function Jc(t=tr){const e={mimic:Ys,useMimicDimensions:!1,useMimicScale:!1,useMimicStart:!1,useMimicHandle:!1,useMimicOffset:!1,useMimicRotation:!1,useMimicFlip:!1,addOwnDimensionsToMimic:!1,addOwnScaleToMimic:!1,addOwnStartToMimic:!1,addOwnHandleToMimic:!1,addOwnOffsetToMimic:!1,addOwnRotationToMimic:!1};t.defs=ur(t.defs,e),t.packetObjects=fr(t.packetObjects,["mimic"]);const i=t.setters;i.mimic=function(t){if(sr(t)&&!t)this.mimic=null,this.lockTo[0]===Pi&&(this.lockTo[0]=Ln),this.lockTo[1]===Pi&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.mimic,i=this.name;let n=t.substring?o[t]:t;n||(n=l[t],n&&n.type!==Un&&(n=!1)),n&&n.name?(e&&e.name!==n.name&&pr(e.mimicked,i),fr(n.mimicked,i),this.mimic=n,this.useMimicDimensions&&(this.dirtyDimensions=!0),this.useMimicScale&&(this.dirtyScale=!0),this.useMimicStart&&(this.dirtyStart=!0),this.useMimicHandle&&(this.dirtyHandle=!0),this.useMimicOffset&&(this.dirtyOffset=!0),this.useMimicRotation&&(this.dirtyRotation=!0)):null==n&&(this.mimic=t)}},i.useMimicDimensions=function(t){this.useMimicDimensions=t,this.dirtyDimensions=!0},i.useMimicScale=function(t){this.useMimicScale=t,this.dirtyScale=!0},i.useMimicStart=function(t){this.useMimicStart=t,this.dirtyStart=!0},i.useMimicHandle=function(t){this.useMimicHandle=t,this.dirtyHandle=!0},i.useMimicOffset=function(t){this.useMimicOffset=t,this.dirtyOffset=!0},i.useMimicRotation=function(t){this.useMimicRotation=t,this.dirtyRotation=!0},i.addOwnDimensionsToMimic=function(t){this.addOwnDimensionsToMimic=t,this.dirtyDimensions=!0},i.addOwnScaleToMimic=function(t){this.addOwnScaleToMimic=t,this.dirtyScale=!0},i.addOwnStartToMimic=function(t){this.addOwnStartToMimic=t,this.dirtyStart=!0},i.addOwnHandleToMimic=function(t){this.addOwnHandleToMimic=t,this.dirtyHandle=!0},i.addOwnOffsetToMimic=function(t){this.addOwnOffsetToMimic=t,this.dirtyOffset=!0},i.addOwnRotationToMimic=function(t){this.addOwnRotationToMimic=t,this.dirtyRotation=!0},t.updateMimicSubscribers=function(){const t=this.dirtyMimicHandle,e=this.dirtyMimicOffset,i=this.dirtyMimicRotation,n=this.dirtyMimicScale,s=this.dirtyMimicDimensions;let r;this.mimicked.forEach((a=>{r=o[a],r||(r=l[a],r&&r.type===Un||(r=!1)),r&&(r.useMimicStart&&(r.dirtyStart=!0),t&&r.useMimicHandle&&(r.dirtyHandle=!0),e&&r.useMimicOffset&&(r.dirtyOffset=!0),i&&r.useMimicRotation&&(r.dirtyRotation=!0),n&&r.useMimicScale&&(r.dirtyScale=!0),s&&r.useMimicDimensions&&(r.dirtyDimensions=!0))})),this.dirtyMimicHandle=!1,this.dirtyMimicOffset=!1,this.dirtyMimicRotation=!1,this.dirtyMimicScale=!1,this.dirtyMimicDimensions=!1}}function th(t=tr){const e={path:Ys,pathPosition:0,addPathHandle:!1,addPathOffset:!0,addPathRotation:!1,constantSpeedAlongPath:!1};t.defs=ur(t.defs,e),t.packetObjects=fr(t.packetObjects,["path"]);const i=t.setters,n=t.deltaSetters;i.path=function(t){if(sr(t)&&!t)this.path=null,this.lockTo[0]===ji&&(this.lockTo[0]=Ln),this.lockTo[1]===ji&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.path,i=t.substring?o[t]:t,n=this.name;i&&i.name&&i.useAsPath?(e&&e.name!==i.name&&pr(e.pathed,n),fr(i.pathed,n),this.path=i,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0):null==i&&(this.path=t)}},i.pathPosition=function(t){t<0&&(t=et(t)),t>1&&(t%=1),this.pathPosition=t,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0,this.currentPathData=!1},n.pathPosition=function(t){let e=this.pathPosition+t;e<0&&(e+=1),e>1&&(e%=1),this.pathPosition=e,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0,this.currentPathData=!1},i.addPathHandle=function(t){this.addPathHandle=t,this.dirtyHandle=!0},i.addPathOffset=function(t){this.addPathOffset=t,this.dirtyOffset=!0},i.addPathRotation=function(t){this.addPathRotation=t,this.dirtyRotation=!0},t.getPathData=function(){if(this.currentPathData)return this.currentPathData;const t=this.path;if(t){const e=t.getPathPositionData(this.pathPosition,this.constantSpeedAlongPath);return this.addPathRotation&&(this.dirtyRotation=!0),this.currentPathData=e,e}return!1}}const eh=["anchor","anchorHref","anchorName","anchorDescription","anchorType","anchorTarget","anchorTabOrder","anchorDisabled","anchorRel","anchorReferrerPolicy","anchorPing","anchorHreflang","anchorDownload","anchorFocusAction","anchorBlurAction","anchorClickAction"],ih=["button","buttonName","buttonAutofocus","buttonDescription","buttonDisabled","buttonTabOrder","buttonForm","buttonFormAction","buttonFormEnctype","buttonFormMethod","buttonFormNoValidate","buttonFormTarget","buttonElementName","buttonPopoverTarget","buttonPopoverTargetAction","buttonElementType","buttonElementValue","buttonFocusAction","buttonBlurAction","buttonClickAction"];function nh(t=tr){t.getCanvasNavElement=function(){const t=this.currentHost;if(t){if(t.type===Wn)return t.navigation;if(t.type===Un){const e=t.currentHost?t.currentHost:h[t.host];if(e&&e.type===Wn)return e.navigation}}return null},t.getCanvasWrapper=function(){const t=this.currentHost;if(t){if(t.type===Wn)return t;if(t.type===Un){const e=t.currentHost?t.currentHost:h[t.host];if(e&&e.type===Wn)return e}}return null},t.prepareStampTabsHelper=function(){this.anchor&&this.rebuildAnchor(),this.button&&this.rebuildButton()},t.modifyConstructorInputForAnchorButton=function(t){const e=ft(t);let i=!1;for(let t=0,n=eh.length;t<n;t++)if(e.includes(eh[t])){i=!0;break}let n=!1;for(let t=0,i=ih.length;t<i;t++)if(e.includes(ih[t])){n=!0;break}if(i){const e=t.anchor||{};null!=t.anchorHref&&(e.href=t.anchorHref,delete t.anchorHref),null!=t.anchorName&&(e.name=t.anchorName,delete t.anchorName),null!=t.anchorDescription&&(e.description=t.anchorDescription,delete t.anchorDescription),null!=t.anchorType&&(e.anchorType=t.anchorType,delete t.anchorType),null!=t.anchorTarget&&(e.target=t.anchorTarget,delete t.anchorTarget),null!=t.anchorTabOrder&&(e.tabOrder=t.anchorTabOrder,delete t.anchorTabOrder),null!=t.anchorDisabled&&(e.disabled=t.anchorDisabled,delete t.anchorDisabled),null!=t.anchorRel&&(e.rel=t.anchorRel,delete t.anchorRel),null!=t.anchorReferrerPolicy&&(e.referrerPolicy=t.anchorReferrerPolicy,delete t.anchorReferrerPolicy),null!=t.anchorPing&&(e.ping=t.anchorPing,delete t.anchorPing),null!=t.anchorHreflang&&(e.hrefLang=t.anchorHreflang,delete t.anchorHreflang),null!=t.anchorDownload&&(e.download=t.anchorDownload,delete t.anchorDownload),null!=t.anchorFocusAction&&(e.focusAction=t.anchorFocusAction,delete t.anchorFocusAction),null!=t.anchorBlurAction&&(e.blurAction=t.anchorBlurAction,delete t.anchorBlurAction),null!=t.anchorClickAction&&(e.clickAction=t.anchorClickAction,delete t.anchorClickAction),t.anchor=e}if(n){const e=t.button||{};null!=t.buttonName&&(e.name=t.buttonName,delete t.buttonName),null!=t.buttonAutofocus&&(e.autofocus=t.buttonAutofocus,delete t.buttonAutofocus),null!=t.buttonDescription&&(e.description=t.buttonDescription,delete t.buttonDescription),null!=t.buttonDisabled&&(e.disabled=t.buttonDisabled,delete t.buttonDisabled),null!=t.buttonTabOrder&&(e.tabOrder=t.buttonTabOrder,delete t.buttonTabOrder),null!=t.buttonForm&&(e.form=t.buttonForm,delete t.buttonForm),null!=t.buttonFormAction&&(e.formAction=t.buttonFormAction,delete t.buttonFormAction),null!=t.buttonFormEnctype&&(e.formEncType=t.buttonFormEnctype,delete t.buttonFormEnctype),null!=t.buttonFormMethod&&(e.formMethod=t.buttonFormMethod,delete t.buttonFormMethod),null!=t.buttonFormNoValidate&&(e.formNoValidate=t.buttonFormNoValidate,delete t.buttonFormNoValidate),null!=t.buttonFormTarget&&(e.formTarget=t.buttonFormTarget,delete t.buttonFormTarget),null!=t.buttonElementName&&(e.elementName=t.buttonElementName,delete t.buttonElementName),null!=t.buttonPopoverTarget&&(e.popoverTarget=t.buttonPopoverTarget,delete t.buttonPopoverTarget),null!=t.buttonPopoverTargetAction&&(e.popoverTargetAction=t.buttonPopoverTargetAction,delete t.buttonPopoverTargetAction),null!=t.buttonElementType&&(e.elementType=t.buttonElementType,delete t.buttonElementType),null!=t.buttonElementValue&&(e.elementValue=t.buttonElementValue,delete t.buttonElementValue),null!=t.buttonFocusAction&&(e.focusAction=t.buttonFocusAction,delete t.buttonFocusAction),null!=t.buttonBlurAction&&(e.blurAction=t.buttonBlurAction,delete t.buttonBlurAction),null!=t.buttonClickAction&&(e.clickAction=t.buttonClickAction,delete t.buttonClickAction),t.button=e}}}const Anchor=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.host=t.host,this.controller=t.controller,this.hold=t.hold,this.clickAction=null,this.domElement=null,this.hasBeenRecentlyClicked=null,this.set(t),this.dirtyAnchor=!0,this},sh=Anchor.prototype=Ar();sh.type="Anchor",sh.lib=Xt,sh.isArtefact=!1,sh.isAsset=!1,Ro(sh);const rh={host:null,description:Ys,disabled:!1,tabOrder:0,download:Ys,href:Ys,hreflang:Ys,ping:Ys,referrerpolicy:Ys,rel:"noreferrer",target:"_blank",anchorType:Ys,clickAction:null,focusAction:!0,blurAction:!0};sh.defs=ur(sh.defs,rh),sh.packetExclusions=fr(sh.packetExclusions,["domElement"]),sh.packetObjects=fr(sh.packetObjects,["host"]),sh.packetFunctions=fr(sh.packetFunctions,["clickAction"]),sh.demolish=function(){const{host:t,controller:e,domElement:i,hold:n,clickAction:s,focusAction:r,blurAction:o}=this;i&&s&&i.removeEventListener(pe,s,!1),t&&i&&r&&i.removeEventListener(Ke,(()=>t.onEnter()),!1),t&&i&&o&&i.removeEventListener(se,(()=>t.onLeave()),!1),n&&i&&n.removeChild(i),e&&(e.dirtyNavigationTabOrder=!0),t&&(t.anchor=null),this.deregister()},sh.set=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==$i&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Fs&&(this[i]=n));this.dirtyAnchor=!0}return this},sh.build=function(){const{host:t}=this;if(t){this.controller||(this.controller=t.getCanvasWrapper()),this.hold||(this.hold=t.getCanvasNavElement());const{hold:e,controller:i}=this;if(e&&i){const{anchorType:n,blurAction:s,clickAction:r,description:o,disabled:a,download:l,focusAction:c,href:h,hreflang:u,name:d,ping:f,referrerpolicy:p,rel:g,tabOrder:m,target:y}=this;let b=this.domElement;b&&(r&&b.removeEventListener(pe,r,!1),c&&b.removeEventListener(Ke,(()=>t.onEnter()),!1),s&&b.removeEventListener(se,(()=>t.onLeave()),!1),e.removeChild(b),this.domElement=null),a||(b=document.createElement("a"),b.id=d,l&&b.setAttribute(Me,l),h&&b.setAttribute(li,h),u&&b.setAttribute(ci,u),f&&b.setAttribute(Ki,f),p&&b.setAttribute(yn,p),g&&b.setAttribute(bn,g),y&&b.setAttribute(ys,y),n&&b.setAttribute(ws,n),b.setAttribute(xe,m),r&&ar(r)&&b.addEventListener(pe,r,!1),o&&(b.textContent=o),c&&b.addEventListener(Ke,(()=>t.onEnter()),!1),s&&b.addEventListener(se,(()=>t.onLeave()),!1),this.domElement=b,e.appendChild(b)),i.dirtyNavigationTabOrder=!0}}},sh.rebuild=function(){this.dirtyAnchor&&(this.build(),this.dirtyAnchor=!1)},sh.click=function(){if(this.hasBeenRecentlyClicked)return!1;{const t=new MouseEvent(pe,{view:window,bubbles:!0,cancelable:!0});this.hasBeenRecentlyClicked=!0;const e=this;return setTimeout((()=>e.hasBeenRecentlyClicked=!1),200),this.domElement.dispatchEvent(t)}};J.Anchor=Anchor;const oh="anchorType";function ah(t=tr){t.defs=ur(t.defs,{anchor:null}),t.demolishAnchor=function(){this.anchor&&this.anchor.demolish()};const e=t.getters,i=t.setters;e.anchorName=function(){return this.anchorGetHelper($i)},e.anchorDescription=function(){return this.anchorGetHelper(Fe)},i.anchorDescription=function(t){this.anchorSetHelper(Fe,t)},e.anchorType=function(){return this.anchorGetHelper(oh)},i.anchorType=function(t){this.anchorSetHelper(oh,t)},e.anchorTarget=function(){return this.anchorGetHelper(ys)},i.anchorTarget=function(t){this.anchorSetHelper(ys,t)},e.anchorTabOrder=function(){return this.anchorGetHelper(ms)},i.anchorTabOrder=function(t){this.anchorSetHelper(ms,t)},e.anchorDisabled=function(){return this.anchorGetHelper(He)},i.anchorDisabled=function(t){this.anchorSetHelper(He,t)},e.anchorRel=function(){return this.anchorGetHelper(bn)},i.anchorRel=function(t){this.anchorSetHelper(bn,t)},e.anchorReferrerPolicy=function(){return this.anchorGetHelper(yn)},i.anchorReferrerPolicy=function(t){this.anchorSetHelper(yn,t)},e.anchorPing=function(){return this.anchorGetHelper(Ki)},i.anchorPing=function(t){this.anchorSetHelper(Ki,t)},e.anchorHreflang=function(){return this.anchorGetHelper(ci)},i.anchorHreflang=function(t){this.anchorSetHelper(ci,t)},e.anchorHref=function(){return this.anchorGetHelper(li)},i.anchorHref=function(t){this.anchorSetHelper(li,t)},e.anchorDownload=function(){return this.anchorGetHelper(Me)},i.anchorDownload=function(t){this.anchorSetHelper(Me,t)},i.anchorFocusAction=function(t){this.anchorSetHelper(_e,t)},i.anchorBlurAction=function(t){this.anchorSetHelper(re,t)},i.anchorClickAction=function(t){this.anchorSetHelper(ge,t)},i.anchor=function(t){this.anchor?this.anchor.set(t):this.buildAnchor(t)},t.anchorGetHelper=function(t){return this.anchor?this.anchor.get(t):null},t.anchorSetHelper=function(t,e){this.anchor||this.buildAnchor({[t]:e}),this.anchor&&this.anchor.set({[t]:e})},t.buildAnchor=function(t={}){this.anchor&&this.anchor.demolish(),t.anchorName||(t.anchorName=`${this.name}-anchor`),t.description||(t.description=`Anchor link for ${this.name} ${this.type}`),t.host=this,t.controller=this.getCanvasWrapper(),t.hold=this.getCanvasNavElement(),this.anchor=function(t){return!!t&&new Anchor(t)}(t)},t.rebuildAnchor=function(){this.anchor&&this.anchor.rebuild()},t.clickAnchor=function(){this.anchor&&this.anchor.click()}}const lh="button",Button=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.host=t.host,this.controller=t.controller,this.hold=t.hold,this.clickAction=null,this.domElement=null,this.hasBeenRecentlyClicked=!1,this.set(t),this.dirtyButton=!0,this},ch=Button.prototype=Ar();ch.type="Button",ch.lib=Xt,ch.isArtefact=!1,ch.isAsset=!1,Ro(ch);const hh={host:null,description:Ys,tabOrder:0,autofocus:!1,disabled:!1,form:Ys,formAction:Ys,formEnctype:Ys,formMethod:Ys,formNoValidate:!1,formTarget:Ys,popoverTarget:Ys,popoverTargetAction:Ys,elementType:lh,elementValue:Ys,clickAction:null,focusAction:!0,blurAction:!0};ch.defs=ur(ch.defs,hh),ch.packetExclusions=fr(ch.packetExclusions,["domElement"]),ch.packetObjects=fr(ch.packetObjects,["host"]),ch.packetFunctions=fr(ch.packetFunctions,["clickAction"]),ch.demolish=function(){const{host:t,controller:e,domElement:i,hold:n,clickAction:s,focusAction:r,blurAction:o}=this;i&&s&&i.removeEventListener(pe,s,!1),t&&i&&r&&i.removeEventListener(Ke,(()=>t.onEnter()),!1),t&&i&&o&&i.removeEventListener(se,(()=>t.onLeave()),!1),n&&i&&n.removeChild(i),e&&(e.dirtyNavigationTabOrder=!0),t&&(t.button=null),this.deregister()},ch.set=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==$i&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Fs&&(this[i]=n));this.dirtyButton=!0}return this},ch.build=function(){const{host:t}=this;if(t){this.controller||(this.controller=t.getCanvasWrapper()),this.hold||(this.hold=t.getCanvasNavElement());const{hold:e,controller:i}=this;if(e&&i){const{autofocus:n,blurAction:s,clickAction:r,description:o,disabled:a,elementType:l,elementValue:c,focusAction:h,form:u,formAction:d,formEnctype:f,formMethod:p,formNoValidate:g,formTarget:m,name:y,popoverTarget:b,popoverTargetAction:S,tabOrder:A}=this;let C=this.domElement;C&&e&&(r&&C.removeEventListener(pe,r,!1),h&&C.removeEventListener(Ke,(()=>t.onEnter()),!1),s&&C.removeEventListener(se,(()=>t.onLeave()),!1),e.removeChild(C),this.domElement=null),a||(C=document.createElement(lh),C.id=y,n&&C.setAttribute(Kt,Ys),a&&C.setAttribute(He,Ys),u&&C.setAttribute(Qe,u),d&&C.setAttribute("formaction",d),f&&C.setAttribute("formenctype",f),p&&C.setAttribute("formmethod",p),g&&C.setAttribute("formnovalidate",Ys),m&&C.setAttribute(ys,m),b&&C.setAttribute("popovertarget",b),S&&C.setAttribute("popovertargetaction",S),null!=c&&C.setAttribute(Is,c),l?C.setAttribute(ws,l):C.setAttribute(ws,lh),C.setAttribute(xe,A),r&&ar(r)&&C.addEventListener(pe,r,!1),o&&(C.textContent=o),h&&C.addEventListener(Ke,(()=>t.onEnter()),!1),s&&C.addEventListener(se,(()=>t.onLeave()),!1),this.domElement=C,e.appendChild(C)),i.dirtyNavigationTabOrder=!0}}},ch.rebuild=function(){this.dirtyButton&&(this.build(),this.dirtyButton=!1)},ch.click=function(){if(this.hasBeenRecentlyClicked)return!1;{const t=new MouseEvent(pe,{view:window,bubbles:!0,cancelable:!0});this.hasBeenRecentlyClicked=!0;const e=this;return setTimeout((()=>e.hasBeenRecentlyClicked=!1),200),this.domElement.dispatchEvent(t)}};J.Button=Button;const uh="elementType",dh="elementValue",fh="formAction",ph="formEnctype",gh="formMethod",mh="formNoValidate",yh="formTarget",bh="popoverTarget",Sh="popoverTargetAction";function Ah(t=tr){t.defs=ur(t.defs,{button:null}),t.demolishButton=function(){this.button&&this.button.demolish()};const e=t.getters,i=t.setters;e.buttonName=function(){return this.buttonGetHelper($i)},e.buttonAutofocus=function(){return this.buttonGetHelper(Kt)},i.buttonAutofocus=function(t){this.buttonSetHelper(Kt,t)},e.buttonDescription=function(){return this.buttonGetHelper(Fe)},i.buttonDescription=function(t){this.buttonSetHelper(Fe,t)},e.buttonDisabled=function(){return this.buttonGetHelper(He)},i.buttonDisabled=function(t){this.buttonSetHelper(He,t)},e.buttonTabOrder=function(){return this.buttonGetHelper(ms)},i.buttonTabOrder=function(t){this.buttonSetHelper(ms,t)},e.buttonForm=function(){return this.buttonGetHelper(Qe)},i.buttonForm=function(t){this.buttonSetHelper(Qe,t)},e.buttonFormAction=function(){return this.buttonGetHelper(fh)},i.buttonFormAction=function(t){this.buttonSetHelper(fh,t)},e.buttonFormEnctype=function(){return this.buttonGetHelper(ph)},i.buttonFormEnctype=function(t){this.buttonSetHelper(ph,t)},e.buttonFormMethod=function(){return this.buttonGetHelper(gh)},i.buttonFormMethod=function(t){this.buttonSetHelper(gh,t)},e.buttonFormNoValidate=function(){return this.buttonGetHelper(mh)},i.buttonFormNoValidate=function(t){this.buttonSetHelper(mh,t)},e.buttonFormTarget=function(){return this.buttonGetHelper(yh)},i.buttonFormTarget=function(t){this.buttonSetHelper(yh,t)},e.buttonPopoverTarget=function(){return this.buttonGetHelper(bh)},i.buttonPopoverTarget=function(t){this.buttonSetHelper(bh,t)},e.buttonPopoverTargetAction=function(){return this.buttonGetHelper(Sh)},i.buttonPopoverTargetAction=function(t){this.buttonSetHelper(Sh,t)},e.buttonElementType=function(){return this.buttonGetHelper(uh)},i.buttonElementType=function(t){this.buttonSetHelper(uh,t)},e.buttonElementValue=function(){return this.buttonGetHelper(dh)},i.buttonElementValue=function(t){this.buttonSetHelper(dh,t)},i.buttonFocusAction=function(t){this.buttonSetHelper(_e,t)},i.buttonBlurAction=function(t){this.buttonSetHelper(re,t)},i.buttonClickAction=function(t){this.buttonSetHelper(ge,t)},i.button=function(t){this.button?this.button.set(t):this.buildButton(t)},t.buttonGetHelper=function(t){return this.button?this.button.get(t):null},t.buttonSetHelper=function(t,e){this.button||this.buildButton({[t]:e}),this.button&&this.button.set({[t]:e})},t.buildButton=function(t={}){this.button&&this.button.demolish(),t.buttonName||(t.buttonName=`${this.name}-button`),t.description||(t.description=`Button for ${this.name} ${this.type}`),t.host=this,t.controller=this.getCanvasWrapper(),t.hold=this.getCanvasNavElement(),this.button=function(t){return!!t&&new Button(t)}(t)},t.rebuildButton=function(){this.button&&this.button.rebuild()},t.clickButton=function(){this.button&&this.button.click()}}function Ch(t=tr){t.defs=ur(t.defs,{groups:null,groupBuckets:null,batchResort:!0});const e=t.getters,i=t.setters;e.groups=function(){return[].concat(this.groups)},i.groups=function(t){this.groups.length=0,this.addGroups(t)},t.sortGroups=function(){if(this.batchResort){this.batchResort=!1;const{groups:t,groupBuckets:e}=this,i=lo();let n,s,r,o,a,l;for(n=0,s=t.length;n<s;n++)o=t[n],r=k[o],r&&(a=ct(r.order)||0,i[a]||(i[a]=lo()),i[a].push(r));for(e.length=0,n=0,s=i.length;n<s;n++)l=i[n],l&&(e.push(...l),co(l));co(i)}},t.initializeCascade=function(){this.groups=[],this.groupBuckets=[]},t.addGroups=function(...t){const e=this.groups;return t.forEach((t=>{t.substring?fr(e,t):k[t]&&fr(e,t.name)}),this),this.batchResort=!0,this},t.removeGroups=function(...t){const e=this.groups;return t.forEach((t=>{t.substring?pr(e,t):k[t]&&pr(e,t.name)}),this),this.batchResort=!0,this},t.cascadeAction=function(t,e){let i;return this.groups.forEach((n=>{i=k[n],i&&i[e](t)}),this),this},t.updateArtefacts=function(t){return this.cascadeAction(t,"updateArtefacts"),this},t.setArtefacts=function(t){return this.cascadeAction(t,"setArtefacts"),this},t.addArtefactClasses=function(t){return this.cascadeAction(t,"addArtefactClasses"),this},t.removeArtefactClasses=function(t){return this.cascadeAction(t,"removeArtefactClasses"),this},t.updateByDelta=function(){return this.cascadeAction(!1,Es),this},t.reverseByDelta=function(){return this.cascadeAction(!1,Cn),this},t.getArtefactAt=function(t){if(t=yr(t,this.here,!1)){let e,i;for(let n=this.groups.length-1;n>=0;n--)if(e=k[this.groups[n]],e&&(i=e.getArtefactAt(t),i))return i}return!1},t.getAllArtefactsAt=function(t){const e=[];if(t=yr(t,this.here,!1)){let i,n;for(let s=this.groups.length-1;s>=0;s--)i=k[this.groups[s]],i&&(n=i.getAllArtefactsAt(t),n&&e.push(...n))}return e}}const kh="a",vh="b",Ph="c",Oh="d",xh="e",Dh="f",wh=["a","b","c","d","e","f"],Fh=["repeat","repeat-x","repeat-y","no-repeat"];function Rh(t=tr){const e={repeat:"repeat",patternMatrix:null};t.defs=ur(t.defs,e);const i=t.setters,n=t.getters;i.repeat=function(t){Fh.includes(t)?this.repeat=t:this.repeat=this.defs.repeat},t.checkMatrixExists=function(){this.patternMatrix||(this.patternMatrix=new DOMMatrix)},t.updateMatrixNumber=function(t,e){this.checkMatrixExists(),t=t.substring?parseFloat(t):t;const i=wh.includes(e);lr(t)&&i&&(this.patternMatrix[e]=t)},i.matrixA=function(t){this.updateMatrixNumber(t,kh)},i.matrixB=function(t){this.updateMatrixNumber(t,vh)},i.matrixC=function(t){this.updateMatrixNumber(t,Ph)},i.matrixD=function(t){this.updateMatrixNumber(t,Oh)},i.matrixE=function(t){this.updateMatrixNumber(t,xh)},i.matrixF=function(t){this.updateMatrixNumber(t,Dh)},i.stretchX=function(t){this.updateMatrixNumber(t,kh)},i.skewY=function(t){this.updateMatrixNumber(t,vh)},i.skewX=function(t){this.updateMatrixNumber(t,Ph)},i.stretchY=function(t){this.updateMatrixNumber(t,Oh)},i.shiftX=function(t){this.updateMatrixNumber(t,xh)},i.shiftY=function(t){this.updateMatrixNumber(t,Dh)},t.retrieveMatrixNumber=function(t){return this.checkMatrixExists(),this.patternMatrix[t]},n.matrixA=function(){return this.retrieveMatrixNumber(kh)},n.matrixB=function(){return this.retrieveMatrixNumber(vh)},n.matrixC=function(){return this.retrieveMatrixNumber(Ph)},n.matrixD=function(){return this.retrieveMatrixNumber(Oh)},n.matrixE=function(){return this.retrieveMatrixNumber(xh)},n.matrixF=function(){return this.retrieveMatrixNumber(Dh)},n.stretchX=function(){return this.retrieveMatrixNumber(kh)},n.skewY=function(){return this.retrieveMatrixNumber(vh)},n.skewX=function(){return this.retrieveMatrixNumber(Ph)},n.stretchY=function(){return this.retrieveMatrixNumber(Oh)},n.shiftX=function(){return this.retrieveMatrixNumber(xh)},n.shiftY=function(){return this.retrieveMatrixNumber(Dh)},i.patternMatrix=function(t){if(ut(t)){const e=this.updateMatrixNumber;e(t[0],kh),e(t[1],vh),e(t[2],Ph),e(t[3],Oh),e(t[4],xh),e(t[5],Dh)}},t.buildStyle=function(t){if(t){t.substring&&(t=d[t]);let e=this.source,i=this.sourceLoaded;const n=this.repeat,s=t.engine;if(this.type!==Un&&"Noise"!==this.type||(e=this.element,i=!0),s&&i){const t=s.createPattern(e,n);return t.setTransform(this.patternMatrix),t}}return te}}const Th="contain",Eh="cover",Hh=["rgb(0 0 0 / 0)","rgba(0 0 0 / 0)","rgba(0,0,0,0)","rgba(0, 0, 0, 0)","transparent","#00000000","#0000"],Cell=function(t=tr){this.makeName(t.name),this.register(),this.initializePositions(),this.initializeCascade(),this.modifyConstructorInputForAnchorButton(t);let e=t.element;return delete t.element,rr(e)||(e=document.createElement(le),e.id=this.name,e.width=300,e.height=150),this.set(this.defs),this.dirtyAssetSubscribers=!0,this.basePaste=null,this.dirtyFilters=!0,this.dirtyFiltersCache=!0,this.filters=[],this.currentFilters=[],this.dirtyImageSubscribers=!0,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.paste=null,this.patternMatrix=null,this.pivot=null,this.set(t),this.installElement(e,t.canvasColorSpace),this.state.setStateFromEngine(this.engine),Gc({name:this.name,host:this.name}),this.subscribers=[],this.sourceNaturalDimensions=al(),this.dirtyDimensionsOverride=!0,this.sourceLoaded=!0,this.here={},this},Ih=Cell.prototype=Ar();Ih.type=Un,Ih.lib="cell",Ih.isArtefact=!1,Ih.isAsset=!0,Ro(Ih),Ka(Ih),Cc(Ih),Wc(Ih),qc(Ih),Qc(Ih),Jc(Ih),th(Ih),nh(Ih),ah(Ih),Ah(Ih),Ch(Ih),Rh(Ih),Bc(Ih);const Lh={cleared:!0,compiled:!0,shown:!0,compileOrder:0,showOrder:0,backgroundColor:Ys,clearAlpha:0,alpha:1,composite:En,scale:1,flipReverse:!1,flipUpend:!1,filter:Yi,isBase:!1,controller:null,includeInCascadeEventActions:!1,willReadFrequently:!0,setRelativeDimensionsUsingBase:!1};Ih.defs=ur(Ih.defs,Lh),delete Ih.defs.source,delete Ih.defs.sourceLoaded,Ih.stringifyFunction=qs,Ih.processPacketOut=qs,Ih.finalizePacketOut=qs,Ih.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Ih.clone=Js,Ih.factoryKill=function(){const t=this.name;wt(h).forEach((e=>{e.cells.includes(t)&&e.removeCell(t),e.base&&e.base.name===t&&e.set({visibility:!1})})),wt(o).forEach((e=>{if(e.name!==t){const i=e.state;if(i){const e=i.fillStyle,n=i.strokeStyle;e.name&&e.name===t&&(i.fillStyle=i.defs.fillStyle),n.name&&n.name===t&&(i.strokeStyle=i.defs.strokeStyle)}}})),k[t]&&k[t].kill()};const Bh=Ih.getters,$h=Ih.setters,Mh=Ih.deltaSetters;Ih.get=function(t){const e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t];const n=this.state;return null!=i?(e=this[t],null!=e?e:i):(i=n.defs[t],null!=i?(e=n[t],null!=e?e:i):void 0)}},Bh.width=function(){return this.currentDimensions[0]||this.element.getAttribute(Ms)},$h.width=function(t){null!=t&&(this.dimensions[0]=t,this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0)},Bh.height=function(){return this.currentDimensions[1]||this.element.getAttribute(oi)},$h.height=function(t){null!=t&&(this.dimensions[1]=t,this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0)},Bh.dimensions=function(){return[this.currentDimensions[0]||this.element.getAttribute(Ms),this.currentDimensions[1]||this.element.getAttribute(oi)]},$h.dimensions=function(t){if(ut(t)&&t.length>1){const[e,i]=t;null!=e&&(this.dimensions[0]=e),null!=i&&(this.dimensions[1]=i),this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0}},$h.source=function(){},$h.engine=function(){},$h.state=function(){},$h.element=function(t){rr(t)&&this.installElement(t)},$h.backgroundColor=function(t){Hh.includes(t)&&(t=Ys),this.backgroundColor=t},$h.cleared=function(t){this.cleared=t,this.updateControllerCells()},$h.compiled=function(t){this.compiled=t,this.updateControllerCells()},$h.shown=function(t){this.shown=t,this.updateControllerCells()},$h.compileOrder=function(t){this.compileOrder=t,this.updateControllerCells()},$h.showOrder=function(t){this.showOrder=t,this.updateControllerCells()},$h.order=function(t){this.compileOrder=t,this.showOrder=t,this.updateControllerCells()},$h.setRelativeDimensionsUsingBase=function(t){this.setRelativeDimensionsUsingBase=!!t,this.dirtyDimensions=!0},$h.stashX=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]),this.stashCoordinates[0]=t},$h.stashY=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]),this.stashCoordinates[1]=t},$h.stashWidth=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}this.stashDimensions[0]=t},$h.stashHeight=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}this.stashDimensions[1]=t},Mh.stashX=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]);const e=this.stashCoordinates;e[0]=Ws(e[0],t)},Mh.stashY=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]);const e=this.stashCoordinates;e[1]=Ws(e[1],t)},Mh.stashWidth=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}const e=this.stashDimensions;e[0]=Ws(e[0],t)},Mh.stashHeight=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}const e=this.stashDimensions;e[1]=Ws(e[1],t)},$h.clearAlpha=function(t){t.toFixed&&(t>1?t=1:t<0&&(t=0),this.clearAlpha=t)},Mh.clearAlpha=function(t){t.toFixed&&((t+=this.clearAlpha)>1?t=1:t<0&&(t=0),this.clearAlpha=t)},$h.checkForEntityHover=function(t){k[this.name].set({checkForEntityHover:t})},$h.onEntityHover=function(t){k[this.name].set({onEntityHover:t})},$h.onEntityNoHover=function(t){k[this.name].set({onEntityNoHover:t})},Bh.group=function(){return k[this.name]},Ih.getGroup=function(){return k[this.name]},Ih.checkSource=function(t,e){this.currentDimensions[0]===t&&this.currentDimensions[1]===e||this.notifySubscribers()},Ih.getData=function(t,e){return this.checkSource(this.sourceNaturalDimensions[0],this.sourceNaturalDimensions[1]),this.buildStyle(e)},Ih.updateArtefacts=function(t=tr){const e=this.groupBuckets;let i,n,s,r,o,a;for(s=0,r=e.length;s<r;s++)for(n=e[s].artefactCalculateBuckets,o=0,a=n.length;o<a;o++)i=n[o],t.dirtyScale&&(i.dirtyScale=!0),t.dirtyDimensions&&(i.dirtyDimensions=!0),t.dirtyLock&&(i.dirtyLock=!0),t.dirtyStart&&(i.dirtyStart=!0),t.dirtyOffset&&(i.dirtyOffset=!0),t.dirtyHandle&&(i.dirtyHandle=!0),t.dirtyRotation&&(i.dirtyRotation=!0),t.dirtyPathObject&&(i.dirtyPathObject=!0)},Ih.cleanDimensionsAdditionalActions=function(){const t=this.element;if(t){const{mimic:e,useMimicDimensions:i,isBase:n}=this;if(!n&&e&&i){const[e,i]=this.currentDimensions;t.width=e,t.height=i,this.setEngineFromState(this.engine),this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0})}else{const{cleared:e,dirtyDimensionsOverride:i}=this,s=this.getController();if(s&&(e||i)){this.dirtyDimensionsOverride=!1;const{currentDimensions:e,dimensions:i,setRelativeDimensionsUsingBase:r}=this;let o=s.currentDimensions;const[a,l]=o;if(n&&(s.baseMatchesCanvasDimensions||s.isComponent))i[0]=a,i[1]=l,e[0]=a,e[1]=l;else{let t;!n&&r&&(o=s.base.currentDimensions);for(let n=0;n<2;n++)t=i[n],t.substring?(t=parseFloat(t),dt(t)&&t>=1?e[n]=ct(o[n]*(t/100)):e[n]=1):dt(t)&&t>=1?e[n]=ct(t):e[n]=1}const[c,h]=e;t.width=c,t.height=h,this.setEngineFromState(this.engine),n&&s&&s.updateBaseHere(),this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0})}}}},Ih.notifySubscriber=function(t){t.sourceNaturalDimensions||(t.sourceNaturalDimensions=[]),t.sourceNaturalWidth=this.currentDimensions[0],t.sourceNaturalHeight=this.currentDimensions[1],t.sourceLoaded=!0,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0},Ih.subscribeAction=function(t={}){this.subscribers.push(t),t.asset=this,t.source=this.element,this.notifySubscriber(t)},Ih.installElement=function(t,e=In){return this.element=t,this.engine=this.element.getContext(Et,{willReadFrequently:this.willReadFrequently,colorSpace:e}),this.state=Ea({engine:this.engine}),this},Ih.updateControllerCells=function(){const t=this.getController();t&&(t.dirtyCells=!0)},Ih.getController=function(){const{controller:t,currentHost:e}=this;return t||(e?e.getHost():null)},Ih.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=l[this.host]||o[this.host];return t&&(this.currentHost=t),!!t&&this.currentHost}return!1},Ih.updateBaseHere=function(t,e){if(this.isBase){const i=this.here,n=this.currentDimensions;let s=t.active;const r=t.localListener?t.originalWidth:t.w,o=t.localListener?t.originalHeight:t.h;if(n[0]!==r||n[1]!==o){this.basePaste||(this.basePaste=[]);const a=this.basePaste[0],l=n[0],c=n[1],h=r,u=o,d=t.x,f=t.y,p=l/h||1,g=c/u||1;let m,y;switch(i.w=l,i.h=c,e){case Th:case Eh:a?(m=(h-l/g)/2,i.x=vt((d-m)*g),i.y=vt(f*g)):(y=(u-c/p)/2,i.x=vt(d*p),i.y=vt((f-y)*p));break;case We:i.x=vt(d*p),i.y=vt(f*g);break;default:m=(h-l)/2,y=(u-c)/2,i.x=vt(d-m),i.y=vt(f-y)}(i.x<0||i.x>l)&&(s=!1),(i.y<0||i.y>c)&&(s=!1),i.active=s}else i.x=t.x,i.y=t.y,i.w=r,i.h=o,i.active=s;t.baseActive=s}},Ih.clear=function(){const{element:t,engine:e,backgroundColor:i,clearAlpha:n}=this;this.prepareStamp();const s=ct(t.width),r=ct(t.height);if(i)e.save(),e.fillStyle=i,e.globalCompositeOperation=En,e.globalAlpha=1,e.fillRect(0,0,s,r),e.restore();else if(n){e.save();const i=el(s,r),{engine:o,element:a}=i;o.drawImage(t,0,0,s,r,0,0,s,r),e.clearRect(0,0,s,r),e.globalAlpha=n,e.drawImage(a,0,0,s,r,0,0,s,r),e.restore(),il(i)}else e.clearRect(0,0,s,r)},Ih.compile=function(){this.sortGroups(),this.cleared||this.prepareStamp(),!this.dirtyFilters&&this.currentFilters||this.cleanFilters();const t=this.groupBuckets,e=t.length;for(let i,n=0;n<e;n++)i=t[n],i&&i.stamp&&i.stamp();!this.noFilters&&this.filters&&this.filters.length&&this.applyFilters(),this.stashOutputAction()},Ih.setImageSmoothing=function(t){t.imageSmoothingEnabled=!0,t.imageSmoothingQuality=ai},Ih.show=function(){const t=this.getHost(),e=!(!t||!t.engine)&&t.engine;if(t&&e){let i=0,n=0;if(t.type===Wn?(i=t.domElement.width,n=t.domElement.height):t.type===Un&&(i=t.element.width,n=t.element.height),!i||!n)return!1;const{currentScale:s,composite:r,alpha:o,controller:a,element:l,isBase:c,currentStampHandlePosition:h,currentStampPosition:u}=this,d=l.width,f=l.height;if(!d||!f)return!1;let p;e.save(),e.filter=this.filter;const g=Uo()?1:Vo();if(c){this.basePaste||(this.basePaste=[]),p=this.basePaste,this.cleared||this.compiled||this.prepareStamp(),e.globalCompositeOperation=En,e.globalAlpha=1,e.clearRect(0,0,i,n),e.globalCompositeOperation=r,e.globalAlpha=o,this.setImageSmoothing(e);let t,s;switch(a?a.fit:Yi){case Th:t=i/(d||1),s=n/(f||1),t>s?(p[0]=ct((i-d*s)/2),p[1]=0,p[2]=ct(d*s),p[3]=ct(f*s)):(p[0]=0,p[1]=ct((n-f*t)/2),p[2]=ct(d*t),p[3]=ct(f*t));break;case Eh:t=i/(d||1),s=n/(f||1),t<s?(p[0]=ct((i-d*s)/2),p[1]=0,p[2]=ct(d*s),p[3]=ct(f*s)):(p[0]=0,p[1]=ct((n-f*t)/2),p[2]=ct(d*t),p[3]=ct(f*t));break;case We:p[0]=0,p[1]=0,p[2]=ct(i),p[3]=ct(n);break;default:p[0]=ct((i-d*g)/2),p[1]=ct((n-f*g)/2),p[2]=d*g,p[3]=f*g}e.clearRect(0,0,i,n),e.drawImage(l,0,0,d,f,...p)}else s>0&&(this.paste||(this.paste=[]),p=this.paste,this.noDeltaUpdates||this.setDelta(this.delta),this.cleared||this.compiled||this.prepareStamp(),e.globalCompositeOperation=r,e.globalAlpha=o,this.setImageSmoothing(e),p[0]=ct(-h[0]*s),p[1]=ct(-h[1]*s),p[2]=ct(d*s),p[3]=ct(f*s),this.rotateDestination(e,...u),e.drawImage(l,0,0,d,f,...p));e.restore()}},Ih.applyFilters=function(){const t=this.engine,e=this.element,i=t.getImageData(0,0,this.currentDimensions[0],this.currentDimensions[1]);this.preprocessFilters(this.currentFilters,e.width,e.height);const n=Ac.action({identifier:this.filterIdentifier,image:i,filters:this.currentFilters});n&&t.putImageData(n,0,0)},Ih.stashOutputAction=function(){if(this.stashOutput){this.stashOutput=!1;const{currentDimensions:t,stashCoordinates:e,stashDimensions:i,engine:n}=this,[s,r]=t;let o=e?e[0]:0,a=e?e[1]:0,l=i?i[0]:s,c=i?i[1]:r;if((l.substring||c.substring||o.substring||a.substring||o||a||l!==s||c!==r)&&(l.substring&&(l=parseFloat(l)/100*s),(!dt(l)||l<=0)&&(l=1),l>s&&(l=s),c.substring&&(c=parseFloat(c)/100*r),(!dt(c)||c<=0)&&(c=1),c>r&&(c=r),o.substring&&(o=parseFloat(o)/100*s),(!dt(o)||o<0)&&(o=0),o+l>s&&(o=s-l),a.substring&&(a=parseFloat(a)/100*r),(!dt(a)||a<0)&&(a=0),a+c>r&&(a=r-c)),n.save(),n.setTransform(1,0,0,1,0,0),this.stashedImageData=n.getImageData(o,a,l,c),n.restore(),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-image`;this.stashOutputAsAsset=!1;const e=el(),i=e.element;if(i.width=l,i.height=c,e.engine.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=i.toDataURL();else{const e=this.getController();if(e){const n=this,s=document.createElement(ui);s.id=t,s.alt=`A cached image of the ${this.name} Cell`,s.onload=function(){e.canvasHold.appendChild(s),n.stashedImage=s,Tc(`#${t}`)},s.src=i.toDataURL()}}il(e)}}},Ih.prepareStamp=function(){(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&(this.cleanDimensions(),this.dirtyAssetSubscribers=!0),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(Fi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.dirtyAssetSubscribers&&(this.dirtyAssetSubscribers=!1,this.notifySubscribers()),this.prepareStampTabsHelper()},Ih.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,n=this.currentDimensions,s=-e[0]*i,r=-e[1]*i,o=n[0]*i,a=n[1]*i;t.rect(s,r,o,a)}},Ih.updateHere=function(){const t=this.currentHost;if(t){const e=this.here,[i,n]=this.currentDimensions;e.w=i,e.h=n,e.x=-1e4,e.y=-1e4,e.active=!1;const s=t.here;if(s&&s.active){const{x:t,y:i}=s;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const n=el(),r=n.engine,[o,a]=this.currentStampPosition;n.rotateDestination(r,o,a,this);const l=r.isPointInPath(this.pathObject,t,i);if(il(n),e.active=l,l){const[n,s]=this.currentStampHandlePosition,{flipUpend:r,flipReverse:l,scale:c}=this;let h=this.roll;if(c){let u=(t-o)/c,d=(i-a)/c;if(l&&(u=-u),r&&(d=-d),h){(l&&!r||!l&&r)&&(h=-h);const t=rl(u,d);t.rotate(-h),[u,d]=t,ol(t)}u+=n,d+=s,e.x=u,e.y=d}}}}},Ih.splitShift=function(t){if(t&&t.px){const{px:e,vertical:i=!1,cycle:n=!1}=t,[s,r]=this.currentDimensions;let o=0,a=null;if(e.toFixed?o=vt(e):e.substring&&(o=vt(i?parseFloat(e)/100*r:parseFloat(e)/100*s)),o){const t=this.engine;i?o<0?(n&&(a=t.getImageData(0,0,s,-o)),t.putImageData(t.getImageData(0,-o,s,r+o),0,0),n&&t.putImageData(a,0,r+o)):(n&&(a=t.getImageData(0,r-o,s,o)),t.putImageData(t.getImageData(0,0,s,r-o),0,o),n&&t.putImageData(a,0,0)):o<0?(n&&(a=t.getImageData(0,0,-o,r)),t.putImageData(t.getImageData(-o,0,s+o,r),0,0),n&&t.putImageData(a,s+o,0)):(n&&(a=t.getImageData(s-o,0,o,r)),t.putImageData(t.getImageData(0,0,s-o,r),o,0),n&&t.putImageData(a,0,0))}}},Ih.getCellData=function(t=!1){const[e,i]=this.currentDimensions,n=ct(e/2),s=ct(i/2),r=this.engine.getImageData(0,0,e,i),o=r.data,a=[],l=rl();for(let r=0;r<i;r++)for(let i=0;i<e;i++){const c=4*(r*e+i);l.setFromArray([n,s]).subtract([r,i]);let h=1-(nt(l[1],l[0])/bt+.5);h>.5?h-=.5:h+=.5,a.push({indexR:c,indexG:c+1,indexB:c+2,indexA:c+3,red:o[c+0],green:o[c+1],blue:o[c+2],alpha:t?255:o[c+3],row:r,col:i,distance:l.getMagnitude(),angle:h})}return ol(l),{iData:r,pixelState:a}};const Xh=new Uint8ClampedArray(1);Ih.paintCellData=function(t=tr){const{iData:e,pixelState:i}=t,{width:n,height:s,data:r}=e,[o,a]=this.currentDimensions;n&&s&&r&&i&&o===n&&a===s&&(i.forEach((t=>{const{indexR:e,indexG:i,indexB:n,indexA:s}=t,o=Xh[0]=t.red,a=Xh[0]=t.green,l=Xh[0]=t.blue,c=Xh[0]=t.alpha;t.red=o,t.green=a,t.blue=l,t.alpha=c,r[e]=o,r[i]=a,r[n]=l,r[s]=c})),this.engine.putImageData(e,0,0))};J.Cell=Cell;const Vector=function(t,e,i){return this.x=0,this.y=0,this.z=0,gr(t)&&this.set(t,e,i),this},Yh=Vector.prototype=Ar();Yh.type=fs,Yh.getXYCoordinate=function(){return[this.x,this.y]},Yh.getXYZCoordinate=function(){return[this.x,this.y,this.z]},Yh.setX=function(t){return gr(t)&&lr(t)&&(this.x=t),this},Yh.setY=function(t){return gr(t)&&lr(t)&&(this.y=t),this},Yh.setZ=function(t){return gr(t)&&lr(t)&&(this.z=t),this},Yh.setXY=function(t,e){return mr(t,e)&&lr(t)&&lr(e)&&(this.x=t,this.y=e),this},Yh.set=function(t,e,i){return cr(t)?this.setFromVector(t):ut(t)?this.setFromArray(t):mr(t,e)?this.setFromArray([t,e,i]):this},Yh.setFromArray=function(t){if(ut(t)){const[e,i,n]=t;lr(e)&&(this.x=e),lr(i)&&(this.y=i),lr(n)&&(this.z=n)}return this},Yh.setFromVector=function(t){if(cr(t)){const{x:e,y:i,z:n}=t;lr(e)&&(this.x=e),lr(i)&&(this.y=i),lr(n)&&(this.z=n)}return this},Yh.zero=function(){return this.x=0,this.y=0,this.z=0,this},Yh.vectorAdd=function(t=tr){if(ut(t))return this.vectorAddArray(t);const{x:e,y:i,z:n}=t;return lr(e)&&(this.x+=e),lr(i)&&(this.y+=i),lr(n)&&(this.z+=n),this},Yh.vectorAddArray=function(t=[]){const[e,i,n]=t;return lr(e)&&(this.x+=e),lr(i)&&(this.y+=i),lr(n)&&(this.z+=n),this},Yh.vectorSubtract=function(t=tr){if(ut(t))return this.vectorSubtractArray(t);const{x:e,y:i,z:n}=t;return lr(e)&&(this.x-=e),lr(i)&&(this.y-=i),lr(n)&&(this.z-=n),this},Yh.vectorSubtractArray=function(t){const[e,i,n]=t;return lr(e)&&(this.x-=e),lr(i)&&(this.y-=i),lr(n)&&(this.z-=n),this},Yh.scalarMultiply=function(t){return lr(t)||(t=1),this.x*=t,this.y*=t,this.z*=t,this},Yh.vectorMultiply=function(t=tr){if(ut(t))return this.vectorMultiplyArray(t);const{x:e,y:i,z:n}=t;return lr(e)&&(this.x*=e),lr(i)&&(this.y*=i),lr(n)&&(this.z*=n),this},Yh.vectorMultiplyArray=function(t){const[e,i,n]=t;return lr(e)&&(this.x*=e),lr(i)&&(this.y*=i),lr(n)&&(this.z*=n),this},Yh.scalarDivide=function(t){return lr(t)&&t&&(this.x/=t,this.y/=t,this.z/=t),this},Yh.getMagnitude=function(){return xt(this.x*this.x+this.y*this.y+this.z*this.z)},Yh.rotate=function(t){lr(t)||(t=0);let e=nt(this.y,this.x);e+=.01745329251*t;const i=this.getMagnitude();return this.x=i*ot(e),this.y=i*Ot(e),this},Yh.reverse=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},Yh.normalize=function(){const t=this.getMagnitude();return t>0&&(this.x/=t,this.y/=t,this.z/=t),this};const Gh=[],Nh=function(t,e,i){Gh.length||Gh.push(new Vector);const n=Gh.shift();return n.set(t,e,i),n},zh=function(...t){t.forEach((t=>{t&&t.type===fs&&Gh.push(t.zero())}))},jh=function(t,e,i){return new Vector(t,e,i)};J.Vector=Vector;const Vh=Math.acos,Quaternion=function(t=tr){return this.n=t.n||1,this.v=jh(),this.set(t),this},Wh=Quaternion.prototype=Ar();Wh.type=as,Wh.set=function(t=tr){if(hr(t))return this.setFromQuaternion(t);if(br(t.pitch,t.yaw,t.roll))return this.setFromEuler(t);const e=this.v,i=!(!gr(t.vector)&&!gr(t.v))&&(t.vector||t.v),n=!(!gr(t.scalar)&&!gr(t.n))&&(t.scalar||t.n||0),s=i?i.x||0:t.x||!1,r=i?i.y||0:t.y||!1,o=i?i.z||0:t.z||!1;return this.n=lr(n)?n:this.n,e.x=lr(s)?s:e.x,e.y=lr(r)?r:e.y,e.z=lr(o)?o:e.z,this},Wh.setFromQuaternion=function(t){if(hr(t)){const e=this.v,i=t.v;this.n=t.n,e.x=i.x,e.y=i.y,e.z=i.z}return this},Wh.setFromEuler=function(t=tr){const e=this.v,i=(t.pitch||t.x||0)*Ct,n=(t.yaw||t.y||0)*Ct,s=(t.roll||t.z||0)*Ct,r=ot(i/2),o=ot(n/2),a=ot(s/2),l=Ot(i/2),c=Ot(n/2),h=Ot(s/2);return e.x=l*o*a+r*c*h,e.y=r*c*a+l*o*h,e.z=r*o*h-l*c*a,this.n=r*o*a-l*c*h,this},Wh.zero=function(){const t=this.v;return this.n=1,t.x=0,t.y=0,t.z=0,this},Wh.getMagnitude=function(){const t=this.v;return xt(this.n*this.n+t.x*t.x+t.y*t.y+t.z*t.z)},Wh.normalize=function(){const t=this.getMagnitude(),e=this.v;return t&&(this.n=_s(this.n/t),e.x=_s(e.x/t),e.y=_s(e.y/t),e.z=_s(e.z/t)),this},Wh.quaternionMultiply=function(t){if(hr(t)){const e=this.v,i=t.v,n=this.n,s=e.x,r=e.y,o=e.z,a=t.n,l=i.x,c=i.y,h=i.z;this.n=n*a-s*l-r*c-o*h,e.x=n*l+s*a+r*h-o*c,e.y=n*c+r*a+o*l-s*h,e.z=n*h+o*a+s*c-r*l}return this},Wh.getAngle=function(t){let e;return t=!!gr(t)&&t,e=2*Vh(this.n),t&&(e*=1/Ct),_s(e)},Wh.quaternionRotate=function(t){if(hr(t)){const e=Zh(t),i=Zh(this);this.setFromQuaternion(e.quaternionMultiply(i)),Kh(e,i)}return this};const Uh=[],Zh=function(t){Uh.length||Uh.push(_h());const e=Uh.shift();return e.set(t),e},Kh=function(...t){t.forEach((t=>{t&&t.type===as&&Uh.push(t.zero())}))},_h=function(t){return new Quaternion(t)};J.Quaternion=Quaternion;const qh=/[\s\uFEFF\xA0]+/g,Qh="tabindex";function Jh(t=tr){Wc(t),qc(t),Qc(t),Jc(t),th(t);const e={domElement:Ys,pitch:0,yaw:0,offsetZ:0,css:null,classes:Ys,position:Ht,checkForResize:!1,trackHere:Ys,activePadding:5,includeInTabNavigation:!1,moreContrastAction:null,otherContrastAction:null,reduceMotionAction:null,noPreferenceMotionAction:null,colorSchemeLightAction:null,colorSchemeDarkAction:null,reduceTransparencyAction:null,noPreferenceTransparencyAction:null,reduceDataAction:null,noPreferenceDataAction:null,invertedColorsAction:null,normalColorsAction:null,noForcedColorsAction:null,activeForcedColorsAction:null};t.defs=ur(t.defs,e),t.packetExclusions=fr(t.packetExclusions,["domElement","pathCorners","rotation"]),t.packetFunctions=fr(t.packetFunctions,["onEnter","onLeave","onDown","onUp"]),t.processDOMPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},t.processFactoryPacketOut=function(t,e,i){let n=!0;return i.includes(t)||e!==this.defs[t]||(n=!1),n},t.finalizePacketOut=function(t,e){if(or(this.domElement)){const e=this.domElement,i=e.cloneNode(!0);i.querySelectorAll(ve).forEach((t=>i.removeChild(t))),t.outerHTML=i.outerHTML,t.host=e.parentElement.id}return t=this.handlePacketAnchor(t,e)};const i=t.setters,n=t.deltaSetters;i.trackHere=function(t){var e;gr(t)&&(t?(fr(Lo,this.name),"local"===t&&(cr(e=this)&&(e.localMouseListener&&e.localMouseListener(),e.here||(e.here={}),e.here.originalWidth=e.currentDimensions[0],e.here.originalHeight=e.currentDimensions[1],e.localMouseListener=Ao(Li,(function(t){e.here&&(e.here.x=vt(parseFloat(t.offsetX)),e.here.y=vt(parseFloat(t.offsetY)))}),e.domElement)))):(pr(Lo,this.name),function(t){cr(t)&&(t.localMouseListener&&t.localMouseListener(),t.localMouseListener=!1)}(this)),this.trackHere=t)},i.position=function(t){this.position=t,this.dirtyPosition=!0},i.visibility=function(t){this.visibility=t,this.dirtyVisibility=!0},i.offsetZ=function(t){this.offsetZ=t,this.dirtyOffsetZ=!0},n.offsetZ=function(t){this.offsetZ+=t,this.dirtyOffsetZ=!0},i.roll=function(t){this.roll=Ks(t),this.dirtyRotation=!0},n.roll=function(t){this.roll=Ks(this.roll+t),this.dirtyRotation=!0},i.pitch=function(t){this.pitch=Ks(t),this.dirtyRotation=!0},n.pitch=function(t){this.pitch=Ks(this.pitch+t),this.dirtyRotation=!0},i.yaw=function(t){this.yaw=Ks(t),this.dirtyRotation=!0},n.yaw=function(t){this.yaw=Ks(this.yaw+t),this.dirtyRotation=!0},i.css=function(t){this.css=this.css?ur(this.css,t):t,this.dirtyCss=!0},i.classes=function(t){this.classes=t,this.dirtyClasses=!0},i.stampOrder=function(t){this.stampOrder=t,this.dirtyStampOrder=!0},i.domAttributes=function(t){this.updateDomAttributes(t)},i.includeInTabNavigation=function(t){const e=this.domElement;e&&(this.includeInTabNavigation=t,t?e.setAttribute(Qh,0):e.setAttribute(Qh,-1))},t.updateDomAttributes=function(t,e){const i=this.domElement;return i&&(t.substring&&gr(e)?gr(e)&&e?i.setAttribute(t,e):i.removeAttribute(t):cr(t)&&lt(t).forEach((([t,e])=>{gr(e)&&e?i.setAttribute(t,e):i.removeAttribute(t)}))),this},t.initializeDomLayout=function(t){const e=t.domElement;if(e){const i=e.style;if(i.boxSizing=oe,t.setInitialDimensions){const n=e.getBoundingClientRect();this.currentDimensions[0]=n.width,this.currentDimensions[1]=n.height,t.width=n.width,t.height=n.height,e.className&&(t.classes=e.className);let s=!1;if(t&&t.host&&(s=t.host,s.substring&&o[s]&&(s=o[s])),s&&s.domElement){const e=s.domElement.getBoundingClientRect();e&&(t.startX=n.left-e.left,t.startY=n.top-e.top)}if(this.type===hs){const e=parseFloat(i.perspective),{perspective:n,perspectiveX:s,perspectiveY:r,perspectiveZ:o}=t;mr(n,o)||(t.perspectiveZ=dt(e)?e:0);const a=i.perspectiveOrigin;if(a.length){const[e,i]=a.split(Hn);mr(n,s)||(t.perspectiveX=e),mr(n,r)||(t.perspectiveY=i)}}}}},t.addClasses=function(t){if(t.substring){const e=`${this.classes}  ${t}`.trim().replace(qh,Hn);e!==this.classes&&(this.classes=e,this.dirtyClasses=!0)}return this},t.removeClasses=function(t){if(t.substring){const e=t.split(" ");let i,n=this.classes;e.forEach((t=>{i=new RegExp(" ?"+t+" ?"),n=n.replace(i,Hn),n=n.trim(),n=n.replace(qh,Hn)})),n!==this.classes&&(this.classes=n,this.dirtyClasses=!0)}return this},t.addPathCorners=function(){const t=this.domElement;if(t&&!this.noUserInteraction&&Ns.includes(t.tagName)){const e=function(){const t=document.createElement(Be),e=t.style;return e.width=0,e.height=0,e.position=Ht,e.margin=0,e.border=0,e.padding=0,t.setAttribute("data-scrawl-corner-div","sc"),t.setAttribute(jt,xs),t},i=this.pathCorners,n=e(),s=e(),r=e(),o=e();n.style.top=Wi,n.style.left=Wi,s.style.top=Wi,s.style.left=Ui,r.style.top=Ui,r.style.left=Ui,o.style.top=Ui,o.style.left=Wi,t.appendChild(n),t.appendChild(s),t.appendChild(r),t.appendChild(o),i.push(n),i.push(s),i.push(r),i.push(o),this.currentCornersData||(this.currentCornersData=[])}return this},t.checkCornerPositions=function(t){const e=this.pathCorners;if(4===e.length){const i=this.getHere(),n=Bo.scrollX-(i.offsetX||0),s=Bo.scrollY-(i.offsetY||0),r=[];let o,a;const l=function(t){a=t[0],a?(r.push(vt(a.left+n)),r.push(vt(a.top+s))):r.push(0,0)};switch(t){case"topLeft":return o=e[0].getClientRects(),l(o),r;case"topRight":return o=e[1].getClientRects(),l(o),r;case"bottomRight":return o=e[2].getClientRects(),l(o),r;case"bottomLeft":return o=e[3].getClientRects(),l(o),r;default:return e.forEach((t=>{or(t)&&(o=t.getClientRects(),l(o))})),r}}},t.getCornerCoordinate=function(t){return ke.includes(t)?this.checkCornerPositions(t):[].concat(this.currentStampPosition)},t.cleanPathObject=function(){if(this.dirtyPathObject=!1,this.domElement&&!this.noUserInteraction)if(this.pathCorners.length||this.addPathCorners(),this.pathCorners.length){this.currentCornersData||(this.currentCornersData=[]);const t=this.currentCornersData;t.length=0,t.push(...this.checkCornerPositions());const e=this.pathObject=new Path2D;e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.closePath()}else{const t=this.pathObject=new Path2D;t.moveTo(0,0),t.lineTo(10,0),t.lineTo(0,10),t.lineTo(-10,0),t.closePath()}},t.checkHit=function(t=[]){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const e=ut(t)?t:[t],i=el(),n=i.engine;let s,r;return e.some((t=>{if(ut(t))s=t[0],r=t[1];else{if(!mr(t,t.x,t.y))return!1;s=t.x,r=t.y}return!(!dt(s)||!dt(r))&&n.isPointInPath(this.pathObject,s,r)}),this)?(il(i),{x:s,y:r,artefact:this}):(il(i),!1)},t.cleanRotation=function(){this.dirtyRotation=!1,this.rotation&&hr(this.rotation)||(this.rotation=_h()),this.currentRotation&&hr(this.rotation)||(this.currentRotation=_h());const t=this.rotation;t.setFromEuler({pitch:this.pitch||0,yaw:this.yaw||0,roll:this.roll||0}),1!==t.getMagnitude()&&t.normalize();const e=Zh(),i=this.path,n=this.mimic,s=this.pivot,r=this.lockTo;i&&r.includes(ji)?e.set(t):n&&this.useMimicRotation&&r.includes(Pi)?gr(n.currentRotation)?(e.set(n.currentRotation),this.addOwnRotationToMimic&&e.quaternionRotate(t)):this.dirtyMimicRotation=!0:(e.set(t),s&&this.addPivotRotation&&r.includes(_i)&&(gr(s.currentRotation)?e.quaternionRotate(s.currentRotation):this.dirtyPivotRotation=!0)),this.currentRotation.set(e),Kh(e),this.dirtyPositionSubscribers=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicRotation=!0)},t.cleanOffsetZ=function(){this.dirtyOffsetZ=!1},t.cleanContent=function(){this.dirtyContent=!1,this.domElement&&(this.dirtyDimensions=!0)},t.cleanDisplayShape=qs,t.cleanDisplayArea=qs,t.prepareStamp=function(){(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle||this.dirtyRotation)&&(this.dirtyPathObject=!0),this.dirtyContent&&this.cleanContent(),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyDisplayArea&&this.cleanDisplayArea(),this.dirtyDisplayShape&&this.cleanDisplayShape(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyOffsetZ&&this.cleanOffsetZ(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.pivoted.length&&(this.dirtyStampPositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.prepareStampAdditionalActions()},t.prepareStampAdditionalActions=qs,t.stamp=function(){if(!this.domElement)return!1;const[t,e]=this.currentStampPosition,[i,n]=this.currentStampHandlePosition,s=this.currentScale,r=this.currentRotation,o=`${i}px ${n}px 0`;let a=`translate(${t-i}px,${e-n}px)`;if(this.yaw||this.pitch||this.roll||this.pivot&&this.addPivotRotation||this.mimic&&this.useMimicRotation||this.path&&this.addPathRotation){const t=r.v;a+=` rotate3d(${t.x},${t.y},${t.z},${r.getAngle(!1)}rad)`}this.offsetZ&&(a+=` translateZ(${this.offsetZ}px)`),1!==s&&(a+=` scale(${s},${s})`),a!==this.currentTransformString&&(this.currentTransformString=a,this.dirtyTransform=!0),o!==this.currentTransformOriginString&&(this.currentTransformOriginString=o,this.dirtyTransformOrigin=!0),(this.dirtyTransform||this.dirtyPerspective||this.dirtyPosition||this.dirtyDomDimensions||this.dirtyTransformOrigin||this.dirtyVisibility||this.dirtyCss||this.dirtyClasses||this.dirtyStampOrder||this.domShowRequired)&&(this.domShowRequired=!1,function(t=Ys){t&&t.substring&&fr(ga,t)}(this.name),((t=!0)=>{ma=t})(!0),xr(!0)),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),(this.dirtyMimicRotation||this.dirtyPivotRotation)&&(this.dirtyMimicRotation=!1,this.dirtyPivotRotation=!1,this.dirtyRotation=!0),this.dirtyMimicScale&&(this.dirtyMimicScale=!1,this.dirtyScale=!0)},t.initializeAccessibility=function(){this.reduceMotionAction=qs,this.noPreferenceMotionAction=qs,this.colorSchemeLightAction=qs,this.colorSchemeDarkAction=qs,this.reduceTransparencyAction=qs,this.noPreferenceTransparencyAction=qs,this.reduceDataAction=qs,this.noPreferenceDataAction=qs,this.moreContrastAction=qs,this.otherContrastAction=qs,this.invertedColorsAction=qs,this.normalColorsAction=qs,this.noForcedColorsAction=qs,this.activeForcedColorsAction=qs},i.moreContrastAction=function(t){ar(t)&&(this.moreContrastAction=t)},t.setMoreContrastAction=function(t){ar(t)&&(this.moreContrastAction=t)},i.otherContrastAction=function(t){ar(t)&&(this.otherContrastAction=t)},t.setOtherContrastAction=function(t){ar(t)&&(this.otherContrastAction=t)},t.contrastActions=function(){const t=this.here;if(gr(t)){const e=t.prefersContrast;gr(e)&&(e?this.moreContrastAction():this.otherContrastAction())}},i.reduceMotionAction=function(t){ar(t)&&(this.reduceMotionAction=t)},t.setReduceMotionAction=function(t){ar(t)&&(this.reduceMotionAction=t)},i.noPreferenceMotionAction=function(t){ar(t)&&(this.noPreferenceMotionAction=t)},t.setNoPreferenceMotionAction=function(t){ar(t)&&(this.noPreferenceMotionAction=t)},t.reducedMotionActions=function(){const t=this.here;if(gr(t)){const e=t.prefersReducedMotion;gr(e)&&(e?this.reduceMotionAction():this.noPreferenceMotionAction())}},i.colorSchemeLightAction=function(t){ar(t)&&(this.colorSchemeLightAction=t)},t.setColorSchemeLightAction=function(t){ar(t)&&(this.colorSchemeLightAction=t)},i.colorSchemeDarkAction=function(t){ar(t)&&(this.colorSchemeDarkAction=t)},t.setColorSchemeDarkAction=function(t){ar(t)&&(this.colorSchemeDarkAction=t)},t.colorSchemeActions=function(){const t=this.here;if(gr(t)){const e=t.prefersDarkColorScheme;gr(e)&&(e?this.colorSchemeDarkAction():this.colorSchemeLightAction())}},i.reduceTransparencyAction=function(t){ar(t)&&(this.reduceTransparencyAction=t)},t.setReduceTransparencyAction=function(t){ar(t)&&(this.reduceTransparencyAction=t)},i.noPreferenceTransparencyAction=function(t){ar(t)&&(this.noPreferenceTransparencyAction=t)},t.setNoPreferenceTransparencyAction=function(t){ar(t)&&(this.noPreferenceTransparencyAction=t)},t.reducedTransparencyActions=function(){const t=this.here;if(gr(t)){const e=t.prefersReduceTransparency;gr(e)&&(e?this.reduceTransparencyAction():this.noPreferenceTransparencyAction())}},i.reduceDataAction=function(t){ar(t)&&(this.reduceDataAction=t)},t.setReduceDataAction=function(t){ar(t)&&(this.reduceDataAction=t)},i.noPreferenceDataAction=function(t){ar(t)&&(this.noPreferenceDataAction=t)},t.setNoPreferenceDataAction=function(t){ar(t)&&(this.noPreferenceDataAction=t)},t.reducedDataActions=function(){const t=this.here;if(gr(t)){const e=t.prefersReduceData;gr(e)&&(e?this.reduceDataAction():this.noPreferenceDataAction())}},i.invertedColorsAction=function(t){ar(t)&&(this.invertedColorsAction=t)},t.setInvertedColorsAction=function(t){ar(t)&&(this.invertedColorsAction=t)},i.normalColorsAction=function(t){ar(t)&&(this.normalColorsAction=t)},t.setNormalColorsAction=function(t){ar(t)&&(this.normalColorsAction=t)},t.invertedColorsActions=function(){const t=this.here;if(gr(t)){const e=t.prefersInvertedColors;gr(e)&&(e?this.invertedColorsAction():this.normalColorsAction())}},i.noForcedColorsAction=function(t){ar(t)&&(this.noForcedColorsAction=t)},t.setNoForcedColorsAction=function(t){ar(t)&&(this.noForcedColorsAction=t)},i.activeForcedColorsAction=function(t){ar(t)&&(this.activeForcedColorsAction=t)},t.setActiveForcedColorsAction=function(t){ar(t)&&(this.activeForcedColorsAction=t)},t.forcedColorsActions=function(){const t=this.here;if(gr(t)){const e=t.prefersForcedColors;gr(e)&&(e?this.activeForcedColorsAction():this.noForcedColorsAction())}},t.checkAccessibilityValues=function(){this.contrastActions(),this.reducedMotionActions(),this.colorSchemeActions(),this.reducedTransparencyActions(),this.reducedDataActions(),this.invertedColorsActions(),this.forcedColorsActions()}}const tu="banner",eu="landscape",iu="larger",nu="largest",su="portrait",ru="regular",ou="skyscraper",au="smaller",lu="smallest";function cu(t=tr){t.defs=ur(t.defs,{breakToBanner:3,breakToLandscape:1.5,breakToPortrait:.65,breakToSkyscraper:.35,actionBannerShape:null,actionLandscapeShape:null,actionRectangleShape:null,actionPortraitShape:null,actionSkyscraperShape:null,breakToSmallest:2e4,breakToSmaller:8e4,breakToLarger:18e4,breakToLargest:32e4,actionSmallestArea:null,actionSmallerArea:null,actionRegularArea:null,actionLargerArea:null,actionLargestArea:null}),t.packetFunctions=fr(t.packetFunctions,["actionBannerShape","actionLandscapeShape","actionRectangleShape","actionPortraitShape","actionSkyscraperShape","actionSmallestArea","actionSmallerArea","actionRegularArea","actionLargerArea","actionLargestArea"]);const e=t.getters,i=t.setters;e.displayShape=function(){return this.currentDisplayShape},e.displayShapeBreakpoints=function(){return{breakToBanner:this.breakToBanner,breakToLandscape:this.breakToLandscape,breakToPortrait:this.breakToPortrait,breakToSkyscraper:this.breakToSkyscraper,breakToSmallest:this.breakToSmallest,breakToSmaller:this.breakToSmaller,breakToLarger:this.breakToLarger,breakToLargest:this.breakToLargest}},i.displayShapeBreakpoints=function(t=tr){for(const[e,i]of lt(t))if(lr(i))switch(e){case"breakToBanner":this.breakToBanner=i;break;case"breakToLandscape":this.breakToLandscape=i;break;case"breakToPortrait":this.breakToPortrait=i;break;case"breakToSkyscraper":this.breakToSkyscraper=i;break;case"breakToSmallest":this.breakToSmallest=i;break;case"breakToSmaller":this.breakToSmaller=i;break;case"breakToLarger":this.breakToLarger=i;break;case"breakToLargest":this.breakToLargest=i}this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},t.setDisplayShapeBreakpoints=i.displayShapeBreakpoints,i.breakToBanner=function(t){lr(t)&&(this.breakToBanner=t),this.dirtyDisplayShape=!0},i.breakToLandscape=function(t){lr(t)&&(this.breakToLandscape=t),this.dirtyDisplayShape=!0},i.breakToPortrait=function(t){lr(t)&&(this.breakToPortrait=t),this.dirtyDisplayShape=!0},i.breakToSkyscraper=function(t){lr(t)&&(this.breakToSkyscraper=t),this.dirtyDisplayShape=!0},i.breakToSmallest=function(t){lr(t)&&(this.breakToSmallest=t),this.dirtyDisplayArea=!0},i.breakToSmaller=function(t){lr(t)&&(this.breakToSmaller=t),this.dirtyDisplayArea=!0},i.breakToLarger=function(t){lr(t)&&(this.breakToLarger=t),this.dirtyDisplayArea=!0},i.breakToLargest=function(t){lr(t)&&(this.breakToLargest=t),this.dirtyDisplayArea=!0},i.actionBannerShape=function(t){ar(t)&&(this.actionBannerShape=t),this.dirtyDisplayShape=!0},t.setActionBannerShape=i.actionBannerShape,i.actionLandscapeShape=function(t){ar(t)&&(this.actionLandscapeShape=t),this.dirtyDisplayShape=!0},t.setActionLandscapeShape=i.actionLandscapeShape,i.actionRectangleShape=function(t){ar(t)&&(this.actionRectangleShape=t),this.dirtyDisplayShape=!0},t.setActionRectangleShape=i.actionRectangleShape,i.actionPortraitShape=function(t){ar(t)&&(this.actionPortraitShape=t),this.dirtyDisplayShape=!0},t.setActionPortraitShape=i.actionPortraitShape,i.actionSkyscraperShape=function(t){ar(t)&&(this.actionSkyscraperShape=t),this.dirtyDisplayShape=!0},t.setActionSkyscraperShape=i.actionSkyscraperShape,i.actionSmallestArea=function(t){ar(t)&&(this.actionSmallestArea=t),this.dirtyDisplayArea=!0},t.setActionSmallestArea=i.actionSmallestArea,i.actionSmallerArea=function(t){ar(t)&&(this.actionSmallerArea=t),this.dirtyDisplayArea=!0},t.setActionSmallerArea=i.actionSmallerArea,i.actionRegularArea=function(t){ar(t)&&(this.actionRegularArea=t),this.dirtyDisplayArea=!0},t.setActionRegularArea=i.actionRegularArea,i.actionLargerArea=function(t){ar(t)&&(this.actionLargerArea=t),this.dirtyDisplayArea=!0},t.setActionLargerArea=i.actionLargerArea,i.actionLargestArea=function(t){ar(t)&&(this.actionLargestArea=t),this.dirtyDisplayArea=!0},t.setActionLargestArea=i.actionLargestArea,t.initializeDisplayShapeActions=function(){this.actionBannerShape=qs,this.actionLandscapeShape=qs,this.actionRectangleShape=qs,this.actionPortraitShape=qs,this.actionSkyscraperShape=qs,this.currentDisplayShape=Ys,this.dirtyDisplayShape=!0,this.actionSmallestArea=qs,this.actionSmallerArea=qs,this.actionRegularArea=qs,this.actionLargerArea=qs,this.actionLargestArea=qs,this.currentDisplayArea=Ys,this.dirtyDisplayArea=!0},t.cleanDisplayShape=function(){this.dirtyDisplayShape=!1;const[t,e]=this.currentDimensions;if(t>0&&e>0){const i=t/e,n=this.currentDisplayShape,s=this.breakToBanner,r=this.breakToLandscape,o=this.breakToPortrait,a=this.breakToSkyscraper;return i>s?n!==tu&&(this.currentDisplayShape=tu,this.actionBannerShape(),!0):i>r?n!==eu&&(this.currentDisplayShape=eu,this.actionLandscapeShape(),!0):i<a?n!==ou&&(this.currentDisplayShape=ou,this.actionSkyscraperShape(),!0):i<o?n!==su&&(this.currentDisplayShape=su,this.actionPortraitShape(),!0):n!==pn&&(this.currentDisplayShape=pn,this.actionRectangleShape(),!0)}return this.dirtyDisplayShape=!0,!1},t.cleanDisplayArea=function(){this.dirtyDisplayArea=!1;const[t,e]=this.currentDimensions;if(t>0&&e>0){const i=t*e,n=this.currentDisplayArea,s=this.breakToLargest,r=this.breakToLarger,o=this.breakToSmaller,a=this.breakToSmallest;return i>s?n!==nu&&(this.currentDisplayArea=nu,this.actionLargestArea(),!0):i>r?n!==iu&&(this.currentDisplayArea=iu,this.actionLargerArea(),!0):i<a?n!==lu&&(this.currentDisplayArea=lu,this.actionSmallestArea(),!0):i<o?n!==au&&(this.currentDisplayArea=au,this.actionSmallerArea(),!0):n!==ru&&(this.currentDisplayArea=ru,this.actionRegularArea(),!0)}return this.dirtyDisplayArea=!0,!1},t.updateDisplayShape=function(){this.currentDisplayShape=Ys,this.dirtyDisplayShape=!0},t.updateDisplayArea=function(){this.currentDisplayArea=Ys,this.dirtyDisplayArea=!0},t.updateDisplay=function(){this.updateDisplayShape(),this.updateDisplayArea()}}const hu="aria-busy",uu=["assertive","polite","off"],du=["fill","contain","cover"],Canvas=function(t=tr){this.makeName(t.name),this.register(),this.initializePositions(),this.dimensions[0]=300,this.dimensions[1]=150,this.pathCorners=[],this.css={},this.here={},this.perspective={x:Zi,y:Zi,z:0},this.dirtyPerspective=!0,this.initializeDomLayout(t),this.modifyConstructorInputForAnchorButton(t),this.set(this.defs),t.label||(t.label=`${this.name} canvas element`),this.initializeDisplayShapeActions(),this.initializeAccessibility(),this.currentActiveEntityNames=null,this.dirtyCss=!0,this.dirtyStampOrder=!0,this.localMouseListener=null,this.mimic=null,this.pivot=null,this.set(t);const e=this.domElement;if(e){const i=e.dataset;this.useDisplayP3WhereAvailable=i.canvasColorSpace===Le||t.canvasColorSpace===Le,this.canvasColorSpace=fa(this.useDisplayP3WhereAvailable),this.engine=this.domElement.getContext(Et,{colorSpace:this.canvasColorSpace}),this.state=Ea({engine:this.engine}),this.cells=[],this.cellBatchesClear=[],this.cellBatchesCompile=[],this.cellBatchesShow=[];let n=e.width,s=e.height;if(i.isResponsive){e.style.width=Ui,e.style.height=Ui;let t=!0;i.baseWidth&&i.baseHeight&&(t=!1,n=parseFloat(i.baseWidth),s=parseFloat(i.baseHeight)),this.set({checkForResize:!0,baseMatchesCanvasDimensions:t,ignoreCanvasCssDimensions:!0,fit:i.fit||this.fit})}this.cleanDimensions();let r=i.willReadFrequently;r="false"!==r&&t.willReadFrequently,r=null==r||!!r;const o={name:`${this.name}_base`,element:!1,width:n,height:s,cleared:!0,compiled:!0,shown:!1,isBase:!0,host:this.name,controller:this,order:10,canvasColorSpace:this.canvasColorSpace,willReadFrequently:r};i.baseClearAlpha&&(o.clearAlpha=parseFloat(i.baseClearAlpha)),i.baseBackgroundColor&&(o.backgroundColor=i.baseBackgroundColor),this.base=this.buildCell(o),Ca(this.name),e.getAttribute("role")&&(this.role=e.getAttribute("role")),e.getAttribute("title")&&(this.title=e.getAttribute("title")),i.label&&(this.label=i.label),i.description&&(this.description=i.description);const a=document.createElement("nav");a.id=`${this.name}-navigation`,a.setAttribute(Vt,sn),a.setAttribute(hu,"false"),this.navigation=a,e.appendChild(a),this.dirtyNavigationTabOrder=!0;const l=document.createElement(Be);l.id=`${this.name}-text-hold`,l.setAttribute(Vt,sn),l.setAttribute(hu,"false"),this.textHold=l,e.appendChild(l),this.dirtyTextTabOrder=!0;const c=document.createElement("div");c.id=`${this.name}-canvas-hold`,c.style.display=Yi,c.setAttribute(jt,xs),this.canvasHold=c,e.appendChild(c);const h=document.createElement(Be);h.id=`${this.name}-fontSizeCalculator`,h.setAttribute(jt,xs),this.fontSizeCalculator=h,this.fontSizeCalculatorValues=rt(h),c.appendChild(h);const u=document.createElement(Be);u.id=`${this.name}-styles`,u.setAttribute(jt,xs),this.labelStylesCalculator=u,this.labelStylesCalculatorValues=rt(u),c.appendChild(u);const d=document.createElement(Be);d.id=`${this.name}-ARIA-label`,d.setAttribute(Vt,sn),this.ariaLabelElement=d,e.appendChild(d),e.setAttribute("aria-labelledby",d.id);const f=document.createElement(Be);f.id=`${this.name}-ARIA-description`,f.setAttribute(Vt,sn),this.ariaDescriptionElement=f,e.appendChild(f),e.setAttribute("aria-describedby",f.id),this.includeInTabNavigation=!1,this.cleanAria(),this.computedStyles=rt(e)}return this.dirtyCells=!0,this.dirtyDomDimensions=!0,t.setAsCurrentCanvas&&this.setAsCurrentCanvas(),this},fu=Canvas.prototype=Ar();fu.type=Wn,fu.lib=le,fu.isArtefact=!0,fu.isAsset=!1,Ro(fu),Jh(fu),cu(fu),nh(fu),ah(fu),Ah(fu);const pu={position:Sn,trackHere:Nn,fit:Yi,isComponent:!1,baseMatchesCanvasDimensions:!1,renderOnResize:!0,ignoreCanvasCssDimensions:!1,title:Ys,label:Ys,description:Ys,role:ui,navigationAriaLive:sn,textAriaLive:sn,canvasColorSpace:In};fu.defs=ur(fu.defs,pu),fu.stringifyFunction=qs,fu.processPacketOut=qs,fu.finalizePacketOut=qs,fu.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},fu.clone=Js,fu.factoryKill=function(){const t=this.name,e=this.host;if(ka(t),pr(Lo,t),e&&e!==On){const i=this.currentHost?this.currentHost:o[e];if(i){i.removeGroups(t);const e=k[i.name];e&&e.removeArtefacts(t)}}k[t]&&k[t].kill(),this.base.kill(),this.domElement.remove()};const gu=fu.getters,mu=fu.setters,yu=fu.deltaSetters;mu.fit=function(t){this.fit=du.includes(t)?t:Yi},mu.title=function(t){this.title=t,this.dirtyAria=!0},mu.label=function(t){this.label=t,this.dirtyAria=!0},mu.description=function(t){this.description=t,this.dirtyAria=!0},mu.role=function(t){this.role=t,this.dirtyAria=!0},mu.navigationAriaLive=function(t){t.substring&&uu.includes(t)&&(this.navigationAriaLive=t,this.dirtyAria=!0)},mu.textAriaLive=function(t){t.substring&&uu.includes(t)&&(this.textAriaLive=t,this.dirtyAria=!0)},gu.backgroundColor=function(){return this.base.backgroundColor},mu.backgroundColor=function(t){this.base&&this.base.set({backgroundColor:t})},gu.alpha=function(){return this.base.alpha},mu.alpha=function(t){this.base&&this.base.set({alpha:t})},yu.alpha=function(t){this.base&&this.base.deltaSet({alpha:t})},gu.composite=function(){return this.base.composite},mu.composite=function(t){this.base&&this.base.set({composite:t})},mu.checkForEntityHover=function(t){this.base.set({checkForEntityHover:t})},mu.onEntityHover=function(t){this.base.set({onEntityHover:t})},mu.onEntityNoHover=function(t){this.base.set({onEntityNoHover:t})},gu.baseGroup=function(){return k[this.base.name]},gu.baseName=function(){return this.base.name},fu.setAsCurrentCanvas=function(){return this.base&&vu(this),this},fu.setBase=function(t){return this.base&&(this.base.set(t),this.setBaseHelper()),this},fu.deltaSetBase=function(t){return this.base&&(this.base.deltaSet(t),this.setBaseHelper()),this},fu.getBase=function(){return this.base},fu.getBaseHere=function(){return this.base.here},fu.reset=function(){this.dirtyDimensions=!0,ya(this.name)},fu.updateBaseHere=function(){this.base&&this.base.updateBaseHere(this.here,this.fit)},fu.setBaseHelper=function(){const t={},e=this.base;e.dirtyScale&&(t.dirtyScale=!0),e.dirtyDimensions&&(t.dirtyDimensions=!0),e.dirtyLock&&(t.dirtyLock=!0),e.dirtyStart&&(t.dirtyStart=!0),e.dirtyOffset&&(t.dirtyOffset=!0),e.dirtyHandle&&(t.dirtyHandle=!0),e.dirtyRotation&&(t.dirtyRotation=!0),this.cleanCells(),e.prepareStamp(),this.updateCells(t)},fu.updateCells=function(t=tr){const e=this.cells;let i;for(let n=0,s=e.length;n<s;n++)i=d[e[n]],i&&(t.dirtyScale&&(i.dirtyScale=!0),t.dirtyDimensions&&(i.dirtyDimensions=!0),t.dirtyLock&&(i.dirtyLock=!0),t.dirtyStart&&(i.dirtyStart=!0),t.dirtyOffset&&(i.dirtyOffset=!0),t.dirtyHandle&&(i.dirtyHandle=!0),t.dirtyRotation&&(i.dirtyRotation=!0))},fu.buildCell=function(t=tr){t.host||null||(t.host=this.base.name);const e=function(t){return!!t&&new Cell(t)}(t);return this.addCell(e),this.cleanCells(),e},fu.cleanDimensionsAdditionalActions=function(){this.cells&&this.updateCells({dirtyDimensions:!0}),this.dirtyDomDimensions=!0,this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},fu.prepareStampAdditionalActions=function(){this.prepareStampTabsHelper()},fu.addCell=function(t){if(t=t.substring?t:t.name||null){const e=d[t];e&&(this.base&&(e.host=this.base.name,e.currentHost=null),e.prepareStamp(),fr(this.cells,t),this.dirtyCells=!0)}return this},fu.removeCell=function(t){return(t=t.substring?t:t.name||null)&&(pr(this.cells,t),this.dirtyCells=!0),this},fu.killCell=function(t){const e=t.substring?d[t]:t;return e&&e.kill(),this.dirtyCells=!0,this},fu.clear=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesClear;for(let e=0,i=t.length;e<i;e++)t[e].clear()},fu.compile=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesCompile;for(let e=0,i=t.length;e<i;e++)t[e].compile();this.prepareStamp(),this.stamp()},fu.show=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesShow;for(let e=0,i=t.length;e<i;e++)t[e].show();this.base.show(),ya(),this.dirtyAria&&this.cleanAria(),this.dirtyNavigationTabOrder&&this.reorderNavElements(),this.dirtyTextTabOrder&&this.reorderTextElements()},fu.reorderNavElements=function(){this.dirtyNavigationTabOrder=!1;const t=[],e=this.navigation;for(e.setAttribute(hu,"true");e.firstChild;)t.push(e.removeChild(e.firstChild));t.sort(((t,e)=>{const i=parseInt(t.getAttribute(xe),10),n=parseInt(e.getAttribute(xe),10);return i<n?-1:i>n?1:0})),t.forEach((t=>e.appendChild(t))),e.setAttribute(hu,"false")},fu.reorderTextElements=function(){this.dirtyTextTabOrder=!1;const t=[],e=this.textHold;for(e.setAttribute(hu,"true");e.firstChild;)t.push(e.removeChild(e.firstChild));t.sort(((t,e)=>{const i=parseInt(t.getAttribute(xe),10),n=parseInt(e.getAttribute(xe),10);return i<n?-1:i>n?1:0})),t.forEach((t=>e.appendChild(t))),e.setAttribute(hu,"false")},fu.render=function(){this.clear(),this.compile(),this.show()},fu.cleanCells=function(){this.dirtyCells=!1;const t=lo(),e=lo(),i=lo(),{cells:n,cellBatchesClear:s,cellBatchesCompile:r,cellBatchesShow:o}=this;let a,l,c,h,u;for(h=0,u=n.length;h<u;h++)a=d[n[h]],a&&!a.isBase&&(a.cleared&&t.push(a),a.compiled&&(l=a.compileOrder,e[l]||(e[l]=lo()),e[l].push(a)),a.shown&&(l=a.showOrder,i[l]||(i[l]=lo()),i[l].push(a)));for(s.length=0,s.push(...t,this.base),co(t),r.length=0,h=0,u=e.length;h<u;h++)c=e[h],c&&(r.push(...c),co(c));for(r.push(this.base),co(e),o.length=0,h=0,u=i.length;h<u;h++)c=i[h],c&&(o.push(...c),co(c));o.push(this.base),co(i)},fu.cascadeEventAction=function(t,e={}){this.currentActiveEntityNames||(this.currentActiveEntityNames=[]);const i=this.currentActiveEntityNames,n=lo(),s=lo(),r=lo(),a=lo(),l=lo(),c=lo(),h=lo();let u,f,p,g,m,y;const b=this.cells;for(u=0,f=b.length;u<f;u++)p=d[b[u]],p&&(p.shown||p.isBase||p.includeInCascadeEventActions)&&s.push(...p.getEntityHits());for(u=0,f=s.length;u<f;u++)g=s[u],m=g.name,r.includes(m)||(r.push(m),i.includes(m)?(c.push(g),h.push(m)):(a.push(g),l.push(m)));n.push(...a,...c);const S=function(t){if(i.length){for(u=0,f=l.length;u<f;u++)pr(i,l[u]);for(u=0,f=h.length;u<f;u++)pr(i,h[u]);for(u=0,f=i.length;u<f;u++)y=o[i[u]],y&&y.onLeave(t)}},A=n.length,C=a.length;switch(t){case $e:for(u=0;u<A;u++)n[u].onDown(e);break;case Ts:for(u=0;u<A;u++)n[u].onUp(e);break;case ze:for(u=0;u<C;u++)a[u].onEnter(e);break;case pi:S(e);break;case Li:for(S(e),u=0;u<C;u++)a[u].onEnter(e);break;case"otherInteraction":for(u=0;u<A;u++)n[u].onOtherInteraction(e)}return i.length=0,i.push(...l,...h),co(n,s,r,a,l,c,h),[...i]},fu.getEntityHits=function(){return this.cascadeEventAction()},fu.checkHover=function(){this.cascadeEventAction()},fu.cleanAria=function(){this.dirtyAria=!1,this.domElement.setAttribute("title",this.title),this.domElement.setAttribute(Pn,this.role),this.ariaLabelElement.textContent=this.label,this.ariaDescriptionElement.textContent=this.description,this.navigation.setAttribute(Vt,this.navigationAriaLive),this.textHold.setAttribute(Vt,this.textAriaLive)};const bu=function(t){return!!t&&new Canvas(t)};J.Canvas=Canvas;const Su=function(t){let e=t.getAttribute(Oe),i=t.id||t.getAttribute($i),n=Ht;return e&&e!==On||(t.setAttribute(Oe,On),e=On,n=t.style.position),i||(i=ir(),t.id=i),bu({name:i,domElement:t,group:e,host:e,position:n,setInitialDimensions:!0})},Au=function(t){const e=document.querySelector(`#${t}`),i=h[t];if(i){if(null!=e.dataset.scrawlGroup)return vu(i),i;M(t)}if(e){const t=Su(e);return vu(t),t}};let Cu=null,ku=null;const vu=function(t){let e=!1;if(t)if(t.substring){const i=h[t];i&&(ku=i,e=!0)}else t.type===Wn&&(ku=t,e=!0);if(e&&ku.base){const t=k[ku.base.name];t&&(Cu=t)}},Pu=function(t=tr){const e=document.createElement(le),i=t.name?t.name:ir(),n=t.width||300,s=t.height||150;let r,a=On,l=Sn,c=t.host;c.substring&&(r=o[c],!r&&c?(c=document.querySelector(c),c&&(a=c.id)):c=r),c?c.type===hs?(a=c.name,l=Ht,c=c.domElement):or(c)||(c=document.body):c=document.body,e.id=i,e.setAttribute(Oe,a),e.width=n,e.height=s,e.style.position=l,c.appendChild(e);const h=bu({name:i,domElement:e,group:a,host:a,position:l,setInitialDimensions:!1,setAsCurrentCanvas:!gr(t.setAsCurrentCanvas)||t.setAsCurrentCanvas,trackHere:gr(t.trackHere)?t.trackHere:Nn});return delete t.group,delete t.host,delete t.name,delete t.element,delete t.position,delete t.setInitialDimensions,delete t.setAsCurrentCanvas,delete t.trackHere,h.set(t),h},Element=function(t=tr){const e=t.domElement;if(e&&!zs.includes(e.tagName)&&!e.tagName.includes("-")){this.makeName(t.name),this.register(),e&&(t.text?e.textContent=t.text:t.content&&(e.innerHTML=t.content)),this.initializePositions(),this.dimensions[0]=this.dimensions[1]=100,this.pathCorners=[],this.css={},this.here={},this.initializeDomLayout(t),this.set(this.defs),this.initializeAccessibility(),this.mimic=null,this.pivot=null,this.dirtyContent=!0,this.dirtyCss=!0,this.dirtyStampOrder=!0,this.localMouseListener=null,this.canvas=null,this.elementComputedStyles=null,this.set(t);const i=this.domElement;return i&&(i.id=this.name),this}return null},Ou=Element.prototype=Ar();Ou.type="Element",Ou.lib=Xe,Ou.isArtefact=!0,Ou.isAsset=!1,Ro(Ou),Jh(Ou),Ou.factoryKill=function(t=!0){pr(Lo,this.name),t&&this.domElement.remove()};const xu=Ou.setters;xu.text=function(t){const e=this.domElement;if(or(e)){const i=e.querySelectorAll(ve);e.textContent=t,i.forEach((t=>e.appendChild(t))),this.dirtyContent=!0}},xu.content=function(t){const e=this.domElement;if(or(e)){const i=e.querySelectorAll(ve);e.innerHTML=t,i.forEach((t=>e.appendChild(t))),this.dirtyContent=!0}},Ou.cleanDimensionsAdditionalActions=function(){this.dirtyDomDimensions=!0},Ou.addCanvas=function(t=tr){if(this.canvas)return this.canvas;{const e=document.createElement(le),i=this.domElement;e.id=`${this.name}-canvas`;const n=i.getBoundingClientRect();i.parentNode.insertBefore(e,this.domElement);const s=bu({name:`${this.name}-canvas`,domElement:e,position:Ht,width:n.width,height:n.height,mimic:this.name,lockTo:Pi,useMimicDimensions:!0,useMimicScale:!0,useMimicStart:!0,useMimicHandle:!0,useMimicOffset:!0,useMimicRotation:!0,addOwnDimensionsToMimic:!1,addOwnScaleToMimic:!1,addOwnStartToMimic:!1,addOwnHandleToMimic:!1,addOwnOffsetToMimic:!1,addOwnRotationToMimic:!1});return s.set(t),this.canvas=s,s}};const Du=function(t){return!!t&&new Element(t)};J.Element=Element;const wu="data-scrawl-stack",Stack=function(t=tr){if(t.domElement&&Gs.includes(t.domElement.tagName)){this.makeName(t.name),this.register(),this.initializePositions(),this.initializeCascade(),this.dimensions[0]=300,this.dimensions[1]=150,this.pathCorners=[],this.css={},this.here={},this.perspective={x:Zi,y:Zi,z:0},this.dirtyPerspective=!0,this.initializeDomLayout(t);const e=Gc({name:this.name,host:this.name});this.addGroups(e.name),this.set(this.defs),this.initializeDisplayShapeActions(),this.initializeAccessibility(),this.dirtyDomDimensions=!0,this.dirtyPath=!0,this.rotation=null,this.currentCornersData=null,this.currentTransformString="",this.dirtyTransform=!0,this.currentTransformOriginString="",this.dirtyTransformOrigin=!0,this.domShowRequired=!0,this.dirtyCss=!0,this.dirtyStampOrder=!0,this.localMouseListener=null,this.set(t);const i=this.domElement;if(i){i.dataset.isResponsive&&(this.isResponsive=!0),i.getAttribute(Oe)===On&&Ca(this.name)}return this}return null},Fu=Stack.prototype=Ar();Fu.type=hs,Fu.lib="stack",Fu.isArtefact=!0,Fu.isAsset=!1,Ro(Fu),Ch(Fu),Jh(Fu),cu(Fu);const Ru={position:Sn,perspective:null,trackHere:Nn,isResponsive:!1,containElementsInHeight:!1};Fu.defs=ur(Fu.defs,Ru),Fu.stringifyFunction=qs,Fu.processPacketOut=qs,Fu.finalizePacketOut=qs,Fu.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Fu.clone=Js,Fu.factoryKill=function(){const t=this.name;ka(t),pr(Lo,t),k[t]&&k[t].kill(),wt(o).forEach((e=>{e.host===t&&e.kill()})),this.domElement.remove()};const Tu=Fu.getters,Eu=Fu.setters,Hu=Fu.deltaSetters;Tu.perspectiveX=function(){return this.perspective.x},Tu.perspectiveY=function(){return this.perspective.y},Tu.perspectiveZ=function(){return this.perspective.z},Eu.perspectiveX=function(t){this.perspective.x=t,this.dirtyPerspective=!0},Eu.perspectiveY=function(t){this.perspective.y=t,this.dirtyPerspective=!0},Eu.perspectiveZ=function(t){this.perspective.z=t,this.dirtyPerspective=!0},Eu.perspective=function(t=tr){this.perspective.x=gr(t.x)?t.x:this.perspective.x,this.perspective.y=gr(t.y)?t.y:this.perspective.y,this.perspective.z=gr(t.z)?t.z:this.perspective.z,this.dirtyPerspective=!0},Hu.perspectiveX=function(t){this.perspective.x=Ws(this.perspective.x,t),this.dirtyPerspective=!0},Hu.perspectiveY=function(t){this.perspective.y=Ws(this.perspective.y,t),this.dirtyPerspective=!0},Tu.group=function(){return k[this.name]},Fu.updateArtefacts=function(t=tr){this.groupBuckets.forEach((e=>{e.artefactCalculateBuckets.forEach((e=>{t.dirtyScale&&(e.dirtyScale=!0),t.dirtyDimensions&&(e.dirtyDimensions=!0),t.dirtyLock&&(e.dirtyLock=!0),t.dirtyStart&&(e.dirtyStart=!0),t.dirtyOffset&&(e.dirtyOffset=!0),t.dirtyHandle&&(e.dirtyHandle=!0),t.dirtyRotation&&(e.dirtyRotation=!0),t.dirtyPathObject&&(e.dirtyPathObject=!0)}))}))},Fu.reset=function(){this.dirtyDimensions=!0,ya(this.name)},Fu.cleanDimensionsAdditionalActions=function(){this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0,dirtyPath:!0,dirtyStart:!0,dirtyHandle:!0}),this.dirtyDomDimensions=!0,this.dirtyPath=!0,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},Fu.cleanPerspective=function(){this.dirtyPerspective=!1;const t=this.perspective;this.domPerspectiveString=`perspective-origin: ${t.x} ${t.y}; perspective: ${t.z}px;`,this.domShowRequired=!0,this.groupBuckets&&this.updateArtefacts({dirtyHandle:!0,dirtyPathObject:!0})},Fu.checkResponsive=function(){this.isResponsive&&this.trackHere&&(this.currentVportWidth||(this.currentVportWidth=Bo.w),this.currentVportHeight||(this.currentVportHeight=Bo.h),this.dirtyHeight&&this.containElementsInHeight&&(this.dirtyHeight=!1),this.currentVportWidth!==Bo.w&&(this.currentVportWidth=Bo.w,this.containElementsInHeight&&(this.dirtyHeight=!0)),this.currentVportHeight!==Bo.h&&(this.currentVportHeight=Bo.h))},Fu.clear=function(){this.checkResponsive()},Fu.compile=function(){this.sortGroups(),this.prepareStamp(),this.stamp(),this.groupBuckets.forEach((t=>t.stamp()))},Fu.show=function(){ya()},Fu.render=function(){this.clear(),this.compile(),this.show()},Fu.addExistingDomElements=function(t){if(gr(t)){let e,i,n,s;const r=t.substring?document.querySelectorAll(t):[].concat(t);for(n=0,s=r.length;n<s;n++)e=r[n],or(e)&&(i=Du({name:e.id||e.name,domElement:e,group:this.name,host:this.name,position:Ht,setInitialDimensions:!0}),i&&i.domElement&&this.domElement.appendChild(i.domElement))}return this},Fu.addNewElement=function(t){if(t&&t.tag){t.domElement=document.createElement(t.tag),t.domElement.setAttribute(Oe,this.name),gr(t.group)||(t.group=this.name),t.host=this.name,t.position||(t.position=Ht),t.dimensions&&ut(t.dimensions)&&(t.width=t.dimensions[0]||100,t.height=t.dimensions[1]||100),gr(t.width)||(t.width=100),gr(t.height)||(t.height=100);const e=Du(t);return e&&e.domElement&&(gr(t.boxSizing)||(e.domElement.style.boxSizing=oe),this.domElement.appendChild(e.domElement)),e}return!1};const Iu=function(t){return!!t&&new Stack(t)};J.Stack=Stack;const Lu=function(t){let e=t.getAttribute(Oe),i=t.id||t.getAttribute($i),n=Ht;e||(t.setAttribute(Oe,On),e=On,n=Sn),i||(i=ir(),t.id=i);const s=Iu({name:i,domElement:t,group:e,host:e,position:n,setInitialDimensions:!0});return Bu(t,i),s},Bu=function(t,e){const i=t.getBoundingClientRect();let n,s,r,o,a=0;Array.from(t.children).forEach((t=>{null!=t.getAttribute(wu)||rr(t)||"SCRIPT"==t.tagName?t.setAttribute(Oe,e):(n=t.getBoundingClientRect(),s=rt(t),r=parseFloat(s.marginTop)+parseFloat(s.borderTopWidth)+parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)+parseFloat(s.borderBottomWidth)+parseFloat(s.marginBottom),a=a||n.top-i.top,o={name:t.id||t.getAttribute($i),domElement:t,group:e,host:e,position:Ht,width:n.width,height:n.height,startX:n.left-i.left,startY:a,classes:t.className?t.className:Ys},a+=r+n.height,Du(o))}))},$u=function(t=tr){let e,i,n,s,r,a=Ht;e=t.element&&t.element.substring?document.querySelector(t.element):or(t.element)?t.element:document.createElement(Be),t.host&&t.host.substring?(i=document.querySelector(t.host),i||(i=document.body)):i=or(t.host)?t.host:gr(e.parentElement)?e.parentElement:document.body,gr(t.width)&&(e.style.width=t.width.toFixed?`${t.width}px`:t.width),gr(t.height)&&(e.style.height=t.height.toFixed?`${t.height}px`:t.height),r=t.name||e.id||e.getAttribute($i)||Ys,r||(r=ir()),e.id=r,e.setAttribute(wu,wu),i&&null!=i.getAttribute(wu)?(n=o[i.id],s=n?n.name:On):s=On,e.setAttribute(Oe,s),s===On&&(a=Sn),e.parentElement&&i.id===e.parentElement.id||i.appendChild(e);const l=Iu({name:r,domElement:e,group:s,host:s,position:a,setInitialDimensions:!0});return Bu(e,r),Array.from(e.childNodes).forEach((t=>{var e;t.id&&(e=t.id,Sa.includes(e))&&ka(t.id)})),delete t.name,delete t.element,delete t.host,delete t.width,delete t.height,l.set(t),l},Mu=function(t){const e=document.querySelector(`#${t}`),i=T[t];if(i){if(null!=e.dataset.scrawlGroup)return i;M(t)}if(e){return Lu(e)}},Xu=function(){!function(t="[data-scrawl-stack]"){document.querySelectorAll(t).forEach((t=>Lu(t)))}(),function(t="[data-scrawl-canvas]"){let e;document.querySelectorAll(t).forEach(((t,i)=>{e=Su(t),i||vu(e)}))}(),yo(),Qo(),xr(!0),Fr(!0),Jo(),xr(!0),ca()},Yu=function(t){return t.length?t:va()},Gu=function(t,e){let i,n,s;for(i=0,n=t.length;i<n;i++)s=o[t[i]],s&&s[e]&&s[e]()},Nu=function(...t){const e=Yu(t);Gu(e,fe)},zu=function(...t){const e=Yu(t);Gu(e,"compile")},ju=function(...t){const e=Yu(t);Gu(e,"show")},Vu=function(...t){const e=Yu(t);Gu(e,"render")},RenderAnimation=function(t=tr){let e;if(this.noTarget=null!=t.noTarget&&t.noTarget,t.target||t.noTarget){if(ut(t.target)){const e=[];return t.target.forEach((i=>{const n=it({},t);n.name=`${n.name}_${i.name}`,n.target=i,e.push(new RenderAnimation(n))})),e}e=t.target&&t.target.substring?o[t.target]:t.target}else e={clear:Nu,compile:zu,show:ju,checkAccessibilityValues:qs};this.makeName(t.name),this.order=gr(t.order)?t.order:this.defs.order,this.onRun=t.onRun||qs,this.onHalt=t.onHalt||qs,this.onKill=t.onKill||qs,this.maxFrameRate=t.maxFrameRate||60,this.lastRun=0,this.chokedAnimation=!0,this.target=e,this.commence=t.commence||qs,this.afterClear=t.afterClear||qs,this.afterCompile=t.afterCompile||qs,this.afterShow=t.afterShow||qs,this.afterCreated=t.afterCreated||qs,this.readyToInitialize=!0,this.register();const i=null==t.observer||t.observer;return this.observer=null,i&&setTimeout((()=>{sr(i)?this.observer=So(this,this.target):this.observer=So(this,this.target,i)}),0),t.delay||this.run(),this},Wu=RenderAnimation.prototype=Ar();Wu.type=ls,Wu.lib=Yt,Wu.isArtefact=!1,Wu.isAsset=!1,Ro(Wu);Wu.defs=ur(Wu.defs,{order:1,maxFrameRate:60,onRun:null,onHalt:null,onKill:null,commence:null,afterClear:null,afterCompile:null,afterShow:null,afterCreated:null,target:null}),Wu.stringifyFunction=qs,Wu.processPacketOut=qs,Wu.finalizePacketOut=qs,Wu.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Wu.clone=Js,Wu.kill=function(){return this.onKill(),po(this.name),this.deregister(),!0},Wu.fn=function(){this.noTarget?(this.commence(),this.afterClear(),this.afterCompile(),this.afterShow(),this.readyToInitialize&&(this.afterCreated(this),this.readyToInitialize=!1)):this.isRunning()&&(this.commence(),this.target.clear(),this.afterClear(),this.target.compile(),this.afterCompile(),this.target.show(),this.afterShow(),this.readyToInitialize&&(this.target.checkAccessibilityValues(),this.afterCreated(this),this.readyToInitialize=!1))},Wu.run=function(){return this.onRun(),fo(this.name),this.target&&this.target.checkAccessibilityValues(),setTimeout((()=>no()),20),this},Wu.start=function(){return this.readyToInitialize=!0,this.run()},Wu.isRunning=function(){return go(this.name)},Wu.halt=function(){return this.onHalt(),po(this.name),this},Wu.updateOnce=function(){return this.isRunning()||(this.run(),setTimeout((()=>this.halt()),0)),this},Wu.updateHook=function(t="",e){switch(t){case"commence":this.commence=e||qs;break;case"afterClear":this.afterClear=e||qs;break;case"afterCompile":this.afterCompile=e||qs;break;case"afterShow":this.afterShow=e||qs;break;case"afterCreated":this.afterCreated=e||qs}};const Uu=function(t){return!!t&&new RenderAnimation(t)};J.RenderAnimation=RenderAnimation;const Zu=["width","height","zIndex","borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],Ku=["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],UnstackedElement=function(t){const e=t.id||t.name;return this.makeName(e),this.register(),t.setAttribute("data-scrawl-name",this.name),this.domElement=t,this.elementComputedStyles=rt(t),this.hostStyles={},this.canvasStartX=0,this.canvasStartY=0,this.canvasWidth=0,this.canvasHeight=0,this.canvasZIndex=0,this},_u=UnstackedElement.prototype=Ar();_u.type="UnstackedElement",_u.lib="unstackedelement",_u.isArtefact=!1,_u.isAsset=!1,Ro(_u);_u.defs=ur(_u.defs,{canvasOnTop:!1}),_u.demolish=function(){return!0},_u.addCanvas=function(t=tr){if(!this.canvas){const e=document.createElement(le),i=this.domElement,n=i.style;"static"===n.position&&(n.position=Sn),e.id=`${this.name}-canvas`,i.prepend(e);const s=bu({name:`${this.name}-canvas`,domElement:e,position:Ht});return this.canvas=s,s.set(t),this.updateCanvas(),s}},_u.checkElementStyleValues=function(){const t={},e=this.domElement,i=this.canvas;if(e&&i&&i.domElement){const n=this.hostStyles,s=this.elementComputedStyles,r=i.domElement;let{x:o,y:a,width:l,height:c}=e.getBoundingClientRect(),{x:h,y:u}=r.getBoundingClientRect(),{width:d,height:f}=s;const p=s.zIndex;let g,m,y,b,S;o=ct(o),a=ct(a),h=ct(h),u=ct(u),l=ct(l),c=ct(c),d=ct(parseFloat(d)),f=ct(parseFloat(f)),Zu.forEach((e=>{switch(e){case Ms:g=pt(d,l),this.canvasWidth!==g&&(this.canvasWidth=g,this.dirtyDimensions=!0);break;case oi:m=pt(f,c),this.canvasHeight!==m&&(this.canvasHeight=m,this.dirtyDimensions=!0);break;case"zIndex":y=p===Zt?0:parseInt(p,10),y=this.canvasOnTop?y+1:y-1,this.canvasZIndex!==y&&(this.canvasZIndex=y,this.dirtyZIndex=!0);break;default:b=n[e],S=s[e],gr(b)&&b===S||(n[e]=S,t[e]=S)}}));const A=o-h,C=a-u;(A||C)&&(this.canvasStartX+=A,this.canvasStartY+=C,this.dirtyStart=!0)}return t},_u.updateCanvas=function(){if(this.canvas&&this.canvas.domElement){const t=this.canvas,e=t.domElement.style,i=this.checkElementStyleValues();for(const[t,n]of lt(i))Ku.includes(t)&&(e[t]=n);if(this.dirtyStart&&(this.dirtyStart=!1,t.set({startX:this.canvasStartX,startY:this.canvasStartY})),this.dirtyDimensions){this.dirtyDimensions=!1;const e=this.canvasWidth,i=this.canvasHeight;t.set({width:e,height:i}),t.dirtyDimensions=!0,t.base.set({width:e,height:i}),t.base.dirtyDimensions=!0,t.cleanDimensions(),t.base.cleanDimensions()}this.dirtyZIndex&&(this.dirtyZIndex=!1,e.zIndex=this.canvasZIndex)}};J.UnstackedElement=UnstackedElement;const qu=["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"],Qu=function(t){const e=!!or(t.domElement)&&t.domElement,i=cr(t.animationHooks)?t.animationHooks:{},n=cr(t.canvasSpecs)?t.canvasSpecs:{},s=cr(t.observerSpecs)?t.observerSpecs:{},r=!sr(t.includeCanvas)||t.includeCanvas;return e&&e.id&&o[e.id]?Ju(e,n,i,s):td(e,n,i,s,r)},Ju=function(t,e,i,n){const s=o[t.id];if(!s)return!1;e.baseMatchesCanvasDimensions=!0,e.ignoreCanvasCssDimensions=!0,e.checkForResize=!0;const r=s.addCanvas(e);s.elementComputedStyles=rt(t),i.name=`${s.name}-animation`,i.target=r;const a=Uu(i),l=So(a,s,n);return{element:s,canvas:r,animation:a,demolish:()=>{l(),a.kill(),r.demolish(),s.demolish(!0)}}},td=function(t,e,i,n,s){if(!t||qu.includes(t.tagName))return{};const r=t.id;let o;var a;r&&$[r]?o=$[r]:o=!!(a=t)&&new UnstackedElement(a),e.baseMatchesCanvasDimensions=!0,e.checkForResize=!0;const l=!!s&&o.addCanvas(e);i.name=`${o.name}-animation`,l?(i.afterClear||(i.afterClear=()=>o.updateCanvas()),i.target=l):i.noTarget=!0;const c=Uu(i),h=So(c,o,n);return{element:o,canvas:l,animation:c,demolish:()=>{h(),c.kill(),l&&l.demolish(),o.demolish(!0)}}},ed=["artefact","group","animation","animationtickers","world","tween","styles","filter"];function id(t=tr){const e={order:1,ticker:Ys,targets:null,time:0,action:null,reverseOnCycleEnd:!1,reversed:!1};t.defs=ur(t.defs,e),t.kill=function(){const t=this.ticker;if(t===`${this.name}_ticker`){const e=s[t];e&&e.kill(!1)}else t&&this.removeFromTicker(t);return this.deregister(),!0};const i=t.getters,n=t.setters;i.targets=function(){return[...this.targets]},n.targets=function(t){this.setTargets(t)},n.action=function(t){this.action=t,typeof this.action!==Je&&(this.action=qs)},t.calculateEffectiveTime=function(t){const[e,i]=Zs(yr(t,this.time));if(this.effectiveTime=0,e===Vi&&i<=100){if(this.ticker){const t=s[this.ticker];t&&(this.effectiveTime=t.effectiveDuration*(i/100))}}else this.effectiveTime=i;return this},t.addToTicker=function(t){if(t&&!t.substring&&t.name&&t.type===us&&(t=t.name),gr(t)){const e=this.ticker,i=s[t];e&&e!==t&&this.removeFromTicker(e),gr(i)&&(this.ticker=t,i.subscribe(this.name),this.calculateEffectiveTime())}return this},t.removeFromTicker=function(t){if(t&&!t.substring&&t.name&&t.type===us&&(t=t.name),t||(t=this.ticker),t){const e=s[t];gr(e)&&(this.ticker=Ys,e.unsubscribe(this.name))}return this};const r=function(...t){const e=lo(),i=lo();return t.flat(1/0).forEach((t=>{if(null!=t)if(ar(t)&&ar(t.set))i.push(t);else if(t.substring&&!e.includes(t)){const n=(t=>{if(t&&t.substring){let e;return!!ed.some((i=>(e=tt[i][t],e)))&&e}return!1})(t);n&&(e.push(t),i.push(n))}else cr(t)&&ar(t.set)&&t.name&&!e.includes(t.name)&&(e.push(t.name),i.push(t))})),co(e),i};t.setTargets=function(...t){const e=r(t);this.targets.length=0,this.targets.push(...e),co(e)},t.addToTargets=function(...t){const e=r(t),i=[...this.targets],n=i.map((t=>t.name||""));e.forEach((t=>{t.name&&n.includes(t.name)||i.push(t)})),this.targets.length=0,this.targets.push(...i),co(e)},t.removeFromTargets=function(...t){const e=r(t),i=[...this.targets],n=i.map((t=>t.name||"")),s=lo(),o=lo();e.forEach((t=>{t.name?n.includes(t.name)&&s.push(t.name):o.push(t)})),this.targets.length=0,this.targets.push(...o),this.targets.push(...i.filter((t=>!!t.name&&!s.includes(t.name)))),co(e,s,o)},t.checkForTarget=function(t){return t.substring?this.targets.some((e=>e.name===t)):!!t.name&&this.targets.some((e=>e.name===t.name))},t.run=qs,t.isRunning=qs,t.halt=qs,t.reverse=qs,t.resume=qs,t.seekTo=qs,t.seekFor=qs}const Action=function(t=tr){return this.makeName(t.name),this.register(),this.targets=[],this.set(this.defs),this.action=qs,this.revert=qs,this.triggered=null,this.set(t),this.calculateEffectiveTime(),gr(t.ticker)&&this.addToTicker(t.ticker),this},nd=Action.prototype=Ar();nd.type=jn,nd.lib=Ds,nd.isArtefact=!1,nd.isAsset=!1,Ro(nd),id(nd);nd.defs=ur(nd.defs,{revert:null}),nd.packetExclusions=fr(nd.packetExclusions,["targets"]),nd.packetFunctions=fr(nd.packetFunctions,["revert","action"]),nd.finalizePacketOut=function(t){return ut(this.targets)&&(t.targets=this.targets.map((t=>t.name))),t};const sd=nd.setters;sd.revert=function(t){this.revert=t,typeof this.revert!==Je&&(this.revert=qs)},sd.triggered=function(t){this.triggered!==t&&(t?this.action():this.revert(),this.triggered=t)},nd.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==$i&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Fs&&(this[a]=l));const c=!!gr(t.ticker)&&this.ticker;c?(this.ticker=c,this.addToTicker(t.ticker)):gr(t.time)&&this.calculateEffectiveTime()}return this},nd.getEndTime=function(){return this.effectiveTime},nd.update=function(t){const{tick:e,reverseTick:i,willLoop:n}=t,{reversed:s,effectiveTime:r,triggered:o}=this;return s?i>=r?o||(this.action(),this.triggered=!0):o&&(this.revert(),this.triggered=!1):e>=r?o||(this.action(),this.triggered=!0):o&&(this.revert(),this.triggered=!1),n&&(this.triggered=!this.triggered),!0};const rd=function(t){return!!t&&new Action(t)};J.Action=Action;function od(t=tr){Wc(t),qc(t),Qc(t),Jc(t),th(t),nh(t),ah(t),Ah(t),Bc(t);const e={method:We,pathObject:null,winding:"nonzero",flipReverse:!1,flipUpend:!1,scaleOutline:!0,scaleShadow:!1,lockFillStyleToEntity:!1,lockStrokeStyleToEntity:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,onOtherInteraction:null};t.defs=ur(t.defs,e),t.packetExclusions=fr(t.packetExclusions,["state"]),t.packetFunctions=fr(t.packetFunctions,["onEnter","onLeave","onDown","onUp","onOtherInteraction"]),t.processEntityPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},t.processFactoryPacketOut=function(t,e,i){let n=!0;return i.indexOf(t)||e!==this.defs[t]||(n=!1),n},t.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=ur(t,i),t=this.handlePacketAnchor(t,e)},t.postCloneAction=function(t,e){return e.sharedState&&(t.state=this.state),t};const i=t.getters,n=t.setters;i.group=function(){return this.group?this.group.name:Ys},n.lockStylesToEntity=function(t){this.lockFillStyleToEntity=t,this.lockStrokeStyleToEntity=t},t.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return null!=n?(i=this[t],typeof i!==Fs?i:n):(n=e.defs[t],null!=n?(i=e[t],typeof i!==Fs?i:n):null)}},t.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.state,o=r?r.setters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Mn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=u)))}return this},t.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.state,o=r?r.deltaSetters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Mn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=Ws(r[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=Ws(this[h],u))))}return this},t.entityInit=function(t=tr){this.modifyConstructorInputForAnchorButton(t),this.makeName(t.name),this.register(),this.initializePositions(),this.state=Ea(tr),this.filters=[],this.currentFilters=[],this.dirtyFilters=!1,this.dirtyFiltersCache=!1,this.dirtyImageSubscribers=!1,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.set(this.defs),t.group||(t.group=Cu),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.onOtherInteraction=qs,this.set(t),this.midInitActions(t),this.purge&&this.purgeArtefact(this.purge)},t.midInitActions=qs,t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1,this.dirtyDimensions=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},t.cleanPathObject=qs,t.stamp=function(t=!1,e,i){const n=!(this.noFilters||!this.filters||!this.filters.length);return t?(e&&ii.includes(e.type)&&(this.currentHost=e),i&&this.set(i),this.prepareStamp(),n?this.filteredStamp(n):this.regularStamp()):this.visibility?this.checkHitIgnoreTransparency||this.stashOutput||n?this.filteredStamp(n):this.regularStamp():void 0},t.regularStamp=function(){const t=this.currentHost;if(t){const e=t.engine,[i,n]=this.currentStampPosition;t.rotateDestination(e,i,n,this),this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},t.filteredStamp=function(t=!1){const{dirtyFilters:e,currentHost:i,state:n}=this;!e&&this.currentFilters||this.cleanFilters();const{element:s,engine:r,currentDimensions:o}=i,a=o?o[0]:s.width,l=o?o[1]:s.height;if(a&&l){const e=el(a,l),{element:o,engine:c}=e;this.currentHost=e;const h=this.noCanvasEngineUpdates;this.noCanvasEngineUpdates=!1;const u=n?n.globalCompositeOperation:En;if(n.globalCompositeOperation=En,this.regularStamp(),n.globalCompositeOperation=u,t){const t=this.currentFilters;this.isStencil&&(c.save(),c.globalCompositeOperation=Rn,c.globalAlpha=1,c.resetTransform(),c.drawImage(s,0,0),c.restore(),this.dirtyFilterIdentifier=!0),c.resetTransform();const e=c.getImageData(0,0,a,l);this.preprocessFilters(t,a,l);const i=Ac.action({identifier:this.filterIdentifier,image:e,filters:t});i&&(c.globalCompositeOperation=En,c.globalAlpha=1,c.resetTransform(),c.putImageData(i,0,0),this.checkHitIgnoreTransparency&&(this.stashedImageData=i))}if(r.save(),r.globalAlpha=n&&n.globalAlpha?n.globalAlpha:1,r.globalCompositeOperation=n&&n.globalCompositeOperation?n.globalCompositeOperation:En,r.resetTransform(),r.drawImage(o,0,0),this.stashOutput){this.stashOutput=!1;const[t,e,i,n]=this.getCellCoverage(c.getImageData(0,0,o.width,o.height));if(this.stashedImageData=c.getImageData(t,e,i,n),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-image`;if(this.stashOutputAsAsset=!1,o.width=i,o.height=n,c.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=o.toDataURL();else{const e=this.group.currentHost.getController();if(e){const i=this,n=document.createElement(ui);n.id=t,n.alt=`A cached image of the ${this.name} ${this.type} entity`,n.onload=function(){e.canvasHold.appendChild(n),i.stashedImage=n,Tc(`#${t}`)},n.src=o.toDataURL()}}}}r.restore(),this.currentHost=i,this.noCanvasEngineUpdates=h,il(e)}},t.getCellCoverage=function(t){const{width:e,height:i,data:n}=t;let s,r,o,a,l=0,c=0,h=e,u=i,d=3;for(o=0,a=e*i;o<a;o++)n[d]&&(r=ct(o/e),s=o-r*e,h>s&&(h=s),l<s&&(l=s),u>r&&(u=r),c<r&&(c=r)),d+=4;return h<l&&u<c?[h,u,l-h,c-u]:[0,0,e,i]},t.simpleStamp=function(t,e){t&&ii.includes(t.type)&&(this.currentHost=t,e&&this.set(e),this.prepareStamp(),this.regularStamp())},t.draw=function(t){t.stroke(this.pathObject)},t.fill=function(t){t.fill(this.pathObject,this.winding)},t.drawAndFill=function(t){const e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(e),t.fill(e,this.winding)},t.fillAndDraw=function(t){const e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e)},t.drawThenFill=function(t){const e=this.pathObject;t.stroke(e),t.fill(e,this.winding)},t.fillThenDraw=function(t){const e=this.pathObject;t.fill(e,this.winding),t.stroke(e)},t.clip=function(t){t.clip(this.pathObject,this.winding)},t.clear=function(t){const e=t.globalCompositeOperation;t.globalCompositeOperation=Re,t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e},t.none=function(){}}const Block=function(t=tr){return this.entityInit(t),t.dimensions||(t.width||(this.currentDimensions[0]=this.dimensions[0]=10),t.height||(this.currentDimensions[1]=this.dimensions[1]=10)),this},ad=Block.prototype=Ar();ad.type="Block",ad.lib=je,ad.isArtefact=!0,ad.isAsset=!1,Ro(ad),od(ad),ad.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,n=this.currentDimensions,s=-e[0]*i,r=-e[1]*i,o=n[0]*i,a=n[1]*i;t.rect(s,r,o,a)}};const ld=function(t){return!!t&&new Block(t)};J.Block=Block;const cd="getBezierXY",hd="getQuadraticXY",ud=[],dd={x:0,y:0},fd=function(t,e,i){t.x=e,t.y=i},pd=function(t,e){let i=nt(t.y,t.x);i+=.01745329251*e;const n=xt(t.x*t.x+t.y*t.y);t.x=n*ot(i),t.y=n*Ot(i)},gd=function(t,e,i){let n,s,r=[],o=[],a=0;const l=[],c=[];if(t===yi){const[t,e,l,c]=i;n=l-t,s=c-e,a=xt(n*n+s*s),r=r.concat([t,l]),o=o.concat([e,c])}else if(t===qt||t===an){const h=t===qt?cd:hd;let u,d,f,p,g,m,y=!1,b=.25,S=0;for(;!y;){for(r.length=0,o.length=0,S=0,l.length=0,c.length=0,m=md[h](0,...i),u=m.x,d=m.y,r.push(u),o.push(d),g=b;g<=1;g+=b)m=md[h](g,...i),({x:f,y:p}=m),r.push(f),o.push(p),n=f-u,s=p-d,S+=xt(n*n+s*s),u=f,d=p,l.push(S),c.push(g);S<a+e&&(y=!0),a=S,b/=2,b<.004&&(y=!0)}}return{length:a,xPoints:r,yPoints:o,positions:c,progression:l}},md={[cd]:function(t,e,i,n,s,r,o,a,l){const c=1-t;return{x:At(c,3)*e+3*t*At(c,2)*n+3*t*t*c*r+t*t*t*a,y:At(c,3)*i+3*t*At(c,2)*s+3*t*t*c*o+t*t*t*l}},[hd]:function(t,e,i,n,s,r,o){const a=1-t;return{x:a*a*e+2*a*t*n+t*t*r,y:a*a*i+2*a*t*s+t*t*o}}};function yd(t=tr){od(t);const e={species:Ys,useAsPath:!1,precision:10,pathDefinition:Ys,showBoundingBox:!1,boundingBoxColor:"rgb(0 0 0 / 0.5)",minimumBoundingBoxDimensions:20};t.defs=ur(t.defs,e),t.packetExclusions=fr(t.packetExclusions,["dimensions","pathed"]),t.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=ur(t,i),t=this.handlePacketAnchor(t,e)};const i=t.setters,n=t.deltaSetters;i.species=function(t){gr(t)&&(this.species=t,this.updateDirty())},i.precision=function(t){gr(t)&&t.toFixed&&(this.precision=t,this.updateDirty())},i.width=qs,i.height=qs,i.dimensions=qs,n.width=qs,n.height=qs,n.dimensions=qs,i.pathDefinition=function(t){t.substring&&(this.pathDefinition=t),this.pathCalculatedOnce=!1,this.dirtyPathObject=!0},t.updateDirty=function(){this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},t.shapeInit=function(t){this.units=[],this.unitLengths=[],this.unitPartials=[],this.pathed=[],this.localBox=[],this.localPath=null,this.length=0,this.unitProgression=[],this.unitPositions=[],this.entityInit(t)},t.positionPointOnPath=function(t){const e=Nh(t);e.vectorSubtract(this.currentStampHandlePosition),this.flipReverse&&(e.x=-e.x),this.flipUpend&&(e.y=-e.y),e.rotate(this.roll),e.vectorAdd(this.currentStampPosition);const i={x:e.x,y:e.y};return zh(e),i},t.getBezierXY=function(t,e,i,n,s,r,o,a,l){const c=1-t;return{x:At(c,3)*e+3*t*At(c,2)*n+3*t*t*c*r+t*t*t*a,y:At(c,3)*i+3*t*At(c,2)*s+3*t*t*c*o+t*t*t*l}},t.getQuadraticXY=function(t,e,i,n,s,r,o){const a=1-t;return{x:a*a*e+2*a*t*n+t*t*r,y:a*a*i+2*a*t*s+t*t*o}},t.getLinearXY=function(t,e,i,n,s){return{x:e+(n-e)*t,y:i+(s-i)*t}},t.getBezierAngle=function(t,e,i,n,s,r,o,a,l){const c=1-t,h=At(c,2)*(n-e)+2*t*c*(r-n)+t*t*(a-r),u=At(c,2)*(s-i)+2*t*c*(o-s)+t*t*(l-o);return(-nt(h,u)+St)/Ct},t.getQuadraticAngle=function(t,e,i,n,s,r,o){const a=1-t;return(-nt(2*a*(n-e)+2*t*(r-n),2*a*(s-i)+2*t*(o-s))+St)/Ct},t.getLinearAngle=function(t,e,i,n,s){return(-nt(n-e,s-i)+St)/Ct},t.getConstantPosition=function(t){if(!dt(t))return 0;if(t>=1)return.9999;const{unitPositions:e,unitProgression:i,length:n}=this;if(e&&e.length){const s=e.length;let r,o=0,a=0,l=0;for(let c=0;c<s;c++)r=i[c]/n,t>r&&(a=e[c],l=r,o++);const c=o?t-l:t,h=o?(i[o]-i[o-1])/n:i[o]/n;return a+=c*((o?e[o]-e[o-1]:e[o])/h),a}return t},t.buildPathPositionObject=function(t,e){if(t){const[i,...n]=t;let s,r;switch(i){case yi:s=this.positionPointOnPath(this.getLinearXY(e,...n)),r=this.getLinearAngle(e,...n);break;case an:s=this.positionPointOnPath(this.getQuadraticXY(e,...n)),r=this.getQuadraticAngle(e,...n);break;case qt:s=this.positionPointOnPath(this.getBezierXY(e,...n)),r=this.getBezierAngle(e,...n)}let o=0;return this.flipReverse&&o++,this.flipUpend&&o++,1===o&&(r=-r),r+=this.roll,s.angle=r,s}return!1},t.getPathPositionData=function(t,e=!1){if(this.useAsPath&&gr(t)&&t.toFixed){const i=this.unitPartials;let n,s,r,o,a,l,c=0,h=t%1;for(0===t?h=0:1===t&&(h=.9999),e&&(h=this.getConstantPosition(h)),r=0,o=i.length;r<o;r++)if(l=this.units[r][0],l!==Li&&l!==me&&l!==Rs){if(n=i[r],h<=n){a=this.units[r],s=(h-c)/(n-c);break}c=n}return this.buildPathPositionObject(a,s)}return!1},t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyHandle)&&(this.dirtyPathObject=!0,(this.dirtyScale||this.dirtySpecies)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},t.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0},t.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.dirtyDimensions&&(this.cleanSpecies(),this.pathCalculatedOnce=!1),this.calculateLocalPath(this.pathDefinition),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyHandle&&this.cleanHandle(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions();const t=this.currentStampHandlePosition;this.pathObject=new Path2D(`m${-t[0]},${-t[1]}${this.localPath}`)}},t.calculateLocalPath=function(t,e){let i;if(this.pathCalculatedOnce||(i=((t,e,i,n,s,r)=>{const o=lo(),a=lo(),l=lo(),c=lo(),h=r.units,u=r.unitLengths,d=r.unitPartials,f=r.unitProgression,p=r.unitPositions,g=t.match(/([A-Za-z][0-9. ,-]*)/g),m=/(-?[0-9.]+\b)/g;let y,b,S,A,C,k=Ys,v=Ys,P=0,O=0,x=0,D=0,w=0,F=0,R=0;const T=t=>{a.push({c:k.toLowerCase(),p:t||null,x:D,y:w,cx:O,cy:x,rx:F,ry:R}),n||(l.push(O),c.push(x)),D=O,w=x};for(y=0,b=g.length;y<b;y++)if(k=g[y][0],o.length=0,C=g[y].match(m),C&&o.push(...C),o.length){for(S=0,A=o.length;S<A;S++)o[S]=parseFloat(o[S]);switch(0===y?"M"===k&&(D=o[0]*e-i.x,w=o[1]*e-i.y,k="m"):(D=O,w=x),k){case"H":for(S=0,A=o.length;S<A;S++)o[S]=o[S]*e-D,O+=o[S],F=R=0,T(o.slice(S,S+1));break;case"V":for(S=0,A=o.length;S<A;S++)o[S]=o[S]*e-w,x+=o[S],F=R=0,T(o.slice(S,S+1));break;case"M":for(S=0,A=o.length;S<A;S+=2)o[S]=o[S]*e-D,o[S+1]=o[S+1]*e-w,O+=o[S],x+=o[S+1],F=R=0,T(o.slice(S,S+2));break;case"L":case"T":for(S=0,A=o.length;S<A;S+=2)o[S]=o[S]*e-D,o[S+1]=o[S+1]*e-w,O+=o[S],x+=o[S+1],"T"===k?(F=o[S]+D,R=o[S+1]+w):F=R=0,T(o.slice(S,S+2));break;case"Q":case"S":for(S=0,A=o.length;S<A;S+=4)o[S]=o[S]*e-D,o[S+1]=o[S+1]*e-w,o[S+2]=o[S+2]*e-D,o[S+3]=o[S+3]*e-w,O+=o[S+2],x+=o[S+3],F=o[S]+D,R=o[S+1]+w,T(o.slice(S,S+4));break;case"C":for(S=0,A=o.length;S<A;S+=6)o[S]=o[S]*e-D,o[S+1]=o[S+1]*e-w,o[S+2]=o[S+2]*e-D,o[S+3]=o[S+3]*e-w,o[S+4]=o[S+4]*e-D,o[S+5]=o[S+5]*e-w,O+=o[S+4],x+=o[S+5],F=o[S+2]+D,R=o[S+3]+w,T(o.slice(S,S+6));break;case"A":for(S=0,A=o.length;S<A;S+=7)o[S+5]=o[S+5]*e-D,o[S+6]=o[S+6]*e-w,O+=o[S+5],x+=o[S+6],F=R=0,T(o.slice(S,S+7));break;case"h":for(S=0,A=o.length;S<A;S++)o[S]*=e,O+=o[S],F=R=0,T(o.slice(S,S+1));break;case"v":for(S=0,A=o.length;S<A;S++)o[S]*=e,x+=o[S],F=R=0,T(o.slice(S,S+1));break;case"m":case"l":case"t":for(S=0,A=o.length;S<A;S+=2)o[S]*=e,o[S+1]*=e,O+=o[S],x+=o[S+1],"t"===k?(F=o[S]+D,R=o[S+1]+w):F=R=0,T(o.slice(S,S+2));break;case"q":case"s":for(S=0,A=o.length;S<A;S+=4)o[S]*=e,o[S+1]*=e,o[S+2]*=e,o[S+3]*=e,O+=o[S+2],x+=o[S+3],F=o[S]+D,R=o[S+1]+w,T(o.slice(S,S+4));break;case"c":for(S=0,A=o.length;S<A;S+=6)o[S]*=e,o[S+1]*=e,o[S+2]*=e,o[S+3]*=e,o[S+4]*=e,o[S+5]*=e,O+=o[S+4],x+=o[S+5],F=o[S+2]+D,R=o[S+3]+w,T(o.slice(S,S+6));break;case"a":for(S=0,A=o.length;S<A;S+=7)o[S]*=e,o[S+1]*=e,o[S+5]*=e,o[S+6]*=e,O+=o[S+5],x+=o[S+6],F=R=0,T(o.slice(S,S+7))}}else F=R=0,T();for(y=0,b=a.length;y<b;y++){const t=a[y];v+=t.p?`${t.c}${t.p.join()}`:`${t.c}`}if(r.localPath=v,n){const t=dd;let e,i,n,r,o,g,m,S;for(y=0,b=a.length;y<b;y++)if(e=a[y],i=y>0&&a[y-1],({c:n,p:r,x:o,y:g,cx:m,cy:S}=e),r)switch(n){case"h":h[y]=[yi,o,g,r[0]+o,g];break;case"v":h[y]=[yi,o,g,o,r[0]+g];break;case"m":h[y]=[Li,o,g];break;case"l":h[y]=[yi,o,g,r[0]+o,r[1]+g];break;case"t":i&&(i.rx||i.ry)?(fd(t,i.rx-m,i.ry-S),pd(t,180),h[y]=[an,o,g,t.x+m,t.y+S,r[0]+o,r[1]+g]):h[y]=[an,o,g,o,g,r[0]+o,r[1]+g];break;case"q":h[y]=[an,o,g,r[0]+o,r[1]+g,r[2]+o,r[3]+g];break;case"s":i&&(i.rx||i.ry)?(fd(t,i.rx-m,i.ry-S),pd(t,180),h[y]=[qt,o,g,t.x+m,t.y+S,r[0]+o,r[1]+g,r[2]+o,r[3]+g]):h[y]=[qt,o,g,o,g,r[0]+o,r[1]+g,r[2]+o,r[3]+g];break;case"c":h[y]=[qt,o,g,r[0]+o,r[1]+g,r[2]+o,r[3]+g,r[4]+o,r[5]+g];break;case"a":h[y]=[yi,o,g,r[5]+o,r[6]+g];break;case"z":dt(o)||(o=0),dt(g)||(g=0),h[y]=[me,o,g];break;default:dt(o)||(o=0),dt(g)||(g=0),h[y]=[Rs,o,g]}else h[y]=[`no-points-${n}`,o,g];for(y=0,b=h.length;y<b;y++){const[t,...e]=h[y];let i;switch(t){case yi:case an:case qt:i=gd(t,s,e),u[y]=i.length,l.push(...i.xPoints),c.push(...i.yPoints),f.push(i.progression),p.push(i.positions);break;default:u[y]=0}}P=u.reduce(((t,e)=>t+e),0);let A=0;for(y=0,b=u.length;y<b;y++)A+=u[y]/P,d[y]=A}return r.length=P,r.maxX=pt(...l),r.maxY=pt(...c),r.minX=gt(...l),r.minY=gt(...c),r.xRange.push(...l),r.yRange.push(...c),co(o,a,l,c),r})(t,this.currentScale,this.currentStart,this.useAsPath,this.precision,(ud.length||ud.push({localPath:null,length:0,maxX:0,maxY:0,minX:0,minY:0,unitLengths:[],unitPartials:[],units:[],unitPositions:[],unitProgression:[],xRange:[],yRange:[]}),ud.shift())),this.pathCalculatedOnce=!0),i){this.localPath=i.localPath,this.length=i.length;const t=i.maxX,s=i.maxY,r=i.minX,o=i.minY,a=this.dimensions,l=this.currentDimensions,c=this.localBox;if(a[0]=t-r,a[1]=s-o,a[0]===l[0]&&a[1]===l[1]||(l[0]=a[0],l[1]=a[1],this.dirtyHandle=!0),c.length=0,c.push(r,o,a[0],a[1]),this.useAsPath){const{units:t,unitLengths:e,unitPartials:n,unitProgression:s,unitPositions:r}=i,o=lo(),a=lo();let l,c,h,u,d,f,p,g,m,y,b=0;for(d=0,f=e.length;d<f;d++)if(b+=e[d],h=s[d],h)for(c=n[d],l=n[d+1]-c,u=r[d],p=0,g=h.length;p<g;p++)m=b+h[p],o.push(m),y=c+u[p]*l,a.push(y);this.units.length=0,this.units.push(...t),this.unitLengths.length=0,this.unitLengths.push(...e),this.unitPartials.length=0,this.unitPartials.push(...n),this.unitProgression||(this.unitProgression=[]),this.unitProgression.length=0,this.unitProgression.push(...o),this.unitPositions||(this.unitPositions=[]),this.unitPositions.length=0,this.unitPositions.push(...a),co(o,a)}(n=i).localPath=null,n.length=0,n.units.length=0,n.maxX=0,n.maxY=0,n.minX=0,n.minY=0,n.unitLengths.length=0,n.unitPartials.length=0,n.unitPositions.length=0,n.unitProgression.length=0,n.xRange.length=0,n.yRange.length=0,ud.push(n),e||this.calculateLocalPathAdditionalActions()}var n},t.calculateLocalPathAdditionalActions=qs,t.updatePathSubscribers=function(){let t;this.pathed.forEach((e=>{t=o[e],t&&(t.currentPathData=!1,t.dirtyStart=!0,t.addPathHandle&&(t.dirtyHandle=!0),t.addPathOffset&&(t.dirtyOffset=!0),t.addPathRotation&&(t.dirtyRotation=!0),t.type===rs?t.dirtyPins=!0:t.type!==es&&t.type!==os&&t.type!==Vn||t.dirtyPins.push(this.name))}),this)},t.draw=function(t){t.stroke(this.pathObject),this.showBoundingBox&&this.drawBoundingBox(t)},t.fill=function(t){t.fill(this.pathObject,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.drawAndFill=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.fillAndDraw=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e),this.showBoundingBox&&this.drawBoundingBox(t)},t.drawThenFill=function(t){const e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.fillThenDraw=function(t){const e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.showBoundingBox&&this.drawBoundingBox(t)},t.clear=function(t){const e=t.globalCompositeOperation;t.globalCompositeOperation=Re,t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e,this.showBoundingBox&&this.drawBoundingBox(t)},t.drawBoundingBox=function(t){t.save(),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation=En,t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.strokeRect(...this.getBoundingBox()),t.restore()},t.getBoundingBox=function(){const t=this.minimumBoundingBoxDimensions;let[e,i,n,s]=this.localBox;const[r,o]=this.currentStampHandlePosition,[a,l]=this.currentStampPosition;return n<t&&(n=t),s<t&&(s=t),[ct(e-r),ct(i-o),st(n),st(s),a,l]}}const bd=t=>t.substring?t.charAt(0).toUpperCase()+t.slice(1):Ys;function Sd(t=tr){const e={end:null,endPivot:Ys,endPivotCorner:Ys,endPivotIndex:-1,addEndPivotHandle:!1,addEndPivotOffset:!1,endPath:Ys,endPathPosition:0,addEndPathHandle:!1,addEndPathOffset:!0,endParticle:Ys,endLockTo:Ys,useStartAsControlPoint:!1};t.defs=ur(t.defs,e),t.packetExclusions=fr(t.packetExclusions,["controlledLineOffset"]),t.packetCoordinates=fr(t.packetCoordinates,["end"]),t.packetObjects=fr(t.packetObjects,["endPivot","endPath"]),t.factoryKill=function(){wt(o).forEach((t=>{t.name!==this.name&&(t.startControlPivot&&t.startControlPivot.name===this.name&&t.set({startControlPivot:!1}),t.controlPivot&&t.controlPivot.name===this.name&&t.set({controlPivot:!1}),t.endControlPivot&&t.endControlPivot.name===this.name&&t.set({endControlPivot:!1}),t.endPivot&&t.endPivot.name===this.name&&t.set({endPivot:!1}),t.startControlPath&&t.startControlPath.name===this.name&&t.set({startControlPath:!1}),t.controlPath&&t.controlPath.name===this.name&&t.set({controlPath:!1}),t.endControlPath&&t.endControlPath.name===this.name&&t.set({endControlPath:!1}),t.endPath&&t.endPath.name===this.name&&t.set({endPath:!1}))}))};const i=t.getters,n=t.setters,s=t.deltaSetters;n.useStartAsControlPoint=function(t){if(this.useStartAsControlPoint=t,!t){const t=this.controlledLineOffset;t[0]=0,t[1]=0}this.updateDirty()},n.endPivot=function(t){this.setControlHelper(t,"endPivot",Ge),this.updateDirty(),this.dirtyEnd=!0},n.endParticle=function(t){this.setControlHelper(t,"endParticle",Ge),this.updateDirty(),this.dirtyEnd=!0},n.endPath=function(t){this.setControlHelper(t,"endPath",Ge),this.updateDirty(),this.dirtyEnd=!0},n.endPathPosition=function(t){this.endPathPosition=t,this.dirtyEnd=!0,this.currentEndPathData=!1,this.dirtyFilterIdentifier=!0},s.endPathPosition=function(t){this.endPathPosition+=t,this.dirtyEnd=!0,this.currentEndPathData=!1,this.dirtyFilterIdentifier=!0},i.endPositionX=function(){return this.currentEnd[0]},i.endPositionY=function(){return this.currentEnd[1]},i.endPosition=function(){return[].concat(this.currentEnd)},n.endX=function(t){null!=t&&(this.end[0]=t,this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1)},n.endY=function(t){null!=t&&(this.end[1]=t,this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1)},n.end=function(t,e){this.setCoordinateHelper(Ge,t,e),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.endX=function(t){const e=this.end;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.endY=function(t){const e=this.end;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.end=function(t,e){this.setDeltaCoordinateHelper(Ge,t,e),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},n.endLockTo=function(t){this.endLockTo=t,this.updateDirty(),this.dirtyEndLock=!0,this.currentEndPathData=!1},t.curveInit=function(){this.end=al(),this.currentEnd=al(),this.endLockTo=Ce,this.dirtyEnd=!0,this.dirtyPins=[],this.controlledLineOffset=al()},t.setControlHelper=function(t,e,i){if(sr(t)&&!t)this[e]=null,i===Bn?this.dirtyStartControlLock=!0:i===Ae?this.dirtyControlLock=!0:i===Ne?this.dirtyEndControlLock=!0:this.dirtyEndLock=!0;else if(t){const n=this[e];let s=t.substring?o[t]:t;e.includes("Pivot")?s&&s.isArtefact&&(n&&n.isArtefact&&pr(n.pivoted,this.name),fr(s.pivoted,this.name),this[e]=s):e.includes("Path")?s&&s.isArtefact&&(n&&n.isArtefact&&pr(n.pathed,this.name),fr(s.pathed,this.name),this[e]=s):e.includes(ns)&&(s=t.substring?P[t]:t,s||(this.updateDirty(),i===Bn?this.dirtyStartControl=!0:i===Ae?this.dirtyControl=!0:i===Ne?this.dirtyEndControl=!0:this.dirtyEnd=!0,this[e]=t))}},t.buildPathPositionObject=function(t,e){if(t){const[i,...n]=t;let s,r;switch(i){case yi:s=this.positionPointOnPath(this.getLinearXY(e,...n)),r=this.getLinearAngle(e,...n);break;case an:s=this.positionPointOnPath(this.getQuadraticXY(e,...n)),r=this.getQuadraticAngle(e,...n);break;case qt:s=this.positionPointOnPath(this.getBezierXY(e,...n)),r=this.getBezierAngle(e,...n)}let o=0;this.flipReverse&&o++,this.flipUpend&&o++,1===o&&(r=-r),r+=this.roll;const a=this.controlledLineOffset;return s.x+=a[0],s.y+=a[1],s.angle=r,s}return!1},t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),this.dirtyPins.length&&this.preparePinsForStamp(),this.dirtyLock&&this.cleanLock(),this.dirtyStartControlLock&&this.cleanControlLock(Bn),this.dirtyEndControlLock&&this.cleanControlLock(Ne),this.dirtyControlLock&&this.cleanControlLock(Ae),this.dirtyEndLock&&this.cleanControlLock(Ge),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyStartControl||this.dirtyEndControl||this.dirtyControl||this.dirtyEnd||this.dirtyHandle)&&(this.dirtyPathObject=!0,this.useStartAsControlPoint&&this.dirtyStart&&(this.dirtySpecies=!0,this.pathCalculatedOnce=!1),(this.dirtyScale||this.dirtySpecies||this.dirtyStartControl||this.dirtyEndControl||this.dirtyControl||this.dirtyEnd)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.useStartAsControlPoint&&(this.dirtySpecies=!0,this.dirtyPathObject=!0,this.pathCalculatedOnce=!1)),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),(this.dirtyStartControl||this.startControlLockTo===zi)&&this.cleanControl(Bn),(this.dirtyEndControl||this.endControlLockTo===zi)&&this.cleanControl(Ne),(this.dirtyControl||this.controlLockTo===zi)&&this.cleanControl(Ae),(this.dirtyEnd||this.endLockTo===zi)&&this.cleanControl(Ge),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&(this.updatePositionSubscribers(),this.updateControlPathSubscribers()),this.prepareStampTabsHelper()},t.cleanControlLock=function(t){const e=bd(t);this[`dirty${e}Lock`]=!1,this[`dirty${e}`]=!0},t.cleanControl=function(t){const e=bd(t);this[`dirty${e}`]=!1;let i,n,s=this[`${t}Pivot`],r=this[`${t}Path`],a=this[`${t}Particle`];s&&s.substring&&(i=o[s],i&&(s=i)),r&&r.substring&&(i=o[r],i&&(r=i)),a&&a.substring&&(i=P[a],i&&(a=i));let l,c,h,u,d,f,p,g=this[`${t}LockTo`];const m=this[t],y=this[`current${e}`];switch((g!==_i||s&&!s.substring)&&(g!==ji||r&&!r.substring)&&(g!==zi||a&&!a.substring)||(g=Ce),g){case _i:if(this.pivotCorner&&s.getCornerCoordinate)[l,c]=s.getCornerCoordinate(this[`${t}PivotCorner`]);else if(s.type===_n)if(this[`${t}PivotIndex`]<0)s.layoutTemplate?[l,c]=s.layoutTemplate.currentStampPosition:this[`dirty${e}`]=!0;else{const i=s.getUnitStartAt(this[`${t}PivotIndex`]);i?[l,c]=i:this[`dirty${e}`]=!0}else[l,c]=s.currentStampPosition;this.addPivotOffset||([h,u]=s.currentOffset,l-=h,c-=u);break;case ji:n=this.getControlPathData(r,t,e),l=n.x,c=n.y,this.addPathOffset||(l-=r.currentOffset[0],c-=r.currentOffset[1]);break;case zi:l=a.position.x,c=a.position.y,this.pathCalculatedOnce=!1;break;case Fi:d=this.getHere(),l=d.x||0,c=d.y||0;break;default:l=c=0,f=this.getHost(),f&&(p=f.currentDimensions,p&&(this.cleanPosition(y,m,p),[l,c]=y))}y[0]=l,y[1]=c,this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyPositionSubscribers=!0},t.getControlPathData=function(t,e,i){const n=this[`current${i}PathData`];if(n)return n;let s=this[`${e}PathPosition`];const r=s,o=t.getPathPositionData(s);if(s<0&&(s+=1),s>1&&(s%=1),s=parseFloat(s.toFixed(6)),s!==r&&(this[`${e}PathPosition`]=s),o)return this[`current${i}PathData`]=o,o;{const t=this.getHost();if(t){const n=t.currentDimensions;if(n){const t=this[`current${i}`];return this.cleanPosition(t,this[e],n),{x:t[0],y:t[1]}}}return{x:0,y:0}}},t.updateControlPathSubscribers=function(){let t;[].concat(this.endSubscriber,this.endControlSubscriber,this.controlSubscriber,this.startControlSubscriber).forEach((e=>{t=o[e],t&&(t.type!==es&&t.type!==os&&t.type!==Vn||(t.type===os?(t.dirtyControl=!0,t.currentControlPathData=!1):t.type===Vn&&(t.dirtyStartControl=!0,t.dirtyEndControl=!0,t.currentStartControlPathData=!1,t.currentEndControlPathData=!1),t.currentEndPathData=!1,t.dirtyEnd=!0),t.currentPathData=!1,t.dirtyStart=!0)}))}}const Bezier=function(t=tr){return this.startControl=al(),this.endControl=al(),this.currentStartControl=al(),this.currentEndControl=al(),this.startControlLockTo=Ce,this.endControlLockTo=Ce,this.curveInit(t),this.shapeInit(t),this.dirtyStartControl=!0,this.dirtyEndControl=!0,this},Ad=Bezier.prototype=Ar();Ad.type=Vn,Ad.lib=je,Ad.isArtefact=!0,Ad.isAsset=!1,Ro(Ad),yd(Ad),Sd(Ad);const Cd={startControl:null,startControlPivot:Ys,startControlPivotIndex:-1,startControlPivotCorner:Ys,addStartControlPivotHandle:!1,addStartControlPivotOffset:!1,startControlPath:Ys,startControlPathPosition:0,addStartControlPathHandle:!1,addStartControlPathOffset:!0,startControlParticle:Ys,endControl:null,endControlPivot:Ys,endControlPivotIndex:-1,endControlPivotCorner:Ys,addEndControlPivotHandle:!1,addEndControlPivotOffset:!1,endControlPath:Ys,endControlPathPosition:0,addEndControlPathHandle:!1,addEndControlPathOffset:!0,endControlParticle:Ys,startControlLockTo:Ys,endControlLockTo:Ys};Ad.defs=ur(Ad.defs,Cd),Ad.packetCoordinates=fr(Ad.packetCoordinates,["startControl","endControl"]),Ad.packetObjects=fr(Ad.packetObjects,["startControlPivot","startControlParticle","startControlPath","endControlPivot","endControlParticle","endControlPath"]);const kd=Ad.getters,vd=Ad.setters,Pd=Ad.deltaSetters;vd.endControlPivot=function(t){this.setControlHelper(t,"endControlPivot",Ne),this.updateDirty(),this.dirtyEndControl=!0},vd.endControlParticle=function(t){this.setControlHelper(t,"endControlParticle",Ne),this.updateDirty(),this.dirtyEndControl=!0},vd.endControlPath=function(t){this.setControlHelper(t,"endControlPath",Ne),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},vd.endControlPathPosition=function(t){this.endControlPathPosition=t,this.dirtyEndControl=!0,this.currentEndControlPathData=!1,this.dirtyFilterIdentifier=!0},Pd.endControlPathPosition=function(t){this.endControlPathPosition+=t,this.dirtyEndControl=!0,this.currentEndControlPathData=!1,this.dirtyFilterIdentifier=!0},vd.startControlPivot=function(t){this.setControlHelper(t,"startControlPivot",Bn),this.updateDirty(),this.dirtyStartControl=!0},vd.startControlParticle=function(t){this.setControlHelper(t,"startControlParticle",Bn),this.updateDirty(),this.dirtyStartControl=!0},vd.startControlPath=function(t){this.setControlHelper(t,"startControlPath",Bn),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},vd.startControlPathPosition=function(t){this.startControlPathPosition=t,this.dirtyStartControl=!0,this.currentStartControlPathData=!1,this.dirtyFilterIdentifier=!0},Pd.startControlPathPosition=function(t){this.startControlPathPosition+=t,this.dirtyStartControl=!0,this.currentStartControlPathData=!1,this.dirtyFilterIdentifier=!0},kd.startControlPositionX=function(){return this.currentStartControl[0]},kd.startControlPositionY=function(){return this.currentStartControl[1]},kd.startControlPosition=function(){return[].concat(this.currentStartControl)},vd.startControlX=function(t){null!=t&&(this.startControl[0]=t,this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1)},vd.startControlY=function(t){null!=t&&(this.startControl[1]=t,this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1)},vd.startControl=function(t,e){this.setCoordinateHelper(Bn,t,e),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},Pd.startControlX=function(t){const e=this.startControl;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},Pd.startControlY=function(t){const e=this.startControl;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},Pd.startControl=function(t,e){this.setDeltaCoordinateHelper(Bn,t,e),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},kd.endControlPositionX=function(){return this.currentEndControl[0]},kd.endControlPositionY=function(){return this.currentEndControl[1]},kd.endControlPosition=function(){return[].concat(this.currentEndControl)},vd.endControlX=function(t){null!=t&&(this.endControl[0]=t,this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1)},vd.endControlY=function(t){null!=t&&(this.endControl[1]=t,this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1)},vd.endControl=function(t,e){this.setCoordinateHelper(Ne,t,e),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},Pd.endControlX=function(t){const e=this.endControl;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},Pd.endControlY=function(t){const e=this.endControl;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},Pd.endControl=function(t,e){this.setDeltaCoordinateHelper(Ne,t,e),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},vd.startControlLockTo=function(t){this.startControlLockTo=t,this.updateDirty(),this.dirtyStartControlLock=!0},vd.endControlLockTo=function(t){this.endControlLockTo=t,this.updateDirty(),this.dirtyEndControlLock=!0,this.currentEndControlPathData=!1},Ad.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeBezierPath()},Ad.makeBezierPath=function(){const[t,e]=this.currentStampPosition,[i,n]=this.currentStartControl,[s,r]=this.currentEndControl,[o,a]=this.currentEnd;return`m0,0c${(i-t).toFixed(2)},${(n-e).toFixed(2)} ${(s-t).toFixed(2)},${(r-e).toFixed(2)} ${(o-t).toFixed(2)},${(a-e).toFixed(2)}`},Ad.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyStartControl=!0,this.dirtyEndControl=!0,this.dirtyEnd=!0,this.dirtyFilterIdentifier=!0},Ad.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath,n=this.startControlPivot,s=this.startControlPath,r=this.endControlPivot,o=this.endControlPath;for(let a,l=0,c=t.length;l<c;l++)a=t[l],(n&&n.name===a||s&&s.name===a)&&(this.dirtyStartControl=!0,this.startControlLockTo.includes(ji)&&(this.currentStartControlPathData=!1)),(r&&r.name===a||o&&o.name===a)&&(this.dirtyEndControl=!0,this.endControlLockTo.includes(ji)&&(this.currentEndControlPathData=!1)),(e&&e.name===a||i&&i.name===a)&&(this.dirtyEnd=!0,this.endLockTo.includes(ji)&&(this.currentEndPathData=!1));t.length=0};const Od=function(t=tr){return!!t&&(t.species=qt,new Bezier(t))};J.Bezier=Bezier;const xd=["line","quadratic","bezier"],Cog=function(t=tr){return this.shapeInit(t),this},Dd=Cog.prototype=Ar();Dd.type="Cog",Dd.lib=je,Dd.isArtefact=!0,Dd.isAsset=!1,Ro(Dd),yd(Dd);const wd={outerRadius:0,innerRadius:0,outerControlsDistance:0,innerControlsDistance:0,outerControlsOffset:0,innerControlsOffset:0,points:0,twist:0,curve:qt};Dd.defs=ur(Dd.defs,wd);const Fd=Dd.setters,Rd=Dd.deltaSetters;Fd.outerRadius=function(t){this.outerRadius=t,this.updateDirty()},Rd.outerRadius=function(t){this.outerRadius+=t,this.updateDirty()},Fd.innerRadius=function(t){this.innerRadius=t,this.updateDirty()},Rd.innerRadius=function(t){this.innerRadius+=t,this.updateDirty()},Fd.outerControlsDistance=function(t){this.outerControlsDistance=t,this.updateDirty()},Rd.outerControlsDistance=function(t){this.outerControlsDistance+=t,this.updateDirty()},Fd.innerControlsDistance=function(t){this.innerControlsDistance=t,this.updateDirty()},Rd.innerControlsDistance=function(t){this.innerControlsDistance+=t,this.updateDirty()},Fd.outerControlsOffset=function(t){this.outerControlsOffset=t,this.updateDirty()},Rd.outerControlsOffset=function(t){this.outerControlsOffset+=t,this.updateDirty()},Fd.innerControlsOffset=function(t){this.innerControlsOffset=t,this.updateDirty()},Rd.innerControlsOffset=function(t){this.innerControlsOffset+=t,this.updateDirty()},Fd.points=function(t){this.points=t,this.updateDirty()},Rd.points=function(t){this.points+=t,this.updateDirty()},Fd.twist=function(t){this.twist=t,this.updateDirty()},Rd.twist=function(t){this.twist+=t,this.updateDirty()},Fd.curve=function(t){t&&xd.includes(t)?this.curve=t:this.curve=qt,this.updateDirty()},Dd.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeCogPath()},Dd.makeCogPath=function(){const{points:t,twist:e,curve:i}=this;let{outerRadius:n,innerRadius:s,outerControlsDistance:r,innerControlsDistance:o,outerControlsOffset:a,innerControlsOffset:l}=this;const c=360/t;let h,u,d,f,p,g=Ys;if(n.substring||s.substring||r.substring||o.substring||a.substring||l.substring){const t=this.getHost();if(t){const[e]=t.currentDimensions;n=n.substring?parseFloat(n)/100*e:n,s=s.substring?parseFloat(s)/100*e:s,r=r.substring?parseFloat(r)/100*e:r,o=o.substring?parseFloat(o)/100*e:o,a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*e:l}}const m=Nh({x:0,y:-n}),y=Nh({x:0,y:-s}),b=Nh({x:r+a,y:-n}),S=Nh({x:-o+l,y:-s}),A=Nh({x:o+l,y:-s}),C=Nh({x:-r+a,y:-n});if(S.rotate(-c/2),S.rotate(e),y.rotate(-c/2),y.rotate(e),A.rotate(-c/2),A.rotate(e),h=m.x,u=m.y,i===qt)for(p=0;p<t;p++)d=parseFloat((b.x-h).toFixed(1)),f=parseFloat((b.y-u).toFixed(1)),g+=`${d},${f} `,S.rotate(c),y.rotate(c),A.rotate(c),d=parseFloat((S.x-h).toFixed(1)),f=parseFloat((S.y-u).toFixed(1)),g+=`${d},${f} `,d=parseFloat((y.x-h).toFixed(1)),h+=d,f=parseFloat((y.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((A.x-h).toFixed(1)),f=parseFloat((A.y-u).toFixed(1)),g+=`${d},${f} `,C.rotate(c),m.rotate(c),b.rotate(c),d=parseFloat((C.x-h).toFixed(1)),f=parseFloat((C.y-u).toFixed(1)),g+=`${d},${f} `,d=parseFloat((m.x-h).toFixed(1)),h+=d,f=parseFloat((m.y-u).toFixed(1)),u+=f,g+=`${d},${f} `;else if(i===an)for(p=0;p<t;p++)d=parseFloat((b.x-h).toFixed(1)),f=parseFloat((b.y-u).toFixed(1)),g+=`${d},${f} `,y.rotate(c),A.rotate(c),d=parseFloat((y.x-h).toFixed(1)),h+=d,f=parseFloat((y.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((A.x-h).toFixed(1)),f=parseFloat((A.y-u).toFixed(1)),g+=`${d},${f} `,m.rotate(c),b.rotate(c),d=parseFloat((m.x-h).toFixed(1)),h+=d,f=parseFloat((m.y-u).toFixed(1)),u+=f,g+=`${d},${f} `;else for(p=0;p<t;p++)d=parseFloat((b.x-h).toFixed(1)),h+=d,f=parseFloat((b.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,S.rotate(c),y.rotate(c),A.rotate(c),d=parseFloat((S.x-h).toFixed(1)),h+=d,f=parseFloat((S.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((y.x-h).toFixed(1)),h+=d,f=parseFloat((y.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((A.x-h).toFixed(1)),h+=d,f=parseFloat((A.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,C.rotate(c),m.rotate(c),b.rotate(c),d=parseFloat((C.x-h).toFixed(1)),h+=d,f=parseFloat((C.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((m.x-h).toFixed(1)),h+=d,f=parseFloat((m.y-u).toFixed(1)),u+=f,g+=`${d},${f} `;return zh(m,b,C,y,A,S),i===qt?`${Xs}c${g}z`:i===an?`${Xs}q${g}z`:`${Xs}l${g}z`},Dd.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(Xs,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Td=function(t){return!!t&&(t.species="cog",new Cog(t))};J.Cog=Cog;const Palette=function(t=tr){return this.makeName(t.name),this.register(),this.factory=_l({name:`${this.name}-color-factory`}),this.set(this.defs),this.colors=t.colors||{"0 ":[0,0,0,1],"999 ":[255,255,255,1]},this.stops=Array(1e3).fill(te),this.easingFunction=Qs,this.set(t),this.dirtyPalette=!0,this},Ed=Palette.prototype=Ar();Ed.type=is,Ed.lib="palette",Ed.isArtefact=!1,Ed.isAsset=!1,Ro(Ed);const Hd={colors:null,stops:null,cyclic:!1,easing:yi,easingFunction:null,precision:25};Ed.defs=ur(Ed.defs,Hd),Ed.packetFunctions=fr(Ed.packetFunctions,["easingFunction"]),Ed.packetExclusions=fr(Ed.packetExclusions,["stops"]),Ed.kill=function(){return this.factory&&this.factory.kill&&this.factory.kill(),this.deregister(),this};const Id=Ed.getters,Ld=Ed.setters;Id.colors=function(){const t=this.factory,e=[];if(t){const i=t.colorSpace;for(const[n,s]of lt(this.colors))e.push([parseInt(n,10),t.buildColorString(...s,i)])}else e.push([0,Qt],[999,$s]);return e},Ld.colors=function(t){if(ut(t)){const e=this.factory,i={},n=e.colorSpace.toLowerCase();t.forEach((t=>{const[s,r]=t;s.toFixed&&r.substring&&(e.convert(r),i[`${s} `]=[...e[n]])})),this.colors=i,this.dirtyPalette=!0}},Ld.easing=function(t){this.setEasingHelper(t)},Ld.easingFunction=Ld.easing,Ed.setEasing=function(t){return this.setEasingHelper(t),this},Ed.setEasingFunction=Ed.setEasing,Ed.setEasingHelper=function(t){ar(t)?(this.easing=Je,this.easingFunction=t):t.substring&&Sr[t]?(this.easing=t,this.easingFunction=Qs):(this.easing=yi,this.easingFunction=Qs),this.dirtyPaletteData=!0},Id.colorSpace=function(){return this.getColorSpace()},Ld.colorSpace=function(t){if(t.substring){const e=t.toUpperCase(),i=t.toLowerCase();if(di.includes(e)){const t=it({},this.colors),n=this.factory.colorSpace;this.factory.set({colorSpace:e});for(const[e,s]of lt(t)){const t=this.factory.buildColorString(...s,n);this.factory.setColor(t),this.colors[e].length=0,this.colors[e].push(...this.factory[i])}this.dirtyPalette=!0}}},Id.returnColorAs=function(){return this.getReturnColorAs()},Ld.returnColorAs=function(t){this.factory.set({returnColorAs:t}),this.dirtyPalette=!0},Ld.precision=function(t){t=parseInt(t,10),(!dt(t)||t<0)&&(t=0),t>50&&(t=50),this.precision=t,this.dirtyPaletteData=!0},Ld.stops=qs,Ed.getColorSpace=function(){return this.factory?this.factory.colorSpace:kn},Ed.getReturnColorAs=function(){return this.factory?this.factory.returnColorAs:kn},Ed.recalculateStopColors=function(){if(this.dirtyPalette){this.dirtyPalette=!1,this.dirtyPaletteData=!0;const{colors:t,stops:e,factory:i}=this;e.fill(te);const{colorSpace:n}=i,s=ft(t).map((t=>parseInt(t,10))).sort(((t,e)=>t-e));let r,o,a,l,c,h,u,d=s[0];const[f,p,g,m]=t[`${d} `];for(e[d]=i.returnColorFromValues(f,p,g,m),c=0,h=s.length-1;c<h;c++)for(d=s[c],r=s[c+1],o=t[`${d} `],a=t[`${r} `],i.setMinimumColor(i.buildColorString(...o,n)),i.setMaximumColor(i.buildColorString(...a,n)),l=r-d,u=d+1;u<=r;u++)e[u]=i.getRangeColor((u-d)/l,!0)}},Ed.updateColor=function(t,e){const i=this.factory,n=i.colorSpace.toLowerCase();mr(t,e)&&(t=t.substring?parseInt(t,10):ct(t))>=0&&t<1e3&&(i.convert(e),t+=Hn,this.colors[t]=[...i[n]],this.dirtyPalette=!0)},Ed.removeColor=function(t){gr(t)&&(t=t.substring?parseInt(t,10):ct(t))>=0&&t<1e3&&(t+=Hn,delete this.colors[t],this.dirtyPalette=!0)},Ed.getStopData=function(t,e,i,n){if(!t)return te;const s=`${this.name}-data`,{stops:r}=this;if(this.dirtyPaletteData||!Ga()){this.dirtyPaletteData=!1,mr(e,i)||(e=0,i=999);const{easing:t,easingFunction:o,precision:a}=this,l=ft(this.colors).map((t=>parseInt(t,10))).sort(((t,e)=>t-e));let c,h,u,d,f,p,g=o;t!==Je&&Sr[t]&&(g=Sr[t]);const m=this.getColorSpace(),y=!(!a||t===yi&&m===kn),b=[];if(e<i){if(b.push(0,r[e]),c=i-e,y)for(u=e+1;u<i;u+=a)h=(u-e)/c,n&&(h>1?h-=1:h<0&&(h+=1)),h=g(h),h>0&&h<1&&b.push(h,r[u]);else for(u=0,d=l.length;u<d;u++)f=l[u],f>e&&f<i&&(h=(f-e)/c,n&&(h>1?h-=1:h<0&&(h+=1)),h>0&&h<1&&b.push(h,r[f]));b.push(1,r[i])}else if(n){if(b.push(0,r[e]),p=999-e,c=p+i,y)for(u=0;u<c;u+=a)f=u+e,f>999&&(f-=1e3),h=g(u/c),h>0&&h<1&&b.push(h,r[f]);else for(u=0,d=l.length;u<d;u++){if(f=l[u],999===f)h=(f-e-.01)/c;else if(f>e)h=(f-e)/c;else if(0===f)h=(f+p+.01)/c;else{if(!(f<i))continue;h=(f+p)/c}h>1?h-=1:h<0&&(h+=1),h>0&&h<1&&b.push(h,r[f])}b.push(1,r[i])}else{if(b.push(0,r[e]),c=e-i,y)for(u=i+1;u<e;u+=a)u<e&&u>i&&(h=g(1-(u-i)/c),h>0&&h<1&&b.push(h,r[u]));else for(u=0,d=l.length;u<d;u++)f=l[u],f<e&&f>i&&(h=1-(f-i)/c,h>0&&h<1&&b.push(h,r[f]));b.push(1,r[i])}za(s,b)}return e===i?r[e]||te:Na(s)||te},Ed.addStopsToGradient=function(t,e,i,n){this.recalculateStopColors();const s=this.getStopData(t,e,i,n);if(s.substring)return s;for(let e=0,i=s.length;e<i;e+=2)t.addColorStop(s[e],s[e+1]);return t},Ed.updateData=function(){this.dirtyPaletteData=!0};J.Palette=Palette;const Bd=["colors","cyclic","stops"];function $d(t=tr){t.defs=ur(t.defs,{start:null,end:null,palette:null,paletteStart:0,paletteEnd:999,cyclePalette:!1,animateByDelta:!1}),t.finalizePacketOut=function(t,e){return e.colors?t.colors=e.colors:this.palette?t.colors=this.palette.get("colors"):t.colors=[[0,Qt],[999,$s]],e.easing?t.easing=e.easing:this.palette&&this.palette.easing?t.easing=this.palette.easing:t.easing=yi,gr(e.precision)?t.precision=e.precision:this.palette&&gr(this.palette.precision)?t.precision=this.palette.precision:t.precision=0,e.colorSpace?t.colorSpace=e.colorSpace:this.palette?t.colorSpace=this.palette.getColorSpace():t.colorSpace=kn,e.returnColorAs?t.returnColorAs=e.returnColorAs:this.palette?t.returnColorAs=this.palette.getReturnColorAs():t.returnColorAs=kn,t},t.kill=function(){const t=this.name;return this.palette&&this.palette.kill&&this.palette.kill(),wt(m).forEach((e=>{const i=e.state;if(i){const e=i.fillStyle,n=i.strokeStyle;cr(e)&&e.name===t&&(i.fillStyle=i.defs.fillStyle),cr(n)&&n.name===t&&(i.strokeStyle=i.defs.strokeStyle)}})),this.deregister(),this};const e=t.getters,i=t.setters,n=t.deltaSetters;e.startX=function(){return this.currentStart[0]},e.startY=function(){return this.currentStart[1]},i.startX=function(t){null!=t&&(this.start[0]=t,this.dirtyStart=!0)},i.startY=function(t){null!=t&&(this.start[1]=t,this.dirtyStart=!0)},i.start=function(t,e){this.setCoordinateHelper(Ln,t,e),this.dirtyStart=!0},n.startX=function(t){const e=this.start;e[0]=Ws(e[0],t),this.dirtyStart=!0},n.startY=function(t){const e=this.start;e[1]=Ws(e[1],t),this.dirtyStart=!0},n.start=function(t,e){this.setDeltaCoordinateHelper(Ln,t,e),this.dirtyStart=!0},e.endX=function(){return this.currentEnd[0]},e.endY=function(){return this.currentEnd[1]},i.endX=function(t){null!=t&&(this.end[0]=t,this.dirtyEnd=!0)},i.endY=function(t){null!=t&&(this.end[1]=t,this.dirtyEnd=!0)},i.end=function(t,e){this.setCoordinateHelper(Ge,t,e),this.dirtyEnd=!0},n.endX=function(t){const e=this.end;e[0]=Ws(e[0],t),this.dirtyEnd=!0},n.endY=function(t){const e=this.end;e[1]=Ws(e[1],t),this.dirtyEnd=!0},n.end=function(t,e){this.setDeltaCoordinateHelper(Ge,t,e),this.dirtyEnd=!0},i.palette=function(t=tr){t.type===is&&(t.dirtyPalette=!0,this.palette=t)},i.paletteStart=function(t){t.toFixed&&this.palette&&(this.paletteStart=t,(t<0||t>999)&&(this.paletteStart=t>500?999:0),this.palette.updateData())},n.paletteStart=function(t){let e;t.toFixed&&this.palette&&(e=this.paletteStart+t,(e<0||e>999)&&(e=this.cyclePalette?e>500?e-1e3:e+1e3:t>500?999:0),this.paletteStart=e,this.palette.updateData())},i.paletteEnd=function(t){t.toFixed&&this.palette&&(this.paletteEnd=t,(t<0||t>999)&&(this.paletteEnd=t>500?999:0),this.palette.updateData())},n.paletteEnd=function(t){let e;t.toFixed&&this.palette&&(e=this.paletteEnd+t,(e<0||e>999)&&(e=this.cyclePalette?e>500?e-1e3:e+1e3:t>500?999:0),this.paletteEnd=e,this.palette.updateData())},i.cyclePalette=function(t){this.palette&&(this.cyclePalette=!!t,this.palette.updateData())},i.colors=function(t){ut(t)&&this.palette&&this.palette.set({colors:t})},i.easing=function(t){this.palette&&this.palette.set({easing:t})},i.easingFunction=i.easing,i.colorSpace=function(t){this.palette&&this.palette.set({colorSpace:t})},i.returnColorAs=function(t){this.palette&&this.palette.set({returnColorAs:t})},i.precision=function(t){this.palette&&this.palette.set({precision:t})},i.delta=function(t=tr){t&&(this.delta=dr(this.delta,t))},t.get=function(t){const e=this.getters[t],i=this.palette;if(e)return e.call(this);{let e,n=this.defs[t];return typeof n!==Fs?(e=this[t],typeof e!==Fs?e:n):(n=i.defs[t],typeof n!==Fs?(e=i[t],typeof e!==Fs?e:n):void 0)}},t.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.palette;let o,a,l,c,h,u;for(r&&(o=r.setters||tr,a=r.defs||tr),c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Bd.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=u)));this.dirtyFilterIdentifier=!0}return this},t.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.palette;let o,a,l,c,h,u;for(r&&(o=r.deltaSetters||tr,a=r.defs||tr),c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Bd.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=Ws(this[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=Ws(this[h],u))));this.dirtyFilterIdentifier=!0}return this},t.setCoordinateHelper=function(t,e,i){const n=this[t];ut(e)?(n[0]=e[0],n[1]=e[1]):(n[0]=e,n[1]=i)},t.setDeltaCoordinateHelper=function(t,e,i){const n=this[t],s=n[0],r=n[1];ut(e)?(n[0]=Ws(s,e[0]),n[1]=Ws(r,e[1])):(n[0]=Ws(s,e),n[1]=Ws(r,i))},t.updateByDelta=function(){return this.setDelta(this.delta),this},t.stylesInit=function(t=tr){this.makeName(t.name),this.register(),this.gradientArgs=[],this.start=al(),this.end=al(),this.currentStart=al(),this.currentEnd=al(),this.palette=function(t){return!!t&&new Palette(t)}({name:`${this.name}_palette`}),this.delta={},this.set(this.defs),this.set(t)},t.getData=function(t,e){return this.cleanStyle(t,e),this.finalizeCoordinates(t),this.buildStyle(e)},t.cleanStyle=function(t=tr,e=tr){let i,n,s,r;t.lockFillStyleToEntity||t.lockStrokeStyleToEntity?(i=t.currentDimensions,r=t.currentScale,n=i[0]*r,s=i[1]*r):(i=e.currentDimensions||[e.element.width,e.element.height],n=i[0],s=i[1]),this.cleanPosition(this.currentStart,this.start,[n,s]),this.cleanPosition(this.currentEnd,this.end,[n,s]),this.cleanRadius(n)},t.cleanPosition=function(t,e,i){let n,s;for(let r=0;r<2;r++)n=e[r],s=i[r],n.toFixed?t[r]=n:n===gi||n===Cs?t[r]=0:n===vn||n===ae?t[r]=s:n===ce?t[r]=s/2:dt(parseFloat(n))?t[r]=parseFloat(n)/100*s:t[r]=0},t.finalizeCoordinates=function(t=tr){const e=t.currentStampPosition,i=t.currentStampHandlePosition,n=t.currentScale;let s,r;t.lockFillStyleToEntity||t.lockStrokeStyleToEntity?(s=-i[0]*n||0,r=-i[1]*n||0):(s=-e[0]||0,r=-e[1]||0),this.updateGradientArgs(s,r)},t.cleanRadius=qs,t.buildStyle=function(){return te},t.addStopsToGradient=function(t,e,i,n){return this.palette?this.palette.addStopsToGradient(t,e,i,n):t},t.updateColor=function(t,e){return this.palette&&(this.dirtyFilterIdentifier=!0,this.palette.updateColor(t,e)),this},t.removeColor=function(t){return this.palette&&(this.dirtyFilterIdentifier=!0,this.palette.removeColor(t)),this}}Eo({name:"SC-core-gradient-delta-animation",fn:()=>{B.forEach((t=>{const e=L[t];e&&e.animateByDelta&&e.updateByDelta()}))}});const ConicGradient=function(t=tr){return this.stylesInit(t),this},Md=ConicGradient.prototype=Ar();Md.type="ConicGradient",Md.lib=Gn,Md.isArtefact=!1,Md.isAsset=!1,Ro(Md),$d(Md);Md.defs=ur(Md.defs,{angle:0}),Md.packetObjects=fr(Md.packetObjects,["palette"]),Md.buildStyle=function(t){if(t){const e=t.engine;if(e){if(!e.createConicGradient)return te;const t=e.createConicGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return te},Md.updateGradientArgs=function(t,e){const i=this.gradientArgs,n=this.currentStart,s=this.angle*Ct,r=n[0]+t,o=n[1]+e;i.length=0,i.push(s,r,o)};const Xd=function(t){return!!t&&new ConicGradient(t)};J.ConicGradient=ConicGradient;const Crescent=function(t=tr){return br(t.dimensions,t.width,t.height,t.radius)||(t.radius=5),this.currentOuterRadius=5,this.currentInnerRadius=5,this.currentDisplacement=0,this.currentDimensions=[],this.outerCircleStart=0,this.outerCircleEnd=0,this.innerCircleStart=0,this.innerCircleEnd=0,this.drawOuterCircle=!1,this.drawDonut=!1,this.pathObjectOuter=null,this.pathObjectInner=null,this.entityInit(t),this},Yd=Crescent.prototype=Ar();Yd.type="Crescent",Yd.lib=je,Yd.isArtefact=!0,Yd.isAsset=!1,Ro(Yd),od(Yd);Yd.defs=ur(Yd.defs,{outerRadius:20,innerRadius:10,displacement:0,displayIntersect:!1});const Gd=Yd.setters,Nd=Yd.deltaSetters;Gd.outerRadius=function(t){null!=t&&(this.outerRadius=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Nd.outerRadius=function(t){null!=t&&(this.outerRadius=Ws(this.outerRadius,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Gd.innerRadius=function(t){null!=t&&(this.innerRadius=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Nd.innerRadius=function(t){null!=t&&(this.innerRadius=Ws(this.innerRadius,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Gd.width=Gd.outerRadius,Nd.width=Nd.outerRadius,Gd.height=Gd.innerRadius,Nd.height=Nd.innerRadius,Gd.displacement=function(t){if(null!=t&&t.toFixed&&t>=0){let e=t;e<0&&(e=0),this.displacement=e,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0}},Nd.displacement=function(t){if(null!=t&&t.toFixed){let e=Ws(this.displacement,t);e.toFixed&&e<0&&(e=0),this.displacement=e,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0}},Gd.displayIntersect=function(t){this.displayIntersect=t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Yd.cleanDimensionsAdditionalActions=function(){const{outerRadius:t,innerRadius:e,displacement:i}=this,n=this.getHost();let s;s=n?n.currentDimensions?n.currentDimensions:[n.w,n.h]:[300,150];const[r,o]=s;this.currentOuterRadius=t.substring?parseFloat(t)/100*r:t,this.currentInnerRadius=e.substring?parseFloat(e)/100*o:e,this.currentDisplacement=i.substring?parseFloat(i)/100*r:i,this.currentDimensions[0]=this.currentDimensions[1]=2*this.currentOuterRadius,this.dirtyPathObject=!0},Yd.calculateInterception=function(){mr(this.currentOuterRadius,this.currentInnerRadius,this.currentDisplacement)||this.cleanDimensionsAdditionalActions();const{currentOuterRadius:t,currentInnerRadius:e,currentDisplacement:i}=this;this.outerCircleStart=0,this.outerCircleEnd=360*Ct,this.innerCircleStart=0,this.innerCircleEnd=360*Ct,this.drawOuterCircle=!1,this.drawDonut=!1;const n=t+e,s=t-e;if(!s&&!i)this.drawOuterCircle=!0;else if(i>=n)this.drawOuterCircle=!0;else if(i<n&&i>s){const n=el(),{engine:s,element:r}=n,o=rl();let a,l;for(r.width=r.width,s.fillStyle="black",s.save(),s.beginPath(),s.arc(0,0,t,0,2*Math.PI),o.setFromArray([e,0]),a=0;a<360&&(o.rotate(.5),!s.isPointInPath(o[0]+i,o[1]));a+=.5);for(s.restore(),s.save(),s.beginPath(),s.arc(i,0,e,0,2*Math.PI),o.setFromArray([t,0]),l=0;l<360&&(o.rotate(.5),s.isPointInPath(...o));l+=.5);s.restore(),this.outerCircleStart=-l*Ct,this.outerCircleEnd=l*Ct,this.innerCircleStart=a*Ct,this.innerCircleEnd=-a*Ct,ol(o),il(n)}else this.drawDonut=!0},Yd.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.calculateInterception();const{currentStampHandlePosition:t,currentScale:e,outerCircleStart:i,outerCircleEnd:n,innerCircleStart:s,innerCircleEnd:r,drawOuterCircle:o,displayIntersect:a}=this;let{currentOuterRadius:l,currentInnerRadius:c,currentDisplacement:h}=this;const u=this.pathObject=new Path2D;l*=e,c*=e,h*=e;const d=l-t[0]*e,f=l-t[1]*e;if(o)u.arc(d,f,l,i,n),u.closePath(),this.pathObjectOuter=!1,this.pathObjectInner=!1;else{const t=this.pathObjectOuter=new Path2D,e=this.pathObjectInner=new Path2D;a?u.arc(d,f,l,i,n):u.arc(d,f,l,i,n,!0),u.arc(d+h,f,c,s,r),u.closePath(),t.arc(d,f,l,i,n,!0),t.closePath(),e.arc(d+h,f,c,s,r),e.closePath()}}},Yd.draw=function(t){this.drawDonut?(t.stroke(this.pathObjectOuter),t.stroke(this.pathObjectInner)):t.stroke(this.pathObject)},Yd.fill=function(t){t.fill(this.pathObject,this.winding)},Yd.drawAndFill=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.stroke(i),t.stroke(n),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(i),t.stroke(n),t.fill(e,this.winding)}else{const e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(e),t.fill(e,this.winding)}},Yd.fillAndDraw=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.fill(e,this.winding),t.stroke(i),t.stroke(n),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(i),t.stroke(n)}else{const e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e)}},Yd.drawThenFill=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.stroke(i),t.stroke(n),t.fill(e,this.winding)}else{const e=this.pathObject;t.stroke(e),t.fill(e,this.winding)}},Yd.fillThenDraw=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.fill(e,this.winding),t.stroke(i),t.stroke(n)}else{const e=this.pathObject;t.fill(e,this.winding),t.stroke(e)}},Yd.clip=function(t){t.clip(this.pathObject,this.winding)},Yd.clear=function(t){const e=t.globalCompositeOperation;t.globalCompositeOperation=Re,t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e};const zd=function(t){return!!t&&new Crescent(t)};J.Crescent=Crescent;const jd="ParticleHistory",ParticleHistory=function(){const t=Array(4).fill(0);return Pt(t,ParticleHistory.prototype),t},Vd=ParticleHistory.prototype=at(Array.prototype);Vd.constructor=ParticleHistory,Vd.type=jd;const Wd=[],Ud=function(...t){t.forEach((t=>{t&&t.type===jd&&(t.fill(0),Wd.push(t),Wd.length>100&&(Wd.length=0))}))};J.ParticleHistory=ParticleHistory;const Particle=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.initializePositions(),this.hasLifetime=!1,this.distanceLimit=0,this.killBeyondCanvas=!1,this.isBeingDragged=!1,this.dragOffset=null,this.set(t),this},Zd=Particle.prototype=Ar();Zd.type=ns,Zd.lib=zi,Zd.isArtefact=!1,Zd.isAsset=!1,Ro(Zd);const Kd={position:null,velocity:null,load:null,history:null,historyLength:1,engine:Ve,forces:null,mass:1,fill:Qt,stroke:Qt};Zd.defs=ur(Zd.defs,Kd),Zd.packetExclusionsByRegex=fr(Zd.packetExclusionsByRegex,["^(local|dirty|current)"]),Zd.packetObjects=fr(Zd.packetObjects,["position","velocity","acceleration"]),Zd.factoryKill=function(){this.history.forEach((t=>Ud(t)));const t=[];let e;w.forEach((i=>{e=D[i],(e.particleFrom&&e.particleFrom.name===this.name||e.particleTo&&e.particleTo.name===this.name)&&t.push(e)})),t.forEach((t=>t.kill()))};const _d=Zd.getters,qd=Zd.setters,Qd=Zd.deltaSetters;_d.positionX=function(){return this.position.x},_d.positionY=function(){return this.position.y},_d.positionZ=function(){return this.position.z},_d.position=function(){const t=this.position;return[t.x,t.y,t.z]},qd.positionX=function(t){this.position.x=t},qd.positionY=function(t){this.position.y=t},qd.positionZ=function(t){this.position.z=t},qd.position=function(t){this.position.set(t)},Qd.positionX=function(t){this.position.x+=t},Qd.positionY=function(t){this.position.y+=t},Qd.positionZ=function(t){this.position.z+=t},Qd.position=qs,_d.velocityX=function(){return this.velocity.x},_d.velocityY=function(){return this.velocity.y},_d.velocityZ=function(){return this.velocity.z},_d.velocity=function(){const t=this.velocity;return[t.x,t.y,t.z]},qd.velocityX=function(t){this.velocity.x=t},qd.velocityY=function(t){this.velocity.y=t},qd.velocityZ=function(t){this.velocity.z=t},qd.velocity=function(t,e,i){this.velocity.set(t,e,i)},Qd.velocityX=function(t){this.velocity.x+=t},Qd.velocityY=function(t){this.velocity.y+=t},Qd.velocityZ=function(t){this.velocity.z+=t},Qd.velocity=qs,qd.forces=function(t){t&&(ut(t)?(this.forces.length=0,this.forces=this.forces.concat(t)):this.forces.push(t))},qd.load=qs,qd.history=qs,Qd.load=qs,Zd.initializePositions=function(){this.initialPosition=jh(),this.position=jh(),this.velocity=jh(),this.load=jh(),this.forces=[],this.history=[],this.isRunning=!1},Zd.applyForces=function(t,e){let i;this.load.zero(),this.isBeingDragged||this.forces.forEach((n=>{i=O[n],i&&i.action&&i.action(this,t,e)}))},Zd.update=function(t,e){this.isBeingDragged?this.position.setFromVector(this.isBeingDragged).vectorAdd(this.dragOffset):sf[this.engine].call(this,t*e.tickMultiplier)},Zd.manageHistory=function(t,e){const{history:i,remainingTime:n,position:s,historyLength:r,hasLifetime:o,distanceLimit:a,initialPosition:l,killBeyondCanvas:c}=this;let h=!0,u=0;if(o)if(u=n-t,u<=0){const t=i.pop();Ud(t),h=!1,i.length||(this.isRunning=!1)}else this.remainingTime=u;const d=i[i.length-1];if(d){const[,t,i,n]=d;if(c){const t=e.element.width,s=e.element.height;(i<0||n<0||i>t||n>s)&&(h=!1,this.isRunning=!1)}if(a){const e=Nh(l);e.vectorSubtractArray([i,n,t]),e.getMagnitude()>a&&(h=!1,this.isRunning=!1),zh(e)}}if(h){const{x:t,y:e,z:n}=s,o=(Wd.length||Wd.push(new ParticleHistory),Wd.shift());if(o[0]=u,o[1]=n,o[2]=t,o[3]=e,i.unshift(o),i.length>r){i.splice(r).forEach((t=>Ud(t)))}}},Zd.run=function(t,e,i){this.hasLifetime=!1,t&&(this.remainingTime=t,this.hasLifetime=!0),this.distanceLimit=0,e&&(this.initialPosition.set(this.position),this.distanceLimit=e),this.killBeyondCanvas=i,this.isRunning=!0};const Jd=function(t){return!!t&&new Particle(t)};J.Particle=Particle;const tf=[],ef=function(t){tf.length||tf.push(new Particle);const e=tf.shift();return e.set(t),e},nf=function(t){if(t&&t.type===ns&&(t.history.forEach((t=>Ud(t))),t.history.length=0,t.set(t.defs),tf.push(t),tf.length>50)){const t=[...tf];tf.length=0,t.forEach((t=>t.kill()))}},sf={euler:function(t){const{position:e,velocity:i,load:n,mass:s}=this,r=Nh(),o=Nh(i);r.setFromVector(n).scalarDivide(s),o.vectorAdd(r.scalarMultiply(t)),i.setFromVector(o),e.vectorAdd(o.scalarMultiply(t)),zh(r,o)},"improved-euler":function(t){const{position:e,velocity:i,load:n,mass:s}=this,r=Nh(),o=Nh(),a=Nh(),l=Nh(i);r.setFromVector(n).scalarDivide(s).scalarMultiply(t),o.setFromVector(n).vectorAdd(r).scalarDivide(s).scalarMultiply(t),a.setFromVector(r).vectorAdd(o).scalarDivide(2),l.vectorAdd(a),i.setFromVector(l),e.vectorAdd(l.scalarMultiply(t)),zh(r,o,a,l)},"runge-kutta":function(t){const{position:e,velocity:i,load:n,mass:s}=this,r=Nh(),o=Nh(),a=Nh(),l=Nh(),c=Nh(),h=Nh(i);r.setFromVector(n).scalarDivide(s).scalarMultiply(t).scalarDivide(2),o.setFromVector(n).vectorAdd(r).scalarDivide(s).scalarMultiply(t).scalarDivide(2),a.setFromVector(n).vectorAdd(o).scalarDivide(s).scalarMultiply(t).scalarDivide(2),l.setFromVector(n).vectorAdd(a).scalarDivide(s).scalarMultiply(t).scalarDivide(2),o.scalarMultiply(2),a.scalarMultiply(2),c.setFromVector(r).vectorAdd(o).vectorAdd(a).vectorAdd(l).scalarDivide(6),h.vectorAdd(c),i.setFromVector(h),e.vectorAdd(h.scalarMultiply(t)),zh(r,o,a,l,c,h)}},Emitter=function(t=tr){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.fillColorFactory=_l({name:`${this.name}-fillColorFactory`}),this.strokeColorFactory=_l({name:`${this.name}-strokeColorFactory`}),this.range=jh(),this.rangeFrom=jh(),this.minimumVelocity=jh(),this.preAction=qs,this.stampAction=qs,this.postAction=qs,this.particleStore=[],this.deadParticles=[],this.liveParticles=[],this.forces=[],this.filters=[],this.currentFilters=[],this.dirtyFilters=!1,this.dirtyFiltersCache=!1,this.dirtyImageSubscribers=!1,this.generatorChoke=0,this.lastUpdated=0,t.group||(t.group=Cu),this.set(t),this.purge&&this.purgeArtefact(this.purge),this},rf=Emitter.prototype=Ar();rf.type="Emitter",rf.lib=je,rf.isArtefact=!0,rf.isAsset=!1,Ro(rf),od(rf);const of={world:null,artefact:null,range:null,rangeFrom:null,minimumVelocity:null,generationRate:0,particleCount:0,generateAlongPath:null,generateInArea:null,generateFromExistingParticles:!1,generateFromExistingParticleHistories:!1,limitDirectionToAngleMultiples:0,generationChoke:15,killAfterTime:0,killAfterTimeVariation:0,killRadius:0,killRadiusVariation:0,killBeyondCanvas:!1,historyLength:1,forces:null,mass:1,massVariation:0,engine:Ve,hitRadius:10,showHitRadius:!1,hitRadiusColor:Qt,resetAfterBlur:3};rf.defs=ur(rf.defs,of),rf.packetExclusions=fr(rf.packetExclusions,["forces","particleStore","deadParticles","liveParticles","fillColorFactory","strokeColorFactory"]),rf.packetObjects=fr(rf.packetObjects,["world","artefact","generateInArea","generateAlongPath"]),rf.packetFunctions=fr(rf.packetFunctions,["preAction","stampAction","postAction"]),rf.finalizePacketOut=function(t,e){const i=e.forces||this.forces||!1;if(i){const e=[];i.forEach((t=>{t.substring?e.push(t):cr(t)&&t.name&&e.push(t.name)})),t.forces=e}const n=[];return this.particleStore.forEach((t=>n.push(t.saveAsPacket()))),t.particleStore=n,t},rf.postCloneAction=function(t){return t},rf.factoryKill=function(t,e){this.isRunning=!1,t&&this.artefact.kill(),e&&this.world.kill(),this.fillColorFactory.kill(),this.strokeColorFactory.kill(),this.deadParticles.forEach((t=>t.kill())),this.liveParticles.forEach((t=>t.kill())),this.particleStore.forEach((t=>t.kill()))};const af=rf.setters,lf=rf.deltaSetters;af.rangeX=function(t){this.range.x=t},af.rangeY=function(t){this.range.y=t},af.rangeZ=function(t){this.range.z=t},af.range=function(t){this.range.set(t)},af.rangeFromX=function(t){this.rangeFrom.x=t},af.rangeFromY=function(t){this.rangeFrom.y=t},af.rangeFromZ=function(t){this.rangeFrom.z=t},af.rangeFrom=function(t){this.rangeFrom.set(t)},af.minimumVelocityX=function(t){this.minimumVelocity.x=t},af.minimumVelocityY=function(t){this.minimumVelocity.y=t},af.minimumVelocityZ=function(t){this.minimumVelocity.z=t},af.minimumVelocity=function(t){this.minimumVelocity.set(t)},af.preAction=function(t){ar(t)&&(this.preAction=t,this.dirtyFilterIdentifier=!0)},af.stampAction=function(t){ar(t)&&(this.stampAction=t,this.dirtyFilterIdentifier=!0)},af.postAction=function(t){ar(t)&&(this.postAction=t,this.dirtyFilterIdentifier=!0)},af.world=function(t){let e;t.substring?e=F[t]:cr(t)&&t.type===gs&&(e=t),e&&(this.world=e)},af.artefact=function(t){let e;t.substring?e=o[t]:cr(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e,this.dirtyFilterIdentifier=!0)},af.generateAlongPath=function(t){let e;t.substring?e=o[t]:cr(t)&&t.isArtefact&&(e=t),e&&e.useAsPath?this.generateAlongPath=e:this.generateAlongPath=!1,this.dirtyFilterIdentifier=!0},af.generateInArea=function(t){let e;t.substring?e=o[t]:cr(t)&&t.isArtefact&&(e=t),this.generateInArea=e||!1,this.dirtyFilterIdentifier=!0},af.fillColor=function(t){this.fillColorFactory.set({color:t}),this.dirtyFilterIdentifier=!0},af.fillMinimumColor=function(t){this.fillColorFactory.set({minimumColor:t}),this.dirtyFilterIdentifier=!0},af.fillMaximumColor=function(t){this.fillColorFactory.set({maximumColor:t}),this.dirtyFilterIdentifier=!0},af.strokeColor=function(t){this.strokeColorFactory.set({color:t}),this.dirtyFilterIdentifier=!0},af.strokeMinimumColor=function(t){this.strokeColorFactory.set({minimumColor:t}),this.dirtyFilterIdentifier=!0},af.strokeMaximumColor=function(t){this.strokeColorFactory.set({maximumColor:t}),this.dirtyFilterIdentifier=!0},af.hitRadius=function(t){t.toFixed&&(this.hitRadius=t,this.width=this.height=2*t)},lf.hitRadius=function(t){t.toFixed&&(this.hitRadius+=t,this.width=this.height=2*this.hitRadius)},af.width=function(t){t.toFixed&&(this.hitRadius=t/2,this.width=this.height=t)},lf.width=function(t){t.toFixed&&(this.hitRadius=t/2,this.width=this.height=t)},af.height=af.width,lf.height=lf.width,rf.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1,this.dirtyDimensions=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions();const t=mt(),{particleStore:e,deadParticles:i,liveParticles:n,particleCount:s,generationRate:r,resetAfterBlur:o}=this;let a=this.generatorChoke;a||(this.generatorChoke=a=t),e.forEach((t=>{t.isRunning?n.push(t):i.push(t)})),e.length=0,i.forEach((t=>nf(t))),i.length=0,e.push(...n),n.length=0;let l=t-a;if(l/1e3>o&&(l=0,this.generatorChoke=t),l>0&&r){let i=ct(r/1e3*l);if(s){const t=s-e.length;t<=0?i=0:t<i&&(i=t)}i&&(this.addParticles(i),this.generatorChoke=t)}this.prepareStampTabsHelper()},rf.addParticles=function(t){const e=function(t,e){return _s(t+(kt()*e*2-e))},i=function(t,e,i){let n=_s(t+kt()*e);for(;et(n)<i;)n=_s(t+kt()*e);return n};let n,s,r,o,a,l;const c=mt(),{historyLength:h,engine:u,forces:d,mass:f,massVariation:p,fillColorFactory:g,strokeColorFactory:m,range:y,rangeFrom:b,minimumVelocity:S,currentStampPosition:A,particleStore:C,killAfterTime:k,killAfterTimeVariation:v,killRadius:P,killRadiusVariation:O,killBeyondCanvas:x,currentRotation:D,generateAlongPath:w,generateInArea:F,generateFromExistingParticles:R,generateFromExistingParticleHistories:T,limitDirectionToAngleMultiples:E,generationChoke:H}=this,{x:I,y:L,z:B}=y,{x:$,y:M,z:X}=b;if(F){const y=this.currentHost;if(y){const b=y.element,{width:A,height:D}=b;F.pathObject&&!F.dirtyPathObject||F.cleanPathObject();const w=el(),R=w.engine,T=rl(),{pathObject:E,winding:Y,currentStart:G}=F;[r,o]=G;const N=t=>R.isPointInPath(E,...t,Y);w.rotateDestination(R,r,o,F);t:for(n=0;n<t;n++){let t=!1;for(;!t;){if(c+H<mt())break t;T.set(kt()*A,kt()*D),N(T)&&(t=!0)}s=ef(),s.set({positionX:T[0],positionY:T[1],positionZ:0,velocityX:i($,I,S.x),velocityY:i(M,L,S.y),velocityZ:i(X,B,S.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(kt()),stroke:m.getRangeColor(kt())}),a=et(e(k,v)),l=et(e(P,O)),s.run(a,l,x),C.push(s)}il(w),ol(T)}}else if(w){if(w.useAsPath){w.pathObject&&!w.dirtyPathObject||w.cleanPathObject();t:for(n=0;n<t;n++){let t=!1,n=!1;for(;!n;){if(c+H<mt())break t;t=w.getPathPositionData(kt(),!0),t&&(n=!0)}s=ef(),s.set({positionX:t.x,positionY:t.y,positionZ:0,velocityX:i($,I,S.x),velocityY:i(M,L,S.y),velocityZ:i(X,B,S.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(kt()),stroke:m.getRangeColor(kt())}),a=et(e(k,v)),l=et(e(P,O)),s.run(a,l,x),C.push(s)}}}else if(T){const r=C.length,o=Nh();let c,y,b,w;for(n=0;n<t;n++)r?(y=C[ct(kt()*r)],b=y.history,b&&b.length>1?([,,...w]=b[ct(kt()*b.length)],w?o.setFromArray(w):o.setFromVector(y.position)):o.setFromVector(y.position)):o.setFromArray(A),s=ef(),s.set({positionX:_s(o.x),positionY:_s(o.y),positionZ:_s(o.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(kt()),stroke:m.getRangeColor(kt())}),E?(o.zero(),c=ct(360/E),o.x=i($,I,S.x),o.rotate(ct(kt()*c)*E),s.set({velocityX:_s(o.x),velocityY:_s(o.y),velocityZ:i(X,B,S.z)})):s.set({velocityX:i($,I,S.x),velocityY:i(M,L,S.y),velocityZ:i(X,B,S.z)}),s.velocity.rotate(D),a=et(e(k,v)),l=et(e(P,O)),s.run(a,l,x),C.push(s);zh(o)}else if(R){const r=C.length,o=Nh();let c,y;for(n=0;n<t;n++)r?(y=C[ct(kt()*r)],o.setFromVector(y.position)):o.setFromArray(A),s=ef(),s.set({positionX:_s(o.x),positionY:_s(o.y),positionZ:_s(o.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(kt()),stroke:m.getRangeColor(kt())}),E?(o.zero(),c=ct(360/E),o.x=i($,I,S.x),o.rotate(ct(kt()*c)*E),s.set({velocityX:_s(o.x),velocityY:_s(o.y),velocityZ:i(X,B,S.z)})):s.set({velocityX:i($,I,S.x),velocityY:i(M,L,S.y),velocityZ:i(X,B,S.z)}),s.velocity.rotate(D),a=et(e(k,v)),l=et(e(P,O)),s.run(a,l,x),C.push(s);zh(o)}else for([r,o]=A,n=0;n<t;n++)s=ef(),s.set({positionX:r,positionY:o,positionZ:0,velocityX:i($,I,S.x),velocityY:i(M,L,S.y),velocityZ:i(X,B,S.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(kt()),stroke:m.getRangeColor(kt())}),s.velocity.rotate(D),a=et(e(k,v)),l=et(e(P,O)),s.run(a,l,x),C.push(s)},rf.regularStamp=function(){const{world:t,artefact:e,particleStore:i,preAction:n,stampAction:s,postAction:r,lastUpdated:o,resetAfterBlur:a,showHitRadius:l,hitRadius:c,hitRadiusColor:h,currentStampPosition:u}=this,d=this.currentHost;let f=Dt;const p=mt();if(o&&(f=(p-o)/1e3),f>a&&(i.forEach((t=>nf(t))),i.length=0,f=Dt),i.forEach((e=>e.applyForces(t,d))),i.forEach((e=>e.update(f,t))),n.call(this,d),i.forEach((t=>{t.manageHistory(f,d),s.call(this,e,t,d)})),r.call(this,d),l){const t=d.engine;t.save(),t.lineWidth=1,t.strokeStyle=h,t.setTransform(1,0,0,1,0,0),t.beginPath(),t.arc(u[0],u[1],c,0,bt),t.stroke(),t.restore()}this.lastUpdated=p},rf.checkHit=function(t=[]){if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=this.currentStampPosition;let n,s,r=!1;return!!e.some((t=>{if(ut(t))n=t[0],s=t[1];else{if(!mr(t,t.x,t.y))return!1;n=t.x,s=t.y}if(!dt(n)||!dt(s))return!1;const e=Nh(i).vectorSubtract(t);return e.getMagnitude()<this.hitRadius&&(r=!0),zh(e),r}),this)&&this.checkHitReturn(n,s)};const cf=function(t){return!!t&&new Emitter(t)};J.Emitter=Emitter;const hf=["ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded","ultra-expanded"],uf=function(t=tr){return this.isDefaultTextStyle=!!t.isDefaultTextStyle,this.isDefaultTextStyle?(this.set(this.defs),this.set(t),this.letterSpacing=`${this.letterSpaceValue}px`,this.wordSpacing=`${this.wordSpaceValue}px`):this.set(t,!0),this},df=uf.prototype=Ar();df.type="TextStyle",Ro(df);const ff={direction:Si,fontKerning:Gi,fontStretch:Gi,fontVariantCaps:Gi,textRendering:Zt,fillStyle:Qt,lineDash:null,lineDashOffset:0,lineWidth:1,strokeStyle:Qt,canvasFont:De,fontString:De,letterSpaceValue:0,wordSpaceValue:0,fontFamily:"sans-serif",fontSize:"12px",fontStyle:Gi,fontWeight:Gi,includeUnderline:!1,underlineGap:3,underlineOffset:0,underlineStyle:Ys,underlineWidth:1,includeOverline:!1,overlineOffset:0,overlineStyle:Ys,overlineWidth:1,highlightStyle:Ys,includeHighlight:!1,method:We};df.defs=ur(df.defs,ff),df.processPacketOut=function(t,e,i){let n=!0;if(t===mi)e.length||(n=!!i.includes(mi));else i.includes(t)||e!==this.defs[t]||(n=!1);return n},df.finalizePacketOut=function(t){const e=t.fillStyle,i=t.strokeStyle;return e&&!e.substring&&(t.fillStyle=e.name),i&&!i.substring&&(t.strokeStyle=i.name),t},df.set=function(t=tr,e=!1){if(this.isDefaultTextStyle||e){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!=$i&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!=Fs&&(this[i]=n))}}return this},df.setDelta=function(t=tr,e=!1){if(this.isDefaultTextStyle||e){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.deltaSetters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!=$i&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!=Fs&&(this[i]=Ws(this[i],n)))}}return this};const pf=df.getters,gf=df.setters,mf=df.deltaSetters;gf.fontString=function(t){null!=t&&t.substring&&(this.fontString=t)},gf.fontSize=function(t){null!=t&&t.substring&&(this.fontSize=t.toLowerCase())},gf.fontStyle=function(t){null!=t&&t.substring&&(this.fontStyle=t.toLowerCase())},gf.fontVariantCaps=function(t){null!=t&&t.substring&&(this.fontVariantCaps=t.toLowerCase())},gf.fontStretch=function(t){null!=t&&t.substring&&(this.fontStretch=this.fontStretchHelper(t))},df.fontStretchHelper=function(t){if(!t.substring)return Gi;if(t=t.toLowerCase(),hf.includes(t))return t;if(t.includes(Vi)){const e=parseFloat(t);if(dt(e)){if(e<=50)return hf[0];if(e<=62.5)return hf[1];if(e<=75)return hf[2];if(e<=87.5)return hf[3];if(e>=200)return hf[7];if(e>=150)return hf[6];if(e>=125)return hf[5];if(e>=112.5)return hf[4]}}return Gi},gf.fontWeight=function(t){this.fontWeight=t.toFixed?`${t}`:t},gf.direction=function(t){null!=t&&t.substring&&(this.direction=t)},gf.fontKerning=function(t){null!=t&&t.substring&&(this.fontKerning=t)},pf.letterSpaceValue=function(){return this.letterSpaceValue},pf.letterSpacing=function(){return`${this.letterSpaceValue}px`},mf.letterSpacing=function(t){if(null!=t){t===Gi&&(t=0);const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.letterSpaceValue+=e,this.letterSpacing=`${this.letterSpaceValue}px`)}},gf.letterSpacing=function(t){if(null!=t){t===Gi&&(t=0);const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.letterSpaceValue=e,this.letterSpacing=`${e}px`)}},pf.wordSpaceValue=function(){return this.wordSpaceValue},pf.wordSpacing=function(){return`${this.wordSpaceValue}px`},mf.wordSpacing=function(t){if(null!=t){const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.wordSpaceValue+=e,this.wordSpacing=`${this.wordSpaceValue}px`)}},gf.wordSpacing=function(t){if(null!=t){const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.wordSpaceValue=e,this.wordSpacing=`${e}px`)}},gf.textRendering=function(t){null!=t&&t.substring&&(this.textRendering=t)},pf.textAlign=qs,gf.textAlign=qs,pf.textBaseline=qs,gf.textBaseline=qs;const yf=function(t){return!!t&&new uf(t)};J.TextStyle=uf;const bf=/[0-9.,]+(%|cap|ch|cm|cqb|cqh|cqi|cqmax|cqmin|cqw|dvb|dvh|dvi|dvmax|dvmin|dvw|em|ex|ic|in|lh|lvb|lvh|lvi|lvmax|lvmin|lvw|mm|pc|pt|px|Q|rcap|rch|rem|rex|ric|rlh|svb|svh|svi|svmax|svmin|svw|vb|vh|vi|vmax|vmin|vw)/i,Sf=["small-caps","all-small-caps","petite-caps","all-petite-caps","unicase","titling-caps"],Af="italic",Cf=["direction","fontKerning","fontSize","fontStretch","fontString","fontStyle","fontVariantCaps","fontWeight","letterSpaceValue","letterSpacing","scale","textRendering","wordSpaceValue","wordSpacing"],kf=["fontString"],vf=["fontString","scale"],Pf=["fontFamily","fontSize","fontStretch","fontStyle","fontVariantCaps","fontWeight"],Of=["lineSpacing","textUnitFlow","lineAdjustment","alignment","justifyLine","flipReverse","flipUpend","alignTextUnitsToPath","lockFillStyleToEntity","lockStrokeStyleToEntity"],xf="oblique",Df=["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"],wf=["width","height","dimensions","startX","startY","start","position","handleX","handleY","handle","offsetX","offsetY","offset","roll","scale","flipReverse","flipUpend"],Ff=["canvasFont","direction","fillStyle","fontFamily","fontKerning","fontSize","fontStretch","fontString","fontStyle","fontVariantCaps","fontWeight","highlightStyle","includeHighlight","includeUnderline","letterSpaceValue","letterSpacing","lineDash","lineDashOffset","lineWidth","overlineOffset","overlineStyle","overlineWidth","strokeStyle","textRendering","underlineGap","underlineOffset","underlineStyle","underlineWidth","wordSpaceValue","wordSpacing","method"],Rf=document.createElement(Be);function Tf(t=tr){const e={textIsAccessible:!0,accessibleText:"",accessibleTextPlaceholder:"",accessibleTextRole:Ys,accessibleTextOrder:0};t.defs=ur(t.defs,e),t.finalizePacketOut=function(t,e){const i=yt(this.defaultTextStyle.saveAsPacket(e))[3],n=yt(this.state.saveAsPacket(e))[3];return t=ur(t,{direction:i.direction,fillStyle:i.fillStyle,fontKerning:i.fontKerning,fontStretch:i.fontStretch,fontString:i.fontString,fontVariantCaps:i.fontVariantCaps,highlightStyle:i.highlightStyle,includeHighlight:i.includeHighlight,includeUnderline:i.includeUnderline,letterSpacing:i.letterSpaceValue,lineDash:i.lineDash,lineDashOffset:i.lineDashOffset,lineWidth:i.lineWidth,method:i.method,overlineOffset:i.overlineOffset,overlineStyle:i.overlineStyle,overlineWidth:i.overlineWidth,strokeStyle:i.strokeStyle,textRendering:i.textRendering,underlineGap:i.underlineGap,underlineOffset:i.underlineOffset,underlineStyle:i.underlineStyle,underlineWidth:i.underlineWidth,wordSpacing:i.wordSpaceValue,filter:n.filter,font:null,globalAlpha:n.globalAlpha,globalCompositeOperation:n.globalCompositeOperation,imageSmoothingEnabled:n.imageSmoothingEnabled,imageSmoothingQuality:n.imageSmoothingQuality,lineCap:Dn,lineJoin:Dn,miterLimit:10,shadowBlur:n.shadowBlur,shadowColor:n.shadowColor,shadowOffsetX:n.shadowOffsetX,shadowOffsetY:n.shadowOffsetY,textAlign:gi,textBaseline:Cs}),this.type===ts&&(t=this.handlePacketAnchor(t,e)),t},t.factoryKill=function(){this.dirtyCache(),this.accessibleTextHold&&this.accessibleTextHold.remove();const t=this.getCanvasTextHold(this.currentHost);t&&(t.dirtyTextTabOrder=!0)},t.get=function(t){const{defs:e,getters:i,state:n,defaultTextStyle:s,layoutTemplate:r}=this,o=s?s.getters:tr,a=s?s.defs:tr,l=n?n.getters:tr,c=n?n.defs:tr;let h;if(r&&wf.includes(t))return r.get(t);if(Ff.includes(t)){if(h=o[t],h)return h.call(s);if(typeof a[t]!=Fs)return s[t]}if(Mn.includes(t)){if(h=l[t],h)return h.call(n);if(typeof c[t]!=Fs)return n[t]}return h=i[t],h?h.call(this):typeof e[t]!=Fs?this[t]:null},t.set=function(t=tr){const e=ft(t),i=e.length;if(i){this.dirtyCache();const{defs:n,setters:s,state:r,defaultTextStyle:o,layoutTemplate:a}=this,l=o?o.setters:tr,c=o?o.defs:tr,h=r?r.setters:tr,u=r?r.defs:tr;let d,f,p,g;for(f=0;f<i;f++)p=e[f],g=t[p],p&&p!==$i&&null!=g&&(a&&wf.includes(p)?a.set({[p]:g}):Ff.includes(p)?(d=l[p],d?d.call(o,g):typeof c[p]!==Fs&&(o[p]=g)):Mn.includes(p)?(d=h[p],d?d.call(r,g):typeof u[p]!==Fs&&(r[p]=g)):(d=s[p],d?d.call(this,g):typeof n[p]!==Fs&&(this[p]=g)),a&&(Of.includes(p)||Ff.includes(p))&&(this.dirtyLayout=!0),Cf.includes(p)&&(this.dirtyFont=!0),Pf.includes(p)&&(this.updateUsingFontParts=!0),vf.includes(p)&&(this.updateUsingFontString=!0),kf.includes(p)&&(this.currentFontIsLoaded=!1))}return this},t.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){this.dirtyCache();const{defs:n,deltaSetters:s,state:r,defaultTextStyle:o,layoutTemplate:a}=this,l=o?o.deltaSetters:tr,c=o?o.defs:tr,h=r?r.deltaSetters:tr,u=r?r.defs:tr;let d,f,p,g;for(f=0;f<i;f++)p=e[f],g=t[p],p&&p!=$i&&null!=g&&(a&&wf.includes(p)?a.setDelta({[p]:g}):Ff.includes(p)?(d=l[p],d?d.call(r,g):typeof c[p]!=Fs&&(o[p]=Ws(o[p],g))):Mn.includes(p)?(d=h[p],d?d.call(r,g):typeof u[p]!=Fs&&(r[p]=Ws(r[p],g))):(d=s[p],d?d.call(this,g):typeof n[p]!=Fs&&(this[p]=Ws(this[p],g))),a&&(Of.includes(p)||Ff.includes(p))&&(this.dirtyLayout=!0),Cf.includes(p)&&(this.dirtyFont=!0),Pf.includes(p)&&(this.updateUsingFontParts=!0),vf.includes(p)&&(this.updateUsingFontString=!0),kf.includes(p)&&(this.currentFontIsLoaded=!1))}return this};const i=t.getters,n=t.setters;i.rawText=function(){return this.rawText},n.text=function(t){this.rawText=t.substring?t:t.toString(),this.text=this.convertTextEntityCharacters(this.rawText.normalize("NFC")),this.dirtyText=!0,this.dirtyFont=!0,this.currentFontIsLoaded=!1},i.accessibleText=function(){return this.getAccessibleText()},n.accessibleText=function(t){null!=t&&t.substring&&(this.accessibleText=t,this.dirtyText=!0)},n.accessibleTextPlaceholder=function(t){null!=t&&t.substring&&(this.accessibleTextPlaceholder=t,this.dirtyText=!0)},n.accessibleTextOrder=function(t){null!=t&&t.toFixed&&(this.accessibleTextOrder=t,this.dirtyText=!0)},n.textIsAccessible=function(t){this.textIsAccessible=!!t,this.dirtyText=!0},t.dirtyCache=qs,t.recalculateFont=function(t=!1){t?this.usingViewportFontSizing&&(this.dirtyFont=!0):this.dirtyFont=!0},t.convertTextEntityCharacters=function(t){return Rf.innerHTML=t,Rf.textContent},t.updateCanvasFont=function(t,e){const{fontStyle:i,fontVariantCaps:n,fontWeight:s,fontSize:r,fontSizeValue:o,fontFamily:a}=t;let l="";(i==Af||i.includes(xf))&&(l+=`${i} `),"small-caps"==n&&(l+=`${n} `),null!=s&&s&&s!==Gi&&"400"!==s&&(l+=`${s} `),this.type===ts?l+=`${o*e}px ${a}`:l+=`${parseFloat(r)*e}px ${a}`,t.canvasFont=l},t.updateFontString=function(t){const{fontStretch:e,fontStyle:i,fontVariantCaps:n,fontWeight:s,fontSize:r,fontFamily:o}=t;let a="";null!=e&&e&&e!==Gi&&(a+=`${e} `),null!=i&&i&&i!==Gi&&(a+=`${i} `),null!=n&&n&&n!==Gi&&(a+=`${n} `),null!=s&&s&&s!==Gi&&"400"!==s&&(a+=`${s} `),a+=`${r} ${o}`,t.fontString=a},t.getControllerCell=function(){const t=this.group;if(t){const e=t&&t.getHost?t.getHost():null;if(e)return e.getController()}return null},t.setImageSmoothing=function(t){Vo()>=2?t.imageSmoothingEnabled=!1:(t.imageSmoothingEnabled=!0,t.imageSmoothingQuality=ai)},t.getCalculators=function(){let t=null,e=null;const i=this.getControllerCell();return i&&(t=i.fontSizeCalculator,e=i.fontSizeCalculatorValues),[t,e]},t.temperFont=function(){const{group:t,defaultTextStyle:e}=this;if(mr(t,e)){const[t,i]=this.getCalculators();t?this.calculateTextStyleFontStrings(e,t,i):this.dirtyFont=!0}},t.cleanFont=function(){if(this.currentFontIsLoaded)this.dirtyFont=!1,this.temperFont(),this.type!==ts||this.dirtyFont||this.measureFont();else if(null!=this.currentFontIsLoaded){const[t,e]=this.getCalculators(),i=this.defaultTextStyle.fontString;if(t){t.style.font=i;const n=e.fontFamily;C.includes(`100px ${n}`)?(this.currentFontIsLoaded=!0,this.dirtyFont=!1,this.temperFont(),this.type!==ts||this.dirtyFont||this.measureFont()):this.checkFontIsLoaded(i)}}},t.calculateTextStyleFontStrings=function(t,e,i){let n=t.fontSize;const{fontStretch:s,fontStyle:r,fontWeight:o,fontVariantCaps:a,fontString:l}=t,{lineSpacing:c,updateUsingFontParts:h,updateUsingFontString:u}=this,d=this.getScale();e.style.font=l;const f=i.fontFamily;if(this.getFontMetadata(f),u||null==n||!n){this.updateUsingFontString=!1;const s=l.match(bf);s&&s[0]&&(n=s[0]),e.style.fontSize=n,t.fontSize=i.fontSize}h?(this.updateUsingFontParts=!1,e.style.fontStretch=s,e.style.fontStyle=r,e.style.fontVariantCaps=a,e.style.fontWeight=o,e.style.fontSize=n):1!==d&&(e.style.fontSize=n);const p=i.fontWeight,g=t.fontStretchHelper(i.fontStretch);let m=i.fontVariantCaps,y=i.fontStyle;m=Sf.includes(m)?m:Gi,y=y===Af||y.includes(xf)?y:Gi;const b=i.fontSize,S=parseFloat(b);if(t.fontSizeValue=S,null!=c&&l.includes("/")){const t=parseFloat(i.lineHeight);this.lineSpacing=dt(t)?t/S:this.defs.lineSpacing,this.dirtyLayout=!0}t.fontStretch=g,t.fontStyle=y,t.fontVariantCaps=m,t.fontWeight=p,t.fontFamily=f,this.updateCanvasFont(t,d),this.updateFontString(t)},t.getScale=function(){const t=this.layoutTemplate;return t?null!=t.currentScale?t.currentScale:1:null!=this.currentScale?this.currentScale:1},t.getStyle=function(t,e,i){if(null==i)return Qt;if(t||(t=this.state[e]),null==t)return Qt;if(t.substring){let e=null;B.includes(t)?e=L[t]:f.includes(t)&&(e=d[t]),null!=e&&(t=e.getData(this,i))}else t=t.getData(this,i);return t},t.getFontMetadata=function(t){if(t){const e=`100px ${t}`;if(C.includes(e))return A[e];const i=el(),n=i.engine;n.textAlign=gi,n.textBaseline=Cs,n.font=e;const s=n.measureText(Hn),{actualBoundingBoxAscent:r,actualBoundingBoxDescent:o,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,alphabeticBaseline:c,hangingBaseline:h,ideographicBaseline:u}=s;let d=a+l;dt(d)||(d=st(et(o)+et(r)));const f=dt(a)?a:r;return C.push(e),A[e]={height:d,verticalOffset:f,alphabeticRatio:et((c-f)/d),hangingRatio:et((h-f)/d),ideographicRatio:et((u-f)/d),alphabeticBaseline:-c,hangingBaseline:-h,ideographicBaseline:-u},il(i),A[e]}},t.checkFontIsLoaded=function(t){if(null==t)this.currentFontIsLoaded=!1;else if(Df.includes(t))this.currentFontIsLoaded=!0;else if(null!=this.currentFontIsLoaded&&!this.currentFontIsLoaded){this.currentFontIsLoaded=null;document.fonts.load(t).then((()=>this.currentFontIsLoaded=!0)).catch((e=>{this.currentFontIsLoaded=!1,console.log("checkFontIsLoaded error:",t,e)}))}},t.getCanvasTextHold=function(t){return t&&t.type===Un&&t.controller&&t.controller.type&&t.controller.type===Wn&&t.controller.textHold?t.controller:!(!t||t.type!==Un||!t.currentHost)&&this.getCanvasTextHold(t.currentHost)},t.updateAccessibleTextHold=function(){if(this.dirtyText=!1,this.textIsAccessible){if(!this.accessibleTextHold){const t=document.createElement(Be);t.id=`${this.name}-text-hold`,t.setAttribute(Vt,sn),t.setAttribute(xe,this.accessibleTextOrder),this.accessibleTextRole&&t.setAttribute(Pn,this.accessibleTextRole),this.accessibleTextHold=t,this.accessibleTextHoldAttached=!1}if(this.accessibleTextHold.textContent=this.getAccessibleText(),this.currentHost){const t=this.getCanvasTextHold(this.currentHost);t&&t.textHold&&(this.accessibleTextHoldAttached||(t.textHold.appendChild(this.accessibleTextHold),this.accessibleTextHoldAttached=!0),t.dirtyTextTabOrder=!0)}}else if(this.accessibleTextHold){this.accessibleTextHold.remove(),this.accessibleTextHold=null,this.accessibleTextHoldAttached=!1;const t=this.getCanvasTextHold(this.currentHost);t&&(t.dirtyTextTabOrder=!0)}},t.getAccessibleText=function(){const{accessibleText:t,accessibleTextPlaceholder:e,text:i}=this;return t.replace(e,i)}}const Ef="draw",Hf="drawAndFill",If="fillAndDraw",Lf=/[0-9.,]+(svh|lvh|dvh|vh|svw|lvw|dvw|vw|svmax|lvmax|dvmax|vmax|svmin|lvmin|dvmin|vmin|svb|lvb|dvb|vb|svi|lvi|dvi|vi)/i,Bf="space-around",$f="space-between",Mf="EnhancedLabelLine",Xf="EnhancedLabelUnit",Yf=/[-]/,Gf=["column","column-reverse"],Nf=["row-reverse","column-reverse"],zf=/[\u2060]/,jf=/[\u00ad]/,Vf=/[ \f\n\r\t\v\u2028\u2029\u200b]/,Wf="C",Uf="h",Zf="S",Kf=/[\u200b]/,EnhancedLabel=function(t=tr){return this.makeName(t.name),this.register(),this.state=Ea(tr),this.defaultTextStyle=yf({isDefaultTextStyle:!0}),this.cache=null,this.textUnitHitZones=[],this.pivoted=[],this.set(this.defs),t.group||(t.group=Cu),this.currentFontIsLoaded=!1,this.updateUsingFontParts=!1,this.updateUsingFontString=!1,this.usingViewportFontSizing=!1,this.useMimicDimensions=!0,this.useMimicFlip=!0,this.useMimicHandle=!0,this.useMimicOffset=!0,this.useMimicRotation=!0,this.useMimicScale=!0,this.useMimicStart=!0,this.delta={},this.deltaConstraints={},this.currentStampPosition=al(),this.textHandle=al(),this.textOffset=al(),this.lines=[],this.textUnits=gp(),this.underlinePaths=[],this.overlinePaths=[],this.highlightPaths=[],this.guidelineDash=[],this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyRotation=!0,this.dirtyScale=!0,this.dirtyDimensions=!0,this.currentHost=null,this.dirtyHost=!0,this.currentDimensions=[],this.currentScale=1,this.currentStampHandlePosition=null,this.pathObject=null,this.accessibleTextHold=null,this.accessibleTextHoldAttached=null,this.guidelinesPath=null,this.currentPathData=null,this.filters=[],this.currentFilters=[],this.dirtyFilters=!0,this.dirtyFiltersCache=!0,this.dirtyImageSubscribers=!0,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.set(t),this.dirtyFont=!0,this.currentFontIsLoaded=!1,this},_f=EnhancedLabel.prototype=Ar();_f.type=_n,_f.lib=je,_f.isArtefact=!0,_f.isAsset=!1,Ro(_f),qc(_f),Bc(_f),Tf(_f);const qf={text:Ys,lineSpacing:1.5,layoutTemplate:null,useLayoutTemplateAsPath:!1,pathPosition:0,constantSpeedAlongPath:!0,alignment:0,alignTextUnitsToPath:!0,lineAdjustment:0,breakTextOnSpaces:!0,breakWordsOnHyphens:!1,justifyLine:ce,textUnitFlow:"row",truncateString:"",hyphenString:"-",textHandle:null,textOffset:null,showGuidelines:!1,guidelineStyle:"rgb(0 0 0 / 0.5)",guidelineWidth:1,guidelineDash:null,visibility:!0,calculateOrder:0,stampOrder:0,host:null,group:null,method:We,lockFillStyleToEntity:!1,lockStrokeStyleToEntity:!1,cacheOutput:!0,checkHitUseTemplate:!0};_f.defs=ur(_f.defs,qf),_f.packetExclusions=fr(_f.packetExclusions,["pathObject","mimicked","pivoted","state"]),_f.packetExclusionsByRegex=fr(_f.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),_f.packetCoordinates=fr(_f.packetCoordinates,["start","handle","offset"]),_f.packetObjects=fr(_f.packetObjects,["group","layoutTemplate"]),_f.packetFunctions=fr(_f.packetFunctions,["onEnter","onLeave","onDown","onUp"]),_f.processPacketOut=function(t,e,i){return this.processEntityPacketOut(t,e,i)},_f.handlePacketAnchor=function(t){return t},_f.processEntityPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},_f.processFactoryPacketOut=function(t,e,i){let n=!0;return i.indexOf(t)||e!==this.defs[t]||(n=!1),n},_f.postCloneAction=function(t){return t},_f.kill=function(t=!1,e=!1){const i=this.name;return wt(k).forEach((t=>{t.artefacts.includes(i)&&t.removeArtefacts(i)})),this.anchor&&this.demolishAnchor(),this.button&&this.demolishButton(),wt(o).forEach((t=>{t.name!==i&&(t.pivot&&t.pivot.name===i&&t.set({pivot:!1}),t.mimic&&t.mimic.name===i&&t.set({mimic:!1}),t.path&&t.path.name===i&&t.set({path:!1}),t.generateAlongPath&&t.generateAlongPath.name===i&&t.set({generateAlongPath:!1}),t.generateInArea&&t.generateInArea.name===i&&t.set({generateInArea:!1}),t.artefact&&t.artefact.name===i&&t.set({artefact:!1}),ut(t.pins)&&t.pins.forEach(((e,n)=>{cr(e)&&e.name===i&&t.removePinAt(n)})))})),wt(H).forEach((t=>{t.checkForTarget(i)&&t.removeFromTargets(this)})),this.factoryKill(t,e),this.deregister(),this};const Qf=_f.getters,Jf=_f.setters,tp=_f.deltaSetters;Qf.group=function(){return this.group?this.group.name:Ys},Jf.group=function(t){let e;t&&(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring?(e=k[t],this.group=e||t):this.group=t),this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},Jf.layoutTemplate=function(t){if(t){const e=this.layoutTemplate,i=t.substring?o[t]:t,n=this.name;i&&i.name&&(e&&e.name!==i.name&&(e.mimicked&&pr(e.mimicked,n),e.pathed&&pr(e.pathed,n)),i.mimicked&&fr(i.mimicked,n),i.pathed&&fr(i.pathed,n),this.layoutTemplate=i,this.dirtyPathObject=!0,this.dirtyLayout=!0)}},Jf.breakTextOnSpaces=function(t){this.breakTextOnSpaces=!!t,this.dirtyText=!0},Jf.breakWordsOnHyphens=function(t){this.breakWordsOnHyphens=!!t,this.dirtyText=!0},Jf.truncateString=function(t){t.substring&&(this.truncateString=this.convertTextEntityCharacters(t),this.dirtyText=!0)},Jf.hyphenString=function(t){t.substring&&(this.hyphenString=this.convertTextEntityCharacters(t),this.dirtyText=!0)},Jf.textHandleX=function(t){this.textHandle[0]=t,this.dirtyLayout=!0},Jf.textHandleY=function(t){this.textHandle[1]=t,this.dirtyLayout=!0},Jf.textHandle=function(t){ut(t)&&t.length>1&&(this.textHandle[0]=t[0],this.textHandle[1]=t[1],this.dirtyLayout=!0)},Jf.guidelineDash=function(t){ut(t)&&(this.guidelineDash=t)},Jf.guidelineStyle=function(t){t?t.substring&&(this.guidelineStyle=t):this.guidelineStyle=this.defs.guidelineStyle},Jf.pathPosition=function(t){t<0&&(t=et(t)),t>1&&(t%=1),this.pathPosition=parseFloat(t.toFixed(6)),this.dirtyTextLayout=!0},tp.pathPosition=function(t){let e=this.pathPosition+t;e<0&&(e+=1),e>1&&(e%=1),this.pathPosition=parseFloat(e.toFixed(6)),this.dirtyTextLayout=!0},Jf.textUnitFlow=function(t){this.textUnitFlow=t,this.dirtyText=!0},Qf.textUnits=function(){return this.textUnits},Qf.textLines=function(){return this.lines},_f.getTester=function(){const t=this.getControllerCell();return t?t.labelStylesCalculator:null},_f.makeWorkingTextStyle=function(t){const e=at(t);return it(e,t),e.isDefaultTextStyle=!1,e},_f.setEngineFromWorkingTextStyle=function(t,e,i,n){this.updateWorkingTextStyle(t,e),i.set(t),n.setEngine(this)},_f.updateWorkingTextStyle=function(t,e){let i=1;this.layoutTemplate&&(i=this.layoutTemplate.currentScale),t.set(e,!0),this.updateCanvasFont(t,i),this.updateFontString(t)},_f.getTextHandleX=function(t,e,i){return t.toFixed?t:t===Ln?i===Si?0:e:t===ce?e/2:t===Ge?i===Si?e:0:t===gi?0:t===vn?e:dt(parseFloat(t))?parseFloat(t)/100*e:0},_f.getTextHandleY=function(t,e,i){const n=this.getFontMetadata(i),{alphabeticRatio:s,hangingRatio:r,height:o,ideographicRatio:a}=n,l=e/100;let c=1;this.layoutTemplate&&(c=this.layoutTemplate.currentScale);const h=o*l;return t.toFixed?t*c:t===Cs?0:t===ae?h*c:t===ce?h/2*c:t===Mt?h*s*c:t===ri?h*r*c:t===hi?h*a*c:t===Oi?h/2*c:dt(parseFloat(t))?parseFloat(t)/100*h:0},_f.getTextOffset=function(t,e){return t.toFixed?t:dt(parseFloat(t))?parseFloat(t)/100*e:0},_f.dirtyCache=function(){il(this.cache),this.cache=null,this.textUnitHitZones.length=0,this.pivoted.length&&this.updatePivotSubscribers()},_f.cleanPathObject=function(){const t=this.layoutTemplate;t&&this.dirtyPathObject&&t.pathObject&&(this.dirtyPathObject=!1,this.pathObject=new Path2D(t.pathObject))},_f.cleanLayout=function(){this.currentFontIsLoaded&&(this.dirtyCache(),this.dirtyLayout=!1,this.useLayoutTemplateAsPath||this.calculateLines(),this.dirtyTextLayout=!0)},_f.calculateLines=function(){const{alignment:t,defaultTextStyle:e,layoutTemplate:i,lineAdjustment:n,lines:s,lineSpacing:r,textUnitFlow:o}=this,{currentDimensions:a,currentScale:l,currentRotation:c,currentStampPosition:h,pathObject:u,winding:d}=i,{fontSizeValue:f}=e,p=(-t-c)*Ct,[g,m]=h,[y,b]=a,S=rl(),A=el(),C=A.engine;A.rotateDestination(C,g,m,i),C.rotate(p);const k=lo();let v,P,O,x,D,w;const F=vt(f*r*l),R=vt(g),T=vt(R-y*l*2),E=vt(R+y*l*2),H=vt(m+n*l),I=vt(H-b*l*2),L=vt(H+b*l*2);if(F){for(let t=H;t>I;t-=F){const e=lo();v=!1,P=!1;for(let i=T;i<E;i++)P=C.isPointInPath(u,i,t,d),P!==v&&(e.push([!1===P?i-1:i,t]),v=P);k.push([t,[...e]]),co(e)}for(let t=H+F;t<L;t+=F){const e=lo();v=!1,P=!1;for(let i=T;i<E;i++)P=C.isPointInPath(u,i,t,d),P!==v&&(e.push([!1===P?i-1:i,t]),v=P);k.push([t,[...e]]),co(e)}}else{const t=lo();v=!1,P=!1;for(let e=T;e<E;e++)P=C.isPointInPath(u,e,H,d),P!==v&&(t.push([!1===P?e-1:e,H]),v=P);k.push([H,[...t]]),co(t)}const B=lo();B.push(...k.filter((t=>t[1].length))),co(k),B.sort(((t,e)=>t[0]>e[0]?1:t[0]<e[0]?-1:0));const $=B.map((t=>t[1]));Nf.includes(o)&&$.reverse(),co(B),$.forEach((e=>{e.forEach((e=>{S.set(e).subtract(h).rotate(t+c).add(h),e[0]=S[0],e[1]=S[1]}))})),dp(...s),s.length=0,$.forEach((t=>{for(let e=0,i=t.length;e<i;e+=2)s.push(up().set({startAt:t[e],endAt:t[e+1]}))}));let M="";s.forEach((t=>{[O,x]=t.startAt,[D,w]=t.endAt,t.length=ht(O-D,x-w),M+=`M ${O}, ${x} ${D}, ${w} `})),this.guidelinesPath=new Path2D(M),il(A),ol(S)},_f.cleanText=function(){if(this.currentFontIsLoaded){this.dirtyText=!1;const{breakTextOnSpaces:t,breakWordsOnHyphens:e,defaultTextStyle:i,text:n,textUnitFlow:s,textUnits:r}=this,o=[...n],a=i.direction===Si,l=Gf.includes(s),c=[];let h=!1;lp(...r),r.length=0;let u=0;t?a&&e?(o.forEach((t=>{Vf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u})),u++,r.push(ap({[ip]:t,[np]:Zf,index:u})),c.length=0,u++):Yf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u})),u++,r.push(ap({[ip]:t,[np]:"H",index:u})),c.length=0,u++):jf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u})),u++,r.push(ap({[ip]:t,[np]:Uf,index:u})),c.length=0,u++):c.push(t)})),c.length&&r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u}))):(o.forEach((t=>{Vf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u})),u++,r.push(ap({[ip]:t,[np]:Zf})),c.length=0,u++):c.push(t)})),c.length&&r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u}))):o.forEach(((t,e)=>{c.push(t),l?Vf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:Zf,index:u})),c.length=0,u++):zf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:"B",index:u})),c.length=0,u++):Kf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:"Z",index:u})),c.length=0,u++):(r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u})),c.length=0,u++):(h=zf.test(t)||zf.test(o[e+1]),h||(Vf.test(t)?(r.push(ap({[ip]:c.join(Ys),[np]:Zf,index:u})),c.length=0,u++):(r.push(ap({[ip]:c.join(Ys),[np]:Wf,index:u})),c.length=0,u++)))})),this.assessTextForStyle(),this.measureTextUnits(),this.dirtyTextLayout=!0}},_f.assessTextForStyle=function(){const t=this.getTester();if(!t)return this.dirtyText=!0,null;const e=t=>{if(3!==t.nodeType)for(const i of t.childNodes)e(i);else{const e=u[i(f)];null!=e&&null==e.style&&(e.style=yf({})),f+=t.textContent.length,l(t,e)}},i=t=>{let e=0;for(let i=0,n=u.length;i<n;i++)if(e+=u[i].chars.length,t<e)return i;return null},n="",s="",r=0,o=0,a=0,l=(t,e)=>{const i=rt(t.parentNode),l={};let c,h;c=d.direction,h=i.getPropertyValue("direction"),c!==h&&(l.direction=h),c=d.fontFamily,h=i.getPropertyValue("font-family"),c!==h&&(l.fontFamily=h),c=d.fontKerning,h=i.getPropertyValue("font-kerning"),c!==h&&(l.fontKerning=h),c=d.fontSize,h=i.getPropertyValue("font-size"),c!==h&&(l.fontSize=h,Lf.test(h)&&(this.usingViewportFontSizing=!0)),c=d.fontStretch,h=i.getPropertyValue("font-stretch"),"100%"===h&&(h=Gi),c!==h&&(l.fontStretch=h),c=d.fontStyle,h=i.getPropertyValue("font-style"),c!==h&&(l.fontStyle=h),c=d.fontVariantCaps,h=i.getPropertyValue("font-variant-caps"),c!==h&&(l.fontVariantCaps=h),c=d.fontWeight,h=i.getPropertyValue("font-weight"),c!==h&&(l.fontWeight=h),c=d.get("letterSpacing"),h=i.getPropertyValue("letter-spacing"),h===Gi&&(h=on),c!==h&&(l.letterSpacing=h),c=d.textRendering,h=i.getPropertyValue("text-rendering"),c!==h&&(l.textRendering=h),c=d.get("wordSpacing"),h=i.getPropertyValue("word-spacing"),c!==h&&(l.wordSpacing=h),c=d.fillStyle,h=i.getPropertyValue("--SC-fill-style"),c!==h&&(l.fillStyle=h),c=d.includeHighlight,h=!!i.getPropertyValue("--SC-include-highlight"),c!==h&&(l.includeHighlight=h),c=d.highlightStyle,h=i.getPropertyValue("--SC-highlight-style"),c!==h&&(l.highlightStyle=h),c=d.lineWidth,h=parseFloat(i.getPropertyValue("--SC-stroke-width")),c!==h&&(l.lineWidth=h),c=d.includeOverline,h=!!i.getPropertyValue("--SC-include-overline"),c!==h&&(l.includeOverline=h),c=d.overlineOffset,h=parseFloat(i.getPropertyValue("--SC-overline-offset")),c!==h&&(l.overlineOffset=h),c=d.overlineStyle,h=i.getPropertyValue("--SC-overline-style"),c!==h&&(l.overlineStyle=h),c=d.overlineWidth,h=parseFloat(i.getPropertyValue("--SC-overline-width")),c!==h&&(l.overlineWidth=h),c=d.includeUnderline,h=!!i.getPropertyValue("--SC-include-underline"),c!==h&&(l.includeUnderline=h),c=d.underlineGap,h=parseFloat(i.getPropertyValue("--SC-underline-gap")),c!==h&&(l.underlineGap=h),c=d.underlineOffset,h=parseFloat(i.getPropertyValue("--SC-underline-offset")),c!==h&&(l.underlineOffset=h),c=d.underlineStyle,h=i.getPropertyValue("--SC-underline-style"),c!==h&&(l.underlineStyle=h),c=d.underlineWidth,h=parseFloat(i.getPropertyValue("--SC-underline-width")),c!==h&&(l.underlineWidth=h),c=d.method,h=i.getPropertyValue("--SC-method"),c!==h&&(l.method=h),c=n,h=i.getPropertyValue("--SC-local-handle-x"),c!==h&&(l.localHandleX=h),c=s,h=i.getPropertyValue("--SC-local-handle-y"),c!==h&&(l.localHandleY=h),c=r,h=parseFloat(i.getPropertyValue("--SC-local-offset-x")),c!==h&&(l.localOffsetX=h),c=o,h=parseFloat(i.getPropertyValue("--SC-local-offset-y")),c!==h&&(l.localOffsetY=h),c=a,h=parseFloat(i.getPropertyValue("--SC-local-alignment")),c!==h&&(l.localAlignment=h),e.set(l),e.style.set(l,!0),d.set(l,!0)},{rawText:c,defaultTextStyle:h,textUnits:u}=this,d=this.makeWorkingTextStyle(h);let f=0;this.usingViewportFontSizing=Lf.test(d.fontSize),(()=>{t.style.setProperty("direction",h.direction),t.style.setProperty("font-family",h.fontFamily),t.style.setProperty("font-kerning",h.fontKerning),t.style.setProperty("font-size",h.fontSize),t.style.setProperty("font-stretch",h.fontStretch),t.style.setProperty("font-style",h.fontStyle),t.style.setProperty("font-variant-caps",h.fontVariantCaps),t.style.setProperty("font-weight",h.fontWeight),t.style.setProperty("letter-spacing",h.get("letterSpacing")),t.style.setProperty("text-rendering",h.textRendering),t.style.setProperty("word-spacing",h.get("wordSpacing")),t.style.setProperty("--SC-fill-style",h.fillStyle),t.style.setProperty("--SC-highlight-style",h.highlightStyle),t.style.setProperty("--SC-overline-offset",h.overlineOffset),t.style.setProperty("--SC-overline-style",h.overlineStyle),t.style.setProperty("--SC-overline-width",h.overlineWidth),t.style.setProperty("--SC-stroke-width",h.lineWidth),t.style.setProperty("--SC-stroke-style",h.strokeStyle),t.style.setProperty("--SC-underline-gap",h.underlineGap),t.style.setProperty("--SC-underline-offset",h.underlineOffset),t.style.setProperty("--SC-underline-style",h.underlineStyle),t.style.setProperty("--SC-underline-width",h.underlineWidth),t.style.setProperty("--SC-local-handle-x",n),t.style.setProperty("--SC-local-handle-y",s),t.style.setProperty("--SC-local-offset-x",r),t.style.setProperty("--SC-local-offset-y",o),t.style.setProperty("--SC-local-alignment",a),t.style.setProperty("--SC-method",h.method),t.className=this.name,t.innerHTML=c})(),e(t)},_f.measureTextUnits=function(){const{defaultTextStyle:t,hyphenString:e,state:i,textUnitFlow:n,textUnits:s,truncateString:r,breakTextOnSpaces:o}=this,a=el(),l=a.engine;let c,h,u,d,f,p,g,m,y,b,S;const A=this.makeWorkingTextStyle(t);this.setEngineFromWorkingTextStyle(A,tr,i,a);const C=Gf.includes(n);s.forEach((t=>{({chars:h,charType:u,style:d}=t),d&&this.setEngineFromWorkingTextStyle(A,d,i,a),c=l.measureText(h),t.len=c.width,u===Zf?t.len+=A.wordSpaceValue:u===Uf?(c=l.measureText(e),t.replaceLen=c.width):(c=l.measureText(r),t.replaceLen=c.width),t.height=C&&!o&&("Z"===u||"B"===u)?0:parseFloat(A.fontSize)})),!this.useLayoutTemplateAsPath&&this.breakTextOnSpaces||(this.setEngineFromWorkingTextStyle(A,t,i,a),s.forEach(((t,e)=>{({chars:h,charType:u,style:d,len:f}=t),d&&this.setEngineFromWorkingTextStyle(A,d,i,a),A.fontKerning!==Yi&&(p=s[e+1],p&&(({style:g,chars:m,charType:y,len:b}=p),u!==Zf&&y!==Zf&&(g&&(g.fontFamily||g.fontSize||g.fontVariantCaps)||(S=f+b,c=l.measureText(`${h}${m}`),p.kernOffset=S-c.width))))}))),il(a)},_f.layoutText=function(){if(this.currentFontIsLoaded){const{useLayoutTemplateAsPath:t,lines:e,textUnits:i,layoutTemplate:n}=this;t?n&&n.useAsPath&&(this.dirtyTextLayout=!1,dp(...e),e.length=0,e.push(up({length:n.length,isPathEntity:!0}))):e.length&&i.length&&(this.dirtyTextLayout=!1,e.forEach((t=>{t.unitData.length=0})),i.forEach((t=>{t.stampFlag=!0,t.lineOffset=0}))),this.assignTextUnitsToLines(),this.positionTextUnits()}},_f.assignTextUnitsToLines=function(){const{breakWordsOnHyphens:t,defaultTextStyle:e,layoutTemplate:i,lines:n,textUnitFlow:s,textUnits:r}=this,o=e.direction===Si,a=Gf.includes(s),l=i.currentScale,c=r.length;let h,u,d,f,p,g,m,y,b,S,A,C=0;const k=function(t){h-=t,f.push(C),++C};if(n.forEach((e=>{for(({length:y,unitData:f}=e),h=st(y),A=!0,u=C;u<c&&(d=r[u],({len:g,height:m,charType:b}=d),S=a?m*l:g,A&&!a&&d.charType===Zf&&(S=0),S<=h);u++){if(o&&!a&&t)if(d=r[u+1],d&&d.charType===Uf){if(p=r[u+2],!(p&&g+p.len<h)){if(g+d.replaceLen<h){k(S),k(d.replaceLen),f.push(Uf);break}break}k(g)}else k(S);else k(S);A=!1}})),o&&!a&&c!==C){let t,e,i,s;for(t=n.length-1;t>=0;t--){if(({length:y,unitData:f}=n[t]),i=f.reduce(((t,e)=>(r[e]&&r[e].charType===Wf&&t++,t)),0),i){s=[...f];break}f.length=0}if(s&&s.length){for(({length:y,unitData:f}=n[t]),i=f.reduce(((t,e)=>(r[e]&&r[e].len&&(t+=r[e].len),t)),0),u=f.length-1;u>=0;u--)if(d=r[f[u]],d)if(({len:g,replaceLen:e,charType:b}=d),b!==Wf&&b!==Uf)i-=g,s.pop();else{if(i+e<y){s.push("T");break}i-=g,s.pop()}f.length=0,f.push(...s)}}},_f.positionTextUnits=function(){this.useLayoutTemplateAsPath?this.positionTextUnitsAlongPath():this.positionTextUnitsInSpace(),this.positionTextDecoration()},_f.positionTextUnitsAlongPath=function(){const{alignment:t,alignTextUnitsToPath:e,defaultTextStyle:i,layoutTemplate:n,lines:s,pathPosition:r,constantSpeedAlongPath:o,textHandle:a,textOffset:l,textUnitFlow:c,textUnits:h}=this,{length:u,unitData:d}=s[0],f=i.direction,p=f===Si,g=Gf.includes(c),m=n.currentScale||1,y=lo(),b=rl(),S=rl();y.push(...d),p||y.reverse();let A,C,k,v,P,O,x,D,w,F,R,T,E,H,I,L,B,$,M,X,Y,G,N,z,j,V,W,U,Z=r,K=u*Z;const _=this.makeWorkingTextStyle(i);this.updateWorkingTextStyle(_,tr),V=_.fontFamily,j=this.getFontMetadata(V),U=j.verticalOffset*(_.fontSizeValue/100)*m,W=j.height*(_.fontSizeValue/100)*m;for(let i=0,s=y.length;i<s;i++)A=y[i],A.toFixed&&(C=h[y[i]],({len:k,height:v,kernOffset:P,localHandle:O,localOffset:x,startData:w,startCorrection:F,boxData:R,localAlignment:T,style:B}=C),B&&(this.updateWorkingTextStyle(_,B),V=_.fontFamily,j=this.getFontMetadata(V),U=j.verticalOffset*(v/100)*m,W=j.height*(v/100)*m),D=v*m,g?(E=O[0]||a[0]||0,Y=this.getTextHandleX(E,k,f),E=O[1]||a[1]||0,G=this.getTextHandleY(E,v,V),E=x[0]||l[0]||0,N=this.getTextOffset(E,k),E=x[1]||l[1]||0,z=this.getTextOffset(E,v),K+=G,K>=u?(K-=u,C.lineStart=!0):C.lineStart=!1,Z=K/u,C.pathData=n.getPathPositionData(Z,o),({x:$,y:M,angle:X}=C.pathData),H=N-Y,I=z-G,w[0]=$,w[1]=M,F[0]=H,F[1]=I+U,L=e?t+X-90:t-90,C.startAlignment=L,C.startRotation=L*Ct,C.localRotation=T*Ct,K+=D-G):(E=O[0]||a[0]||0,Y=this.getTextHandleX(E,k,f),E=O[1]||a[1]||0,G=this.getTextHandleY(E,v,V),E=x[0]||l[0]||0,N=this.getTextOffset(E,k),E=x[1]||l[1]||0,z=this.getTextOffset(E,v),K+=Y,K>=u?(K-=u,C.lineStart=!0):C.lineStart=!1,Z=K/u,C.pathData=n.getPathPositionData(Z,o),({x:$,y:M,angle:X}=C.pathData),H=N-Y,I=z-G,w[0]=$,w[1]=M,F[0]=H,F[1]=I+U,L=e?t+T+X:t+T,C.startAlignment=L,C.startRotation=L*Ct,C.localRotation=T*Ct,K-=Y,K+=k-P),C.set({boxData:null}),S[0]=$+H,S[1]=M+I-U,b.setFromArray(S).subtract(w).rotate(L).add(w),R.tl.push(...b),S[0]+=k,b.setFromArray(S).subtract(w).rotate(L).add(w),R.tr.push(...b),S[1]=M+I+W,b.setFromArray(S).subtract(w).rotate(L).add(w),R.br.push(...b),S[0]-=k,b.setFromArray(S).subtract(w).rotate(L).add(w),R.bl.push(...b));ol(b,S),co(y)},_f.positionTextUnitsInSpace=function(){const{alignment:t,defaultTextStyle:e,getTextHandleX:i,getTextHandleY:n,getTextOffset:s,justifyLine:r,layoutTemplate:o,lines:a,textHandle:l,textOffset:c,textUnitFlow:h,textUnits:u}=this,d=e.direction,f=d===Si,p=Gf.includes(h),{currentRotation:g,currentScale:m}=o;let y,b,S,A,C,k,v,P,O,x,D,w,F,R,T,E,H,I,L,B,$,M,X,Y,G,N,z,j,V,W,U,Z,K,_,q;const Q=this.makeWorkingTextStyle(e);this.updateWorkingTextStyle(Q,tr),Z=Q.fontFamily,K=this.getFontMetadata(Z),_=K.verticalOffset*(Q.fontSizeValue/100)*m,q=K.height*(Q.fontSizeValue/100)*m,a.forEach((e=>{if(({length:b,unitData:S,startAt:j}=e),S.length){const e=lo(),o=lo(),a=rl(),h=rl();switch(C=S.length-1,A=0,k=0,v=0,e.length=0,o.length=0,[N,z]=j,S.forEach(((t,i)=>{t.toFixed&&(y=u[t],0!==i&&i!==C||y.charType!==Zf||(y.stampFlag=!1),y.stampFlag&&(e.push(A),A+=p?y.height*m:y.len-y.kernOffset,r!==$f&&r!==Bf||y.charType!==Zf||k++))})),P=b-A,f&&(S.includes(Uf)||S.includes("T"))&&(y=u[S[S.length-2]],P-=y&&null!=y.replaceLen?y.replaceLen:0),r){case Ge:o.push(...e.map((t=>t+P)));break;case ce:P/=2,o.push(...e.map((t=>t+P)));break;case $f:k&&(v=P/k),o.push(...e);break;case Bf:v=P/(k+2),o.push(...e);break;default:o.push(...e)}if(r===$f)C=0,S.forEach((t=>{if(y=u[t],y&&y.stampFlag&&(C++,y.charType===Zf))for(let t=C,e=o.length;t<e;t++)o[t]+=v}));else if(r===Bf){C=0,S.forEach((t=>{if(y=u[t],y&&y.stampFlag&&(C++,y.charType===Zf))for(let t=C,e=o.length;t<e;t++)o[t]+=v}));const t=[...o];o.length=0,o.push(...t.map((t=>t+v)))}S.forEach((e=>{e.toFixed&&(y=u[e],({boxData:R,height:x,len:O,localAlignment:H,localHandle:T,localOffset:E,startCorrection:F,startData:w,style:D}=y),D&&(this.updateWorkingTextStyle(Q,D),Z=Q.fontFamily,K=this.getFontMetadata(Z),_=K.verticalOffset*(x/100)*m,q=K.height*(x/100)*m),y.stampFlag&&(p?(I=o.shift(),L=T[0]||l[0]||0,M=i.call(this,L,O,d),L=T[1]||l[1]||0,X=n.call(this,L,x,Z),L=E[0]||c[0]||0,Y=s.call(this,L,O),L=E[1]||c[1]||0,G=s.call(this,L,x),U=t+g,a.set(I+X,0).rotate(U),V=N+a[0],W=z+a[1],B=V+Y,$=W+G-X+_,w[0]=V,w[1]=W,F[0]=B-V-M,F[1]=$-W,y.startAlignment=U-90,y.startRotation=(U-90)*Ct,y.localRotation=H*Ct):(I=f?o.shift():b-O-o.shift(),L=T[0]||l[0]||0,M=i.call(this,L,O,d),L=T[1]||l[1]||0,X=n.call(this,L,x,Z),L=E[0]||c[0]||0,Y=s.call(this,L,O),L=E[1]||c[1]||0,G=s.call(this,L,x),U=t+g,a.set(I+M,0).rotate(U),V=N+a[0],W=z+a[1],B=V+Y,$=W+G-X+_,w[0]=V,w[1]=W,F[0]=B-V-M,F[1]=$-W,y.startAlignment=U,y.startRotation=U*Ct,y.localRotation=H*Ct),y.set({boxData:null}),h[0]=B-M,h[1]=$-_,U+=H,p&&(U-=90),a.setFromArray(h).subtract(w).rotate(U).add(w),R.tl.push(...a),h[0]+=O,a.setFromArray(h).subtract(w).rotate(U).add(w),R.tr.push(...a),h[1]=$+q-_,a.setFromArray(h).subtract(w).rotate(U).add(w),R.br.push(...a),h[0]-=O,a.setFromArray(h).subtract(w).rotate(U).add(w),R.bl.push(...a)))})),co(e,o),ol(a,h)}}))},_f.positionTextDecoration=function(){const t=function(t,e,i,n){if(t.length&&t.length===e.length&&n){const s=lo(),r=lo(),o=lo();let a,l,c,h,u,d,f;for(s.push(...t),r.push(...e),a=0,l=s.length;a<l;a++)c=s[a],h=r[a],o.length=0,u=W.setFromArray(h).subtract(c).getMagnitude(),d=W.scalarMultiply(i).getMagnitude(),o.push(...W.add(c)),f=(d+n*U)/u,W.setFromArray(h).subtract(c).scalarMultiply(f).add(c),c[0]=o[0],c[1]=o[1],h[0]=W[0],h[1]=W[1];t.length=0,t.push(...s),e.length=0,e.push(...r),co(s,r,o)}},e=function(t,e,i,n){const s=t.length,r=e.length;let o,a,l;if(s&&r){for(a=t[0][0]-Z[0],l=t[0][1]-Z[1],v=`m ${a.toFixed(2)}, ${l.toFixed(2)} `,o=1;o<s;o++)a=t[o][0]-t[o-1][0],l=t[o][1]-t[o-1][1],v+=`${a.toFixed(2)}, ${l.toFixed(2)} `;for(a=e[e.length-1][0]-t[t.length-1][0],l=e[e.length-1][1]-t[t.length-1][1],v+=`${a.toFixed(2)}, ${l.toFixed(2)} `,o=r-2;o>=0;o--)a=e[o][0]-e[o+1][0],l=e[o][1]-e[o+1][1],v+=`${a.toFixed(2)}, ${l.toFixed(2)} `;v+="z",n.push([i,new Path2D(v),[...Z]])}},i=function(i=!1){Y.length&&($=x,M=D,X=w,i||(B.underlineStyle&&($=B.underlineStyle),B.underlineOffset&&(M=B.underlineOffset),B.underlineWidth&&(X=B.underlineWidth)),t(Y,G,M,X),e(Y,G,$,f),Y.length=0,G.length=0)},n=function(i=!1){N.length&&($=R,M=T,X=E,i||(B.overlineStyle&&($=B.overlineStyle),B.overlineOffset&&(M=B.overlineOffset),B.overlineWidth&&(X=B.overlineWidth)),t(N,z,M,X),e(N,z,$,h),N.length=0,z.length=0)},s=function(t=!1){j.length&&($=I,t||B.highlightStyle&&($=B.highlightStyle),e(j,V,$,a),j.length=0,V.length=0)},{breakTextOnSpaces:r,defaultTextStyle:o,highlightPaths:a,layoutTemplate:l,lines:c,overlinePaths:h,textUnitFlow:u,textUnits:d,underlinePaths:f,useLayoutTemplateAsPath:p}=this;let g,m,y,b,S,A,C,k,v,P,O,x,D,w,F,R,T,E,H,I,L,B,$,M,X;const Y=lo(),G=lo(),N=lo(),z=lo(),j=lo(),V=lo(),W=rl(),{currentScale:U,currentStampPosition:Z}=l;f.length=0,h.length=0,a.length=0;const K=this.makeWorkingTextStyle(o);this.updateWorkingTextStyle(K,tr),({includeUnderline:O,underlineStyle:x,underlineOffset:D,underlineWidth:w,includeOverline:F,overlineStyle:R,overlineOffset:T,overlineWidth:E,includeHighlight:H,highlightStyle:I}=K),c.forEach((t=>{g=t.unitData,Y.length=0,G.length=0,N.length=0,z.length=0,j.length=0,V.length=0,g.forEach((t=>{t.toFixed&&(m=d[t],({boxData:b,charType:P,lineStart:L,localStyle:B,style:y}=m),B||(B=tr),y&&(this.updateWorkingTextStyle(K,y),({includeUnderline:O,includeOverline:F,includeHighlight:H}=K),O&&({underlineStyle:x,underlineOffset:D,underlineWidth:w}=K),F&&({overlineStyle:R,overlineOffset:T,overlineWidth:E}=K),H&&({highlightStyle:I}=K)),m.stampFlag&&(({tl:S,tr:A,br:C,bl:k}=b),Gf.includes(u)?P!==Zf&&((B.includeUnderline||O)&&(Y.push([...S],[...A]),G.push([...k],[...C]),i()),(B.includeOverline||F)&&(N.push([...S],[...A]),z.push([...k],[...C]),n()),(B.includeHighlight||H)&&(j.push([...S],[...A]),V.push([...k],[...C]),s())):p?r?P!==Zf&&((B.includeUnderline||O)&&(Y.push([...S],[...A]),G.push([...k],[...C]),i()),(B.includeOverline||F)&&(N.push([...S],[...A]),z.push([...k],[...C]),n()),(B.includeHighlight||H)&&(j.push([...S],[...A]),V.push([...k],[...C]),s())):(L&&(i(),n(),s()),B.includeUnderline?(i(!0),Y.push([...S],[...A]),G.push([...k],[...C]),i()):O?(Y.push([...S],[...A]),G.push([...k],[...C])):i(),B.includeOverline?(n(!0),N.push([...S],[...A]),z.push([...k],[...C]),n()):F?(N.push([...S],[...A]),z.push([...k],[...C])):n(),B.includeHighlight?(s(!0),j.push([...S],[...A]),V.push([...k],[...C]),s()):H?(j.push([...S],[...A]),V.push([...k],[...C])):s()):(B.includeUnderline?(i(!0),Y.push([...S],[...A]),G.push([...k],[...C]),i()):O?(Y.push([...S],[...A]),G.push([...k],[...C])):i(),B.includeOverline?(n(!0),N.push([...S],[...A]),z.push([...k],[...C]),n()):F?(N.push([...S],[...A]),z.push([...k],[...C])):n(),B.includeHighlight?(s(!0),j.push([...S],[...A]),V.push([...k],[...C]),s()):H?(j.push([...S],[...A]),V.push([...k],[...C])):s())))})),Y.length&&i(),N.length&&n(),j.length&&s()})),ol(W),co(Y,G,N,z,j,V)},_f.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1);const t=this.layoutTemplate;this.currentDimensions=t.currentDimensions,this.currentScale=t.currentScale,this.currentStampHandlePosition=t.currentStampHandlePosition,this.currentStampPosition=t.currentStampPosition,this.dirtyScale&&(this.dirtyCache(),this.dirtyScale=!1,this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyLayout=!0),(this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle||this.dirtyRotation||this.dirtyFilters)&&(this.dirtyCache(),this.dirtyDimensions=!1,this.dirtyStart=!1,this.dirtyOffset=!1,this.dirtyHandle=!1,this.dirtyRotation=!1,this.dirtyPathObject=!0,this.dirtyLayout=!0),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyFont&&(this.cleanFont(),this.dirtyFont||(this.dirtyText=!0)),!this.dirtyPathObject&&this.currentFontIsLoaded&&(this.dirtyText&&(this.updateAccessibleTextHold(),this.cleanText()),this.dirtyLayout&&this.cleanLayout(),this.dirtyTextLayout&&this.layoutText())},_f.stamp=function(t=!1,e,i){this.dirtyFont||this.dirtyText||this.dirtyLayout||(t?(e&&ii.includes(e.type)&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp()):this.visibility&&this.regularStamp())},_f.simpleStamp=qs,_f.removeShadowAndAlpha=function(t){t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor="rgb(0 0 0 / 0)",t.globalAlpha=1,t.globalCompositeOperation=En,t.lineJoin=Dn,t.lineCap=Dn,this.setImageSmoothing(t)},_f.getCellCoverage=function(t){const{width:e,height:i,data:n}=t;let s,r,o,a,l=0,c=0,h=e,u=i,d=3;for(o=0,a=e*i;o<a;o++)n[d]&&(r=ct(o/e),s=o-r*e,h>s&&(h=s),l<s&&(l=s),u>r&&(u=r),c<r&&(c=r)),d+=4;return h<l&&u<c?[h,u,l-h,c-u]:[0,0,e,i]},_f.regularStamp=function(t){const{cache:e,cacheOutput:i,currentHost:n,layoutTemplate:s,state:r}=this,o=t||n;if(o&&s){const{element:t,engine:n}=o;if(i&&e)n.save(),n.shadowOffsetX=r.shadowOffsetX,n.shadowOffsetY=r.shadowOffsetY,n.shadowBlur=r.shadowBlur,n.shadowColor=r.shadowColor,this.setImageSmoothing(n),n.globalAlpha=r.globalAlpha,n.globalCompositeOperation=r.globalCompositeOperation,n.resetTransform(),n.drawImage(e.element,0,0),n.restore();else{const{guidelinesPath:e,showGuidelines:s,useLayoutTemplateAsPath:a}=this,l=a?this.createTextCellsForPath(o):this.createTextCellsForSpace(o);if(l){const{copyCell:c,mainCell:h}=l,u=t.width,d=t.height,f=el(u,d),p=f.element,g=f.engine;this.removeShadowAndAlpha(g);const m=this.addUnderlinesToCopyCell(o,c),y=this.createOverlineCell(o),b=this.createHighlightCell(o);!a&&s&&e&&this.stampGuidelinesOnCell(f),m&&g.drawImage(c.element,0,0),g.drawImage(h.element,0,0),y&&g.drawImage(y.element,0,0),b&&(g.save(),g.globalCompositeOperation=Te,g.drawImage(b.element,0,0),g.restore());if(!(this.noFilters||!this.filters||!this.filters.length)){!this.dirtyFilters&&this.currentFilters||this.cleanFilters();const e=this.currentFilters;this.isStencil&&(g.save(),g.globalCompositeOperation=Rn,g.globalAlpha=1,g.resetTransform(),g.drawImage(t,0,0),g.restore(),this.dirtyFilterIdentifier=!0),g.resetTransform();const i=g.getImageData(0,0,u,d);this.preprocessFilters(e,t.width,t.height);const n=Ac.action({identifier:this.filterIdentifier,image:i,filters:e});n&&(g.globalCompositeOperation=En,g.globalAlpha=1,g.resetTransform(),g.putImageData(n,0,0))}if(n.save(),n.resetTransform(),n.shadowOffsetX=r.shadowOffsetX,n.shadowOffsetY=r.shadowOffsetY,n.shadowBlur=r.shadowBlur,n.shadowColor=r.shadowColor,n.globalAlpha=r.globalAlpha,n.globalCompositeOperation=r.globalCompositeOperation,n.drawImage(p,0,0),n.restore(),this.stashOutput){this.stashOutput=!1;const[t,e,i,n]=this.getCellCoverage(g.getImageData(0,0,u,d));if(this.stashedImageData=g.getImageData(t,e,i,n),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-image`;this.stashOutputAsAsset=!1;const e=el(i,n);if(this.setImageSmoothing(e.engine),e.engine.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=e.element.toDataURL();else{const i=this.getControllerCell();if(i){const n=this,s=document.createElement(ui);s.id=t,s.alt=`A cached image of the ${this.name} ${this.type} entity`,s.onload=function(){i.canvasHold.appendChild(s),n.stashedImage=s,Tc(`#${t}`)},s.src=e.element.toDataURL()}}il(e)}}i?this.cache=f:il(f),il(c,h,y,b)}}}},_f.createTextCellsForPath=function(t){const e=t.element,i=e.width,n=e.height,s=el(i,n),r=el(i,n);if(s&&r){const t=s.engine,e=r.engine,{state:i,lines:n,textUnits:o,defaultTextStyle:a}=this,l=this.makeWorkingTextStyle(a);this.setEngineFromWorkingTextStyle(l,tr,i,s),this.removeShadowAndAlpha(t),this.setEngineFromWorkingTextStyle(l,tr,i,r),this.removeShadowAndAlpha(e);const c=n[0];if(c){const{unitData:n}=c;let a,h,u,d,f,p,g,m,y,b,S,A,C,k,v,P;n.forEach((n=>{if(a=o[n],a&&(({chars:f,charType:p,localRotation:d,localStyle:v,startCorrection:u,startData:h,startRotation:A,style:g}=a),v||(v=tr),g&&(this.setEngineFromWorkingTextStyle(l,g,i,s),this.removeShadowAndAlpha(t),t.lineWidth=l.underlineGap,this.setEngineFromWorkingTextStyle(l,g,i,r),this.removeShadowAndAlpha(e)),p!==Zf)){switch([m,y]=h,[b,S]=u,C=ot(A),k=Ot(A),t.setTransform(C,k,-k,C,m,y),e.setTransform(C,k,-k,C,m,y),t.rotate(d),e.rotate(d),t.strokeText(f,b,S),t.fillText(f,b,S),e.save(),P=v.method||l.method,v.fillStyle&&(e.fillStyle=v.fillStyle),v.strokeStyle&&(e.strokeStyle=v.strokeStyle),P){case Ef:e.strokeText(f,b,S);break;case If:e.fillText(f,b,S),e.strokeText(f,b,S);break;case Hf:e.strokeText(f,b,S),e.fillText(f,b,S);break;default:e.fillText(f,b,S)}e.restore()}}))}return{copyCell:s,mainCell:r}}return il(s,r),null},_f.createTextCellsForSpace=function(t){const e=t.element,i=e.width,n=e.height,s=el(i,n),r=el(i,n);if(s&&r){const t=s.engine,e=r.engine,{state:i,lines:n,textUnits:o,defaultTextStyle:a,hyphenString:l,truncateString:c}=this,h=a.direction===Si,u=this.makeWorkingTextStyle(a);return this.setEngineFromWorkingTextStyle(u,tr,i,s),this.removeShadowAndAlpha(t),this.setEngineFromWorkingTextStyle(u,tr,i,r),this.removeShadowAndAlpha(e),n.forEach((n=>{const{unitData:a}=n;let d,f,p,g,m,y,b,S,A,C,k,v,P,O,x,D,w;a.forEach(((n,F)=>{if(d=o[n],d&&(({startData:f,startCorrection:p,startRotation:C,localRotation:k,chars:g,style:m,localStyle:D}=d),D||(D=tr),m&&(this.setEngineFromWorkingTextStyle(u,m,i,s),this.removeShadowAndAlpha(t),t.lineWidth=u.underlineGap,this.setEngineFromWorkingTextStyle(u,m,i,r),this.removeShadowAndAlpha(e)),h?(O=a[F+1],x=O&&O.substring?O===Uf?`${g}${l}`:`${g}${c}`:g):x=g,x!==Hn)){switch([y,b]=f,[S,A]=p,S=ct(S),A=ct(A),v=ot(C),P=Ot(C),t.setTransform(v,P,-P,v,y,b),e.setTransform(v,P,-P,v,y,b),t.rotate(k),e.rotate(k),t.strokeText(x,S,A),t.fillText(x,S,A),e.save(),w=D.method||u.method,D.fillStyle&&(e.fillStyle=D.fillStyle),D.strokeStyle&&(e.strokeStyle=D.strokeStyle),w){case Ef:e.strokeText(x,S,A);break;case If:e.fillText(x,S,A),e.strokeText(x,S,A);break;case Hf:e.strokeText(x,S,A),e.fillText(x,S,A);break;default:e.fillText(x,S,A)}e.restore()}}))})),{copyCell:s,mainCell:r}}return il(s,r),null},_f.addUnderlinesToCopyCell=function(t,e){const i=this.underlinePaths;if(i.length){const n=t.element,s=n.width,r=n.height,o=el(s,r);if(o){const t=o.engine;this.removeShadowAndAlpha(t);const n=e.engine;return i.forEach((e=>{t.resetTransform(),t.translate(...e[2]),t.fillStyle=this.getStyle(e[0],"fillStyle",o),t.fill(e[1])})),n.save(),this.removeShadowAndAlpha(n),n.globalCompositeOperation=Tn,n.resetTransform(),n.drawImage(o.element,0,0),n.restore(),il(o),!0}il(o)}return!1},_f.createOverlineCell=function(t){const e=this.overlinePaths;if(e.length){const i=t.element,n=i.width,s=i.height,r=el(n,s);if(r){const t=r.engine;return this.removeShadowAndAlpha(t),e.forEach((e=>{t.resetTransform(),t.translate(...e[2]),t.fillStyle=this.getStyle(e[0],"fillStyle",r),t.fill(e[1])})),r}il(r)}return null},_f.createHighlightCell=function(t){const e=this.highlightPaths;if(e.length){const i=t.element,n=i.width,s=i.height,r=el(n,s);if(r){const t=r.engine;return this.removeShadowAndAlpha(t),e.forEach((e=>{t.resetTransform(),t.translate(...e[2]),t.fillStyle=this.getStyle(e[0],"fillStyle",r),t.fill(e[1])})),r}il(r)}return null},_f.stampGuidelinesOnCell=function(t){if(t&&t.engine){const{guidelinesPath:e,guidelineStyle:i,guidelineWidth:n,guidelineDash:s}=this,r=t.engine;r.save(),r.setLineDash(s),r.strokeStyle=i,r.lineWidth=n,this.setImageSmoothing(r),r.stroke(e),r.restore()}},_f.checkHit=function(t=[]){const e=t=>{let e,i;if(ut(t))e=t[0],i=t[1];else{if(!mr(t,t.x,t.y))return[!1];e=t.x,i=t.y}return dt(e)&&dt(i)?[!0,e,i]:[!1]},{checkHitUseTemplate:i,layoutTemplate:n,textUnits:s,textUnitHitZones:r}=this;if(i&&n)return n.checkHit(t);if(!r.length&&s.length){let t,e,i,n;s.forEach((s=>{({tl:t,tr:e,br:i,bl:n}=s.boxData),r.push(new Path2D(`M ${t[0]},${t[1]} ${e[0]},${e[1]} ${i[0]},${i[1]} ${n[0]},${n[1]}Z`))}))}if(r.length){const i=ut(t)?t:[t],n=r.length;let s,o,a,l,c,h,u;const d=el(),f=d.engine;for(h=0,u=i.length;h<u;h++)if([o,a,l]=e(i[h]),o){for(c=0;c<n;c++)if(f.isPointInPath(r[c],a,l)){s={x:a,y:l,index:c,artefact:this};break}if(s)return il(d),s}il(d)}return!1},_f.updatePivotSubscribers=function(){let t;this.pivoted.forEach((e=>{t=o[e],t||(t=l[e],t&&t.type===Un||(t=!1)),t&&(t.dirtyStart=!0),t.addPivotRotation&&(t.dirtyRotation=!0)}),this)},_f.getUnitStartAt=function(t){const e=this.textUnits;return t>=0&&t<e.length?[...e[t].startData]:null},_f.getUnitAlignment=function(t){const{textUnits:e,alignment:i}=this;return t>=0&&t<e.length?i+e[t].localAlignment:i};const ep=function(t){return!!t&&new EnhancedLabel(t)};J.EnhancedLabel=EnhancedLabel;const ip="chars",np="charType",sp=["localStyle","localHandleX","localHandleY","localOffsetX","localOffsetY","localAlignment"],UnitObject=function(){return this.startData=al(),this.startCorrection=al(),this.boxData={tl:[],tr:[],br:[],bl:[]},this.localHandle=[],this.localOffset=[],this.set(this.defs),this},rp=UnitObject.prototype=Ar();rp.type=Xf,rp.defs={chars:Ys,charType:Ys,style:null,pathData:null,pathPos:0,stampFlag:!0,startData:null,startCorrection:null,localHandle:null,localOffset:null,boxData:null,localAlignment:0,localRotation:0,startRotation:0,localStyle:null,lineStart:!1,len:0,height:0,kernOffset:0,replaceLen:0,index:0},rp.defKeys=ft(rp.defs),rp.set=function(t=tr){let e,i,n,s,r;for(const[o,a]of lt(t))if(this.defKeys.includes(o)||sp.includes(o))switch(o){case"startData":case"startCorrection":null!=a?this[o].set(a):this[o].zero();break;case"localHandleX":this.localHandle[0]=null!=a?a:null;break;case"localHandleY":this.localHandle[1]=null!=a?a:null;break;case"localHandle":null!=a?(this.localHandle[0]=a[0],this.localHandle[1]=a[1]):(this.localHandle[0]=null,this.localHandle[1]=null);break;case"localOffsetX":this.localOffset[0]=null!=a?a:null;break;case"localOffsetY":this.localOffset[1]=null!=a?a:null;break;case"localOffset":null!=a?(this.localOffset[0]=a[0],this.localOffset[1]=a[1]):(this.localOffset[0]=null,this.localOffset[1]=null);break;case"boxData":e=this.boxData,null!=a?(({tl:i,tr:n,br:s,bl:r}=a),null!=i&&ut(i)&&(e.tl.length=0,e.tl.push(...i)),null!=n&&ut(n)&&(e.tr.length=0,e.tr.push(...n)),null!=s&&ut(s)&&(e.br.length=0,e.br.push(...s)),null!=r&&ut(r)&&(e.bl.length=0,e.bl.push(...r))):(e.tl.length=0,e.tr.length=0,e.br.length=0,e.bl.length=0);break;case"chars":case"charType":case"height":case"index":case"kernOffset":case"len":case"lineStart":case"localAlignment":case"localStyle":case"pathData":case"pathPos":case"replaceLen":case"stampFlag":case"startRotation":case"style":this[o]=null!=a?a:this.defs[o]}return this},rp.reset=function(){return this.set(this.defs),this},_f.setTextUnit=function(t,e){const i=this.textUnits[t];if(null!==i)for(const[t,n]of lt(e))sp.includes(t)&&i.set({[t]:n});this.dirtyLayout=!0,this.dirtyCache()},_f.setAllTextUnits=function(t){this.textUnits.forEach((e=>{if(null!==e)for(const[i,n]of lt(t))sp.includes(i)&&e.set({[i]:n})})),this.dirtyLayout=!0,this.dirtyCache()},_f.applyTextUnitUpdates=function(){this.dirtyLayout=!0,this.dirtyCache()};const op=[],ap=function(t=tr){op.length||op.push(new UnitObject);const e=op.shift();return e.set(t),e},lp=function(...t){t.forEach((t=>{t&&t.type===Xf&&op.push(t.reset())}))},LineObject=function(){return this.startAt=al(),this.endAt=al(),this.unitData=[],this.set(this.defs),this},cp=LineObject.prototype=Ar();cp.type=Mf,cp.defs={length:0,isPathEntity:!1,startAt:null,endAt:null,unitData:null},cp.defKeys=ft(cp.defs),cp.set=function(t=tr){for(const[e,i]of lt(t))if(this.defKeys.includes(e))switch(e){case"startAt":case"endAt":null!=i?this[e].set(i):this[e].zero();break;case"unitData":this[e].length=0,null!=i&&this[e].push(...i);break;default:this[e]=null!=i?i:this.defs[e]}return this},cp.reset=function(){return this.set(this.defs),this};const hp=[],up=function(t=tr){hp.length||hp.push(new LineObject);const e=hp.shift();return e.set(t),e},dp=function(...t){t.forEach((t=>{t&&t.type===Mf&&hp.push(t.reset())}))},fp=function(){const t=[];return Pt(t,fp.prototype),t},pp=fp.prototype=at(Array.prototype);pp.constructor=fp,pp.type="EnhancedLabelUnitArray";const gp=()=>new fp;pp.findByIndex=function(t){let e;for(let i=0,n=this.length;i<n;i++)if(e=this[i],e.index===t)return e;return null},pp.findFirstWithChar=function(t){let e;for(let i=0,n=this.length;i<n;i++)if(e=this[i],e.chars.includes(t))return e;return null},pp.findAllWithChar=function(t){let e;const i=[];for(let n=0,s=this.length;n<s;n++)e=this[n],e.chars.includes(t)&&i.push(e);return i},pp.findAllDisplayedChars=function(){let t;const e=[];for(let i=0,n=this.length;i<n;i++)t=this[i],t.stampFlag&&t.charType!==Zf&&e.push(t);return e};const Gradient=function(t=tr){return this.stylesInit(t),this},mp=Gradient.prototype=Ar();mp.type="Gradient",mp.lib=Gn,mp.isArtefact=!1,mp.isAsset=!1,Ro(mp),$d(mp),mp.packetObjects=fr(mp.packetObjects,["palette"]),mp.buildStyle=function(t){if(t){const e=t.engine;if(e){const t=e.createLinearGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return te},mp.updateGradientArgs=function(t,e){const i=this.gradientArgs,n=this.currentStart,s=this.currentEnd,r=n[0]+t,o=n[1]+e,a=s[1]+e;let l=s[0]+t;r===l&&o===a&&l++,i.length=0,i.push(r,o,l,a)};const yp=function(t){return!!t&&new Gradient(t)};J.Gradient=Gradient;const bp=["down","round","up"],Sp="emboss-work",Ap=["random","ordered","bluenoise"],Filter=function(t=tr){return this.makeName(t.name),this.register(),this.actions=[],this.set(t),this},Cp=Filter.prototype=Ar();Cp.type=qn,Cp.lib=Ue,Cp.isArtefact=!1,Cp.isAsset=!1,Ro(Cp);const kp={actions:null,method:Ys,lineIn:Ys,lineMix:Ys,lineOut:Ys,opacity:1,alpha:255,angle:0,areaAlphaLevels:null,asset:Ys,blend:Gi,blue:0,blueInBlue:0,blueColor:Qt,blueInGreen:0,blueInRed:0,channelA:1,channelB:1,channelL:1,channelX:gn,channelY:si,clamp:0,compose:En,copyHeight:1,copyWidth:1,copyX:0,copyY:0,concurrent:!1,easing:yi,excludeAlpha:!0,excludeBlue:!1,excludeGreen:!1,excludeRed:!1,excludeTransparentPixels:!0,gradient:null,green:0,greenInBlue:0,greenColor:Qt,greenInGreen:0,greenInRed:0,gutterHeight:1,gutterWidth:1,height:1,highAlpha:255,highBlue:255,highColor:$s,highGreen:255,highRed:255,includeAlpha:!1,includeBlue:!0,includeGreen:!0,includeRed:!0,innerRadius:0,keepOnlyChangedAreas:!1,level:0,lowAlpha:0,lowBlue:0,lowColor:Qt,lowGreen:0,lowRed:0,minimumColorDistance:1e3,noiseType:un,noWrap:!1,offsetAlphaX:0,offsetAlphaY:0,offsetBlueX:0,offsetBlueY:0,offsetGreenX:0,offsetGreenY:0,offsetRedX:0,offsetRedY:0,offsetX:0,offsetY:0,offsetAlphaMin:0,offsetAlphaMax:0,offsetBlueMin:0,offsetBlueMax:0,offsetGreenMin:0,offsetGreenMax:0,offsetRedMin:0,offsetRedMax:0,offsetMin:0,offsetMax:0,opaqueAt:1,operation:vi,outerRadius:"30%",palette:Jt,passes:1,passesHorizontal:1,passesVertical:1,points:null,postProcessResults:!0,processHorizontal:!0,processVertical:!0,radius:1,radiusHorizontal:1,radiusVertical:1,ranges:null,red:0,redInBlue:0,redColor:Qt,redInGreen:0,redInRed:0,reference:Qt,scaleX:1,scaleY:1,seed:we,smoothing:0,startX:Zi,startY:Zi,step:1,stepHorizontal:1,stepVertical:1,strength:1,staticSwirls:null,tileHeight:1,tileWidth:1,tileRadius:1,tolerance:0,transparentAt:0,transparentEdges:!1,useBluenoise:!1,useLabForPaletteDistance:!1,useMixedChannel:!0,useNaturalGrayscale:!1,weights:null,width:1};Cp.defs=ur(Cp.defs,kp),Cp.kill=function(){const t=this.name;let e;return wt(m).forEach((i=>{e=i.filters,e&&e.includes(t)&&pr(e,t)})),wt(k).forEach((i=>{e=i.filters,e&&e.includes(t)&&pr(e,t)})),wt(d).forEach((i=>{e=i.filters,e&&e.includes(t)&&pr(e,t)})),this.deregister(),this};const vp=Cp.setters;Cp.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==$i&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Fs&&(this[a]=l))}return this.method&&Pp[this.method]&&Pp[this.method](this),this.dirtyFilterIdentifier=!0,this},Cp.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==$i&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Fs&&(this[a]=Ws(this[a],l)))}return this.method&&Pp[this.method]&&Pp[this.method](this),this.dirtyFilterIdentifier=!0,this},vp.actions=function(t){null!=t&&(this.actions=t)};const Pp={alphaToChannels:function(t){t.actions=[{action:Bt,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,excludeRed:null==t.excludeRed||t.excludeRed,excludeGreen:null==t.excludeGreen||t.excludeGreen,excludeBlue:null==t.excludeBlue||t.excludeBlue}]},alphaToLuminance:function(t){t.actions=[{action:$t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1}]},areaAlpha:function(t){t.actions=[{action:Nt,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,gutterWidth:null!=t.gutterWidth?t.gutterWidth:1,gutterHeight:null!=t.gutterHeight?t.gutterHeight:1,areaAlphaLevels:null!=t.areaAlphaLevels?t.areaAlphaLevels:[255,0,0,0]}]},blend:function(t){t.actions=[{action:ee,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,lineMix:null!=t.lineMix?t.lineMix:Ys,blend:null!=t.blend?t.blend:Gi,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,opacity:null!=t.opacity?t.opacity:1}]},blue:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,excludeRed:!0,excludeGreen:!0}]},blur:function(t){null!=t.radius&&(t.radiusHorizontal=t.radius,t.radiusVertical=t.radius,delete t.radius),null!=t.step&&(t.stepHorizontal=t.step,t.stepVertical=t.step,delete t.step),null!=t.passes&&(t.passesHorizontal=t.passes,t.passesVertical=t.passes,delete t.passes),t.actions=[{action:se,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,excludeTransparentPixels:null!=t.excludeTransparentPixels&&t.excludeTransparentPixels,processHorizontal:null==t.processHorizontal||t.processHorizontal,radiusHorizontal:null!=t.radiusHorizontal?t.radiusHorizontal:1,stepHorizontal:null!=t.stepHorizontal?t.stepHorizontal:1,passesHorizontal:null!=t.passesHorizontal?t.passesHorizontal:1,processVertical:null==t.processVertical||t.processVertical,radiusVertical:null!=t.radiusVertical?t.radiusVertical:1,stepVertical:null!=t.stepVertical?t.stepVertical:1,passesVertical:null!=t.passesVertical?t.passesVertical:1}]},brightness:function(t){const e=null!=t.level?t.level:1;t.actions=[{action:Di,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,red:e,green:e,blue:e}]},channelLevels:function(t){t.actions=[{action:bi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,red:null!=t.red?t.red:[0],green:null!=t.green?t.green:[0],blue:null!=t.blue?t.blue:[0],alpha:null!=t.alpha?t.alpha:[255]}]},channels:function(t){t.actions=[{action:Di,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,red:null!=t.red?t.red:1,green:null!=t.green?t.green:1,blue:null!=t.blue?t.blue:1,alpha:null!=t.alpha?t.alpha:1}]},channelstep:function(t){let e=null!=t.clamp?t.clamp:$e;bp.includes(e)||(e=$e),t.actions=[{action:Yn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,clamp:e,red:null!=t.red?t.red:1,green:null!=t.green?t.green:1,blue:null!=t.blue?t.blue:1}]},channelsToAlpha:function(t){t.actions=[{action:he,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue}]},chroma:function(t){const e=[],i=[];null!=t.ranges&&t.ranges.forEach((t=>{6===t.length?e.push(t):2===t.length&&(t[0].substring&&t[1].substring&&(i.length=0,t.forEach((t=>{const[e,n,s]=gc.extractRGBfromColor(t);i.push(e,n,s)}))),e.push(i))})),t.actions=[{action:ue,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,ranges:e}]},chromakey:function(t){let e=null!=t.red?t.red:0,i=null!=t.green?t.green:255,n=null!=t.blue?t.blue:0;null!=t.reference&&([e,i,n]=gc.extractRGBfromColor(t.reference),t.red=e,t.green=i,t.blue=n,delete t.reference),t.actions=[{action:be,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,red:e,green:i,blue:n,transparentAt:null!=t.transparentAt?t.transparentAt:0,opaqueAt:null!=t.opaqueAt?t.opaqueAt:1}]},clampChannels:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,n=null!=t.lowBlue?t.lowBlue:0,s=null!=t.highRed?t.highRed:255,r=null!=t.highGreen?t.highGreen:255,o=null!=t.highBlue?t.highBlue:255;null!=t.lowColor&&([e,i,n]=gc.extractRGBfromColor(t.lowColor),t.lowRed=e,t.lowGreen=i,t.lowBlue=n,delete t.lowColor),null!=t.highColor&&([s,r,o]=gc.extractRGBfromColor(t.highColor),t.highRed=s,t.highGreen=r,t.highBlue=o,delete t.highColor),t.actions=[{action:de,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,lowRed:e,lowGreen:i,lowBlue:n,highRed:s,highGreen:r,highBlue:o}]},compose:function(t){t.actions=[{action:Se,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,lineMix:null!=t.lineMix?t.lineMix:Ys,compose:null!=t.compose?t.compose:En,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,opacity:null!=t.opacity?t.opacity:1}]},corrode:function(t){t.actions=[{action:Pe,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,width:null!=t.width?t.width:3,height:null!=t.height?t.height:3,offsetX:null!=t.offsetX?t.offsetX:1,offsetY:null!=t.offsetY?t.offsetY:1,includeRed:null!=t.includeRed&&t.includeRed,includeGreen:null!=t.includeGreen&&t.includeGreen,includeBlue:null!=t.includeBlue&&t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,operation:null!=t.operation?t.operation:vi,opacity:null!=t.opacity?t.opacity:1}]},curveWeights:function(t){t.actions=[{action:Ls,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,weights:null!=t.weights&&t.weights,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel}]},cyan:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeGreen:!0,includeBlue:!0,excludeRed:!0}]},displace:function(t){t.actions=[{action:Ie,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,lineMix:null!=t.lineMix?t.lineMix:Ys,opacity:null!=t.opacity?t.opacity:1,channelX:null!=t.channelX?t.channelX:gn,channelY:null!=t.channelY?t.channelY:si,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,scaleX:null!=t.scaleX?t.scaleX:1,scaleY:null!=t.scaleY?t.scaleY:1,transparentEdges:null!=t.transparentEdges&&t.transparentEdges}]},edgeDetect:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:!0,includeGreen:!0,includeBlue:!0,includeAlpha:!1,weights:[0,1,0,1,-4,1,0,1,0]}]},emboss:function(t){const e=[];t.useNaturalGrayscale?e.push({action:ni,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:Sp}):e.push({action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:Sp,includeRed:!0,includeGreen:!0,includeBlue:!0}),t.clamp&&e.push({action:de,lineIn:Sp,lineOut:Sp,lowRed:0+t.clamp,lowGreen:0+t.clamp,lowBlue:0+t.clamp,highRed:255-t.clamp,highGreen:255-t.clamp,highBlue:255-t.clamp}),t.smoothing&&e.push({action:ti,lineIn:Sp,lineOut:Sp,radius:t.smoothing}),e.push({action:Ye,lineIn:Sp,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,angle:null!=t.angle?t.angle:0,strength:null!=t.strength?t.strength:1,tolerance:null!=t.tolerance?t.tolerance:0,keepOnlyChangedAreas:null!=t.keepOnlyChangedAreas&&t.keepOnlyChangedAreas,postProcessResults:null==t.postProcessResults||t.postProcessResults}),t.actions=e},flood:function(t){let e=null!=t.red?t.red:0,i=null!=t.green?t.green:0,n=null!=t.blue?t.blue:0,s=null!=t.alpha?t.alpha:255;const r=null!=t.excludeAlpha&&t.excludeAlpha;null!=t.reference&&([e,i,n,s]=gc.extractRGBfromColor(t.reference),s=vt(255*s),t.red=e,t.green=i,t.blue=n,t.alpha=s,delete t.reference),t.actions=[{action:Ze,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,red:e,green:i,blue:n,alpha:s,excludeAlpha:r}]},gaussianBlur:function(t){null!=t.radius&&(t.radiusHorizontal=t.radius,t.radiusVertical=t.radius,delete t.radius),t.actions=[{action:ti,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,excludeTransparentPixels:null!=t.excludeTransparentPixels&&t.excludeTransparentPixels,opacity:null!=t.opacity?t.opacity:1,radiusHorizontal:null!=t.radiusHorizontal?t.radiusHorizontal:1,radiusVertical:null!=t.radiusVertical?t.radiusVertical:1}]},glitch:function(t){t.actions=[{action:ei,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel,seed:null!=t.seed?t.seed:we,step:null!=t.step?t.step:1,offsetMin:null!=t.offsetMin?t.offsetMin:0,offsetMax:null!=t.offsetMax?t.offsetMax:0,offsetRedMin:null!=t.offsetRedMin?t.offsetRedMin:0,offsetRedMax:null!=t.offsetRedMax?t.offsetRedMax:0,offsetGreenMin:null!=t.offsetGreenMin?t.offsetGreenMin:0,offsetGreenMax:null!=t.offsetGreenMax?t.offsetGreenMax:0,offsetBlueMin:null!=t.offsetBlueMin?t.offsetBlueMin:0,offsetBlueMax:null!=t.offsetBlueMax?t.offsetBlueMax:0,offsetAlphaMin:null!=t.offsetAlphaMin?t.offsetAlphaMin:0,offsetAlphaMax:null!=t.offsetAlphaMax?t.offsetAlphaMax:0,transparentEdges:null!=t.transparentEdges&&t.transparentEdges,level:null!=t.level?t.level:0}]},gray:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,includeBlue:!0}]},grayscale:function(t){t.actions=[{action:ni,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1}]},green:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,excludeRed:!0,excludeBlue:!0}]},image:function(t){const e={action:rn,lineOut:null!=t.lineOut?t.lineOut:Ys,asset:null!=t.asset?t.asset:Ys,copyWidth:null!=t.copyWidth?t.copyWidth:1,copyHeight:null!=t.copyHeight?t.copyHeight:1,copyX:null!=t.copyX?t.copyX:0,copyY:null!=t.copyY?t.copyY:0};e.identifier=`user-image-${e.asset}-${er()}`,t.actions=[e]},invert:function(t){t.actions=[{action:fi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,includeBlue:!0}]},luminanceToAlpha:function(t){t.actions=[{action:Ai,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1}]},magenta:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeBlue:!0,excludeGreen:!0}]},mapToGradient:function(t){t.gradient&&t.gradient.substring&&(t.gradient=L[t.gradient]),t.actions=[{action:Ci,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,useNaturalGrayscale:null!=t.useNaturalGrayscale&&t.useNaturalGrayscale,gradient:t.gradient||yp()}]},matrix:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,weights:null!=t.weights?t.weights:[0,0,0,0,1,0,0,0,0]}]},matrix5:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,width:5,height:5,offsetX:2,offsetY:2,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,weights:null!=t.weights?t.weights:[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]}]},modifyOk:function(t){t.actions=[{action:xi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,channelL:null!=t.channelL?t.channelL:0,channelA:null!=t.channelA?t.channelA:0,channelB:null!=t.channelB?t.channelB:0}]},modulateOk:function(t){t.actions=[{action:wi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,channelL:null!=t.channelL?t.channelL:1,channelA:null!=t.channelA?t.channelA:1,channelB:null!=t.channelB?t.channelB:1}]},negative:function(t){t.actions=[{action:Mi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1}]},newsprint:function(t){t.actions=[{action:Xi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,width:null!=t.width?t.width:1}]},notblue:function(t){t.actions=[{action:wn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeBlue:!0,level:0}]},notgreen:function(t){t.actions=[{action:wn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeGreen:!0,level:0}]},notred:function(t){t.actions=[{action:wn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,level:0}]},offset:function(t){t.actions=[{action:Ni,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,offsetRedX:null!=t.offsetX?t.offsetX:0,offsetRedY:null!=t.offsetY?t.offsetY:0,offsetGreenX:null!=t.offsetX?t.offsetX:0,offsetGreenY:null!=t.offsetY?t.offsetY:0,offsetBlueX:null!=t.offsetX?t.offsetX:0,offsetBlueY:null!=t.offsetY?t.offsetY:0,offsetAlphaX:null!=t.offsetX?t.offsetX:0,offsetAlphaY:null!=t.offsetY?t.offsetY:0}]},offsetChannels:function(t){t.actions=[{action:Ni,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,offsetRedX:null!=t.offsetRedX?t.offsetRedX:0,offsetRedY:null!=t.offsetRedY?t.offsetRedY:0,offsetGreenX:null!=t.offsetGreenX?t.offsetGreenX:0,offsetGreenY:null!=t.offsetGreenY?t.offsetGreenY:0,offsetBlueX:null!=t.offsetBlueX?t.offsetBlueX:0,offsetBlueY:null!=t.offsetBlueY?t.offsetBlueY:0,offsetAlphaX:null!=t.offsetAlphaX?t.offsetAlphaX:0,offsetAlphaY:null!=t.offsetAlphaY?t.offsetAlphaY:0}]},pixelate:function(t){t.actions=[{action:qi,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha}]},randomNoise:function(t){const e=Ap.includes(t.noiseType)?t.noiseType:un;t.actions=[{action:dn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,width:null!=t.width?t.width:1,height:null!=t.height?t.height:1,seed:null!=t.seed?t.seed:we,noiseType:e,level:null!=t.level?t.level:0,noWrap:null!=t.noWrap&&t.noWrap,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,excludeTransparentPixels:null==t.excludeTransparentPixels||t.excludeTransparentPixels}]},red:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,excludeGreen:!0,excludeBlue:!0}]},reducePalette:function(t){let e=null!=t.palette?t.palette:Jt;t.actions=[],e.substring&&e.includes(zt)&&(e=e.split(zt),e.forEach((t=>t.trim())));let i=t.useBluenoise?ne:t.noiseType||un;Ap.includes(i)||(i=un),t.actions.push({action:mn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,seed:null!=t.seed?t.seed:we,minimumColorDistance:null!=t.minimumColorDistance?t.minimumColorDistance:1e3,palette:e,noiseType:i,opacity:null!=t.opacity?t.opacity:1})},rotateHue:function(t){t.actions=[{action:xn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,angle:null!=t.angle?t.angle:0}]},saturation:function(t){const e=null!=t.level?t.level:1;t.actions=[{action:Di,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,red:e,green:e,blue:e,saturation:!0}]},sepia:function(t){t.actions=[{action:As,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,redInRed:.393,redInGreen:.349,redInBlue:.272,greenInRed:.769,greenInGreen:.686,greenInBlue:.534,blueInRed:.189,blueInGreen:.168,blueInBlue:.131}]},sharpen:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:!0,includeGreen:!0,includeBlue:!0,includeAlpha:!1,weights:[0,-1,0,-1,5,-1,0,-1,0]}]},swirl:function(t){const e=null!=t.startX?t.startX:Zi,i=null!=t.startY?t.startY:Zi,n=null!=t.innerRadius?t.innerRadius:0,s=null!=t.outerRadius?t.outerRadius:"30%",r=null!=t.angle?t.angle:0,o=null!=t.easing?t.easing:yi,a=[...null!=t.staticSwirls?t.staticSwirls:[]];a.push([e,i,n,s,r,o]),t.actions=[{action:zn,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,swirls:a}]},threshold:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,n=null!=t.lowBlue?t.lowBlue:0,s=null!=t.lowAlpha?t.lowAlpha:255,r=null!=t.highRed?t.highRed:255,o=null!=t.highGreen?t.highGreen:255,a=null!=t.highBlue?t.highBlue:255,l=null!=t.highAlpha?t.highAlpha:255;null!=t.lowColor&&([e,i,n,s]=gc.extractRGBfromColor(t.lowColor),s=vt(255*s),t.lowRed=e,t.lowGreen=i,t.lowBlue=n,t.lowAlpha=s,t.low=[e,i,n,s],delete t.lowColor),null!=t.highColor&&([r,o,a,l]=gc.extractRGBfromColor(t.highColor),l=vt(255*l),t.highRed=r,t.highGreen=o,t.highBlue=a,t.highAlpha=l,t.high=[r,o,a,l],delete t.highColor);const c=null!=t.low?t.low:[e,i,n,s],h=null!=t.high?t.high:[r,o,a,l];t.actions=[{action:bs,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,level:null!=t.level?t.level:128,red:null!=t.red?t.red:128,green:null!=t.green?t.green:128,blue:null!=t.blue?t.blue:128,alpha:null!=t.alpha?t.alpha:128,low:c,high:h,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel}]},tiles:function(t){t.actions=[{action:Ss,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,tileRadius:null!=t.tileRadius?t.tileRadius:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,angle:null!=t.angle?t.angle:0,points:null!=t.points?t.points:fn,seed:null!=t.seed?t.seed:we,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha}]},tint:function(t){let e=null!=t.redInRed?t.redInRed:1,i=null!=t.redInGreen?t.redInGreen:0,n=null!=t.redInBlue?t.redInBlue:0,s=null!=t.greenInRed?t.greenInRed:0,r=null!=t.greenInGreen?t.greenInGreen:1,o=null!=t.greenInBlue?t.greenInBlue:0,a=null!=t.blueInRed?t.blueInRed:0,l=null!=t.blueInGreen?t.blueInGreen:0,c=null!=t.blueInBlue?t.blueInBlue:1;null!=t.redColor&&([e,s,a]=gc.extractRGBfromColor(t.redColor),e/=255,s/=255,a/=255,t.redInRed=e,t.greenInRed=s,t.blueInRed=a,delete t.redColor),null!=t.greenColor&&([i,r,l]=gc.extractRGBfromColor(t.greenColor),i/=255,r/=255,l/=255,t.redInGreen=i,t.greenInGreen=r,t.blueInGreen=l,delete t.greenColor),null!=t.blueColor&&([n,o,c]=gc.extractRGBfromColor(t.blueColor),n/=255,o/=255,c/=255,t.redInBlue=n,t.greenInBlue=o,t.blueInBlue=c,delete t.blueColor),t.actions=[{action:As,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,redInRed:e,redInGreen:i,redInBlue:n,greenInRed:s,greenInGreen:r,greenInBlue:o,blueInRed:a,blueInGreen:l,blueInBlue:c}]},userDefined:function(t){t.actions=[{action:Hs,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1}]},yellow:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:Ys,lineOut:null!=t.lineOut?t.lineOut:Ys,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,excludeBlue:!0}]}},Op=function(t){return!!t&&new Filter(t)};J.Filter=Filter;const Force=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.action||(this.action=qs),this},xp=Force.prototype=Ar();xp.type="Force",xp.lib="force",xp.isArtefact=!1,xp.isAsset=!1,Ro(xp);xp.defs=ur(xp.defs,{action:null}),xp.packetFunctions=fr(xp.packetFunctions,["action"]),xp.kill=function(){return this.deregister(),!0};xp.setters.action=function(t){ar(t)?this.action=t:this.action=qs};const Dp=function(t){return!!t&&new Force(t)};J.Force=Force,Dp({name:"gravity",action:(t,e)=>{const{mass:i,load:n}=t,s=Nh();s.setFromVector(e.gravity).scalarMultiply(i),n.vectorAdd(s),zh(s)}});const wp=Number.isSafeInteger||Number.isInteger,Fp="cellGradient",Rp="gridGradient",Tp="gridPicture",Ep="tilePicture",Grid=function(t=tr){return this.tileFill=[],this.tileSources=[],this.rowLines=null,this.columnLines=null,this.currentTileWidth=0,this.currentTileHeight=0,this.entityInit(t),t.tileSources||(this.tileSources=[].concat([{type:ye,source:Qt},{type:ye,source:$s}])),t.tileFill?ut(t.tileFill)&&this.tileFill.length===t.tileFill.length&&(this.tileFill=t.tileFill):(this.tileFill.length=this.columns*this.rows,this.tileFill.fill(0)),this.tilePaths=[],this.tileRealCoordinates=[],this.tileVirtualCoordinates=[],t.dimensions||(t.width||(this.currentDimensions[0]=this.dimensions[0]=20),t.height||(this.currentDimensions[1]=this.dimensions[1]=20)),this},Hp=Grid.prototype=Ar();Hp.type="Grid",Hp.lib=je,Hp.isArtefact=!0,Hp.isAsset=!1,Ro(Hp),od(Hp);const Ip={columns:2,rows:2,columnGutterWidth:1,rowGutterWidth:1,tileSources:null,tileFill:null,gutterColor:"rgb(127 127 127 / 1)"};Hp.defs=ur(Hp.defs,Ip),Hp.packetExclusions=fr(Hp.packetExclusions,["tileSources"]),Hp.finalizePacketOut=function(t,e){const i=t.tileSources=[];this.tileSources.forEach((t=>{i.push({type:t.type,source:cr(t.source)?t.source.name:t.source})})),cr(t.gutterColor)&&(t.gutterColor=t.gutterColor.name);const n=yt(this.state.saveAsPacket(e))[3];return t=ur(t,n),t=this.handlePacketAnchor(t,e)};const Lp=Hp.setters,Bp=Hp.deltaSetters;Lp.columns=function(t){if(lr(t)&&(wp(t)||(t=parseInt(t,10)),t!==this.columns)){let e,i,n;const s=this.tileFill,r=this.columns,o=[];for(this.columns=t,e=0,i=this.rows;e<i;e++)for(n=0;n<t;n++)n<r?o.push(s[e*r+n]):o.push(0);this.tileFill=o}this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Bp.columns=qs,Lp.rows=function(t){if(lr(t)&&(wp(t)||(t=parseInt(t,10)),t!==this.rows)){const e=this.rows;this.rows=t,this.tileFill.length=this.columns*t,e<t&&this.tileFill.fill(0,e*this.columns)}this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Bp.rows=qs,Hp.setAllTilesTo=function(t){return lr(t)&&(wp(t)||(t=parseInt(t,10)),this.tileFill.fill(t),this.dirtyFilterIdentifier=!0),this},Hp.setTileFill=function(t){const{columns:e,rows:i}=this;return ut(t)&&t.length===e*i&&(this.tileFill=t,this.dirtyFilterIdentifier=!0),this},Hp.setTilesTo=function(t,e){const i=this.tileFill;return gr(t)&&lr(e)&&(wp(e)||(e=parseInt(e,10)),lr(t)?i[t]=e:ut(t)&&t.forEach((t=>{lr(t)&&(i[t]=e)})),this.dirtyFilterIdentifier=!0),this},Hp.setTileSourceTo=function(t,e){return lr(t)&&cr(e)&&e.type&&e.source&&(this.tileSources[t]=e),this},Hp.removeTileSource=function(t){return lr(t)&&t&&(this.tileSources[t]=null,this.tileFill=this.tileFill.map((e=>e===t?0:e))),this},Hp.getTileSource=function(t,e){if(lr(t))return lr(e)?this.tileFill[t*this.rows+e]:this.tileFill[t]},Hp.getTilesUsingSource=function(t){const e=[];return lr(t)&&this.tileFill.forEach(((i,n)=>i===t&&e.push(n))),e},Hp.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=new Path2D,i=new Path2D,n=this.currentStampHandlePosition,s=this.currentScale,r=this.currentDimensions,o=-n[0]*s,a=-n[1]*s,l=r[0]*s,c=r[1]*s;t.rect(o,a,l,c);const h=this.columns,u=this.rows,d=l/h,f=c/u,p=this.tilePaths,g=this.tileRealCoordinates,m=this.tileVirtualCoordinates;let y,b,S,A;for(e.moveTo(o,a),e.lineTo(o+l,a),y=1;y<=u;y++){const t=a+y*f;e.moveTo(o,t),e.lineTo(o+l,t)}for(this.rowLines=e,i.moveTo(o,a),i.lineTo(o,a+c),b=1;b<=h;b++)S=o+b*d,i.moveTo(S,a),i.lineTo(S,a+c);for(this.columnLines=i,p.length=0,g.length=0,m.length=0,y=0;y<u;y++)for(b=0;b<h;b++){const t=new Path2D;S=b*d,A=y*f,t.rect(o+S,a+A,d,f),p.push(t),m.push([S,A]),g.push([o+S,a+A])}this.currentTileWidth=d,this.currentTileHeight=f}},Hp.performFill=function(t){if(this.scale>0){t.save();const e=el(),i=e.engine,n=e.element,s=this.tileSources,r=this.tileFill,o=this.tilePaths,a=this.tileRealCoordinates,l=this.tileVirtualCoordinates,c=this.winding,h=this.currentTileWidth,u=this.currentTileHeight,d=this.scale,f=this.currentDimensions;let p;s.forEach(((s,g)=>{if(s&&s.type)switch(s.type){case ye:t.fillStyle=s.source;break;case Fp:this.lockFillStyleToEntity=!1,t.fillStyle=s.source.getData(this,this.currentHost);break;case Rp:this.lockFillStyleToEntity=!0,t.fillStyle=s.source.getData(this,this.currentHost)}const y=r.map((t=>t===g));if(y.length)switch(s.type){case Tp:p=s.source.substring?m[s.source]:s.source,p.simpleStamp&&(n.width=f[0]*d,n.height=f[1]*d,i.globalCompositeOperation=En,i.fillStyle=Qt,y.forEach(((t,e)=>{t&&i.fillRect(l[e][0],l[e][1],h,u)})),i.globalCompositeOperation=Rn,p.simpleStamp(e,{startX:0,startY:0,width:f[0]*d,height:f[1]*d,method:We}),t.drawImage(n,~~a[0][0],~~a[0][1]));break;case Ep:p=s.source.substring?m[s.source]:s.source,p.simpleStamp&&(n.width=h,n.height=u,i.globalCompositeOperation=En,p.simpleStamp(e,{startX:0,startY:0,width:h,height:u,method:We}),y.forEach(((e,i)=>e&&t.drawImage(n,~~a[i][0],~~a[i][1]))));break;default:y.forEach(((e,i)=>e&&t.fill(o[i],c)))}}));const g=this.gutterColor,y=this.rowGutterWidth,b=this.columnGutterWidth;let S;if(gr(g)){switch(g.substring?S={type:ye,source:this.gutterColor}:cr(g)?S=g:lr(g)&&cr(s[g])&&(S=s[g]),S.type){case Fp:this.lockFillStyleToEntity=!1,t.strokeStyle=S.source.getData(this,this.currentHost);break;case Rp:this.lockFillStyleToEntity=!0,t.strokeStyle=S.source.getData(this,this.currentHost);break;case ye:t.strokeStyle=S.source}switch(S.type){case Tp:case Ep:if((y||b)&&(p=S.source.substring?m[S.source]:S.source,p.simpleStamp)){const s=this.currentStampHandlePosition,r=this.currentScale,o=s[0]*r,l=s[1]*r;n.width=f[0]*r,n.height=f[1]*r,i.globalCompositeOperation=En,i.strokeStyle=Qt,i.translate(o,l),y&&(i.lineWidth=y,i.stroke(this.rowLines)),b&&(i.lineWidth=b,i.stroke(this.columnLines)),i.globalCompositeOperation=Rn,p.simpleStamp(e,{startX:0,startY:0,width:f[0]*r,height:f[1]*r,method:We}),t.drawImage(n,~~a[0][0],~~a[0][1]),i.translate(0,0)}break;default:y&&(t.lineWidth=y,t.stroke(this.rowLines)),b&&(t.lineWidth=b,t.stroke(this.columnLines))}}il(e),t.restore()}},Hp.fill=function(t){this.performFill(t)},Hp.drawAndFill=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),this.performFill(t)},Hp.fillAndDraw=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),this.performFill(t),t.stroke(e)},Hp.drawThenFill=function(t){const e=this.pathObject;t.stroke(e),this.performFill(t)},Hp.fillThenDraw=function(t){const e=this.pathObject;this.performFill(t),t.stroke(e)},Hp.checkHit=function(t=[]){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const e=ut(t)?t:[t],i=el(),n=i.engine,s=this.currentStampPosition,r=s[0],o=s[1],a=new Set,l=this.tilePaths;let c,h,u;const d=t=>{let e,i;if(ut(t))e=t[0],i=t[1];else{if(!mr(t,t.x,t.y))return[!1];e=t.x,i=t.y}return dt(e)&&dt(i)?[!0,e,i]:[!1]};return i.rotateDestination(n,r,o,this),e.some((t=>([c,h,u]=d(t),!!c&&n.isPointInPath(this.pathObject,h,u,this.winding))),this)?(e.forEach((t=>{[c,h,u]=d(t),c&&l.some(((t,e)=>!!n.isPointInPath(t,h,u,this.winding)&&(a.add(e),!0)))})),il(i),{x:h,y:u,tiles:[...a],artefact:this}):(il(i),!1)};const $p=function(t){return!!t&&new Grid(t)};J.Grid=Grid;const Label=function(t=tr){return this.entityInit(t),this},Mp=Label.prototype=Ar();Mp.type=ts,Mp.lib=je,Mp.isArtefact=!0,Mp.isAsset=!1,Ro(Mp),od(Mp),Tf(Mp);const Xp={text:Ys,showBoundingBox:!1,boundingBoxStyle:Qt,boundingBoxLineWidth:1,boundingBoxLineDash:null,boundingBoxLineDashOffset:0};Mp.defs=ur(Mp.defs,Xp);const Yp=Mp.getters,Gp=Mp.setters,Np=Mp.deltaSetters;Yp.width=function(){return this.currentDimensions[0]},Gp.width=qs,Np.width=qs,Yp.height=function(){return this.currentDimensions[1]},Gp.height=qs,Np.height=qs,Yp.dimensions=function(){return[...this.currentDimensions]},Gp.dimensions=qs,Np.dimensions=qs,Mp.entityInit=function(t=tr){this.modifyConstructorInputForAnchorButton(t),this.makeName(t.name),this.register(),this.initializePositions(),this.state=Ea(tr),this.defaultTextStyle=yf({name:`${this.name}_default-textstyle`,isDefaultTextStyle:!0}),this.filters=[],this.currentFilters=[],this.dirtyFilters=!1,this.dirtyFiltersCache=!1,this.dirtyImageSubscribers=!1,this.accessibleTextHold=null,this.accessibleTextHoldAttached=null,this.set(this.defs),t.group||(t.group=Cu),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.currentFontIsLoaded=!1,this.updateUsingFontParts=!1,this.updateUsingFontString=!1,this.usingViewportFontSizing=!0,this.letterSpaceValue=0,this.wordSpaceValue=0,this.alphabeticBaseline=0,this.hangingBaseline=0,this.ideographicBaseline=0,this.fontVerticalOffset=0,this.delta={},this.set(t),this.midInitActions(t),this.purge&&this.purgeArtefact(this.purge),this.dirtyFont=!0,this.currentFontIsLoaded=!1},Mp.measureFont=function(){const{defaultTextStyle:t,currentScale:e,dimensions:i}=this,{fontFamily:n,fontSizeValue:s,letterSpaceValue:r,wordSpaceValue:o}=t;t.letterSpacing=r*e+"px",t.wordSpacing=o*e+"px";const a=el(),l=a.engine;l.font=t.canvasFont,l.fontKerning=t.fontKerning,l.fontStretch=t.fontStretch,l.fontVariantCaps=t.fontVariantCaps,l.textRendering=t.textRendering,l.letterSpacing=t.letterSpacing,l.wordSpacing=t.wordSpacing,l.direction=t.direction,l.textAlign=gi,l.textBaseline=Cs;const c=l.measureText(this.text);il(a);const{actualBoundingBoxLeft:h,actualBoundingBoxRight:u}=c,d=this.getFontMetadata(n),f=s/100;i&&(i[0]=st(et(h)+et(u)),i[1]=d.height*f*e);const p=d.verticalOffset*f;this.alphabeticBaseline=(d.alphabeticBaseline*f+p)*e,this.hangingBaseline=(d.hangingBaseline*f+p)*e,this.ideographicBaseline=(d.ideographicBaseline*f+p)*e,this.fontVerticalOffset=p,this.dirtyPathObject=!0,this.dirtyDimensions=!0},Mp.cleanPathObject=function(){this.dirtyPathObject=!1;const t=this.pathObject=new Path2D,e=this.currentHandle,i=this.currentDimensions,[n,s]=e,[r,o]=i;t.rect(-n,-s,r,o)},Mp.cleanDimensions=function(){this.dirtyDimensions=!1;const t=this.dimensions,e=this.currentDimensions,[i,n]=e;e[0]=t[0],e[1]=t[1],this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,i===e[0]&&n===e[1]||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0),this.dirtyFilterIdentifier=!0},Mp.cleanHandle=function(){this.dirtyHandle=!1;const{handle:t,currentHandle:e,currentDimensions:i,mimicked:n,defaultTextStyle:s,alphabeticBaseline:r,hangingBaseline:o,ideographicBaseline:a}=this,[l,c]=t,[h,u]=i,d=s.direction||Si;l.toFixed?e[0]=l:l===gi?e[0]=0:l===vn?e[0]=h:l===ce?e[0]=h/2:l===Ln?e[0]=d===Si?0:h:l===Ge?e[0]=d===Si?h:0:dt(parseFloat(l))?e[0]=parseFloat(l)/100*h:e[0]=0,c.toFixed?e[1]=c:c===Cs?e[1]=0:c===ae?e[1]=u:c===ce||c===Oi?e[1]=u/2:c===ri?e[1]=dt(o)?o:0:c===Mt?e[1]=dt(r)?r:0:c===hi?e[1]=dt(a)?a:0:dt(parseFloat(c))?e[1]=parseFloat(c)/100*u:e[1]=0,this.dirtyFilterIdentifier=!0,this.dirtyStampHandlePositions=!0,n&&n.length&&(this.dirtyMimicHandle=!0)},Mp.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyText&&this.updateAccessibleTextHold(),this.dirtyFont&&this.cleanFont(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},Mp.regularStamp=function(){const t=this.currentHost,e=this.defaultTextStyle;if(t&&e){const i=t.engine,[n,s]=this.currentStampPosition;t.rotateDestination(i,n,s,this),this.noCanvasEngineUpdates||(this.state.set(this.defaultTextStyle),t.setEngine(this)),this.setImageSmoothing(t.engine),this[e.method](t)}},Mp.stampPositioningHelper=function(){const{currentHandle:t,currentScale:e,text:i,fontVerticalOffset:n}=this,s=-t[0],r=-t[1]+n*e;return[i,ct(s),ct(r)]},Mp.underlineEngine=function(t,e){const{currentDimensions:i,currentScale:n,currentStampPosition:s,defaultTextStyle:r,fontVerticalOffset:o}=this,{underlineGap:a,underlineOffset:l,underlineStyle:c,underlineWidth:h}=r,[,u,d]=e,[f,p]=i,g=d+l*p-o*n,m=h*n,{element:y,engine:b}=t,S=el(y.width,y.height),{element:A,engine:C}=S;S.rotateDestination(C,...s,this),C.fillStyle=Qt,C.strokeStyle=Qt,C.font=r.canvasFont,C.fontKerning=r.fontKerning,C.fontStretch=r.fontStretch,C.fontVariantCaps=r.fontVariant,C.textRendering=r.textRendering,C.letterSpacing=r.letterSpacing,C.lineCap=Dn,C.lineJoin=Dn,C.wordSpacing=r.wordSpacing,C.direction=r.direction,C.textAlign=gi,C.textBaseline=Cs,C.lineWidth=2*a*n,this.setImageSmoothing(C);const k=this.getStyle(c,"fillStyle",S);C.strokeText(...e),C.fillText(...e),C.globalCompositeOperation="source-out",C.fillStyle=k,C.fillRect(u,g,f,m),b.save(),b.resetTransform(),this.setImageSmoothing(b),b.drawImage(A,0,0),b.restore(),il(S)},Mp.drawBoundingBox=function(t){if(this.pathObject){const e=this.getStyle(this.boundingBoxStyle,"fillStyle",t),i=t.engine;i.save(),i.strokeStyle=e,i.lineWidth=this.boundingBoxLineWidth,i.setLineDash(this.boundingBoxLineDash||[]),i.lineDashOffset=this.boundingBoxLineDashOffset||0,i.globalCompositeOperation=En,i.globalAlpha=1,i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,this.setImageSmoothing(i),i.stroke(this.pathObject),i.restore()}},Mp.draw=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.strokeText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.fill=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.fillText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.drawAndFill=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.strokeText(...i),e.fillText(...i),this.currentHost.clearShadow(),e.strokeText(...i),e.fillText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.fillAndDraw=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.fillText(...i),e.strokeText(...i),this.currentHost.clearShadow(),e.fillText(...i),e.strokeText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.drawThenFill=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.strokeText(...i),e.fillText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.fillThenDraw=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.fillText(...i),e.strokeText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.clip=function(t){t.engine.clip(this.pathObject,this.winding)},Mp.clear=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=e.globalCompositeOperation,n=this.stampPositioningHelper();e.globalCompositeOperation=Re,e.fillText(...n),e.globalCompositeOperation=i,this.showBoundingBox&&this.drawBoundingBox(t)}},Mp.none=qs;const zp=function(t){return!!t&&new Label(t)};J.Label=Label;const Line=function(t=tr){return this.curveInit(t),this.shapeInit(t),this},jp=Line.prototype=Ar();jp.type=es,jp.lib=je,jp.isArtefact=!0,jp.isAsset=!1,Ro(jp),yd(jp),Sd(jp),jp.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeLinePath()},jp.makeLinePath=function(){let t=Xs;const{currentStampPosition:e,currentEnd:i}=this;if(e&&i){const[e,i]=this.currentStampPosition,[n,s]=this.currentEnd;t=`m0,0l${(n-e).toFixed(2)},${(s-i).toFixed(2)}`}return t},jp.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyEnd=!0},jp.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath;let n,s,r;for(n=0,s=t.length;n<s;n++)r=t[n],(e&&e.name===r||i&&i.name===r)&&(this.dirtyEnd=!0,this.endLockTo.includes(ji)&&(this.currentEndPathData=!1));t.length=0};const Vp=function(t){return!!t&&(t.species="line",new Line(t))};J.Line=Line;const LineSpiral=function(t=tr){return this.shapeInit(t),this},Wp=LineSpiral.prototype=Ar();Wp.type="LineSpiral",Wp.lib=je,Wp.isArtefact=!0,Wp.isAsset=!1,Ro(Wp),yd(Wp);Wp.defs=ur(Wp.defs,{startRadius:0,radiusIncrement:.1,radiusIncrementAdjust:1,startAngle:0,angleIncrement:5,angleIncrementAdjust:1,stepLimit:100});const Up=Wp.setters,Zp=Wp.deltaSetters;Up.startRadius=function(t){this.startRadius=t,this.updateDirty()},Zp.startRadius=function(t){this.startRadius+=t,this.updateDirty()},Up.radiusIncrement=function(t){this.radiusIncrement=t,this.updateDirty()},Zp.radiusIncrement=function(t){this.radiusIncrement+=t,this.updateDirty()},Up.radiusIncrementAdjust=function(t){this.radiusIncrementAdjust=t,this.updateDirty()},Zp.radiusIncrementAdjust=function(t){this.radiusIncrementAdjust+=t,this.updateDirty()},Up.startAngle=function(t){this.startAngle=t,this.updateDirty()},Zp.startAngle=function(t){this.startAngle+=t,this.updateDirty()},Up.angleIncrement=function(t){this.angleIncrement=t,this.updateDirty()},Zp.angleIncrement=function(t){this.angleIncrement+=t,this.updateDirty()},Up.angleIncrementAdjust=function(t){this.angleIncrementAdjust=t,this.updateDirty()},Zp.angleIncrementAdjust=function(t){this.angleIncrementAdjust+=t,this.updateDirty()},Up.stepLimit=function(t){this.stepLimit=t,this.updateDirty()},Zp.stepLimit=function(t){this.stepLimit+=t,this.updateDirty()},Wp.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeLineSpiralPath()},Wp.makeLineSpiralPath=function(){let t=`${Xs} m`;const{startRadius:e,radiusIncrement:i,radiusIncrementAdjust:n,startAngle:s,angleIncrement:r,angleIncrementAdjust:o,stepLimit:a}=this,l=rl();let c=s,h=r,u=e,d=i,f=0;for(l.setFromArray([0,u]).rotate(c),t+=`${l[0].toFixed(1)},${l[1].toFixed(1)}l`;f<a;)f++,h*=o,c+=h,d*=n,u+=d,l.setFromArray([0,u]).rotate(c),t+=`${l[0].toFixed(1)},${l[1].toFixed(1)} `;return ol(l),t},Wp.calculateLocalPathAdditionalActions=function(){const[t,e]=this.localBox,i=this.scale;this.pathDefinition=this.pathDefinition.replace(`${Xs} `,`m${-t/i},${-e/i}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Kp=function(t){return!!t&&(t.species="linespiral",new LineSpiral(t))};J.LineSpiral=LineSpiral;const Loom=function(t=tr){return this.makeName(t.name),this.register(),this.state=Ea(tr),this.modifyConstructorInputForAnchorButton(t),this.set(this.defs),t.group||(t.group=Cu),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.delta={},this.boundingBox=[],this.currentHost=null,this.currentPathData=null,this.dirtyDimensions=!0,this.dirtyHost=!0,this.dirtyInput=!0,this.dirtyOutput=!0,this.dirtyTargetImage=!0,this.fromPathSteps=1,this.output=null,this.pathTests=null,this.sourceDimension=0,this.sourceImageData=null,this.toPathSteps=1,this.watchFromPath=!0,this.set(t),this.fromPathData=[],this.toPathData=[],this.watchFromPath=null,this.watchIndex=-1,this.engineInstructions=[],this.engineDeltaLengths=[],this},_p=Loom.prototype=Ar();_p.type="Loom",_p.lib=je,_p.isArtefact=!0,_p.isAsset=!1,Ro(_p),qc(_p),nh(_p),ah(_p),Ah(_p);const qp={fromPath:null,toPath:null,fromPathStart:0,fromPathEnd:1,toPathStart:0,toPathEnd:1,synchronizePathCursors:!0,loopPathCursors:!0,constantSpeedAlongPath:!0,isHorizontalCopy:!0,showBoundingBox:!1,boundingBoxColor:Qt,source:null,sourceIsVideoOrSprite:!1,interferenceLoops:2,interferenceFactor:1.03,sourceExpansionFactor:1,visibility:!0,calculateOrder:0,stampOrder:0,host:null,group:null,anchor:null,noCanvasEngineUpdates:!1,noDeltaUpdates:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,noUserInteraction:!1,method:We};_p.defs=ur(_p.defs,qp),_p.packetExclusions=fr(_p.packetExclusions,["pathObject","state"]),_p.packetExclusionsByRegex=fr(_p.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),_p.packetObjects=fr(_p.packetObjects,["group","fromPath","toPath","source"]),_p.packetFunctions=fr(_p.packetFunctions,["onEnter","onLeave","onDown","onUp"]),_p.processPacketOut=function(t,e,i){let n=!0;return i.includes(t)||e!==this.defs[t]||(n=!1),n},_p.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=ur(t,i),t=this.handlePacketAnchor(t,e)},_p.handlePacketAnchor=function(t,e){if(this.anchor){const i=yt(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},_p.clone=Js;const Qp=_p.getters,Jp=_p.setters,tg=_p.deltaSetters;_p.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return null!=n?(i=this[t],typeof i!==Fs?i:n):(n=e.defs[t],null!=n?(i=e[t],typeof i!==Fs?i:n):null)}},_p.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.state,o=r?r.setters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Mn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=u)))}return this},_p.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.state,o=r?r.deltaSetters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Mn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=Ws(r[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=Ws(this[h],u))))}return this},Jp.host=function(t){if(t){const e=o[t];e&&e.here?this.host=e.name:this.host=t}else this.host=Ys},Qp.group=function(){return this.group?this.group.name:Ys},Jp.group=function(t){let e;t&&(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring?(e=k[t],this.group=e||t):this.group=t),this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},_p.getHere=function(){return Bo},Jp.delta=function(t){t&&(this.delta=dr(this.delta,t))},Jp.fromPath=function(t){if(t){const e=this.fromPath,i=t.substring?o[t]:t,n=this.name;i&&i.name&&i.useAsPath&&(e&&e.name!==i.name&&pr(e.pathed,n),fr(i.pathed,n),this.fromPath=i,this.dirtyStart=!0)}},Jp.toPath=function(t){if(t){const e=this.toPath,i=t.substring?o[t]:t,n=this.name;i&&i.name&&i.useAsPath&&(e&&e.name!==i.name&&pr(e.pathed,n),fr(i.pathed,n),this.toPath=i,this.dirtyStart=!0)}},Jp.source=function(t){if((t=t.substring?o[t]:t)&&t.type===ss){const e=this.source;e&&e.type===ss&&e.imageUnsubscribe(this.name),this.source=t,t.imageSubscribe(this.name),this.dirtyInput=!0}},Jp.isHorizontalCopy=function(t){this.isHorizontalCopy=!!t,this.dirtyPathData=!0},Jp.synchronizePathCursors=function(t){this.synchronizePathCursors=!!t,t&&(this.toPathStart=this.fromPathStart,this.toPathEnd=this.fromPathEnd),this.dirtyPathData=!0},Jp.loopPathCursors=function(t){if(this.loopPathCursors=!!t,t){let t=this.fromPathStart;(t<0||t>1)&&(this.fromPathStart=t-ct(t)),t=this.fromPathEnd,(t<0||t>1)&&(this.fromPathEnd=t-ct(t)),t=this.toPathStart,(t<0||t>1)&&(this.toPathStart=t-ct(t)),t=this.toPathEnd,(t<0||t>1)&&(this.toPathEnd=t-ct(t))}this.dirtyOutput=!0},Jp.fromPathStart=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.fromPathStart=t,this.synchronizePathCursors&&(this.toPathStart=t),this.dirtyPathData=!0},tg.fromPathStart=function(t){let e=this.fromPathStart+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.fromPathStart=e,this.synchronizePathCursors&&(this.toPathStart=e),this.dirtyPathData=!0},Jp.fromPathEnd=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.fromPathEnd=t,this.synchronizePathCursors&&(this.toPathEnd=t),this.dirtyPathData=!0},tg.fromPathEnd=function(t){let e=this.fromPathEnd+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.fromPathEnd=e,this.synchronizePathCursors&&(this.toPathEnd=e),this.dirtyPathData=!0},Jp.toPathStart=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.toPathStart=t,this.synchronizePathCursors&&(this.fromPathStart=t),this.dirtyPathData=!0},tg.toPathStart=function(t){let e=this.toPathStart+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.toPathStart=e,this.synchronizePathCursors&&(this.fromPathStart=e),this.dirtyPathData=!0},Jp.toPathEnd=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.toPathEnd=t,this.synchronizePathCursors&&(this.fromPathEnd=t),this.dirtyPathData=!0},tg.toPathEnd=function(t){let e=this.toPathEnd+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.toPathEnd=e,this.synchronizePathCursors&&(this.fromPathEnd=e),this.dirtyPathData=!0},_p.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=o[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return Bo},_p.midInitActions=qs,_p.update=function(){this.dirtyInput=!0,this.dirtyOutput=!0},_p.prepareStamp=function(){const t=this.fromPath,e=this.toPath,[i,n]=this.getBoundingBox();if(!this.dirtyPathData){const{x:i,y:n}=t.getPathPositionData(0),{x:s,y:r}=t.getPathPositionData(1),{x:o,y:a}=e.getPathPositionData(0),{x:l,y:c}=e.getPathPositionData(1),h=[i,n,s,r,o,a,l,c];this.pathTests&&!this.pathTests.some(((t,e)=>t!==h[e]))||(this.pathTests=h,this.dirtyPathData=!0)}if(this.dirtyPathData||!this.fromPathData.length){this.dirtyPathData=!1,this.watchIndex=-1,this.engineInstructions.length=0,this.engineDeltaLengths.length=0;const s=this.fromPathData;s.length=0;const r=this.toPathData;if(r.length=0,t&&e){const o=st(t.length),a=st(e.length),l=this.setSourceDimension(pt(o,a)*this.sourceExpansionFactor),c=this.fromPathStart,h=this.fromPathEnd,u=this.toPathStart,d=this.toPathEnd,f=this.constantSpeedAlongPath;let p,g;p=c<h?h-c:h+(1-c),p<.005&&(p=.005),g=u<d?d-u:d+(1-u),g<.005&&(g=.005);const m=st(gt(p,g)),y=1/(l*(1/m));let b,S,A;for(A=0;A<=1;A+=y)({x:b,y:S}=t.getPathPositionData(A,f)),s.push([b-i,S-n]),({x:b,y:S}=e.getPathPositionData(A,f)),r.push([b-i,S-n]);this.fromPathSteps=p/m,this.toPathSteps=g/m,this.watchFromPath=1===this.fromPathSteps,this.dirtyOutput=!0}else this.dirtyPathData=!0}this.prepareStampTabsHelper()},_p.setSourceDimension=function(t){if(t)this.sourceDimension!==t&&(this.sourceDimension=t,this.dirtyInput=!0);else{const t=this.fromPath,e=this.toPath;if(t&&e){const i=st(t.length),n=st(e.length),s=pt(i,n);this.sourceDimension!==s&&(this.sourceDimension=s)}else this.sourceDimension=0}return this.sourceDimension},_p.simpleStamp=function(t,e){t&&ii.includes(t.type)&&(this.currentHost=t,e&&(this.set(e),this.prepareStamp()),this.regularStamp())},_p.stamp=function(t=!1,e,i){if(t)return e&&ii.includes(e.type)&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp();this.visibility&&((this.sourceIsVideoOrSprite||this.dirtyInput)&&this.cleanInput(),this.dirtyOutput&&(this.output=this.cleanOutput()),this.regularStamp())},_p.cleanInput=function(){this.dirtyInput=!1;const t=this.sourceDimension;if(!t)return this.dirtyInput=!0,!1;const e=el(),i=e.engine,n=e.element;n.width=t,n.height=t,i.setTransform(1,0,0,1,0,0),this.source.stamp(!0,e,{startX:0,startY:0,handleX:0,handleY:0,offsetX:0,offsetY:0,roll:0,scale:1,width:t,height:t,method:We}),this.sourceImageData=i.getImageData(0,0,t,t),il(e)},_p.cleanOutput=function(){this.dirtyOutput=!1;const t=this.sourceDimension,e=this.sourceImageData;if(t&&e){const i=this.fromPathData,n=this.toPathData,s=i.length,r=this.fromPathStart,o=this.fromPathSteps||1,a=this.toPathStart,l=this.toPathSteps||1,c=St-1.5708,h=this.isHorizontalCopy,u=this.loopPathCursors,d=this.watchFromPath,f=this.engineInstructions,p=this.engineDeltaLengths;let g,m,y,b,S,A,C,k,v,P,O,x,D,w=r*s,F=a*s,R=this.watchIndex,[,,T,E]=this.getBoundingBox();if(T&&E){T=~~T,E=~~E;const r=el(),a=r.engine,H=r.element;H.width=t,H.height=t,a.setTransform(1,0,0,1,0,0),a.putImageData(e,0,0);const I=el(),L=I.engine,B=I.element;if(B.width=T,B.height=E,L.globalAlpha=this.state.globalAlpha,L.setTransform(1,0,0,1,0,0),!f.length){for(O=0;O<t;O++)R<0&&(d&&w<1||!d&&F<1)&&(R=O),w<s&&F<s&&w>=0&&F>=0?([g,m]=i[ct(w)],[y,b]=n[ct(F)],S=y-g,A=b-m,C=ht(S,A),h?(k=-nt(S,A)+St,v=ot(k),P=Ot(k),f.push([v,P,-P,v,g,m]),p.push(C)):(k=-nt(S,A)+c,v=ot(k),P=Ot(k),f.push([v,P,-P,v,g,m,C]),p.push(C))):(f.push(!1),p.push(!1)),w+=o,F+=l,u&&(w>=s&&(w-=s),F>=s&&(F-=s));R<0&&(R=0),this.watchIndex=R}if(h)for(O=0;O<t;O++)D=f[R],D&&(L.setTransform(...D),L.drawImage(H,0,~~R,~~t,1,0,0,~~p[R],1)),R++,R>=t&&(R=0);else for(O=0;O<t;O++)D=f[R],D&&(L.setTransform(...D),L.drawImage(H,~~R,0,1,~~t,0,0,1,~~p[R])),R++,R>=t&&(R=0);const $=this.interferenceFactor,M=this.interferenceLoops,X=1+~~(T*$),Y=1+~~(E*$);for(H.width=X,H.height=Y,L.setTransform(1,0,0,1,0,0),a.setTransform(1,0,0,1,0,0),x=0;x<M;x++)a.drawImage(B,0,0,T,E,0,0,X,Y),L.drawImage(H,0,0,X,Y,0,0,T,E);const G=L.getImageData(0,0,T,E);return il(r,I),this.dirtyTargetImage=!0,G}this.dirtyOutput=!0}return!1},_p.regularStamp=function(){const t=this.currentHost;if(t){const e=t.engine;this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},_p.getBoundingBox=function(){const t=this.fromPath,e=this.toPath;if(t&&e){if(this.dirtyStart)if(this.boundingBox.length=0,t.getBoundingBox&&e.getBoundingBox){this.dirtyStart=!1;let[i,n,s,r,o,a]=t.getBoundingBox(),[l,c,h,u,d,f]=e.getBoundingBox();dt(i)&&dt(n)&&dt(s)&&dt(r)&&dt(o)&&dt(a)&&dt(l)&&dt(c)&&dt(h)&&dt(u)&&dt(d)&&dt(f)||(this.dirtyStart=!0),i===l&&n===c&&s===h&&r===u&&o===d&&a===f&&(this.dirtyStart=!0),i+=o,n+=a,l+=d,c+=f;const p=gt(i,l),g=pt(i+s,l+h),m=gt(n,c),y=pt(n+r,c+u);this.boundingBox.push(p,m,g-p,y-m),this.dirtyPathData=!0}else this.boundingBox.push(0,0,0,0)}else this.boundingBox.length||this.boundingBox.push(0,0,0,0);return this.boundingBox},_p.fill=function(t){this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},_p.draw=function(t){this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},_p.drawAndFill=function(t){this.doStroke(t),this.currentHost.clearShadow(),this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},_p.fillAndDraw=function(t){this.doFill(t),this.currentHost.clearShadow(),this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},_p.drawThenFill=function(t){this.doStroke(t),this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},_p.fillThenDraw=function(t){this.doFill(t),this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},_p.clear=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element,n=t.globalCompositeOperation;if(e&&i){const i=el(),s=i.engine,r=i.element;let[o,a,l,c]=this.getBoundingBox();o=~~o,a=~~a,l=~~l,c=~~c,r.width=l,r.height=c,s.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation=Re,t.drawImage(r,0,0,l,c,o,a,l,c),t.globalCompositeOperation=n,il(i),this.showBoundingBox&&this.drawBoundingBox(t)}},_p.none=qs,_p.clip=qs,_p.doStroke=function(t){const e=this.fromPath,i=this.toPath;if(e&&e.getBoundingBox&&i&&i.getBoundingBox){const n=this.currentHost;if(n){const s=e.currentStampPosition,r=e.getPathPositionData(1),o=i.currentStampPosition,a=i.getPathPositionData(1);n.rotateDestination(t,s[0],s[1],e),t.stroke(e.pathObject),n.rotateDestination(t,o[0],o[1],e),t.stroke(i.pathObject),t.setTransform(1,0,0,1,0,0),t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(a.x,a.y),t.moveTo(...o),t.lineTo(...s),t.closePath(),t.stroke()}}},_p.doFill=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element;if(e&&i){const i=el(),n=i.engine,s=i.element;let[r,o,a,l]=this.getBoundingBox();r=~~r,o=~~o,a=~~a,l=~~l,s.width=a,s.height=l,n.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.drawImage(s,0,0,a,l,r,o,a,l),il(i)}},_p.drawBoundingBox=function(t){this.dirtyStart&&this.getBoundingBox(),t.save();const e=t.getTransform();t.setTransform(1,0,0,1,0,0),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation=En,t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.strokeRect(...this.boundingBox),t.restore(),t.setTransform(e)},_p.checkHit=function(t=[]){if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=!(!this.output||!this.output.data)&&this.output.data;let n,s,r,o,a;if(i){const[t,l,c,h]=this.getBoundingBox();if(e.some((e=>{if(ut(e))n=e[0],s=e[1];else{if(!mr(e,e.x,e.y))return!1;n=e.x,s=e.y}return!(!dt(n)||!dt(s))&&(r=n-t,o=s-l,!(r<0||r>c||o<0||o>h)&&(a=4*(o*c+r)+3,!!i&&i[a]>0))}),this))return{x:n,y:s,artefact:this}}return!1};const eg=function(t){return!!t&&new Loom(t)};J.Loom=Loom;const Mesh=function(t=tr){return this.makeName(t.name),this.register(),this.modifyConstructorInputForAnchorButton(t),this.set(this.defs),this.state=Ea(),t.group||(t.group=Cu),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.delta={},this.currentHost=null,this.dirtyHost=!0,this.badNet=!0,this.dirtyParticles=!0,this.particlePositions=null,this.sourceImageData=null,this.sourceDimension=0,this.rows=null,this.columns=null,this.struts=null,this.boundingBox=null,this.pathObject=null,this.dirtyOutput=!0,this.dirtyTargetImage=!0,this.output=null,this.set(t),this.fromPathData=[],this.toPathData=[],this.watchFromPath=null,this.watchIndex=-1,this.engineInstructions=[],this.engineDeltaLengths=[],this},ig=Mesh.prototype=Ar();ig.type="Mesh",ig.lib=je,ig.isArtefact=!0,ig.isAsset=!1,Ro(ig),qc(ig),nh(ig),ah(ig),Ah(ig);const ng={net:null,isHorizontalCopy:!0,source:null,sourceIsVideoOrSprite:!1,interferenceLoops:2,interferenceFactor:1.03,visibility:!0,calculateOrder:0,stampOrder:0,delta:null,host:null,group:null,anchor:null,noCanvasEngineUpdates:!1,noDeltaUpdates:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,noUserInteraction:!1,method:We};ig.defs=ur(ig.defs,ng),ig.packetExclusions=fr(ig.packetExclusions,["pathObject","state"]),ig.packetExclusionsByRegex=fr(ig.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),ig.packetObjects=fr(ig.packetObjects,["group","net","source"]),ig.packetFunctions=fr(ig.packetFunctions,["onEnter","onLeave","onDown","onUp"]),ig.processPacketOut=function(t,e,i){let n=!0;return!i.includes(t)<0&&e===this.defs[t]&&(n=!1),n},ig.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=ur(t,i),t=this.handlePacketAnchor(t,e)},ig.handlePacketAnchor=function(t,e){if(this.anchor){const i=yt(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},ig.clone=Js;const sg=ig.getters,rg=ig.setters;ig.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return typeof n!==Fs?(i=this[t],typeof i!==Fs?i:n):(n=e.defs[t],typeof n!==Fs?(i=e[t],typeof i!==Fs?i:n):null)}},ig.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.state,o=r?r.setters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==$i&&null!=u&&(Mn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Fs&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Fs&&(this[h]=u,this.dirtyFilterIdentifier=!0)))}return this},ig.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.state,o=r?r.deltaSetters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!=$i&&null!=u&&(Mn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!=Fs&&(r[h]=Ws(r[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!=Fs&&(this[h]=Ws(this[h],u),this.dirtyFilterIdentifier=!0)))}return this},rg.host=function(t){if(t){const e=o[t];e&&e.here?this.host=e.name:this.host=t}else this.host=Ys;this.dirtyFilterIdentifier=!0},sg.group=function(){return this.group?this.group.name:Ys},rg.group=function(t){let e;t&&(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring?(e=k[t],this.group=e||t):this.group=t),this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},ig.getHere=function(){return Bo},rg.net=function(t){t&&((t=t.substring?o[t]:t)&&"Net"===t.type&&(this.net=t,this.dirtyStart=!0),this.dirtyFilterIdentifier=!0)},rg.source=function(t){if((t=t.substring?o[t]:t)&&t.type===ss){const e=this.source;e&&e.type===ss&&e.imageUnsubscribe(this.name),this.source=t,t.imageSubscribe(this.name),this.dirtyInput=!0,this.dirtyFilterIdentifier=!0}},rg.isHorizontalCopy=function(t){this.isHorizontalCopy=!!t,this.dirtyPathData=!0,this.dirtyFilterIdentifier=!0},ig.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=o[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return Bo},ig.midInitActions=qs,ig.prepareStamp=function(){this.badNet=!0,this.dirtyParticles=!1,this.particlePositions||(this.particlePositions=[]);const{net:t,particlePositions:e}=this;if(t&&t.particleStore&&t.particleStore.length>3){const{rows:i,columns:n,particleStore:s}=t;if(i&&n){this.badNet=!1,this.rows=i,this.columns=n;const t=[];s.forEach((e=>{const i=e.position,{x:n,y:s}=i;t.push([n,s])}));const r=t.join(zt);e.join(zt)!==r&&(this.particlePositions=t,this.dirtyInput=!0),this.sourceIsVideoOrSprite&&(this.dirtyInput=!0)}}this.prepareStampTabsHelper()},ig.setSourceDimension=function(){if(!this.badNet){const{columns:t,rows:e,particlePositions:i}=this,n=lo(),s=lo(),r=lo(),o=lo(),a=lo(),l=lo(),c=lo(),h=lo(),u=lo();let d,f,p,g,m,y,b,S,A,C,k,v,P,O,x,D,w,F;for(p=0;p<e;p++){for(g=0,P=s[p]=lo(),y=h[p]=[],d=0,f=t-1;d<f;d++)m=p*t+d,[b,A]=i[m],[S,C]=i[m+1],y.push([b,A,S,C]),0===d?l.push([b,A]):d===f-1?c.push([S,C]):0===p?(a.push([b,A]),d===f-2&&a.push([S,C])):p===e-1&&(u.push([b,A]),d===f-2&&u.push([S,C])),r.push(b,S),o.push(A,C),k=S-b,v=C-A,O=xt(k*k+v*v),g+=O,P.push(O);n.push(g)}this.sourceDimension=pt(...n);const R=this.currentHost||this.getHost();if(R){const t=pt(...R.currentDimensions);this.sourceDimension>t&&(this.sourceDimension=t)}for(x=0,D=s.length;x<D;x++)for(O=n[x],P=s[x],y=h[x],w=0,F=P.length;w<F;w++)O&&(P[w]=P[w]/O),y[w].push(P[w]);this.struts||(this.struts=[]),this.struts.length=0,this.struts.push(...h);const T=gt(...r),E=gt(...o),H=pt(...r),I=pt(...o);this.boundingBox=[T,E,H-T,I-E],l.reverse(),u.reverse();let L=`M${a[0][0]},${a[0][1]}L`;for(x=1,D=a.length;x<D;x++)[d,p]=a[x],L+=`${d},${p} `;for(x=0,D=c.length;x<D;x++)[d,p]=c[x],L+=`${d},${p} `;for(x=0,D=u.length;x<D;x++)[d,p]=u[x],L+=`${d},${p} `;for(x=0,D=l.length;x<D;x++)[d,p]=l[x],L+=`${d},${p} `;L+="z",this.pathObject=new Path2D(L),co(...s,s),co(n,r,o,a,l,c,u,h)}},ig.simpleStamp=function(t,e){t&&t.type===Un&&(this.currentHost=t,e&&(this.set(e),this.prepareStamp()),this.regularStamp())},ig.stamp=function(t=!1,e,i){t?(e&&e.type===Un&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp()):this.visibility&&(this.dirtyInput&&(this.sourceImageData=this.cleanInput(),this.sourceImageData?this.output=this.cleanOutput():this.dirtyInput=!0),this.output&&this.regularStamp())},ig.cleanInput=function(){this.dirtyInput=!1,this.setSourceDimension();const t=this.sourceDimension;if(!t)return this.dirtyInput=!0,!1;const e=el(),i=e.engine,n=e.element;n.width=t,n.height=t,i.setTransform(1,0,0,1,0,0),this.source.stamp(!0,e,{startX:0,startY:0,handleX:0,handleY:0,offsetX:0,offsetY:0,roll:0,scale:1,width:t,height:t,method:We});const s=i.getImageData(0,0,t,t);return il(e),s},ig.cleanOutput=function(){this.dirtyOutput=!1;const{sourceImageData:t,columns:e,rows:i,struts:n,boundingBox:s}=this,r=st(this.sourceDimension);if(t&&i-1>0){let[o,a,l,c]=s;l=~~(o+l),c=~~(a+c);const h=el(),u=h.engine,d=h.element;d.width=r,d.height=r,u.setTransform(1,0,0,1,0,0),u.putImageData(t,0,0);const f=el(),p=f.engine,g=f.element;g.width=l,g.height=c,p.globalAlpha=this.state.globalAlpha,p.setTransform(1,0,0,1,0,0);const m=parseFloat((r/(i-1)).toFixed(4)),y=parseFloat((r/(e-1)).toFixed(4));let b,S,A,C,k,v,P,O,x,D,w,F,R,T,E,H,I,L,B,$,M,X,Y;for(M=0,X=i-1;M<X;M++)for(b=n[M],S=n[M+1],B=0,$=e-1;B<$;B++){let[t,e,i,n,s]=b[B],[o,a,l,c,h]=S[B];for(s*=r,h*=r,A=pt(s,h,y),C=y/A,k=(i-t)/A,v=(n-e)/A,P=(l-o)/A,O=(c-a)/A,Y=0;Y<A;Y++){x=t+k*Y,D=e+v*Y,w=o+P*Y,F=a+O*Y,T=M*m,R=B*y+C*Y,E=x-w,H=D-F,I=xt(E*E+H*H),L=nt(H,E)+St,p.setTransform(1,0,0,1,x,D),p.rotate(L);const i=T+m>r?r-T:m;p.drawImage(d,~~R,~~T,1,~~i,0,0,1,~~I)}}const G=this.interferenceFactor,N=this.interferenceLoops,z=1+~~(l*G),j=1+~~(c*G);d.width=z,d.height=j,p.setTransform(1,0,0,1,0,0),u.setTransform(1,0,0,1,0,0);for(let t=0;t<N;t++)u.drawImage(g,0,0,l,c,0,0,z,j),p.drawImage(d,0,0,z,j,0,0,l,c);const V=p.getImageData(0,0,l,c);return il(h,f),this.dirtyTargetImage=!0,V}return!1},ig.regularStamp=function(){const t=this.currentHost;if(t){const e=t.engine;this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},ig.fill=function(t){this.doFill(t)},ig.draw=function(t){this.doStroke(t)},ig.drawAndFill=function(t){this.doStroke(t),this.currentHost.clearShadow(),this.doFill(t)},ig.fillAndDraw=function(t){this.doFill(t),this.currentHost.clearShadow(),this.doStroke(t)},ig.drawThenFill=function(t){this.doStroke(t),this.doFill(t)},ig.fillThenDraw=function(t){this.doFill(t),this.doStroke(t)},ig.clear=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element,n=t.globalCompositeOperation;if(e&&i){const s=el(),r=s.engine,o=s.element,a=i.width,l=i.height;o.width=a,o.height=l,r.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation=Re,t.drawImage(o,0,0),t.globalCompositeOperation=n,il(s)}},ig.none=qs,ig.clip=qs,ig.doStroke=function(t){t.setTransform(1,0,0,1,0,0),t.stroke(this.pathObject)},ig.doFill=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element;if(e&&i){const n=el(),s=n.engine,r=n.element,o=i.width,a=i.height;r.width=o,r.height=a,s.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0),il(n)}},ig.checkHit=function(t=[]){if(this.noUserInteraction)return!1;if(!this.pathObject)return!1;const e=ut(t)?t:[t];let i,n;const s=el();if(e.some((t=>{if(ut(t))i=t[0],n=t[1];else{if(!mr(t,t.x,t.y))return!1;i=t.x,n=t.y}return!(!dt(i)||!dt(n))&&s.engine.isPointInPath(this.pathObject,i,n,this.winding)}),this)){const t={x:i,y:n,artefact:this};return il(s),t}return il(s),!1};const og=function(t){return!!t&&new Mesh(t)};J.Mesh=Mesh;const Spring=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.action||(this.action=qs),this},ag=Spring.prototype=Ar();ag.type="Spring",ag.lib="spring",ag.isArtefact=!1,ag.isAsset=!1,Ro(ag);ag.defs=ur(ag.defs,{particleFrom:null,particleFromIsStatic:!1,particleTo:null,particleToIsStatic:!1,springConstant:50,damperConstant:10,restLength:1}),ag.packetObjects=fr(ag.packetObjects,["particleFrom","particleTo"]),ag.kill=function(){return this.deregister(),!0};const lg=ag.setters;lg.particleFrom=function(t){t.substring&&(t=P[t]),t&&t.type===ns&&(this.particleFrom=t)},lg.particleTo=function(t){t.substring&&(t=P[t]),t&&t.type===ns&&(this.particleTo=t)},ag.applySpring=function(){const{particleFrom:t,particleTo:e,particleFromIsStatic:i,particleToIsStatic:n,springConstant:s,damperConstant:r,restLength:o}=this;if(t&&e){const{position:a,velocity:l,load:c}=t,{position:h,velocity:u,load:d}=e,f=Nh(u).vectorSubtract(l),p=Nh(h).vectorSubtract(a),g=Nh(p).normalize(),m=Nh(g);g.scalarMultiply(s*(p.getMagnitude()-o)),f.vectorMultiply(m).scalarMultiply(r).vectorMultiply(m);const y=Nh(g).vectorAdd(f);i||c.vectorAdd(y),n||d.vectorSubtract(y),zh(f,p,g,m,y)}};const cg=function(t){return!!t&&new Spring(t)};J.Spring=Spring;const hg="fillStyle",ug="hub-spoke",dg="strokeStyle",fg="strong-net",pg="strong-shape",gg="weak-net",mg="weak-shape",yg=["Bezier","Line","Oval","Polygon","Polyline","Quadratic","Rectangle","Shape","Spiral","Star","Tetragon"],Net=function(t=tr){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.generate=qs,this.postGenerate=qs,this.stampAction=qs,this.particleStore=[],this.springs=[],this.lastUpdated=0,this.lastHitParticle=null,t.group||(t.group=Cu),this.set(t),this.purge&&this.purgeArtefact(this.purge),this},bg=Net.prototype=Ar();bg.type="Net",bg.lib=je,bg.isArtefact=!0,bg.isAsset=!1,Ro(bg),od(bg);const Sg={world:null,artefact:null,historyLength:1,forces:null,mass:1,engine:Ve,springConstant:50,damperConstant:10,restLength:1,showSprings:!1,showSpringsColor:Qt,rows:0,columns:0,rowDistance:0,columnDistance:0,shapeTemplate:null,precision:20,joinTemplateEnds:!1,particlesAreDraggable:!1,hitRadius:10,showHitRadius:!1,hitRadiusColor:Qt,resetAfterBlur:3};bg.defs=ur(bg.defs,Sg),bg.packetExclusions=fr(bg.packetExclusions,["forces","springs","particleStore"]),bg.packetObjects=fr(bg.packetObjects,["world","artefact","shapeTemplate"]),bg.packetFunctions=fr(bg.packetFunctions,["generate","postGenerate","stampAction"]),bg.finalizePacketOut=function(t,e){const i=e.forces||this.forces||!1;if(i){const e=[];i.forEach((t=>{t.substring?e.push(t):cr(t)&&t.name&&e.push(t.name)})),t.forces=e}const n=[];return this.particleStore.forEach((t=>n.push(t.saveAsPacket()))),t.particleStore=n,t},bg.postCloneAction=function(t){return t},bg.factoryKill=function(t,e){this.isRunning=!1,t&&(this.artefact.kill(),this.shapeTemplate&&this.shapeTemplate.kill()),e&&this.world.kill(),this.purgeParticlesFromLibrary()},bg.purgeParticlesFromLibrary=function(){const{particleStore:t,springs:e}=this;let i;a.forEach((t=>{i=o[t],i&&(i.particle&&!i.particle.substring&&i.particle.name&&(i.particle=i.particle.name),i.type===rs&&i.useParticlesAsPins&&i.pins.forEach(((t,e)=>{cr(t)&&t.type===ns&&(i.pins[e]=t.name,i.dirtyPins=!0)})))})),t.forEach((t=>t.kill())),t.length=0,e.forEach((t=>t.kill())),e.length=0};const Ag=bg.setters;Ag.generate=function(t){ar(t)?this.generate=t:t.substring&&kg[t]&&(this.generate=kg[t])},Ag.postGenerate=function(t){ar(t)&&(this.postGenerate=t)},Ag.stampAction=function(t){ar(t)&&(this.stampAction=t)},Ag.world=function(t){let e;t.substring?e=F[t]:cr(t)&&t.type===gs&&(e=t),e&&(this.world=e)},Ag.artefact=function(t){let e;t.substring?e=o[t]:cr(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e),this.dirtyFilterIdentifier=!0},Ag.shapeTemplate=function(t){let e;t.substring?e=m[t]:cr(t)&&t.isArtefact&&gr(t.species)&&(e=t),e&&(this.shapeTemplate=e),this.dirtyFilterIdentifier=!0},bg.regularStamp=function(){const{world:t,artefact:e,particleStore:i,springs:n,generate:s,postGenerate:r,stampAction:o,lastUpdated:a,resetAfterBlur:l,showSprings:c,showSpringsColor:h,showHitRadius:u,hitRadius:d,hitRadiusColor:f}=this;let p,g,m=1,y=En;this.state&&(m=this.state.globalAlpha,y=this.state.globalCompositeOperation);const b=this.currentHost;let S=Dt;const A=mt();if(a&&(S=(A-a)/1e3),S>l&&(this.purgeParticlesFromLibrary(),S=Dt),i.length||(s.call(this,b),r.call(this)),i.forEach((e=>e.applyForces(t,b))),n.forEach((t=>t.applySpring())),i.forEach((e=>e.update(S,t))),c){const t=b.engine;t.save(),t.globalAlpha=m,t.globalCompositeOperation=y,t.strokeStyle=h,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=te,t.lineWidth=1,t.setTransform(1,0,0,1,0,0),t.beginPath(),n.forEach((e=>{({particleFrom:p,particleTo:g}=e),t.moveTo(p.position.x,p.position.y),t.lineTo(g.position.x,g.position.y)})),t.stroke(),t.restore()}if(i.forEach((t=>{t.manageHistory(S,b),o.call(this,e,t,b)})),u){const t=b.engine;t.save(),t.globalAlpha=m,t.globalCompositeOperation=y,t.lineWidth=1,t.strokeStyle=f,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=te,t.setTransform(1,0,0,1,0,0),t.beginPath(),i.forEach((e=>{t.moveTo(e.position.x,e.position.y),t.arc(e.position.x,e.position.y,d,0,bt)})),t.stroke(),t.restore()}this.lastUpdated=A},bg.restart=function(){return this.purgeParticlesFromLibrary(),this.lastUpdated=mt(),this},bg.checkHit=function(t=[]){if(this.lastHitParticle=null,!this.particlesAreDraggable)return!1;if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=this.particleStore;let n,s,r,o,a,l=!1;if(e.some((t=>{if(ut(t))n=t[0],s=t[1];else{if(!mr(t,t.x,t.y))return!1;n=t.x,s=t.y}if(!dt(n)||!dt(s))return!1;const e=Nh();for(r=0,o=i.length;r<o;r++)if(a=i[r],e.set(a.position).vectorSubtract(t),e.getMagnitude()<this.hitRadius){l=a;break}return zh(e),l}),this)){const t=this.checkHitReturn(n,s,l);return this.lastHitParticle=l,t}return!1},bg.checkHitReturn=function(t,e,i){return{x:t,y:e,artefact:this,particle:i}},bg.pickupArtefact=function(t){const e=this.lastHitParticle;return mr(t,e)&&(e.isBeingDragged=t,e.dragOffset=Nh(e.position).vectorSubtract(t)),this},bg.dropArtefact=function(){return this.lastHitParticle.isBeingDragged=null,zh(this.lastHitParticle.dragOffset),this.lastHitParticle.dragOffset=null,this.lastHitParticle=null,this};const Cg=function(t,e,i){const{springs:n,springConstant:s,damperConstant:r,restLength:o}=this,a=Nh(t.position).vectorSubtract(e.position),l=a.getMagnitude(),c=cg({name:i,particleFrom:t,particleTo:e,springConstant:s,damperConstant:r,restLength:l*o});n.push(c),zh(a)},kg={[gg]:function(t){const{particleStore:e,artefact:i,historyLength:n,engine:s,forces:r,mass:o,rows:a,columns:l,rowDistance:c,columnDistance:h,name:u}=this;if(t&&a>0&&l>0){const[d,f]=this.currentStampPosition,[,p]=t.currentDimensions,g=c.substring?parseFloat(c)/100*p:c,m=h.substring?parseFloat(h)/100*p:h;let y,b,S,A,C,k,v;for(A=0;A<a;A++)for(b=g*A+f,C=0;C<l;C++)y=m*C+d,S=Jd({name:`${u}-${A}-${C}`,positionX:y,positionY:b,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:n,engine:s,forces:r,mass:o,fill:i.get(hg),stroke:i.get(dg)}),S.run(0,0,!1),e.push(S);for(A=0;A<a;A++)for(C=0;C<l-1;C++)k=P[`${u}-${A}-${C}`],v=P[`${u}-${A}-${C+1}`],Cg.call(this,k,v,`${u}-${A}-${C}~${u}-${A}-${C+1}`);for(A=0;A<l;A++)for(C=0;C<a-1;C++)k=P[`${u}-${C}-${A}`],v=P[`${u}-${C+1}-${A}`],Cg.call(this,k,v,`${u}-${C}-${A}~${u}-${C+1}-${A}`)}},[fg]:function(t){const{particleStore:e,artefact:i,historyLength:n,engine:s,forces:r,mass:o,rows:a,columns:l,rowDistance:c,columnDistance:h,name:u}=this;if(t&&a>0&&l>0){const[d,f]=this.currentStampPosition,[,p]=t.currentDimensions,g=c.substring?parseFloat(c)/100*p:c,m=h.substring?parseFloat(h)/100*p:h;let y,b,S,A,C,k,v;for(A=0;A<a;A++)for(b=g*A+f,C=0;C<l;C++)y=m*C+d,S=Jd({name:`${u}-${A}-${C}`,positionX:y,positionY:b,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:n,engine:s,forces:r,mass:o,fill:i.get(hg),stroke:i.get(dg)}),S.run(0,0,!1),e.push(S);for(A=0;A<a;A++)for(C=0;C<l-1;C++)k=P[`${u}-${A}-${C}`],v=P[`${u}-${A}-${C+1}`],Cg.call(this,k,v,`${u}-${A}-${C}~${u}-${A}-${C+1}`);for(A=0;A<l;A++)for(C=0;C<a-1;C++)k=P[`${u}-${C}-${A}`],v=P[`${u}-${C+1}-${A}`],Cg.call(this,k,v,`${u}-${C}-${A}~${u}-${C+1}-${A}`);for(A=0;A<l-1;A++)for(C=0;C<a-1;C++)k=P[`${u}-${C}-${A}`],v=P[`${u}-${C+1}-${A+1}`],Cg.call(this,k,v,`${u}-${C}-${A}~${u}-${C+1}-${A+1}`);for(A=0;A<l-1;A++)for(C=a-1;C>0;C--)k=P[`${u}-${C}-${A}`],v=P[`${u}-${C-1}-${A+1}`],Cg.call(this,k,v,`${u}-${C}-${A}~${u}-${C-1}-${A+1}`)}},[mg]:function(){const{particleStore:t,artefact:e,historyLength:i,engine:n,forces:s,mass:r,name:o,shapeTemplate:a,precision:l,joinTemplateEnds:c}=this;let h,u,d,f;if(a&&l){for(h=0;h<l;h++){const c=a.getPathPositionData(h/l);u=Jd({name:`${o}-${h}`,positionX:c.x,positionY:c.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:i,engine:n,forces:s,mass:r,fill:e.get(hg),stroke:e.get(dg)}),u.run(0,0,!1),t.push(u)}for(h=0;h<l-1;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+1}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+1}`);for(c&&(d=P[`${o}-${l-1}`],f=P[`${o}-0`],Cg.call(this,d,f,`${o}-${l-1}~${o}-0`)),h=0;h<l-2;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+2}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+2}`);for(c&&(d=P[`${o}-${l-2}`],f=P[`${o}-0`],Cg.call(this,d,f,`${o}-${l-2}~${o}-0`),d=P[`${o}-${l-1}`],f=P[`${o}-1`],Cg.call(this,d,f,`${o}-${l-1}~${o}-1`)),h=0;h<l-3;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+3}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+3}`);c&&(d=P[`${o}-${l-3}`],f=P[`${o}-0`],Cg.call(this,d,f,`${o}-${l-3}~${o}-0`),d=P[`${o}-${l-2}`],f=P[`${o}-1`],Cg.call(this,d,f,`${o}-${l-2}~${o}-1`),d=P[`${o}-${l-1}`],f=P[`${o}-2`],Cg.call(this,d,f,`${o}-${l-1}~${o}-2`))}},[pg]:function(){const{particleStore:t,artefact:e,historyLength:i,engine:n,forces:s,mass:r,name:o,shapeTemplate:a,precision:l,joinTemplateEnds:c}=this;let h,u,d,f;if(a&&l){for(h=0;h<l;h++){const c=a.getPathPositionData(h/l);u=Jd({name:`${o}-${h}`,positionX:c.x,positionY:c.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:i,engine:n,forces:s,mass:r,fill:e.get(hg),stroke:e.get(dg)}),u.run(0,0,!1),t.push(u)}for(h=0;h<l-1;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+1}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+1}`);for(c&&(d=P[`${o}-${l-1}`],f=P[`${o}-0`],Cg.call(this,d,f,`${o}-${l-1}~${o}-0`)),h=0;h<l-2;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+2}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+2}`);for(c&&(d=P[`${o}-${l-2}`],f=P[`${o}-0`],Cg.call(this,d,f,`${o}-${l-2}~${o}-0`),d=P[`${o}-${l-1}`],f=P[`${o}-1`],Cg.call(this,d,f,`${o}-${l-1}~${o}-1`)),h=0;h<l-3;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+3}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+3}`);c&&(d=P[`${o}-${l-3}`],f=P[`${o}-0`],Cg.call(this,d,f,`${o}-${l-3}~${o}-0`),d=P[`${o}-${l-2}`],f=P[`${o}-1`],Cg.call(this,d,f,`${o}-${l-2}~${o}-1`),d=P[`${o}-${l-1}`],f=P[`${o}-2`],Cg.call(this,d,f,`${o}-${l-1}~${o}-2`));const p=ct(l/2);for(h=0;h<l-p;h++)d=P[`${o}-${h}`],h+p<l-1&&(f=P[`${o}-${h+p}`],Cg.call(this,d,f,`${o}-${h}~${o}-${h+p}`))}},[ug]:function(){const{shapeTemplate:t,precision:e}=this;if(t&&t.type&&e){const{particleStore:i,artefact:n,historyLength:s,engine:r,forces:o,mass:a,name:l,joinTemplateEnds:c}=this;let h,u,d,f;if(yg.includes(t.type)){for(h=0;h<e;h++){const c=t.getPathPositionData(h/e);u=Jd({name:`${l}-${h}`,positionX:c.x,positionY:c.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:r,forces:o,mass:a,fill:n.get(hg),stroke:n.get(dg)}),u.run(0,0,!1),i.push(u)}for(h=0;h<e-1;h++)d=P[`${l}-${h}`],f=P[`${l}-${h+1}`],Cg.call(this,d,f,`${l}-${h}-${h+1}`);for(c&&(d=P[`${l}-${e-1}`],f=P[`${l}-0`],Cg.call(this,d,f,`${l}-${e-1}-0`)),h=0;h<e-2;h++)d=P[`${l}-${h}`],f=P[`${l}-${h+2}`],Cg.call(this,d,f,`${l}-${h}~${l}-${h+2}`);c&&(d=P[`${l}-${e-2}`],f=P[`${l}-0`],Cg.call(this,d,f,`${l}-${e-2}~${l}-0`),d=P[`${l}-${e-1}`],f=P[`${l}-1`],Cg.call(this,d,f,`${l}-${e-1}~${l}-1`))}const[p,g]=t.get("position"),m=Jd({name:`${l}-hub`,positionX:p,positionY:g,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:r,forces:o,mass:a,fill:n.get(hg),stroke:n.get(dg)});m.run(0,0,!1),i.forEach(((t,e)=>Cg.call(this,t,m,`${l}-${e}-hub`))),i.push(m)}}},vg=function(t){return!!t&&new Net(t)};function Pg(t=tr){t.defs=ur(t.defs,{choke:15});const e=t.setters,i=t.deltaSetters;e.paletteStart=function(t){this.gradient&&this.gradient.set({paletteStart:t})},i.paletteStart=function(t){this.gradient&&this.gradient.setDelta({paletteStart:t})},e.paletteEnd=function(t){this.gradient&&this.gradient.set({paletteEnd:t})},i.paletteEnd=function(t){this.gradient&&this.gradient.setDelta({paletteEnd:t})},e.colors=function(t){this.gradient&&this.gradient.set({colors:t})},e.precision=function(t){this.gradient&&this.gradient.set({precision:t})},e.easing=function(t){this.gradient&&this.gradient.set({easing:t})},e.easingFunction=e.easing,e.colorSpace=function(t){this.gradient&&this.gradient.set({colorSpace:t})},e.returnColorAs=function(t){this.gradient&&this.gradient.set({returnColorAs:t})},e.cyclePalette=function(t){this.gradient&&this.gradient.set({cyclePalette:t})},e.delta=function(t=tr){this.gradient&&this.gradient.set({delta:t})},t.installElement=function(t){const e=document.createElement(le);e.id=t,this.element=e,this.engine=this.element.getContext(Et,{willReadFrequently:!0});const i=document.createElement(le);return i.id=`${t}-color`,i.width=256,i.height=1,this.colorElement=i,this.colorEngine=this.colorElement.getContext(Et,{willReadFrequently:!0}),this.gradient=yp({name:`${t}-gradient`,endX:Ui,delta:{paletteStart:0,paletteEnd:0},cyclePalette:!1}),this.gradientLastUpdated=0,this},t.checkSource=function(){this.notifySubscribers()},t.getData=function(t,e){return this.notifySubscribers(),this.buildStyle(e)},t.update=function(){this.dirtyOutput=!0},t.notifySubscribers=function(){this.dirtyOutput&&this.cleanOutput(),this.subscribers.forEach((t=>this.notifySubscriber(t)),this)},t.notifySubscriber=function(t){t.sourceNaturalWidth=this.width,t.sourceNaturalHeight=this.height,t.sourceLoaded=!0,t.source=this.element,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0,t.dirtyImageSubscribers=!0},t.paintCanvas=function(){if(this.checkOutputValuesExist()&&this.dirtyOutput){this.dirtyOutput=!1;const{element:t,engine:e,width:i,height:n,colorEngine:s,gradient:r,choke:o,gradientLastUpdated:a}=this;t.width=i,t.height=n;const l=e.getImageData(0,0,i,n),c=l.data,h=i*n;let u,d,f;const p=mt();a+o<p&&(r.updateByDelta(),this.gradientLastUpdated=p);const g=s.createLinearGradient(0,0,255,0);r.addStopsToGradient(g,r.paletteStart,r.paletteEnd,r.cyclePalette),s.fillStyle=g,s.fillRect(0,0,256,1);const m=s.getImageData(0,0,256,1).data;for(u=0;u<h;u++)d=4*ct(255*this.getOutputValue(u,i)),f=4*u,c[f]=m[d],c[++f]=m[++d],c[++f]=m[++d],c[++f]=m[++d];e.putImageData(l,0,0)}}}J.Net=Net;const Og=["stripes","smoothed-stripes","worley-euclidean","worley-manhattan"],xg="euclidian-distance",Dg="improved-perlin",wg="manhattan-distance",Fg="perlin",Rg="simplex",Tg="smoothed-stripes",Eg="stripes",Hg="worley-euclidean",Ig="worley-manhattan",Lg=["X","Y","Z","XminusY","XminusZ","YminusX","YminusZ","ZminusX","ZminusY","XaddY","XaddZ","YaddZ","XaddYminusZ","XaddZminusY","YaddZminusX","XmultiplyY","XmultiplyZ","YmultiplyZ","XmultiplyYaddZ","XmultiplyZaddY","YmultiplyZaddX","XmultiplyYminusZ","XmultiplyZminusY","YmultiplyZminusX","sum"],NoiseAsset=function(t=tr){return this.makeName(t.name),this.register(),this.installElement(this.name),this.perm=[],this.permMod8=[],this.values=[],this.grad=[],this.subscribers=[],this.set(this.defs),this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this.dirtyOutput=!0,this},Bg=NoiseAsset.prototype=Ar();Bg.type="NoiseAsset",Bg.lib=Wt,Bg.isArtefact=!1,Bg.isAsset=!0,Ro(Bg),Cc(Bg),Pg(Bg),Rh(Bg);const $g={width:300,height:150,noiseEngine:Rg,seed:we,size:256,scale:50,octaves:1,octaveFunction:Yi,persistence:.5,lacunarity:2,smoothing:"quintic",sumFunction:Yi,sineFrequencyCoeff:1,sumAmplitude:5,worleyOutput:"X",worleyDepth:0};Bg.defs=ur(Bg.defs,$g),delete Bg.defs.source,delete Bg.defs.sourceLoaded,Bg.stringifyFunction=qs,Bg.processPacketOut=qs,Bg.finalizePacketOut=qs,Bg.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Bg.clone=Js;const Mg=Bg.setters;Mg.source=qs,Mg.subscribers=qs,Mg.octaveFunction=function(t){this.octaveFunction=null!=this.octaveFunctions[t]?this.octaveFunctions[t]:Qs,this.dirtyNoise=!0,this.dirtyOutput=!0},Mg.sumFunction=function(t){this.sumFunction=null!=this.sumFunctions[t]?this.sumFunctions[t]:Qs,this.dirtyNoise=!0,this.dirtyOutput=!0},Mg.smoothing=function(t){this.smoothing=null!=Sr[t]?Sr[t]:Qs,this.dirtyNoise=!0,this.dirtyOutput=!0},Mg.noiseEngine=function(t){this.noiseEngine=null!=this.noiseEngines[t]?this.noiseEngines[t]:this.noiseEngines[Rg],this.dirtyNoise=!0,this.dirtyOutput=!0},Mg.octaves=function(t){t.toFixed&&(this.octaves=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.seed=function(t){t.substring&&(this.seed=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.scale=function(t){t.toFixed&&(this.scale=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.size=function(t){t.toFixed&&(this.size=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.persistence=function(t){t.toFixed&&(this.persistence=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.lacunarity=function(t){t.toFixed&&(this.lacunarity=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.sineFrequencyCoeff=function(t){t.toFixed&&(this.sineFrequencyCoeff=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.modularAmplitude=function(t){t.toFixed&&(this.sumAmplitude=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.sumAmplitude=function(t){t.toFixed&&(this.sumAmplitude=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.width=function(t){t.toFixed&&(this.width=t,this.sourceNaturalWidth=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.height=function(t){t.toFixed&&(this.height=t,this.sourceNaturalHeight=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.worleyDepth=function(t){t.toFixed&&(this.worleyDepth=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.worleyOutput=function(t){t.substring&&Lg.includes(t)&&(this.worleyOutput=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Mg.colors=function(t){this.gradient&&this.gradient.set({colors:t}),this.dirtyOutput=!0},Bg.cleanOutput=function(){this.dirtyNoise&&this.cleanNoise(),this.dirtyOutput&&this.paintCanvas()},Bg.cleanNoise=function(){if(this.dirtyNoise){this.dirtyNoise=!1;const{noiseEngine:t,seed:e,width:i,height:n,octaves:s,lacunarity:r,persistence:o,scale:a,octaveFunction:l,sumFunction:c}=this;if(t&&t.init){this.rndEngine=La(e),this.generatePermutationTable(),t.init.call(this);const h=lo();let u,d,f,p,g,m,y,b;for(d=0;d<n;d++)for(h[d]=[],u=0;u<i;u++)h[d][u]=[];const S=At(i,-a/100);let A=-1e3,C=1e3;const k=t.name;if(Og.includes(k))for(d=0;d<n;d++)for(u=0;u<i;u++)p=u*S,g=d*S,m=t.getNoiseValue.call(this,p,g),h[d][u]=m,C=gt(C,m),A=pt(A,m);else for(d=0;d<n;d++)for(u=0;u<i;u++){for(p=u*S,g=d*S,m=0,y=1,b=1,f=0;f<s;f++){let e=t.getNoiseValue.call(this,p*b,g*b);e=l(e,p,g,f+1),e*=y,m+=e,b*=r,y*=o}h[d][u]=m,C=gt(C,m),A=pt(A,m)}const v=A-C;for(d=0;d<n;d++)for(u=0;u<i;u++){p=u*S,g=d*S;const t=(h[d][u]-C)/v;h[d][u]=c.call(this,t,u*S,d*S)}this.noiseValues||(this.noiseValues=[]),this.noiseValues.length=0,this.noiseValues.push(...h),co(h)}else this.dirtyNoise=!0}},Bg.checkOutputValuesExist=function(){return null!=this.noiseValues},Bg.getOutputValue=function(t,e){const i=ct(t/e),n=t-i*e;return this.noiseValues[i][n]};const Xg=.5*(xt(3)-1),Yg=(3-xt(3))/6,Gg=(3-xt(3))/6*2,Ng=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];Bg.noiseEngines={[Fg]:{name:Fg,init:function(){const{grad:t,size:e,rndEngine:i}=this;let n;t.length=0;for(let s=0;s<e;s++)t[s]=[2*i.random()-1,2*i.random()-1],n=xt(t[s][0]*t[s][0]+t[s][1]*t[s][1]),t[s][0]/=n,t[s][1]/=n},getNoiseValue:function(t,e){const{size:i,perm:n,grad:s,smoothing:r}=this;let o,a;const l=ct(t)%i,c=(l+1)%i,h=t-ct(t),u=h-1,d=ct(e)%i,f=(d+1)%i,p=e-ct(e),g=p-1,m=n[l],y=n[c],b=n[m+d],S=n[y+d],A=n[m+f],C=n[y+f],k=r(h),v=r(p);o=h*s[b][0]+p*s[b][1],a=u*s[S][0]+p*s[S][1];const P=nr(k,o,a);o=h*s[A][0]+g*s[A][1],a=u*s[C][0]+g*s[C][1];const O=nr(k,o,a);return.5*(1+nr(v,P,O))}},[Dg]:{name:Dg,init:qs,getNoiseValue:function(t,e){const{size:i,perm:n,permMod8:s,smoothing:r}=this;let o,a;const l=ct(t)%i,c=(l+1)%i,h=t-ct(t),u=h-1,d=ct(e)%i,f=(d+1)%i,p=e-ct(e),g=p-1,m=n[l],y=n[c],b=s[m+d],S=s[y+d],A=s[m+f],C=s[y+f],k=r(h),v=r(p);o=h*Ng[b][0]+p*Ng[b][1],a=u*Ng[S][0]+p*Ng[S][1];const P=nr(k,o,a);o=h*Ng[A][0]+g*Ng[A][1],a=u*Ng[C][0]+g*Ng[C][1];const O=nr(k,o,a);return.5*(1+nr(v,P,O))}},[Rg]:{name:Rg,init:qs,getNoiseValue:function(t,e){const i=function(t,e,i){const n=.5-t*t-e*e;if(n<0)return 0;const[s,r]=Ng[i];return n*n*(s*t+r*e)},{size:n,perm:s,permMod8:r}=this,o=(t+e)*Xg,a=ct(t+o),l=ct(e+o),c=(a+l)*Yg,h=t-(a-c),u=e-(l-c),d=a%n,f=l%n;let p=r[d+s[f]],g=i(h,u,p);p=r[d+1+s[f+1]],g+=i(h-1+Gg,u-1+Gg,p);let m=0,y=1;return h>u&&(m=1,y=0),p=r[d+m+s[f+y]],g+=i(h-m+Yg,u-y+Yg,p),.5+35*g}},[Is]:{name:Is,init:function(){const{values:t,size:e,rndEngine:i}=this;t.length=0;for(let n=0;n<e;n++)t[n]=t[n+e]=i.random()},getNoiseValue:function(t,e){const{values:i,size:n,perm:s,smoothing:r}=this,o=ct(t)%n,a=ct(e)%n,l=(o+1)%n,c=(a+1)%n,h=t-ct(t),u=e-ct(e),d=r(h),f=r(u),p=s[o],g=s[l],m=s[p+a],y=s[g+a],b=s[p+c],S=s[g+c],A=nr(d,i[m],i[y]),C=nr(d,i[b],i[S]);return nr(f,A,C)}},[Eg]:{name:Eg,init:qs,getNoiseValue:function(t,e){return t/5+e/5}},[Tg]:{name:Tg,init:qs,getNoiseValue:function(t,e){const{smoothing:i}=this;return i(t)/5+i(e)/5}},[Hg]:{name:Hg,init:function(){this.worleySeed=ct(1e6*this.rndEngine.random())},getNoiseValue:function(t,e){const{worleyDepth:i,worleyDistanceFunctions:n,worleyOutputFunctions:s,worleyOutput:r}=this,o=n[xg],a=s[r];return this.worleyNoise({x:t,y:e,z:i},o,a)}},[Ig]:{name:Ig,init:function(){this.worleySeed=ct(1e6*this.rndEngine.random())},getNoiseValue:function(t,e){const{worleyDepth:i,worleyDistanceFunctions:n,worleyOutputFunctions:s,worleyOutput:r}=this,o=n[wg],a=s[r];return this.worleyNoise({x:t,y:e,z:i},o,a)}}},Bg.generatePermutationTable=function(){const{perm:t,permMod8:e,rndEngine:i,size:n}=this;let s,r,o;for(t.length=0,e.length=0,s=0;s<n;s++)t[s]=s;for(;--s;)r=ct(i.random()*n),o=t[s],t[s]=t[r],t[r]=o;for(s=0;s<n;s++)t[s+n]=t[s],e[s]=e[s+n]=t[s]%8},Bg.octaveFunctions={none:Qs,absolute:function(t){return et(2*t-1)}},Bg.sumFunctions={none:Qs,"sine-x":function(t,e){return.5+Ot(e*this.sineFrequencyCoeff+t)/2},"sine-y":function(t,e,i){return.5+Ot(i*this.sineFrequencyCoeff+t)/2},sine:function(t,e,i){return.5+Ot(e*this.sineFrequencyCoeff+t)/4+Ot(i*this.sineFrequencyCoeff+t)/4},modular:function(t){const e=t*this.sumAmplitude;return e-ct(e)},random:function(t){const e=this.sumAmplitude;let i=t+(kt()/e-.5/e);return i>1?i=1:i<0&&(i=0),i}},Bg.wXorshift=function(t){let e=t^t>>12;return e^=e<<25,e^=e>>27,2*e},Bg.wHash=function(t,e,i){return 16777619*(16777619*(16777619*(2166136261^t)^e)^i)&4294967295},Bg.worleyDistanceFunctions={[xg]:function(t,e){return function(t,e){return[t.x-e.x,t.y-e.y,t.z-e.z]}(t,e).reduce(((t,e)=>t+e*e),0)},[wg]:function(t,e){return function(t,e){return[t.x-e.x,t.y-e.y,t.z-e.z]}(t,e).reduce(((t,e)=>t+et(e)),0)}},Bg.wProbLookup=function(t){return(t&=4294967295)<393325350?1:t<1022645910?2:t<1861739990?3:t<2700834071?4:t<3372109335?5:t<3819626178?6:t<4075350088?7:t<4203212043?8:9},Bg.wInsert=function(t,e){let i;for(let n=t.length-1;n>=0&&!(e>t[n]);n--)i=t[n],t[n]=e,n+1<t.length&&(t[n+1]=i)},Bg.worleyOutputFunctions={X:function(t){return t[0]},Y:function(t){return t[1]},Z:function(t){return t[2]},XminusY:function(t){return t[0]-t[1]},XminusZ:function(t){return t[0]-t[2]},YminusX:function(t){return t[1]-t[0]},YminusZ:function(t){return t[1]-t[2]},ZminusX:function(t){return t[2]-t[0]},ZminusY:function(t){return t[2]-t[1]},XaddY:function(t){return t[0]+t[1]},XaddZ:function(t){return t[0]+t[2]},YaddZ:function(t){return t[1]+t[2]},XaddYminusZ:function(t){return t[0]+t[1]-t[2]},XaddZminusY:function(t){return t[0]+t[2]-t[1]},YaddZminusX:function(t){return t[1]+t[2]-t[0]},XmultiplyY:function(t){return t[0]*t[1]},XmultiplyZ:function(t){return t[0]*t[2]},YmultiplyZ:function(t){return t[1]*t[2]},XmultiplyYaddZ:function(t){return t[0]*t[1]+t[2]},XmultiplyZaddY:function(t){return t[0]*t[2]+t[1]},YmultiplyZaddX:function(t){return t[1]*t[2]+t[0]},XmultiplyYminusZ:function(t){return t[0]*t[1]-t[2]},XmultiplyZminusY:function(t){return t[0]*t[2]-t[1]},YmultiplyZminusX:function(t){return t[1]*t[2]-t[0]},sum:function(t){return t[0]+t[1]+t[2]}},Bg.worleyNoise=function(t,e,i){let n,s,r={x:0,y:0,z:0};const o={x:0,y:0,z:0};let a,l,c;const h=[9999999,9999999,9999999];let{x:u,y:d,z:f}=t;u=ct(u),d=ct(d),f=ct(f);for(let i=-1;i<2;++i)for(let p=-1;p<2;++p)for(let g=-1;g<2;++g){a=u+i,l=d+p,c=f+g,n=this.wXorshift(this.wHash(a+this.worleySeed&4294967295,4294967295&l,4294967295&c)),s=this.wProbLookup(n);for(let i=0;i<s;++i)n=this.wXorshift(n),o.X=n/4294967296,n=this.wXorshift(n),o.Y=n/4294967296,n=this.wXorshift(n),o.Z=n/4294967296,r={x:o.X+a,y:o.Y+l,z:o.Z+c},this.wInsert(h,e(t,r))}return i(h.map((t=>t<0?0:t>1?1:t)))};const zg=function(t){return!!t&&new NoiseAsset(t)},jg=function(t){return!!t&&new NoiseAsset(t)};J.NoiseAsset=NoiseAsset;const Oval=function(t=tr){return this.shapeInit(t),this},Vg=Oval.prototype=Ar();Vg.type="Oval",Vg.lib=je,Vg.isArtefact=!0,Vg.isAsset=!1,Ro(Vg),yd(Vg);Vg.defs=ur(Vg.defs,{radiusX:5,radiusY:5,intersectX:.5,intersectY:.5,offshootA:.55,offshootB:0});const Wg=Vg.setters,Ug=Vg.deltaSetters;Wg.radius=function(t){this.setRectHelper(t,cn)},Wg.radiusX=function(t){this.setRectHelper(t,ln)},Wg.radiusY=function(t){this.setRectHelper(t,hn)},Ug.radius=function(t){this.deltaRectHelper(t,cn)},Ug.radiusX=function(t){this.deltaRectHelper(t,ln)},Ug.radiusY=function(t){this.deltaRectHelper(t,hn)},Wg.offshootA=function(t){t.toFixed&&(this.offshootA=t,this.updateDirty())},Wg.offshootB=function(t){t.toFixed&&(this.offshootB=t,this.updateDirty())},Ug.offshootA=function(t){t.toFixed&&(this.offshootA+=t,this.updateDirty())},Ug.offshootB=function(t){t.toFixed&&(this.offshootB+=t,this.updateDirty())},Wg.intersectX=function(t){t.toFixed&&(this.intersectX=t,this.updateDirty())},Wg.intersectY=function(t){t.toFixed&&(this.intersectY=t,this.updateDirty())},Ug.intersectX=function(t){t.toFixed&&(this.intersectX+=t,this.updateDirty())},Ug.intersectY=function(t){t.toFixed&&(this.intersectY+=t,this.updateDirty())},Vg.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},Vg.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=Ws(this[e],t)}),this)},Vg.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeOvalPath()},Vg.makeOvalPath=function(){const t=parseFloat(this.offshootA.toFixed(6)),e=parseFloat(this.offshootB.toFixed(6)),i=this.radiusX,n=this.radiusY;let s,r;if(i.substring||n.substring){const t=this.getHost();if(t){const[e,o]=t.currentDimensions;s=2*(i.substring?parseFloat(i)/100*e:i),r=2*(n.substring?parseFloat(n)/100*o:n)}}else s=2*i,r=2*n;const o=parseFloat((s*this.intersectX).toFixed(2)),a=parseFloat((s-o).toFixed(2)),l=parseFloat((r*this.intersectY).toFixed(2)),c=parseFloat((r-l).toFixed(2));let h=Xs;return h+=`c${a*t},${l*e} ${a-a*e},${l-l*t}, ${a},${l} `,h+=`${-a*e},${c*t} ${a*t-a},${c-c*e} ${-a},${c} `,h+=`${-o*t},${-c*e} ${o*e-o},${c*t-c} ${-o},${-c} `,h+=`${o*e},${-l*t} ${o-o*t},${l*e-l} ${o},${-l}z`,h},Vg.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(Xs,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Zg=function(t){return!!t&&(t.species="oval",new Oval(t))};J.Oval=Oval;const Kg="VIDEO",_g=["video_audioTracks","video_autoPlay","video_buffered","video_controller","video_controls","video_controlsList","video_crossOrigin","video_currentSrc","video_currentTime","video_defaultMuted","video_defaultPlaybackRate","video_disableRemotePlayback","video_duration","video_ended","video_error","video_loop","video_mediaGroup","video_mediaKeys","video_muted","video_networkState","video_paused","video_playbackRate","video_readyState","video_seekable","video_seeking","video_sinkId","video_src","video_srcObject","video_textTracks","video_videoTracks","video_volume"],qg=["video_autoPlay","video_controller","video_controls","video_crossOrigin","video_currentTime","video_defaultMuted","video_defaultPlaybackRate","video_disableRemotePlayback","video_loop","video_mediaGroup","video_muted","video_playbackRate","video_src","video_srcObject","video_volume"],VideoAsset=function(t=tr){return this.assetConstructor(t)},Qg=VideoAsset.prototype=Ar();Qg.type=ps,Qg.lib=Wt,Qg.isArtefact=!1,Qg.isAsset=!0,Ro(Qg),Cc(Qg),Qg.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},Qg.stringifyFunction=qs,Qg.processPacketOut=qs,Qg.finalizePacketOut=qs,Qg.clone=Js;Qg.setters.source=function(t){t&&(t.tagName.toUpperCase()===Kg&&(this.source=t,this.sourceNaturalWidth=t.videoWidth||0,this.sourceNaturalHeight=t.videoHeight||0,this.sourceLoaded=t.readyState>2),this.sourceLoaded&&this.notifySubscribers())},Qg.checkSource=function(t,e){const i=this.source;i&&i.readyState>2?(this.sourceLoaded=!0,this.sourceNaturalWidth===i.videoWidth&&this.sourceNaturalHeight===i.videoHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.videoWidth,this.sourceNaturalHeight=i.videoHeight,this.notifySubscribers())):this.sourceLoaded=!1},Qg.addTextTrack=function(t,e,i){const n=this.source;n&&n.addTextTrack&&n.addTextTrack(t,e,i)},Qg.captureStream=function(){const t=this.source;return!(!t||!t.captureStream)&&t.captureStream()},Qg.canPlayType=function(t){const e=this.source;return e?e.canPlayType(t):"maybe"},Qg.fastSeek=function(t){const e=this.source;e&&e.fastSeek&&e.fastSeek(t)},Qg.load=function(){const t=this.source;t&&t.load()},Qg.pause=function(){const t=this.source;t&&t.pause()},Qg.play=function(){const t=this.source;return t?t.play().catch((t=>console.log(t.code,t.name,t.message))):Promise.reject("Source not defined")},Qg.setMediaKeys=function(t){const e=this.source;return e?e.setMediaKeys?e.setMediaKeys(t):Promise.reject("setMediaKeys not supported"):Promise.reject("Source not defined")},Qg.setSinkId=function(){const t=this.source;return t?t.setSinkId?t.setSinkId():Promise.reject("setSinkId not supported"):Promise.reject("Source not defined")};const Jg=function(t){document.querySelectorAll(t).forEach((t=>{let e;if(t.tagName.toUpperCase()===Kg){if(t.id||t.name)e=t.id||t.name;else{const i=Ut.exec(t.src);e=i&&i[1]?i[1]:Ys}const i=nm({name:e,source:t});t.readyState<=2&&(t.oncanplay=()=>{i.set({source:t})})}}))},tm=function(t=tr){const e={};e.audio=!gr(t.audio)||t.audio,e.video={};const i=e.video.width={};t.minWidth&&(i.min=t.minWidth),t.maxWidth&&(i.max=t.maxWidth),i.ideal=t.width?t.width:1280;const n=e.video.height={};t.minHeight&&(n.min=t.minHeight),t.maxHeight&&(n.max=t.maxHeight),n.ideal=t.height?t.height:720,t.facing&&(e.video.facingMode=t.facing);const s=t.name||ir(),r=document.createElement(Bs),o=nm({name:s,source:r});return new Promise(((t,i)=>{navigator&&navigator.mediaDevices?navigator.mediaDevices.getUserMedia(e).then((e=>{const i=e.getVideoTracks();let n;ut(i)&&i[0]&&(n=i[0].getConstraints()),r.id=o.name,n&&(r.width=n.width,r.height=n.height),r.srcObject=e,r.onloadedmetadata=function(){r.play()},t(o)})).catch((e=>{console.log(e),t(o)})):i("Navigator.mediaDevices object not found")}))},em=function(t=tr){const e={video:{displaySurface:"browser"},audio:{suppressLocalAudioPlayback:!1},preferCurrentTab:!1,selfBrowserSurface:"exclude",systemAudio:"include",surfaceSwitching:"include",monitorTypeSurfaces:"include"},i=t.name||ir(),n=document.createElement(Bs),s=nm({name:i,source:n});return new Promise(((i,r)=>{navigator&&navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia({...e,...t}).then((t=>{const e=t.getVideoTracks();let r;ut(e)&&e[0]&&(r=e[0].getConstraints()),n.id=s.name,r&&(n.width=r.width,n.height=r.height),n.srcObject=t,n.onloadedmetadata=function(){n.play()},i(s)})).catch((t=>{console.log(t.message),i(s)})):r("Navigator.mediaDevices object not found")}))},im=function(...t){let e=Ys;if(t.length){let i,n,s,r,o,a,l=!1;const c=t[0];if(c.substring){const e=Ut.exec(c);i=e&&e[1]?e[1]:Ys,o=[...t],n=Ys,s=!1,r=null,a=Zt,l=!0}else c&&c.src&&(i=c.name||Ys,o=[...c.src],n=c.className||Ys,s=c.visibility||!1,r=document.querySelector(r),a=c.preload||Zt,l=!0);const h=nm({name:i});if(l){const t=document.createElement(Bs);t.name=i,t.className=n,t.style.display=s?ie:Yi,t.crossOrigin=Gt,t.preload=a,o.forEach((e=>{const i=document.createElement(Fn);i.src=e,t.appendChild(i)})),t.onload=()=>{h.set({source:t}),r&&r.appendChild(t)},h.set({source:t}),e=i}}return e},nm=function(t){return!!t&&new VideoAsset(t)};J.VideoAsset=VideoAsset;const SpriteAsset=function(t=tr){return this.sourceHold=null,this.manifest=null,this.assetConstructor(t),this},sm=SpriteAsset.prototype=Ar();sm.type=cs,sm.lib=Wt,sm.isArtefact=!1,sm.isAsset=!0,Ro(sm),Cc(sm);sm.defs=ur(sm.defs,{manifest:null}),sm.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},sm.stringifyFunction=qs,sm.processPacketOut=qs,sm.finalizePacketOut=qs,sm.clone=Js;sm.setters.source=function(t=[]){if(t&&t[0]){this.sourceHold||(this.sourceHold={});const e=this.sourceHold;t.forEach((t=>{const i=t.id||t.name;i&&(e[i]=t)})),this.source=t[0],this.sourceNaturalWidth=t[0].naturalWidth,this.sourceNaturalHeight=t[0].naturalHeight,this.sourceLoaded=t[0].complete}},sm.checkSource=qs;const rm=function(...t){const e=/\.(jpeg|jpg|png|gif|webp|svg|JPEG|JPG|PNG|GIF|WEBP|SVG)/,i=[];return t.forEach((t=>{let n,s,r,o,a,l=!1,c=!1;if(t.substring){const i=Ut.exec(t);n=i&&i[1]?i[1]:Ys,s=[t],r=Ys,o=!1,a=t.replace(e,".json"),c=!0}else cr(t)&&t.imageSrc&&t.manifestSrc?(n=t.name||Ys,s=ut(t.imageSrc)?t.imageSrc:[t.imageSrc],a=t.manifestSrc,r=t.className||Ys,o=t.visibility||!1,l=document.querySelector(t.parent),c=!0):i.push(!1);if(c){const t=om({name:n});cr(a)?t.manifest=a:fetch(a).then((t=>{if(200!=t.status)throw new Error("Failed to load manifest");return t.json()})).then((e=>t.manifest=e)).catch((t=>console.log(t.message)));const c=[];s.forEach((t=>{const i=document.createElement(ui);let s,a;e.test(t)&&(a=Ut.exec(t),s=a&&a[1]?a[1]:Ys),i.name=s||n,i.className=r,i.crossorigin=Gt,i.style.display=o?ie:Yi,l&&l.appendChild(i),i.src=t,c.push(i)})),t.set({source:c}),i.push(n)}else i.push(!1)})),i},om=function(t){return!!t&&new SpriteAsset(t)};J.SpriteAsset=SpriteAsset;function am(t=tr){const e={asset:null,removeAssetOnKill:!1,spriteIsRunning:!1,spriteLastFrameChange:0,spriteCurrentFrame:0,spriteTrack:"default",spriteForward:!0,spriteFrameDuration:100,spriteWillLoop:!0};t.defs=ur(t.defs,e);const i=t.getters,n=t.setters;i.sourceDimensions=function(){return[this.sourceNaturalWidth,this.sourceNaturalHeight]},n.asset=function(t){const e=this.asset,i=t&&t.name?t.name:t;e&&!e.substring&&e.unsubscribe(this),this.asset=i,this.dirtyAsset=!0},n.imageSource=function(t){const e=Rc(t);if(e){const t=l[e[0]];if(t){const e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},n.videoSource=function(t){const e=im(t);if(e){const t=l[e];if(t){const e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},n.spriteSource=function(t){const e=rm(t);if(e){const t=l[e];if(t){const e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},t.cleanAsset=function(){const t=this.asset;if(t&&t.substring){const e=l[t];e&&(this.dirtyAsset=!1,e.subscribe(this))}},t.videoAction=function(t,...e){const i=this.asset;if(i&&i.type===ps)return i[t](...e)},t.videoPromiseAction=function(t,...e){const i=this.asset;return i&&i.type===ps?i[t](...e):Promise.reject("Asset not a video")},t.videoAddTextTrack=function(t,e,i){return this.videoAction("addTextTrack",t,e,i)},t.videoCaptureStream=function(){return this.videoAction("captureStream")},t.videoCanPlayType=function(t){return this.videoAction("canPlayType",t)},t.videoFastSeek=function(t){return this.videoAction("fastSeek",t)},t.videoLoad=function(){return this.videoAction("load")},t.videoPause=function(){return this.videoAction("pause")},t.videoPlay=function(){return this.videoPromiseAction("play")},t.videoSetMediaKeys=function(t){return this.videoPromiseAction("setMediaKeys",t)},t.videoSetSinkId=function(){return this.videoPromiseAction("setSinkId")},t.checkSpriteFrame=function(){const t=this.asset;if(t&&t.type===cs&&t.manifest){const e=this.copyArray;if(this.spriteIsRunning){const i=this.spriteLastFrameChange,n=this.spriteFrameDuration,s=mt();if(s>i+n){const i=t.manifest;if(i){const n=i[this.spriteTrack],r=n.length,o=this.spriteWillLoop;let a=this.spriteCurrentFrame;a=this.spriteForward?a+1:a-1,a<0&&(a=o?r-1:0),a>=r&&(a=o?0:r-1);const[l,c,h,u,d]=n[a];e.length=0,e.push(c,h,u,d),this.dirtyCopyStart=!1,this.dirtyCopyDimensions=!1;if(l!==(this.source.id||this.source.name)){const e=t.sourceHold[l];e&&(this.source=e)}this.spriteCurrentFrame=a,this.spriteLastFrameChange=s}}}else{const[,i,n,s,r]=t.manifest[this.spriteTrack][this.spriteCurrentFrame],[o,a,l,c]=e;o===i&&a===n&&l===s&&c===r||(e.length=0,e.push(i,n,s,r),this.dirtyCopyStart=!1,this.dirtyCopyDimensions=!1)}}},t.playSprite=function(t,e,i,n,s){gr(t)&&(this.spriteFrameDuration=t),gr(e)&&(this.spriteWillLoop=e),gr(i)&&(this.spriteTrack=i),gr(n)&&(this.spriteForward=n),gr(s)&&(this.spriteCurrentFrame=s),this.spriteLastFrameChange=mt(),this.spriteIsRunning=!0},t.haltSprite=function(t,e,i,n,s){gr(t)&&(this.spriteFrameDuration=t),gr(e)&&(this.spriteWillLoop=e),gr(i)&&(this.spriteTrack=i),gr(n)&&(this.spriteForward=n),gr(s)&&(this.spriteCurrentFrame=s),this.spriteIsRunning=!1}}const Pattern=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.source=null,this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.sourceLoaded=!1,this.dirtyImage=!0,this.dirtyCopyStart=!0,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.patternMatrix=null,this.set(t),this},lm=Pattern.prototype=Ar();lm.type="Pattern",lm.lib=Gn,lm.isArtefact=!1,lm.isAsset=!1,Ro(lm),Rh(lm),am(lm),lm.packetObjects=fr(lm.packetObjects,["asset"]),lm.finalizePacketOut=function(t,e){if(ut(e.patternMatrix))t.patternMatrix=e.patternMatrix;else{const e=this.patternMatrix;e&&(t.patternMatrix=[e.a,e.b,e.c,e.d,e.e,e.f])}return t},lm.kill=function(){const{name:t,asset:e,removeAssetOnKill:i}=this;let n,s,r,o;return cr(e)&&e.unsubscribe(this),wt(m).forEach((e=>{n=e.state,s=n.defs,n&&(r=n.fillStyle,o=n.strokeStyle,cr(r)&&r.name===t&&(n.fillStyle=s.fillStyle),cr(o)&&o.name===t&&(n.strokeStyle=s.strokeStyle))})),i&&(i.substring?e.kill(!0):e.kill()),this.deregister(),this},lm.get=function(t){const e=this.source;if(0!==t.indexOf(Tt)&&0!==t.indexOf(Rt)||!e){const e=this.getters[t];if(e)return e.call(this);{const e=this.defs[t];if(typeof e!==Fs){const i=this[t];return typeof i!==Fs?i:e}return}}return _g.includes(t)||wc.includes(t)?e[t.substring(6)]:void 0},lm.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.source,r=this.defs;let o,a,l,c;for(a=0;a<i;a++)l=e[a],c=t[l],0!==l.indexOf(Tt)&&0!==l.indexOf(Rt)||!s?l&&l!==$i&&null!=c&&(o=n[l],o?o.call(this,c):typeof r[l]!==Fs&&(this[l]=c)):(qg.includes(l)||Fc.includes(l))&&(s[l.substring(6)]=c);this.dirtyFilterIdentifier=!0}return this},lm.getData=function(t,e){return this.dirtyAsset&&this.cleanAsset(),this.asset.checkSource(this.sourceNaturalWidth,this.sourceNaturalHeight),this.buildStyle(e)};const cm=function(t){return!!t&&new Pattern(t)};J.Pattern=Pattern;const hm="copyDimensions",um="copyStart",Picture=function(t=tr){return this.copyStart=al(),this.currentCopyStart=al(),this.copyDimensions=al(),this.currentCopyDimensions=al(),this.copyArray=[],this.pasteArray=[],this.dirtyPaste=!0,this.source=null,this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.sourceNaturalDimensions=[],this.sourceLoaded=!1,this.entityInit(t),t.copyStart||(t.copyStartX||(this.copyStart[0]=0),t.copyStartY||(this.copyStart[1]=0)),t.copyDimensions||(t.copyWidth||(this.copyDimensions[0]=1),t.copyHeight||(this.copyDimensions[1]=1)),this.imageSubscribers=[],this.dirtyCopyStart=!0,this.dirtyCopyDimensions=!0,this.dirtyImage=!0,this},dm=Picture.prototype=Ar();dm.type=ss,dm.lib=je,dm.isArtefact=!0,dm.isAsset=!1,Ro(dm),od(dm),am(dm);dm.defs=ur(dm.defs,{copyStart:null,copyDimensions:null,checkHitIgnoreTransparency:!1}),dm.packetCoordinates=fr(dm.packetCoordinates,["copyStart","copyDimensions"]),dm.packetObjects=fr(dm.packetObjects,["asset"]),dm.factoryKill=function(){const{asset:t,removeAssetOnKill:e}=this;cr(t)&&(t.unsubscribe(this),e&&t.kill(!0))};const fm=dm.getters,pm=dm.setters,gm=dm.deltaSetters;fm.copyStart=function(){return[].concat(this.currentCopyStart)},fm.copyStartX=function(){return this.currentCopyStart[0]},fm.copyStartY=function(){return this.currentCopyStart[1]},pm.copyStartX=function(t){null!=t&&(this.copyStart[0]=t,this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},pm.copyStartY=function(t){null!=t&&(this.copyStart[1]=t,this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},pm.copyStart=function(t,e){this.setCoordinateHelper(um,t,e),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},gm.copyStartX=function(t){const e=this.copyStart;e[0]=Ws(e[0],t),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},gm.copyStartY=function(t){const e=this.copyStart;e[1]=Ws(e[1],t),this.dirtyCopyStart=!0,this.dirtyFilterIdentifier=!0},gm.copyStart=function(t,e){this.setDeltaCoordinateHelper(um,t,e),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},fm.copyWidth=function(){return this.currentCopyDimensions[0]},fm.copyHeight=function(){return this.currentCopyDimensions[1]},fm.copyDimensions=function(){return[].concat(this.currentCopyDimensions)},pm.copyWidth=function(t){null!=t&&(this.copyDimensions[0]=t,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},pm.copyHeight=function(t){null!=t&&(this.copyDimensions[1]=t,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},pm.copyDimensions=function(t,e){this.setCoordinateHelper(hm,t,e),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},gm.copyWidth=function(t){const e=this.copyDimensions;e[0]=Ws(e[0],t),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},gm.copyHeight=function(t){const e=this.copyDimensions;e[1]=Ws(e[1],t),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},gm.copyDimensions=function(t,e){this.setDeltaCoordinateHelper(hm,t,e),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},dm.get=function(t){const e=this.source;if(0!==t.indexOf(Tt)&&0!==t.indexOf(Rt)||!e){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return typeof n!==Fs?(i=this[t],typeof i!==Fs?i:n):(n=e.defs[t],typeof n!==Fs?(i=e[t],typeof i!==Fs?i:n):void 0)}}return _g.includes(t)||wc.includes(t)?e[t.substring(6)]:void 0},dm.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.source,o=this.state,a=o?o.setters:tr,l=o?o.defs:tr;let c,h,u,d;for(h=0;h<i;h++)u=e[h],d=t[u],0!==u.indexOf(Tt)&&0!==u.indexOf(Rt)||!r?u&&u!==$i&&null!=d&&(Mn.includes(u)?(c=a[u],c?c.call(o,d):typeof l[u]!==Fs&&(o[u]=d)):(c=n[u],c?c.call(this,d):typeof s[u]!==Fs&&(this[u]=d))):(qg.includes(u)||Fc.includes(u))&&(r[u.substring(6)]=d)}return this},dm.updateImageSubscribers=function(){this.dirtyImageSubscribers=!1,this.imageSubscribers.length&&this.imageSubscribers.forEach((t=>{const e=o[t];e&&(e.dirtyInput=!0)}))},dm.imageSubscribe=function(t){t&&t.substring&&fr(this.imageSubscribers,t)},dm.imageUnsubscribe=function(t){t&&t.substring&&pr(this.imageSubscribers,t)},dm.cleanImage=function(){const t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(mr(t,e)&&t>0&&e>0){this.dirtyImage=!1;const i=this.currentCopyStart,n=i[0],s=i[1],r=this.currentCopyDimensions,o=r[0],a=r[1];n+o>t&&(i[0]=t-o),s+a>e&&(i[1]=e-a);const l=this.copyArray;l.length=0,l.push(~~i[0],~~i[1],~~o,~~a)}},dm.cleanCopyStart=function(){const t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(mr(t,e)&&t>0&&e>0){this.dirtyCopyStart=!1,this.cleanPosition(this.currentCopyStart,this.copyStart,[t,e]);const i=this.currentCopyStart,n=i[0],s=i[1];(n<0||n>t)&&(i[0]=n<0?0:t-1),(s<0||s>e)&&(i[1]=s<0?0:e-1),this.dirtyImage=!0}},dm.cleanCopyDimensions=function(){const t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(mr(t,e)&&t>0&&e>0){this.dirtyCopyDimensions=!1;const i=this.copyDimensions,n=this.currentCopyDimensions,s=i[0],r=i[1];s.substring?n[0]=parseFloat(s)/100*t:n[0]=s,r.substring?n[1]=parseFloat(r)/100*e:n[1]=r;const o=n[0],a=n[1];(o<=0||o>t)&&(n[0]=o<=0?1:t),(a<=0||a>e)&&(n[1]=a<=0?1:e),this.dirtyImage=!0}},dm.prepareStamp=function(){this.dirtyAsset&&this.cleanAsset(),this.asset&&(this.asset.type===cs?this.checkSpriteFrame(this):this.asset.checkSource?this.asset.checkSource(this.sourceNaturalWidth,this.sourceNaturalHeight):this.dirtyAsset=!0),(this.dirtyDimensions||this.dirtyHandle||this.dirtyScale)&&(this.dirtyPaste=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyCopyStart&&this.cleanCopyStart(),this.dirtyCopyDimensions&&this.cleanCopyDimensions(),this.dirtyImage&&this.cleanImage(),this.dirtyPaste&&this.preparePasteObject(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.dirtyImageSubscribers&&this.updateImageSubscribers(),this.prepareStampTabsHelper()},dm.preparePasteObject=function(){this.dirtyPaste=!1;const t=this.currentStampHandlePosition,e=this.currentDimensions,i=this.currentScale,n=-t[0]*i,s=-t[1]*i,r=e[0]*i,o=e[1]*i,a=this.pasteArray;a.length=0,a.push(~~n,~~s,~~r,~~o),this.dirtyPathObject=!0},dm.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject)if(this.pasteArray&&4===this.pasteArray.length||this.preparePasteObject(),4!==this.pasteArray.length)this.dirtyPathObject=!0;else{(this.pathObject=new Path2D).rect(...this.pasteArray)}},dm.draw=function(t){t.stroke(this.pathObject)},dm.fill=function(t){const[e,i,n,s]=this.copyArray;this.source&&n&&s&&t.drawImage(this.source,e,i,n,s,...this.pasteArray)},dm.drawAndFill=function(t){const[e,i,n,s]=this.copyArray,[r,o,a,l]=this.pasteArray;this.source&&n&&s&&(t.stroke(this.pathObject),t.drawImage(this.source,e,i,n,s,r,o,a,l),this.currentHost.clearShadow(),t.stroke(this.pathObject),t.drawImage(this.source,e,i,n,s,r,o,a,l))},dm.fillAndDraw=function(t){const[e,i,n,s]=this.copyArray,[r,o,a,l]=this.pasteArray;this.source&&n&&s&&(t.drawImage(this.source,e,i,n,s,r,o,a,l),t.stroke(this.pathObject),this.currentHost.clearShadow(),t.drawImage(this.source,e,i,n,s,r,o,a,l),t.stroke(this.pathObject)),t.stroke(this.pathObject)},dm.drawThenFill=function(t){const[e,i,n,s]=this.copyArray;this.source&&n&&s&&(t.stroke(this.pathObject),t.drawImage(this.source,e,i,n,s,...this.pasteArray))},dm.fillThenDraw=function(t){const[e,i,n,s]=this.copyArray;this.source&&n&&s&&(t.drawImage(this.source,e,i,n,s,...this.pasteArray),t.stroke(this.pathObject))},dm.checkHitReturn=function(t,e){if(this.checkHitIgnoreTransparency){const i=this.stashedImageData;if(i){const n=4*(e*i.width+t)+3;if(i.data[n])return{x:t,y:e,artefact:this}}return!1}return{x:t,y:e,artefact:this}};const mm=function(t){return!!t&&new Picture(t)};J.Picture=Picture;const Polygon=function(t=tr){return this.shapeInit(t),this},ym=Polygon.prototype=Ar();ym.type="Polygon",ym.lib=je,ym.isArtefact=!0,ym.isAsset=!1,Ro(ym),yd(ym);ym.defs=ur(ym.defs,{sides:0,sideLength:0,radius:0});const bm=ym.setters,Sm=ym.deltaSetters;bm.sides=function(t){this.sides=t,this.updateDirty()},Sm.sides=function(t){this.sides+=t,this.updateDirty()},bm.sideLength=function(t){this.sideLength=t,this.updateDirty()},Sm.sideLength=function(t){this.sideLength+=t,this.updateDirty()},bm.radius=function(t){this.radius=t,this.updateDirty()},Sm.radius=function(t){this.radius+=t,this.updateDirty()},ym.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makePolygonPath()},ym.makePolygonPath=function(){const t=this.sideLength||this.radius,e=this.sides,i=360/e,n=lo();let s=0,r=Ys;const o=Nh({x:0,y:-t});for(let t=0;t<e;t++)o.rotate(i),s+=o.y,n.push(s),r+=`${o.x.toFixed(1)},${o.y.toFixed(1)} `;zh(o);const a=gt(...n),l=pt(...n);return r=`m0,${((et(a)+et(l)-t)/2).toFixed(1)}l${r}z`,co(n),r};const Am=function(t){return!!t&&(t.species="polygon",new Polygon(t))};J.Polygon=Polygon;const Polyline=function(t=tr){return this.pins=[],this.currentPins=[],this.controlledLineOffset=al(),this.shapeInit(t),this},Cm=Polyline.prototype=Ar();Cm.type=rs,Cm.lib=je,Cm.isArtefact=!0,Cm.isAsset=!1,Ro(Cm),yd(Cm);Cm.defs=ur(Cm.defs,{pins:null,tension:0,closed:!1,mapToPins:!1,useParticlesAsPins:!1}),Cm.packetExclusions=fr(Cm.packetExclusions,["controlledLineOffset"]),Cm.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=ur(t,i),t=this.handlePacketAnchor(t,e),ft(t).forEach((e=>{if("pins"===e){const e=[];t.pins.forEach((t=>{cr(t)?e.push(t.name):ut(t)?e.push([].concat(t)):e.push(t)})),t.pins=e}})),t};const km=Cm.getters,vm=Cm.setters,Pm=Cm.deltaSetters;km.pins=function(t){return gr(t)?this.getPinAt(t):this.currentPins.concat()},vm.pins=function(t){if(gr(t)){const e=this.pins;if(ut(t))e.forEach(((t,e)=>this.removePinAt(e))),e.length=0,e.push(...t),this.updateDirty();else if(cr(t)&&gr(t.index)){const i=e[t.index];ut(i)&&(gr(t.x)&&(i[0]=t.x),gr(t.y)&&(i[1]=t.y),this.updateDirty())}}},Pm.pins=function(t){if(gr(t)){const e=this.pins;if(cr(t)&&gr(t.index)){const i=e[t.index];ut(i)&&(gr(t.x)&&(i[0]=Ws(i[0],t.x)),gr(t.y)&&(i[1]=Ws(i[1],t.y)),this.updateDirty())}}},vm.tension=function(t){t.toFixed&&(this.tension=t,this.updateDirty())},Pm.tension=function(t){t.toFixed&&(this.tension+=t,this.updateDirty())},vm.closed=function(t){this.closed=t,this.updateDirty()},vm.mapToPins=function(t){this.mapToPins=t,this.updateDirty()},vm.flipUpend=function(t){this.flipUpend=t,this.updateDirty()},vm.flipReverse=function(t){this.flipReverse=t,this.updateDirty()},vm.useAsPath=function(t){this.useAsPath=t,this.updateDirty()},vm.pivot=function(t){if(sr(t)&&!t)this.pivot=null,this.lockTo[0]===_i&&(this.lockTo[0]=Ln),this.lockTo[1]===_i&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.pivot,i=t.substring?o[t]:t,n=this.name;i&&i.name&&(e&&e.name!==i.name&&pr(e.pivoted,n),fr(i.pivoted,n),this.pivot=i,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}this.updateDirty()},Cm.updateDirty=function(){this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyPins=!0},Cm.getPinAt=function(t){const e=ct(t);if(this.useAsPath){const t=this.getPathPositionData(this.unitPartials[e]);return[t.x,t.y]}{const t=this.currentPins,i=t[e],[n,s]=this.localBox,[r,o]=i,[a]=t[0],[l,c]=this.localOffset,[h,u]=this.currentStampPosition;let d,f;return this.mapToPins?(d=r-a+n,f=o-a+s):(d=r-l,f=o-c),[h+d,u+f]}},Cm.updatePinAt=function(t,e){if(mr(t,e)){e=ct(e);const i=this.pins;if(e<i.length&&e>=0){const n=i[e];cr(n)&&n.pivoted&&pr(n.pivoted,this.name),i[e]=t,this.updateDirty()}}},Cm.removePinAt=function(t){t=ct(t);const e=this.pins;if(t<e.length&&t>=0){const i=e[t];cr(i)&&i.pivoted&&pr(i.pivoted,this.name),e[t]=null,this.updateDirty()}},Cm.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),this.useParticlesAsPins&&(this.dirtyPins=!0),(this.dirtyPins||this.dirtyLock)&&(this.dirtySpecies=!0),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyHandle)&&(this.dirtyPathObject=!0,(this.dirtyScale||this.dirtySpecies)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.includes(Fi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&(this.cleanPathObject(),this.updatePathSubscribers()),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},Cm.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makePolylinePath()},Cm.getPathParts=function(t,e,i,n,s,r,o){const a=xt(At(i-t,2)+At(n-e,2)),l=xt(At(s-i,2)+At(r-n,2)),c=o*a/(a+l),h=o*l/(a+l);return[i-c*(s-t),n-c*(r-e),i,n,i+h*(s-t),n+h*(r-e)]},Cm.buildLine=function(t,e,i){let n=`${Xs}l`;for(let s=2;s<i.length;s+=6)n+=`${_s(i[s]-t)},${_s(i[s+1]-e)} `,t=i[s],e=i[s+1];return n},Cm.buildCurve=function(t,e,i){let n=`${Xs}c`,s=0;for(let r=0;r<i.length;r+=2)n+=`${_s(i[r]-t)},${_s(i[r+1]-e)} `,s++,s>2&&(t=i[r],e=i[r+1],s=0);return n},Cm.cleanCoordinate=function(t,e){return t.toFixed?t:t===gi||t===Cs?0:t===vn||t===ae?e:t===ce?e/2:parseFloat(t)/100*e},Cm.cleanPinsArray=function(){this.dirtyPins=!1;const t=this.pins,e=this.currentPins;if(e.length=0,this.useParticlesAsPins)t.forEach(((i,n)=>{let s;i&&i.substring?(s=P[i],s&&(t[n]=s)):s=i;const r=!(!s||!s.position)&&s.position;r&&e.push([r.x,r.y])})),e.length||(this.dirtyPins=!0);else{const i=this.getHost(),n=this.cleanCoordinate;let s,r,a,l=1,c=1;i&&(a=i.currentDimensions,a&&([l,c]=a)),t.forEach(((i,a)=>{let h;if(i&&i.substring?(h=o[i],t[a]=h):h=i,h)if(ut(h))[s,r]=h,e.push([n(s,l),n(r,c)]);else if(cr(h)&&h.currentStart){const t=this.name;h.pivoted.includes(t)||fr(h.pivoted,t),e.push([...h.currentStampPosition])}}))}if(e.length){let t=e[0][0],i=e[0][1];e.forEach((e=>{e[0]<t&&(t=e[0]),e[1]<i&&(i=e[1])})),this.localOffset=[t,i],this.updatePivotSubscribers()}},Cm.makePolylinePath=function(){const t=this.getPathParts,e=this.buildLine,i=this.buildCurve,n=this.currentPins,s=this.tension,r=this.closed;if(this.dirtyPins&&this.cleanPinsArray(),n.length){const o=n.length,a=n[0],l=n[o-1],c=lo();let h,u=Xs;if(r){const r=lo();for(r.push(...t(...l,...a,...n[1],s)),h=0;h<o-2;h++)c.push(...t(...n[h],...n[h+1],...n[h+2],s));c.push(...t(...n[o-2],...l,...a,s)),c.unshift(r[4],r[5]),c.push(r[0],r[1],r[2],r[3]),u=s?i(a[0],a[1],c)+"z":e(a[0],a[1],c)+"z",co(r)}else{for(c.push(a[0],a[1]),h=0;h<o-2;h++)c.push(...t(...n[h],...n[h+1],...n[h+2],s));c.push(l[0],l[1],l[0],l[1]),u=s?i(a[0],a[1],c):e(a[0],a[1],c)}return co(c),u}return Xs},Cm.calculateLocalPathAdditionalActions=function(){const[t,e]=this.localBox,i=this.pathDefinition;this.mapToPins?this.set({start:this.currentPins[0]}):this.pathDefinition=i.replace(Xs,`m${-t},${-e}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)},Cm.updatePathSubscribers=function(){this.pathed.forEach((t=>{const e=o[t];e&&(e.dirtyStart=!0)}))};const Om=function(t){return!!t&&(t.species="polyline",new Polyline(t))};J.Polyline=Polyline;const Quadratic=function(t=tr){return this.control=al(),this.currentControl=al(),this.controlLockTo="coord",this.curveInit(t),this.shapeInit(t),this.dirtyControl=!0,this},xm=Quadratic.prototype=Ar();xm.type=os,xm.lib=je,xm.isArtefact=!0,xm.isAsset=!1,Ro(xm),yd(xm),Sd(xm);const Dm={control:null,controlPivot:Ys,controlPivotCorner:Ys,controlPivotIndex:-1,addControlPivotHandle:!1,addControlPivotOffset:!1,controlPath:Ys,controlPathPosition:0,addControlPathHandle:!1,addControlPathOffset:!0,controlParticle:Ys,controlLockTo:Ys};xm.defs=ur(xm.defs,Dm),xm.packetCoordinates=fr(xm.packetCoordinates,["control"]),xm.packetObjects=fr(xm.packetObjects,["controlPivot","controlPath"]);const wm=xm.getters,Fm=xm.setters,Rm=xm.deltaSetters;Fm.controlPivot=function(t){this.setControlHelper(t,"controlPivot",Ae),this.updateDirty(),this.dirtyControl=!0},Fm.controlParticle=function(t){this.setControlHelper(t,"controlParticle",Ae),this.updateDirty(),this.dirtyControl=!0},Fm.controlPath=function(t){this.setControlHelper(t,"controlPath",Ae),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Fm.controlPathPosition=function(t){this.controlPathPosition=t,this.dirtyControl=!0,this.currentControlPathData=!1,this.dirtyFilterIdentifier=!0},Rm.controlPathPosition=function(t){this.controlPathPosition+=t,this.dirtyControl=!0,this.currentControlPathData=!1,this.dirtyFilterIdentifier=!0},wm.controlPositionX=function(){return this.currentControl[0]},wm.controlPositionY=function(){return this.currentControl[1]},wm.controlPosition=function(){return[].concat(this.currentControl)},Fm.controlX=function(t){null!=t&&(this.control[0]=t,this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1)},Fm.controlY=function(t){null!=t&&(this.control[1]=t,this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1)},Fm.control=function(t,e){this.setCoordinateHelper(Ae,t,e),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Rm.controlX=function(t){const e=this.control;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Rm.controlY=function(t){const e=this.control;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Rm.control=function(t,e){this.setDeltaCoordinateHelper(Ae,t,e),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Fm.controlLockTo=function(t){this.controlLockTo=t,this.updateDirty(),this.dirtyControlLock=!0,this.currentControlPathData=!1},xm.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeQuadraticPath()},xm.makeQuadraticPath=function(){const[t,e]=this.currentStampPosition,[i,n]=this.currentControl,[s,r]=this.currentEnd;return`${Xs}q${(i-t).toFixed(2)},${(n-e).toFixed(2)} ${(s-t).toFixed(2)},${(r-e).toFixed(2)}`},xm.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyControl=!0,this.dirtyEnd=!0,this.dirtyFilterIdentifier=!0},xm.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath,n=this.controlPivot,s=this.controlPath;for(let r,o=0,a=t.length;o<a;o++)r=t[o],(n&&n.name===r||s&&s.name===r)&&(this.dirtyControl=!0,this.controlLockTo.includes(ji)&&(this.currentControlPathData=!1)),(e&&e.name===r||i&&i.name===r)&&(this.dirtyEnd=!0,this.endLockTo.includes(ji)&&(this.currentEndPathData=!1));t.length=0};const Tm=function(t=tr){return!!t&&(t.species=an,new Quadratic(t))};J.Quadratic=Quadratic;const RadialGradient=function(t=tr){return this.currentStartRadius=0,this.currentEndRadius=0,this.stylesInit(t),this},Em=RadialGradient.prototype=Ar();Em.type="RadialGradient",Em.lib=Gn,Em.isArtefact=!1,Em.isAsset=!1,Ro(Em),$d(Em);Em.defs=ur(Em.defs,{startRadius:0,endRadius:0}),Em.packetObjects=fr(Em.packetObjects,["palette"]);const Hm=Em.getters,Im=Em.setters,Lm=Em.deltaSetters;Hm.startRadius=function(){return this.currentStartRadius},Hm.endRadius=function(){return this.currentEndRadius},Im.startRadius=function(t){this.startRadius=t,this.dirtyStyle=!0},Im.endRadius=function(t){this.endRadius=t,this.dirtyStyle=!0},Lm.startRadius=function(t){this.startRadius=Ws(this.startRadius,t),this.dirtyStyle=!0},Lm.endRadius=function(t){this.endRadius=Ws(this.endRadius,t),this.dirtyStyle=!0},Em.cleanRadius=function(t){const e=(t,e)=>{if(lr(t))return t;switch(t){case Cs:case gi:return 0;case ae:case vn:return e;case ce:return e/2;default:return t=parseFloat(t),lr(t)?t/100*e:0}};this.currentStartRadius=t?e(this.startRadius,t):this.defs.startRadius,this.currentEndRadius=t?e(this.endRadius,t):this.defs.endRadius},Em.buildStyle=function(t){if(t){const e=t.engine;if(e){const t=e.createRadialGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return te},Em.updateGradientArgs=function(t,e){const i=this.gradientArgs,n=this.currentStart,s=this.currentEnd,r=this.currentStartRadius;let o=this.currentEndRadius;const a=n[0]+t,l=n[1]+e,c=s[0]+t,h=s[1]+e;a===c&&l===h&&r===o&&o++,i.length=0,i.push(a,l,r,c,h,o)};const Bm=function(t){return!!t&&new RadialGradient(t)};J.RadialGradient=RadialGradient;const RawAsset=function(t=tr){this.makeName(t.name),this.register(),this.subscribers=[],this.set(this.defs),this.updateSource=qs;const e=t.keytypes||{};t.userAttributes&&t.userAttributes.forEach((t=>{this.addAttribute(t),t.type&&(e[t.key]=t.type)})),this.initializeAttributes(e),this.set(t);const i=document.createElement(le);return i.width=0,i.height=0,this.element=i,this.engine=i.getContext(Et,{willReadFrequently:!0}),t.subscribe&&this.subscribers.push(t.subscribe),this},$m=RawAsset.prototype=Ar();$m.type="RawAsset",$m.lib=Wt,$m.isArtefact=!1,$m.isAsset=!0,Ro($m),Cc($m);$m.defs=ur($m.defs,{keytypes:null,data:null,updateSource:null}),$m.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},$m.stringifyFunction=qs,$m.processPacketOut=qs,$m.finalizePacketOut=qs,$m.clone=Js;const Mm=$m.getters,Xm=$m.setters,Ym=$m.deltaSetters;Xm.source=qs,Xm.element=qs,Xm.engine=qs,Xm.data=function(t){t&&(this.data=t,this.dirtyData=!0)},Xm.updateSource=function(t){t&&ar(t)&&(this.updateSource=t,this.dirtyData=!0)},$m.checkSource=function(t,e){this.source||(this.source=this.element);const i=this.source;if(i){let n=!1;this.dirtyData&&(this.dirtyData=!1,this.updateSource(this),n=!0),this.sourceLoaded=!0,this.sourceNaturalWidth&&this.sourceNaturalHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.width,this.sourceNaturalHeight=i.height,n=!0),n&&this.sourceNaturalWidth&&this.sourceNaturalHeight&&this.notifySubscribers()}else this.sourceLoaded=!1},$m.subscribeAction=function(t={}){this.subscribers.push(t),t.asset=this,t.source=this.element,this.notifySubscriber(t)},$m.addAttribute=function(t=tr){const{key:e,defaultValue:i,setter:n,deltaSetter:s,getter:r}=t;return e&&e.substring&&(this.defs[e]=gr(i)?i:null,this[e]=gr(i)?i:null,ar(n)&&(Xm[e]=n),ar(s)&&(Ym[e]=s),ar(r)&&(Mm[e]=r)),this},$m.removeAttribute=function(t){return t&&t.substring&&(delete this.defs[t],delete this[t],delete Mm[t],delete Xm[t],delete Ym[t]),this},$m.initializeAttributes=function(t){for(const[e,i]of lt(t))switch(i){case as:this[e]=_h();break;case fs:this[e]=jh();break;case Kn:this[e]=al()}};const Gm=function(t){return!!t&&new RawAsset(t)};J.RawAsset=RawAsset;const Nm=["random","entity"],RdAsset=function(t=tr){return this.makeName(t.name),this.register(),this.installElement(this.name),this.subscribers=[],this.set(this.defs),this.currentSource=null,this.initialSettingEntity=null,this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this.currentGeneration=0,this.dataArrays=[],this.dirtyScene=!0,this.dirtyOutput=!0,this},zm=RdAsset.prototype=Ar();zm.type="RdAsset",zm.lib=Wt,zm.isArtefact=!1,zm.isAsset=!0,Ro(zm),Cc(zm),Pg(zm),Rh(zm);const jm={width:300,height:150,diffusionRateA:.2097,diffusionRateB:.105,feedRate:.054,killRate:.062,initialSettingPreference:un,randomEngineSeed:we,initialRandomSeedLevel:.0045,initialSettingEntity:null,drawEvery:10,maxGenerations:4e3};zm.defs=ur(zm.defs,jm),delete zm.defs.source,delete zm.defs.sourceLoaded,zm.stringifyFunction=qs,zm.processPacketOut=qs,zm.finalizePacketOut=qs,zm.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},zm.clone=Js;const Vm=zm.setters,Wm=zm.getters;Vm.subscribers=qs,Vm.width=function(t){t.toFixed&&(this.width=t,this.sourceNaturalWidth=t,this.dirtyScene=!0)},Vm.height=function(t){t.toFixed&&(this.height=t,this.sourceNaturalHeight=t,this.dirtyScene=!0)},Vm.initialRandomSeedLevel=function(t){t.toFixed&&(this.initialRandomSeedLevel=t,this.dirtyScene=!0)},Vm.diffusionRateA=function(t){t.toFixed&&(this.diffusionRateA=t,this.dirtyScene=!0)},Vm.diffusionRateB=function(t){t.toFixed&&(this.diffusionRateB=t,this.dirtyScene=!0)},Vm.feedRate=function(t){t.toFixed&&(this.feedRate=t,this.dirtyScene=!0)},Vm.killRate=function(t){t.toFixed&&(this.killRate=t,this.dirtyScene=!0)},Vm.drawEvery=function(t){t.toFixed&&(this.drawEvery=t,this.dirtyScene=!0)},Vm.maxGenerations=function(t){t.toFixed&&(this.maxGenerations=t,this.dirtyScene=!0)},Vm.initialSettingPreference=function(t){t.substring&&Nm.includes(t)&&(this.initialSettingPreference=t,this.dirtyScene=!0)},Vm.randomEngineSeed=function(t){t.substring&&(this.randomEngineSeed=t,this.dirtyScene=!0)},Vm.initialSettingEntity=function(t){t&&(t.substring||(t=t.name||Ys),t&&(this.initialSettingEntity=t,this.dirtyScene=!0))},Wm.generation=function(){return this.currentGeneration},Vm.preset=function(t){if(t.substring){switch(t){case"negativeBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.098,this.killRate=.0555,this.maxGenerations=4e3,this.initialRandomSeedLevel=.05;break;case"positiveBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.098,this.killRate=.057,this.maxGenerations=4e3,this.initialRandomSeedLevel=.1;break;case"precriticalBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.082,this.killRate=.059,this.maxGenerations=4e3,this.initialRandomSeedLevel=.08;break;case"wormsAndLoops":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.082,this.killRate=.06,this.maxGenerations=4e3,this.initialRandomSeedLevel=.08;break;case"stableSolitons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.074,this.killRate=.064,this.maxGenerations=4e3,this.initialRandomSeedLevel=.15;break;case"uSkateWorld":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.062,this.killRate=.0609,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"worms":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.058,this.killRate=.065,this.maxGenerations=4e3,this.initialRandomSeedLevel=.1;break;case"wormsJoinIntoMazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.046,this.killRate=.063,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"negatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.046,this.killRate=.0594,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"turingPatterns":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.042,this.killRate=.059,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"chaosToTuringNegatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.039,this.killRate=.058,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"fingerprints":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.037,this.killRate=.06,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"chaosWithNegatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.0353,this.killRate=.0566,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"spotsAndWorms":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.034,this.killRate=.0618,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"selfReplicatingSpots":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.03,this.killRate=.063,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"superResonantMazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.03,this.killRate=.0565,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"mazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.029,this.killRate=.057,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"mazesWithSomeChaos":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.026,this.killRate=.055,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"chaos":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.026,this.killRate=.051,this.maxGenerations=0,this.initialRandomSeedLevel=.009;break;case"warringMicrobes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.022,this.killRate=.059,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"spotsAndLoops":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.018,this.killRate=.051,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"movingSpots":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.014,this.killRate=.054,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"waves":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.014,this.killRate=.045,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;default:this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.054,this.killRate=.062,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045}this.dirtyScene=!0}},zm.update=function(){this.dirtyOutput=!0},zm.cleanOutput=function(t=0){if(this.dirtyScene&&this.cleanScene(),!this.dirtyScene){const{dataArrays:e,diffusionRateA:i,diffusionRateB:n,feedRate:s,killRate:r,currentSource:o,drawEvery:a,maxGenerations:l,currentGeneration:c}=this;let h,u,d,f,p,g,m,y,b,S;if(!l||c<l)if(o?[u,h,f,d]=e:[h,u,d,f]=e,t<a){for(m=0,y=h.length;m<y;m++)p=h[m],g=d[m],b=p+i*this.calculateLaplacian(m,h)-p*g*g+s*(1-p),S=g+n*this.calculateLaplacian(m,d)+p*g*g-(r+s)*g,u[m]=Us(b,0,1),f[m]=Us(S,0,1);this.currentSource=o?0:1,this.currentGeneration=c+1,this.cleanOutput(t+1)}else this.paintCanvas();else this.dirtyOutput&&this.paintCanvas()}},zm.cleanScene=function(){const{element:t,width:e,height:i,dataArrays:n,initialRandomSeedLevel:s,initialSettingPreference:r,randomEngineSeed:o,initialSettingEntity:a}=this;if(e&&i&&this.dirtyScene){this.dirtyScene=!1,t.width=e,t.height=i;const l=e*i;n.length=0;for(let t=0;t<4;t++)n.push(new Float64Array(l));this.currentSource=0;const[c,h,u,d]=n;if(c.fill(1),h.fill(1),u.fill(0),d.fill(0),je===r&&m[a]){const t=m[a],n=el(),{engine:s,element:r}=n;r.width=e,r.height=i,t.simpleStamp(n,{fillStyle:$s,strokeStyle:$s});const o=s.getImageData(0,0,e,i).data;let l=0;for(let t=3,e=o.length;t<e;t+=4)u[l]=o[t]/255,l++;il(n)}else{const t=La(o);for(let e=0;e<l;e++)u[e]=t.random()<s?1:0}this.currentGeneration=0}},zm.calculateLaplacian=function(t,e){const i=this.width,n=ct(t/i),s=this.checkRow(n-1)*i,r=this.checkRow(n+1)*i,o=n*i,a=t-o,l=this.checkCol(a-1),c=this.checkCol(a+1);let h,u=0;return u+=-1*e[t],h=s+l,u+=.05*e[h],h=s+c,u+=.05*e[h],h=r+l,u+=.05*e[h],h=r+c,u+=.05*e[h],h=s+a,u+=.2*e[h],h=o+c,u+=.2*e[h],h=o+l,u+=.2*e[h],h=r+a,u+=.2*e[h],u},zm.checkRow=function(t){const e=this.height;return t<0?e-1:t>=e?0:t},zm.checkCol=function(t){const e=this.width;return t<0?e-1:t>=e?0:t},zm.checkOutputValuesExist=function(){return!!this.dataArrays.length},zm.getOutputValue=function(t){let e,i;const{dataArrays:n,currentSource:s}=this;return s?[e,,i]=n:[,e,,i]=n,(e[t]-i[t]+1)/2};const Um=function(t){return!!t&&new RdAsset(t)};J.RdAsset=RdAsset;const Zm=["radiusTLX","radiusTRX","radiusBRX","radiusBLX","radiusTLY","radiusTRY","radiusBRY","radiusBLY"],Km=["radiusBRX","radiusBRY","radiusBLX","radiusBLY"],_m=["radiusBLX","radiusBLY"],qm=["radiusBLX"],Qm=["radiusBLY"],Jm=["radiusBRX","radiusBRY"],ty=["radiusBRX"],ey=["radiusBRY"],iy=["radiusBRX","radiusBLX"],ny=["radiusBRY","radiusBLY"],sy=["radiusTLX","radiusTLY","radiusBLX","radiusBLY"],ry=["radiusTLX","radiusBLX"],oy=["radiusTLY","radiusBLY"],ay=["radiusTRX","radiusTRY","radiusBRX","radiusBRY"],ly=["radiusTRX","radiusBRX"],cy=["radiusTRY","radiusBRY"],hy=["radiusTLX","radiusTLY","radiusTRX","radiusTRY"],uy=["radiusTLX","radiusTLY"],dy=["radiusTLX"],fy=["radiusTLY"],py=["radiusTRX","radiusTRY"],gy=["radiusTRX"],my=["radiusTRY"],yy=["radiusTLX","radiusTRX"],by=["radiusTLY","radiusTRY"],Sy=["radiusTLX","radiusTRX","radiusBRX","radiusBLX"],Ay=["radiusTLY","radiusTRY","radiusBRY","radiusBLY"],Rectangle=function(t=tr){return this.shapeInit(t),this.currentRectangleWidth=1,this.currentRectangleHeight=1,this},Cy=Rectangle.prototype=Ar();Cy.type="Rectangle",Cy.lib=je,Cy.isArtefact=!0,Cy.isAsset=!1,Ro(Cy),yd(Cy);Cy.defs=ur(Cy.defs,{rectangleWidth:10,rectangleHeight:10,radiusTLX:0,radiusTLY:0,radiusTRX:0,radiusTRY:0,radiusBRX:0,radiusBRY:0,radiusBLX:0,radiusBLY:0,offshootA:.55,offshootB:0});const ky=Cy.setters,vy=Cy.deltaSetters;ky.radius=function(t){this.setRectHelper(t,Zm)},ky.radiusX=function(t){this.setRectHelper(t,Sy)},ky.radiusY=function(t){this.setRectHelper(t,Ay)},ky.radiusT=function(t){this.setRectHelper(t,hy)},ky.radiusB=function(t){this.setRectHelper(t,Km)},ky.radiusL=function(t){this.setRectHelper(t,sy)},ky.radiusR=function(t){this.setRectHelper(t,ay)},ky.radiusTX=function(t){this.setRectHelper(t,yy)},ky.radiusBX=function(t){this.setRectHelper(t,iy)},ky.radiusLX=function(t){this.setRectHelper(t,ry)},ky.radiusRX=function(t){this.setRectHelper(t,ly)},ky.radiusTY=function(t){this.setRectHelper(t,by)},ky.radiusBY=function(t){this.setRectHelper(t,ny)},ky.radiusLY=function(t){this.setRectHelper(t,oy)},ky.radiusRY=function(t){this.setRectHelper(t,cy)},ky.radiusTL=function(t){this.setRectHelper(t,uy)},ky.radiusTR=function(t){this.setRectHelper(t,py)},ky.radiusBL=function(t){this.setRectHelper(t,_m)},ky.radiusBR=function(t){this.setRectHelper(t,Jm)},ky.radiusTLX=function(t){this.setRectHelper(t,dy)},ky.radiusTLY=function(t){this.setRectHelper(t,fy)},ky.radiusTRX=function(t){this.setRectHelper(t,gy)},ky.radiusTRY=function(t){this.setRectHelper(t,my)},ky.radiusBRX=function(t){this.setRectHelper(t,ty)},ky.radiusBRY=function(t){this.setRectHelper(t,ey)},ky.radiusBLX=function(t){this.setRectHelper(t,qm)},ky.radiusBLY=function(t){this.setRectHelper(t,Qm)},vy.radius=function(t){this.deltaRectHelper(t,Zm)},vy.radiusX=function(t){this.deltaRectHelper(t,Sy)},vy.radiusY=function(t){this.deltaRectHelper(t,Ay)},vy.radiusT=function(t){this.deltaRectHelper(t,hy)},vy.radiusB=function(t){this.deltaRectHelper(t,Km)},vy.radiusL=function(t){this.deltaRectHelper(t,sy)},vy.radiusR=function(t){this.deltaRectHelper(t,ay)},vy.radiusTX=function(t){this.deltaRectHelper(t,yy)},vy.radiusBX=function(t){this.deltaRectHelper(t,iy)},vy.radiusLX=function(t){this.deltaRectHelper(t,ry)},vy.radiusRX=function(t){this.deltaRectHelper(t,ly)},vy.radiusTY=function(t){this.deltaRectHelper(t,by)},vy.radiusBY=function(t){this.deltaRectHelper(t,ny)},vy.radiusLY=function(t){this.deltaRectHelper(t,oy)},vy.radiusRY=function(t){this.deltaRectHelper(t,cy)},vy.radiusTL=function(t){this.deltaRectHelper(t,uy)},vy.radiusTR=function(t){this.deltaRectHelper(t,py)},vy.radiusBL=function(t){this.deltaRectHelper(t,_m)},vy.radiusBR=function(t){this.deltaRectHelper(t,Jm)},vy.radiusTLX=function(t){this.deltaRectHelper(t,dy)},vy.radiusTLY=function(t){this.deltaRectHelper(t,fy)},vy.radiusTRX=function(t){this.deltaRectHelper(t,gy)},vy.radiusTRY=function(t){this.deltaRectHelper(t,my)},vy.radiusBRX=function(t){this.deltaRectHelper(t,ty)},vy.radiusBRY=function(t){this.deltaRectHelper(t,ey)},vy.radiusBLX=function(t){this.deltaRectHelper(t,qm)},vy.radiusBLY=function(t){this.deltaRectHelper(t,Qm)},ky.offshootA=function(t){this.offshootA=t,this.updateDirty()},ky.offshootB=function(t){this.offshootB=t,this.updateDirty()},vy.offshootA=function(t){t.toFixed&&(this.offshootA+=t,this.updateDirty())},vy.offshootB=function(t){t.toFixed&&(this.offshootB+=t,this.updateDirty())},ky.rectangleWidth=function(t){null!=t&&(this.rectangleWidth=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},ky.rectangleHeight=function(t){null!=t&&(this.rectangleHeight=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},vy.rectangleWidth=function(t){this.rectangleWidth=Ws(this.rectangleWidth,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},vy.rectangleHeight=function(t){this.rectangleHeight=Ws(this.rectangleHeight,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},Cy.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},Cy.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=Ws(this[e],t)}),this)},Cy.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeRectanglePath()},Cy.cleanDimensions=function(){this.dirtyDimensions=!1;const t=this.getHost();if(t){const e=t.currentDimensions?t.currentDimensions:[t.w,t.h],i=this.currentRectangleWidth||1,n=this.currentRectangleHeight||1;let s=this.rectangleWidth,r=this.rectangleHeight;s.substring&&(s=parseFloat(s)/100*e[0]),r.substring&&(r=parseFloat(r)/100*e[1]);const o=this.mimic;let a;o&&o.name&&this.useMimicDimensions&&(a=o.currentDimensions),a?(this.currentRectangleWidth=this.addOwnDimensionsToMimic?a[0]+s:a[0],this.currentRectangleHeight=this.addOwnDimensionsToMimic?a[1]+r:a[1]):(this.currentRectangleWidth=s,this.currentRectangleHeight=r),this.currentDimensions[0]=this.currentRectangleWidth,this.currentDimensions[1]=this.currentRectangleHeight,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,i===this.currentRectangleWidth&&n===this.currentRectangleHeight||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0)}else this.dirtyDimensions=!0},Cy.makeRectanglePath=function(){this.dirtyDimensions&&this.cleanDimensions();const t=this.currentRectangleWidth,e=this.currentRectangleHeight,i=this.offshootA,n=this.offshootB;let s=this.radiusTLX,r=this.radiusTLY,o=this.radiusTRX,a=this.radiusTRY,l=this.radiusBRX,c=this.radiusBRY,h=this.radiusBLX,u=this.radiusBLY;(s.substring||r.substring||o.substring||a.substring||l.substring||c.substring||h.substring||u.substring)&&(s=s.substring?parseFloat(s)/100*t:s,r=r.substring?parseFloat(r)/100*e:r,o=o.substring?parseFloat(o)/100*t:o,a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*t:l,c=c.substring?parseFloat(c)/100*e:c,h=h.substring?parseFloat(h)/100*t:h,u=u.substring?parseFloat(u)/100*e:u);let d=Xs;return t-s-o!=0&&(d+="h"+(t-s-o)),o+a!==0&&(d+=`c${o*i},${a*n} ${o-o*n},${a-a*i}, ${o},${a}`),e-a-c!=0&&(d+="v"+(e-a-c)),l+c!==0&&(d+=`c${-l*n},${c*i} ${l*i-l},${c-c*n} ${-l},${c}`),-t+h+l!==0&&(d+=`h${-t+h+l}`),h+u!==0&&(d+=`c${-h*i},${-u*n} ${h*n-h},${u*i-u} ${-h},${-u}`),-e+r+u!==0&&(d+=`v${-e+r+u}`),s+r!==0&&(d+=`c${s*n},${-r*i} ${s-s*i},${r*n-r} ${s},${-r}`),d+="z",d},Cy.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(Xs,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Py=function(t){return!!t&&(t.species=pn,new Rectangle(t))};J.Rectangle=Rectangle;const Shape=function(t=tr){return this.shapeInit(t),this},Oy=Shape.prototype=Ar();Oy.type="Shape",Oy.lib=je,Oy.isArtefact=!0,Oy.isAsset=!1,Ro(Oy),yd(Oy),Oy.cleanSpecies=function(){this.dirtySpecies=!1},Oy.cleanStampHandlePositionsAdditionalActions=function(){const t=this.localBox,e=this.currentStampHandlePosition;e[0]+=t[0],e[1]+=t[1]};const xy=function(t){return!!t&&new Shape(t)};J.Shape=Shape;const Dy=[[.043,0,.082,-.035,.088,-.088],[.007,-.057,-.024,-.121,-.088,-.162],[-.07,-.045,-.169,-.054,-.265,-.015],[-.106,.043,-.194,.138,-.235,.265],[-.044,.139,-.026,.3,.058,.442],[.091,.153,.25,.267,.442,.308],[.206,.044,.431,-.001,.619,-.131],[.2,-.139,.34,-.361,.381,-.619]],wy=[[0,-.27,-.11,-.52,-.29,-.71],[-.19,-.19,-.44,-.29,-.71,-.29],[-.27,0,-.52,.11,-.71,.29],[-.19,.19,-.29,.44,-.29,.71],[0,.27,.11,.52,.29,.71],[.19,.19,.44,.29,.71,.29],[.27,0,.52,-.11,.71,-.29],[.19,-.19,.29,-.44,.29,-.71]],Spiral=function(t=tr){return this.shapeInit(t),this},Fy=Spiral.prototype=Ar();Fy.type="Spiral",Fy.lib=je,Fy.isArtefact=!0,Fy.isAsset=!1,Ro(Fy),yd(Fy);Fy.defs=ur(Fy.defs,{loops:1,loopIncrement:1,drawFromLoop:0});const Ry=Fy.setters,Ty=Fy.deltaSetters;Ry.loops=function(t){this.loops=t,this.updateDirty()},Ty.loops=function(t){this.loops+=t,this.updateDirty()},Ry.loopIncrement=function(t){this.loopIncrement=t,this.updateDirty()},Ty.loopIncrement=function(t){this.loopIncrement+=t,this.updateDirty()},Ry.drawFromLoop=function(t){this.drawFromLoop=ct(t),this.updateDirty()},Ty.drawFromLoop=function(t){this.drawFromLoop=ct(this.drawFromLoop+t),this.updateDirty()},Fy.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeSpiralPath()},Fy.makeSpiralPath=function(){const t=ct(this.loops),e=this.loopIncrement,i=ct(this.drawFromLoop),n=lo();let s,r,o,a,l,c,h,u,d,f,p,g;for(let t=0,i=Dy.length;t<i;t++)[s,r,o,a,l,c]=Dy[t],n.push([s*e,r*e,o*e,a*e,l*e,c*e]);let m=Xs;for(let y=0;y<t;y++)for(let t=0,b=n.length;t<b;t++)[s,r,o,a,l,c]=n[t],y>=i&&(m+=`c${s},${r} ${o},${a} ${l},${c}`),[h,u,d,f,p,g]=wy[t],n[t]=[s+h*e,r+u*e,o+d*e,a+f*e,l+p*e,c+g*e];return co(n),m},Fy.calculateLocalPathAdditionalActions=function(){const[t,e]=this.localBox,i=this.scale;this.pathDefinition=this.pathDefinition.replace(Xs,`m${-t/i},${-e/i}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Ey=function(t){return!!t&&(t.species="spiral",new Spiral(t))};J.Spiral=Spiral;const Star=function(t=tr){return this.shapeInit(t),this},Hy=Star.prototype=Ar();Hy.type="Star",Hy.lib=je,Hy.isArtefact=!0,Hy.isAsset=!1,Ro(Hy),yd(Hy);Hy.defs=ur(Hy.defs,{radius1:0,radius2:0,points:0,twist:0});const Iy=Hy.setters,Ly=Hy.deltaSetters;Iy.radius1=function(t){this.radius1=t,this.updateDirty()},Ly.radius1=function(t){this.radius1+=t,this.updateDirty()},Iy.radius2=function(t){this.radius2=t,this.updateDirty()},Ly.radius2=function(t){this.radius2+=t,this.updateDirty()},Iy.points=function(t){this.points=t,this.updateDirty()},Ly.points=function(t){this.points+=t,this.updateDirty()},Iy.twist=function(t){this.twist=t,this.updateDirty()},Ly.twist=function(t){this.twist+=t,this.updateDirty()},Hy.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeStarPath()},Hy.makeStarPath=function(){const t=this.points,e=this.twist,i=360/t;let n,s,r,o,a=this.radius1,l=this.radius2,c=Ys;if(a.substring||l.substring){const t=this.getHost();if(t){const e=t.currentDimensions[0];a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*e:l}}const h=Nh({x:0,y:-a}),u=Nh({x:0,y:-l});n=h.x,s=h.y,u.rotate(-i/2),u.rotate(e);for(let e=0;e<t;e++)u.rotate(i),r=parseFloat((u.x-n).toFixed(1)),n+=r,o=parseFloat((u.y-s).toFixed(1)),s+=o,c+=`${r},${o} `,h.rotate(i),r=parseFloat((h.x-n).toFixed(1)),n+=r,o=parseFloat((h.y-s).toFixed(1)),s+=o,c+=`${r},${o} `;return zh(h,u),`${Xs}l${c}z`},Hy.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(Xs,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const By=function(t){return!!t&&(t.species="star",new Star(t))};J.Star=Star;const Tetragon=function(t=tr){return this.shapeInit(t),this},$y=Tetragon.prototype=Ar();$y.type="Tetragon",$y.lib=je,$y.isArtefact=!0,$y.isAsset=!1,Ro($y),yd($y);$y.defs=ur($y.defs,{radiusX:5,radiusY:5,intersectX:.5,intersectY:.5});const My=$y.setters,Xy=$y.deltaSetters;My.radius=function(t){this.setRectHelper(t,cn)},My.radiusX=function(t){this.setRectHelper(t,ln)},My.radiusY=function(t){this.setRectHelper(t,hn)},Xy.radius=function(t){this.deltaRectHelper(t,cn)},Xy.radiusX=function(t){this.deltaRectHelper(t,ln)},Xy.radiusY=function(t){this.deltaRectHelper(t,hn)},My.intersectX=function(t){t.toFixed&&(this.intersectX=t,this.updateDirty())},My.intersectY=function(t){t.toFixed&&(this.intersectY=t,this.updateDirty())},Xy.intersectX=function(t){t.toFixed&&(this.intersectX+=t,this.updateDirty())},Xy.intersectY=function(t){t.toFixed&&(this.intersectY+=t,this.updateDirty())},$y.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},$y.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=Ws(this[e],t)}),this)},$y.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeTetragonPath()},$y.makeTetragonPath=function(){const t=this.radiusX,e=this.radiusY;let i,n;if(t.substring||e.substring){const s=this.getHost();if(s){const[r,o]=s.currentDimensions;i=2*(t.substring?parseFloat(t)/100*r:t),n=2*(e.substring?parseFloat(e)/100*o:e)}}else i=2*t,n=2*e;const s=parseFloat((i*this.intersectX).toFixed(2)),r=parseFloat((i-s).toFixed(2)),o=parseFloat((n*this.intersectY).toFixed(2)),a=parseFloat((n-o).toFixed(2));let l=Xs;return l+=`l${r},${o} ${-r},${a} ${-s},${-a} ${s},${-o}z`,l},$y.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(Xs,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Yy=function(t){return!!t&&(t.species="tetragon",new Tetragon(t))};J.Tetragon=Tetragon;const Ticker=function(t=tr){return this.makeName(t.name),this.register(),this.subscribers=[],this.subscriberObjects=[],this.set(this.defs),this.set(t),this.cycleCount=0,this.active=!1,this.effectiveDuration=0,this.startTime=0,this.currentTime=0,this.tick=0,t.subscribers&&this.subscribe(t.subscribers),this.setEffectiveDuration(),this},Gy=Ticker.prototype=Ar();Gy.type=us,Gy.lib="animationtickers",Gy.isArtefact=!1,Gy.isAsset=!1,Ro(Gy);Gy.defs=ur(Gy.defs,{order:1,duration:0,subscribers:null,killOnComplete:!1,cycles:1,observer:null,onRun:null,onHalt:null,onReverse:null,onResume:null,onSeekTo:null,onSeekFor:null,onComplete:null,onReset:null}),Gy.packetExclusions=fr(Gy.packetExclusions,["subscribers"]),Gy.packetFunctions=fr(Gy.packetFunctions,["onRun","onHalt","onReverse","onResume","onSeekTo","onSeekFor","onComplete","onReset"]),Gy.kill=function(t=!0,e=!0){if(t){const t=[...this.subscribers];for(let e=0,i=t.length;e<i;e++){const i=H[t[e]];i&&(i.completeAction(),i.kill())}}return e?(this.active&&this.halt(),pr(jy,this.name),Vy=!0,this.deregister(),!0):this},Gy.killTweens=function(t=!1){return this.kill(!0,t)};const Ny=Gy.getters,zy=Gy.setters;Ny.subscribers=function(){return[...this.subscribers]},zy.subscribers=function(t){this.subscribe(t)},zy.order=function(t){this.order=t,this.active&&(Vy=!0)},zy.cycles=function(t){this.cycles=t,this.cycles||(this.cycleCount=0)},zy.duration=function(t){let e,i,n;const s=this.subscribers;if(this.duration=t,this.setEffectiveDuration(),gr(s))for(e=0,i=s.length;e<i;e++)n=H[s[e]],n&&(n.calculateEffectiveTime(),n.type===ds&&n.calculateEffectiveDuration())},Gy.subscribe=function(...t){const e=t.flat(1/0);return e.length&&(e.forEach((t=>{let e;t.substring?e=H[t]:!cr(t)||t.type!==jn&&t.type!==ds||(e=t),e&&(fr(this.subscribers,e.name),e.ticker=this.name,e.calculateEffectiveTime())})),this.sortSubscribers(),this.recalculateEffectiveDuration()),this},Gy.unsubscribe=function(...t){const e=t.flat(1/0);return e.length&&(e.forEach((t=>{let e;t.substring?e=H[t]:!cr(t)||t.type!==jn&&t.type!==ds||(e=t),e&&(pr(this.subscribers,e.name),e.ticker=Ys)})),this.sortSubscribers(),this.recalculateEffectiveDuration()),this},Gy.repopulateSubscriberObjects=function(){const t=this.subscriberObjects,e=this.subscribers;let i;t.length=0,e.forEach((e=>{i=H[e],i&&t.push(i)}))},Gy.getSubscriberObjects=function(){return this.subscribers.length&&!this.subscriberObjects.length&&this.repopulateSubscriberObjects(),this.subscriberObjects},Gy.sortSubscribers=function(){const t=this.subscribers,e=t.length;if(e>1){const i=lo();let n,s,r,o;for(n=0;n<e;n++)r=t[n],o=ct(r.effectiveTime)||0,i[o]||(i[o]=lo()),i[o].push(r);for(t.length=0,n=0,s=i.length;n<s;n++)r=i[n],r&&(t.push(...r),co(r));co(i)}this.repopulateSubscriberObjects()},Gy.updateSubscribers=function(t,e){e=!!gr(e)&&e;const i=this.getSubscriberObjects();let n,s;if(e)for(n=i.length-1;n>=0;n--)i[n].set(t);else for(n=0,s=i.length;n<s;n++)i[n].set(t);return this},Gy.changeSubscriberDirection=function(){return this.getSubscriberObjects().forEach((t=>t.reversed=!t.reversed)),this},Gy.recalculateEffectiveDuration=function(){const t=this.getSubscriberObjects();let e,i=0;return this.duration?this.setEffectiveDuration():(t.forEach((t=>{e=t.getEndTime(),e>i&&(i=e)})),this.effectiveDuration=i),this},Gy.setEffectiveDuration=function(){let t;return this.duration&&(t=Zs(this.duration),t[0]===Vi?(this.duration=0,this.recalculateEffectiveDuration()):this.effectiveDuration=t[1]),this},Gy.checkObserverRunningState=function(){let t=this.observer;if(t){if(t.substring){const e=i[t];if(!e||e.type!==ls)return!0;t=this.observer=e}if(t.type===ls)return t.isRunning()}return!0},Gy.fn=function(t){t=!!gr(t)&&t;const e=Uy(),i=this.startTime,n=this.cycles,s=this.effectiveDuration;let r,o,a,l,c,h=this.active,u=this.cycleCount;if(h&&i&&(!n||u<n)){if(l=this.currentTime=mt(),c=this.tick=l-i,!n||u+1<n?(c>=s?(c=this.tick=0,this.startTime=this.currentTime,e.tick=s,e.reverseTick=0,e.willLoop=!0,n&&(u++,this.cycleCount=u)):(e.tick=c,e.reverseTick=s-c),e.next=!0):c>=s?(e.tick=s,e.reverseTick=0,h=this.active=!1,n&&(u++,this.cycleCount=u)):(e.tick=c,e.reverseTick=s-c,e.next=!0),a=this.getSubscriberObjects(),t)for(r=a.length-1;r>=0;r--)a[r].update(e);else for(r=0,o=a.length;r<o;r++)a[r].update(e);h||this.halt(),this.killOnComplete&&u>=n&&this.killTweens(!0)}Zy(e)},Gy.run=function(){return this.active||(this.startTime=this.currentTime=mt(),this.cycleCount=0,this.updateSubscribers({reversed:!1}),this.active=!0,fr(jy,this.name),Vy=!0,typeof this.onRun===Je&&this.onRun()),this},Gy.isRunning=function(){return this.active},Gy.reset=function(){return this.active&&this.halt(),this.startTime=this.currentTime=mt(),this.cycleCount=0,this.updateSubscribers({reversed:!1}),this.active=!0,this.fn(!0),this.active=!1,typeof this.onReset===Je&&this.onReset(),this},Gy.complete=function(){return this.active&&this.halt(),this.startTime=this.currentTime=mt(),this.cycleCount=0,this.updateSubscribers({reversed:!0}),this.active=!0,this.fn(),this.active=!1,typeof this.onComplete===Je&&this.onComplete(),this},Gy.reverse=function(t=!1){this.active&&this.halt();const e=this.currentTime-this.startTime;return this.startTime=this.currentTime-(this.effectiveDuration-e),this.changeSubscriberDirection(),this.active=!0,this.fn(),this.active=!1,typeof this.onReverse===Je&&this.onReverse(),t&&this.resume(),this},Gy.halt=function(){return this.active=!1,pr(jy,this.name),Vy=!0,typeof this.onHalt===Je&&this.onHalt(),this},Gy.resume=function(){let t,e,i;return this.active||(t=mt(),e=this.currentTime,i=this.startTime,this.startTime=t-(e-i),this.currentTime=t,this.active=!0,fr(jy,this.name),Vy=!0,typeof this.onResume===Je&&this.onResume()),this},Gy.seekTo=function(t=0,e=!1){let i=!1;return this.active&&this.halt(),this.cycles&&this.cycleCount>=this.cycles&&(this.cycleCount=this.cycles-1),t<this.tick&&(i=!0),this.currentTime=mt(),this.startTime=this.currentTime-t,this.active=!0,this.fn(i),this.active=!1,typeof this.onSeekTo===Je&&this.onSeekTo(),e&&this.resume(),this},Gy.seekFor=function(t=0,e=!1){let i=!1;return this.active&&this.halt(),this.cycles&&this.cycleCount>=this.cycles&&(this.cycleCount=this.cycles-1),this.startTime-=t,t<0&&(i=!0),this.active=!0,this.fn(i),this.active=!1,typeof this.onSeekFor===Je&&this.onSeekFor(),e&&this.resume(),this};const jy=[];let Vy=!0;Eo({name:"SC-core-tickers-animation",order:0,fn:function(){let t,e,i,n,r,o;if(Vy){Vy=!1;const s=lo();for(n=0,r=jy.length;n<r;n++)e=jy[n],e&&(i=ct(e.order)||0,s[i]||(s[i]=lo()),s[i].push(e));for(jy.length=0,n=0,r=s.length;n<r;n++)t=s[n],t&&(jy.push(...t),co(t));co(s)}for(n=0,r=jy.length;n<r;n++)o=jy[n],e=s[o],e&&e.fn&&e.checkObserverRunningState()&&e.fn()}});const Wy=[],Uy=function(){return Wy.length||Wy.push({tick:0,reverseTick:0,willLoop:!1,next:!1}),Wy.shift()},Zy=function(t){t&&(t.tick=0,t.reverseTick=0,t.willLoop=!1,t.next=!1,Wy.push(t))},Ky=function(t){return!!t&&new Ticker(t)};J.Ticker=Ticker;const Tracer=function(t=tr){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.stampAction=qs,this.trace=Jd(t),t.group||(t.group=Cu),this.set(t),this.purge&&this.purgeArtefact(this.purge),this},_y=Tracer.prototype=Ar();_y.type="Tracer",_y.lib=je,_y.isArtefact=!0,_y.isAsset=!1,Ro(_y),od(_y);const qy={artefact:null,historyLength:1,hitRadius:10,showHitRadius:!1,hitRadiusColor:Qt};_y.defs=ur(_y.defs,qy),_y.packetObjects=fr(_y.packetObjects,["artefact","particle"]),_y.packetFunctions=fr(_y.packetFunctions,["stampAction"]),_y.finalizePacketOut=function(t){return t},_y.postCloneAction=function(t,e){return t.trace=Jd({name:t.name,historyLength:e.historyLength||this.historyLength||1}),t},_y.factoryKill=function(t){t&&this.artefact.kill(),this.trace.kill()};const Qy=_y.setters;Qy.stampAction=function(t){ar(t)&&(this.stampAction=t)},Qy.artefact=function(t){let e;t.substring?e=o[t]:cr(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e,this.dirtyFilterIdentifier=!0)},_y.regularStamp=function(){const{artefact:t,trace:e,stampAction:i,showHitRadius:n,hitRadius:s,hitRadiusColor:r,currentStampPosition:o}=this,a=this.currentHost;if(e.set({position:o}),e.manageHistory(0,a),i.call(this,t,e,a),n){const t=a.engine;t.save(),t.lineWidth=1,t.strokeStyle=r,t.setTransform(1,0,0,1,0,0),t.beginPath(),t.arc(o[0],o[1],s,0,bt),t.stroke(),t.restore()}},_y.checkHit=function(t=[]){if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=this.currentStampPosition;let n,s,r=!1;if(e.some((t=>{if(ut(t))n=t[0],s=t[1];else{if(!mr(t,t.x,t.y))return!1;n=t.x,s=t.y}if(!dt(n)||!dt(s))return!1;const e=Nh(i).vectorSubtract(t);return e.getMagnitude()<this.hitRadius&&(r=!0),zh(e),r}),this)){return this.checkHitReturn(n,s)}return!1};const Jy=function(t){return!!t&&new Tracer(t)};J.Tracer=Tracer;const tb={},eb=t=>{let e="";return t.forEach((t=>e+=t.attribute)),e},Tween=function(t=tr){this.makeName(t.name),this.register(),this.targets=[],this.definitions=[],this.set(this.defs);const e=t.ticker;if(e&&!e.substring&&e.name&&e.type===us&&(t.ticker=e.name),this.set(t),this.setObj=eb(this.definitions),this.status=-1,this.calculateEffectiveTime(),this.calculateEffectiveDuration(),s[t.ticker])this.addToTicker(t.ticker);else{const e=`${this.name}_ticker`;Ky({name:e,order:this.order,subscribers:this.name,duration:this.effectiveDuration,cycles:yr(t.cycles,1),killOnComplete:yr(t.killOnComplete,!1),observer:t.observer}),this.ticker=e,s[e].recalculateEffectiveDuration()}return this},ib=Tween.prototype=Ar();ib.type=ds,ib.lib=Ds,ib.isArtefact=!1,ib.isAsset=!1,Ro(ib),id(ib);ib.defs=ur(ib.defs,{duration:0,killOnComplete:!1,commenceAction:null,onRun:null,onHalt:null,onResume:null,onReverse:null,onSeekTo:null,onSeekFor:null,completeAction:null}),ib.packetExclusions=fr(ib.packetExclusions,["definitions","targets"]),ib.packetFunctions=fr(ib.packetFunctions,["commenceAction","completeAction","onRun","onHalt","onResume","onReverse","onSeekTo","onSeekFor","action"]),ib.finalizePacketOut=function(t){return t.targets=this.targets.map((t=>t.name)),t.definitions=this.definitions.map((t=>{const e={};if(e.attribute=t.attribute,e.start=t.start,e.end=t.end,t.engine&&t.engine.substring)e.engine=t.engine.substring;else if(gr(t.engine)&&null!=t.engine){const i=this.stringifyFunction(t.engine);i&&(e.engine=i,e.engineIsFunction=!0)}return e})),t},ib.postCloneAction=function(t,e){if(e.useNewTicker){const i=s[this.ticker];gr(e.cycles)?t.cycles=e.cycles:t.cycles=i?i.cycles:1;const n=s[t.ticker];n.cycles=t.cycles,gr(e.duration)&&(t.duration=e.duration,t.calculateEffectiveDuration(),n&&n.recalculateEffectiveDuration())}return ut(t.definitions)&&t.definitions.forEach(((t,e)=>{t.engineIsFunction&&(t.engine=this.definitions[e].engine)})),t};const nb=ib.getters,sb=ib.setters;nb.definitions=function(){return[...this.definitions]},sb.definitions=function(t){t&&this.setDefinitions(t)},sb.commenceAction=function(t){this.commenceAction=t,typeof this.commenceAction!=Je&&(this.commenceAction=qs)},sb.completeAction=function(t){this.completeAction=t,typeof this.completeAction!=Je&&(this.completeAction=qs)},ib.set=function(t=tr){const e=t.ticker;e&&!e.substring&&e.name&&e.type===us&&(t.ticker=e.name);const i=this.setters,n=ft(t),s=this.defs,r=!!gr(t.ticker)&&this.ticker;let o,a,l,c;for(a=0,l=n.length;a<l;a++)o=n[a],o!=$i&&(c=i[o],c?c.call(this,t[o]):typeof s[o]!=Fs&&(this[o]=t[o]));return r?(this.ticker=r,this.addToTicker(t.ticker)):br(t.time,t.duration)&&(this.calculateEffectiveTime(),this.calculateEffectiveDuration()),this},ib.getEndTime=function(){return this.effectiveTime+this.effectiveDuration},ib.calculateEffectiveDuration=function(t){const e=yr(t,this.duration),i=Zs(e),n=i[1],r=i[0],o=this.ticker;let a,l=0;return this.effectiveDuration=0,r===Vi?o&&(a=s[o],a&&(l=a.effectiveDuration,this.effectiveDuration=l*(n/100))):this.effectiveDuration=n,this},ib.update=function(t=tr){const e=t.tick||0,i=t.reverseTick||0,n=this.effectiveTime,s=this.effectiveDuration,r=this.reversed;let o,a,l=0;r?(o=n+s,a=n,i>o?l=1:i<a&&(l=-1)):(o=n,a=n+s,e<o?l=-1:e>a&&(l=1)),s?l&&l==this.status||(this.status=l,this.doSimpleUpdate(t),t.next||(this.status=r?-1:1)):l!=this.status&&(this.status=l,this.doSimpleUpdate(t),t.next||(this.status=r?-1:1)),t.willLoop&&(this.reverseOnCycleEnd?this.reversed=!r:this.status=-1)},ib.doSimpleUpdate=function(t=tr){const e=this.effectiveTime,i=this.engineActions,n=this.effectiveDuration,s=this.status,r=this.definitions,o=this.targets,a=this.action,l=(c=this.setObj,tb[c]?tb[c]:c.substring?(tb[c]={},tb[c]):{});var c;let h;const u=this.reversed?t.reverseTick-e:t.tick-e;h=n&&!s?u/n:s>0?1:0;for(let t,e,n,s=0,o=r.length;s<o;s++)e=r[s],n=e.engine,t=n.substring?i(n,e.effectiveStart,e.effectiveChange,h):n(e.effectiveStart,e.effectiveChange,h),e.integer&&(t=vt(t)),e.suffix&&(t+=e.suffix),l[e.attribute]=t;for(let t,e=0,i=o.length;e<i;e++)t=o[e],Qn===t.type?t.setArtefacts(l):t.set(l);a&&a()},ib.engineActions=function(t,e,i,n){const s=null!=Sr[t]?t:yi;return e+i*Sr[s](n)},ib.setDefinitions=function(...t){this.definitions.length=0,this.definitions.push(...t.flat(1/0)),this.setObj=eb(this.definitions),this.setDefinitionsValues()},ib.clearDefinitions=function(){this.definitions.length=0,this.setObj=eb(this.definitions)},ib.setDefinitionsValues=function(){const t=this.parseDefinitionsValue,e=this.definitions;let i,n,s,r;for(i=0,n=e.length;i<n;i++)r=e[i],r&&(s=t(r.start),r.effectiveStart=s[1],r.suffix=s[0],s=t(r.end),r.effectiveEnd=s[1],gr(r.engine)||(r.engine=yi),r.effectiveChange=r.effectiveEnd-r.effectiveStart);return this},ib.parseDefinitionsValue=function(t){const e=[Ys,0];if(gr(t))if(t.toFixed)e[1]=t;else if(t.substring){const i=t.match(/^-?\d+\.?\d*(\D*)/);gr(i[0])&&(e[1]=parseFloat(i)),gr(i[1])&&(e[0]=i[1])}return e},ib.run=function(){const t=s[this.ticker];return t&&(this.commenceAction(),t.run(),typeof this.onRun===Je&&this.onRun()),this},ib.isRunning=function(){const t=s[this.ticker];return!!t&&t.isRunning()},ib.halt=function(){const t=s[this.ticker];return t&&(t.halt(),typeof this.onHalt===Je&&this.onHalt()),this},ib.reverse=function(){const t=s[this.ticker];return t&&(t.reverse(),typeof this.onReverse===Je&&this.onReverse()),this},ib.resume=function(){const t=s[this.ticker];return t&&(t.resume(),typeof this.onResume===Je&&this.onResume()),this},ib.seekTo=function(t){const e=s[this.ticker];return e&&(e.seekTo(t),typeof this.onSeekTo===Je&&this.onSeekTo()),this},ib.seekFor=function(t){const e=s[this.ticker];return e&&(e.seekFor(t),typeof this.onSeekFor===Je&&this.onSeekFor()),this};const rb=function(t){return!!t&&new Tween(t)};J.Tween=Tween;const ob=(t,e)=>(t=parseFloat(t),lr(t)||(t=0),lr(e)||(e=0),parseFloat(t.toFixed(e))),Wheel=function(t=tr){return br(t.dimensions,t.width,t.height,t.radius)||(t.radius=5),this.currentRadius=5,this.entityInit(t),this},ab=Wheel.prototype=Ar();ab.type="Wheel",ab.lib=je,ab.isArtefact=!0,ab.isAsset=!1,Ro(ab),od(ab);ab.defs=ur(ab.defs,{radius:5,startAngle:0,endAngle:360,clockwise:!0,includeCenter:!1,closed:!0});const lb=ab.setters,cb=ab.deltaSetters;lb.width=function(t){if(null!=t){const e=this.dimensions;e[0]=e[1]=t,this.dimensionsHelper()}},cb.width=function(t){const e=this.dimensions;e[0]=e[1]=Ws(e[0],t),this.dimensionsHelper()},lb.height=function(t){if(null!=t){const e=this.dimensions;e[0]=e[1]=t,this.dimensionsHelper()}},cb.height=function(t){const e=this.dimensions;e[0]=e[1]=Ws(e[0],t),this.dimensionsHelper()},lb.dimensions=function(t,e){this.setCoordinateHelper(Ee,t,e),this.dimensionsHelper()},cb.dimensions=function(t,e){this.setDeltaCoordinateHelper(Ee,t,e),this.dimensionsHelper()},lb.radius=function(t){this.radius=t,this.radiusHelper()},cb.radius=function(t){this.radius=Ws(this.radius,t),this.radiusHelper()},lb.startAngle=function(t){this.startAngle=ob(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},cb.startAngle=function(t){this.startAngle+=ob(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},lb.endAngle=function(t){this.endAngle=ob(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},cb.endAngle=function(t){this.endAngle+=ob(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},lb.closed=function(t){gr(t)&&(this.closed=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},lb.includeCenter=function(t){gr(t)&&(this.includeCenter=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},lb.clockwise=function(t){gr(t)&&(this.clockwise=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},ab.dimensionsHelper=function(){const t=this.dimensions[0];t.substring?this.radius=parseFloat(t)/2+"%":this.radius=t/2,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},ab.radiusHelper=function(){const t=this.radius,e=this.dimensions;t.substring?e[0]=e[1]=2*parseFloat(t)+Vi:e[0]=e[1]=2*t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},ab.cleanDimensionsAdditionalActions=function(){const t=this.radius,e=this.currentDimensions,i=t.substring?parseFloat(t)/100*e[0]:t;e[0]!==2*i?(e[1]=e[0],this.currentRadius=e[0]/2):this.currentRadius=i},ab.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,n=this.currentRadius*i,s=n-e[0]*i,r=n-e[1]*i,o=this.startAngle*Ct,a=this.endAngle*Ct;t.arc(s,r,n,o,a,!this.clockwise),this.includeCenter?(t.lineTo(s,r),t.closePath()):this.closed&&t.closePath()}};const hb=function(t){return!!t&&new Wheel(t)};J.Wheel=Wheel;const World=function(t=tr){this.makeName(t.name),this.register(),this.set(this.defs);const e=t.keytypes||{};return e.gravity||(e.gravity=fs),t.gravity||(t.gravity=[0,9.81,0]),t.userAttributes&&t.userAttributes.forEach((t=>{this.addAttribute(t),t.type&&(e[t.key]=t.type)})),this.initializeAttributes(e),this.set(t),this},ub=World.prototype=Ar();ub.type=gs,ub.lib="world",ub.isArtefact=!1,ub.isAsset=!1,Ro(ub);ub.defs=ur(ub.defs,{gravity:null,tickMultiplier:1,keytypes:null}),ub.kill=function(){return this.deregister(),!0};const db=ub.getters,fb=ub.setters,pb=ub.deltaSetters;fb.gravityX=function(t){this.gravity&&gr(t)&&this.gravity.setX(t)},fb.gravityY=function(t){this.gravity&&gr(t)&&this.gravity.setY(t)},fb.gravityZ=function(t){this.gravity&&gr(t)&&this.gravity.setZ(t)},fb.gravity=function(t){this.gravity&&gr(t)&&this.gravity.set(t)},ub.addAttribute=function(t=tr){const{key:e,defaultValue:i,setter:n,deltaSetter:s,getter:r}=t;return e&&e.substring&&(this.defs[e]=gr(i)?i:null,this[e]=gr(i)?i:null,ar(n)&&(fb[e]=n),ar(s)&&(pb[e]=s),ar(r)&&(db[e]=r)),this},ub.removeAttribute=function(t){return t&&t.substring&&(delete this.defs[t],delete this[t],delete db[t],delete fb[t],delete pb[t]),this},ub.initializeAttributes=function(t){for(const[e,i]of lt(t))switch(i){case as:this[e]=_h();break;case fs:this[e]=jh();break;case Kn:this[e]=al()}};const gb=function(t){return!!t&&new World(t)};J.World=World;const mb={},yb=function(t=tr){const e=(t=tr)=>{if(t&&t.target){let e=t.target,n="";for(;!n&&(mb[e.id]&&(n=e.id),e.tagName!==Ft);)e=e.parentElement;const r=mb[n];if(r)for(let e=0,n=r.length;e<n;e++){const n=r[e].pickup(t);if(n.current){i=n.move,s=n.drop;break}}}};let i=qs;const n=(t=tr)=>{i(t)};let s=qs;const r=(t=tr)=>{s(t),i=qs,s=qs},a=function(t=tr,e,i){let{zone:n,coordinateSource:s,collisionGroup:r,startOn:a,endOn:l,updateOnStart:c,updateOnEnd:h,updateWhileMoving:u,updateOnShiftStart:d,updateOnShiftEnd:f,updateWhileShiftMoving:p,updateOnPrematureExit:g,exposeCurrentArtefact:m,preventTouchDefaultWhenDragging:y,resetCoordsToZeroOnTouchEnd:b,processingOrder:S}=t;if(!n)return new Error("dragZone constructor - no zone supplied");if(n.substring&&(n=o[n]),!n||!It.includes(n.type))return new Error("dragZone constructor - zone object is not a Stack or Canvas wrapper");const A=n.domElement;if(!A)return new Error("dragZone constructor - zone does not contain a target DOM element");if(r?r.substring&&(r=k[r]):r=n.type===Wn?k[n.base.name]:k[n.name],!r||r.type!==Qn)return new Error("dragZone constructor - unable to recover collisionGroup group");if(s?s.here?s=s.here:mr(s.x,s.y)||(s=!1):s=n.type===Wn?n.base.here:n.here,!s)return new Error("dragZone constructor - unable to discover a usable coordinateSource object");ut(a)||(a=[$e]),ut(l)||(l=[Ts]),null==m&&(m=!1),null==y&&(y=!1),null==b&&(b=!0),cr(c)&&(c=function(){C.artefact.set(t.updateOnStart)}),ar(c)||(c=qs),cr(d)&&(d=function(){C.artefact.set(t.updateOnShiftStart)}),ar(d)||(d=c),cr(h)&&(h=function(){C.artefact.set(t.updateOnEnd)}),ar(h)||(h=qs),cr(f)&&(f=function(){C.artefact.set(t.updateOnShiftEnd)}),ar(f)||(f=h),ar(u)||(u=qs),ar(p)||(p=u),ar(g)||(g=qs),sr(m)||(m=!1),null==S&&(S=0);let C=!1;const v=function(t){t&&t.cancelable&&(y&&C?(t.preventDefault(),t.returnValue=!1):y||(t.preventDefault(),t.returnValue=!1))},P=function(t=tr){C&&(v(t),t.type===Ps&&ra(t),t.shiftKey?p(t):u(t))},O=function(t=tr){C&&(v(t),t.type===vs&&ra(t,b),C.artefact.dropArtefact(),t.shiftKey?f(t):h(t),C=!1)};mb[n.name]||(mb[n.name]=[],e(a,l,A));const x=function(){const t=`${n.name}_${r.name}_${S}`;mb[n.name]=mb[n.name].filter((e=>e.name!==t)),mb[n.name].length||(i(a,l,A),delete mb[n.name])},D=function(t){if(!t)return C;"exit"===t||"drop"===t?(O(),g()):x()},w={name:`${n.name}_${r.name}_${S}`,exposeCurrentArtefact:m,target:A,processingOrder:S,pickup:function(t=tr){v(t);const e=t.type;return e!==Os&&e!==ks||ra(t,b),C=r.getArtefactAt(s),C&&(C.artefact.pickupArtefact(s),t.shiftKey?d(t):c(t)),{current:C,move:P,drop:O}},move:P,drop:O,kill:x,getCurrent:D};return mb[n.name].push(w),mb[n.name].sort(((t,e)=>t.processingOrder-e.processingOrder)),{exposeCurrentArtefact:m,getCurrent:D,kill:x,zone:n}}(t,((t,i,s)=>{Ao(t,e,s),Ao(Li,n,s),Ao(i,r,s)}),((t,i,s)=>{Co(t,e,s),Co(Li,n,s),Co(i,r,s)}));return a.exposeCurrentArtefact?a.getCurrent:a.kill},bb="keydown",Sb="keyup",Ab=["none","shiftOnly","altOnly","ctrlOnly","metaOnly","shiftAlt","shiftCtrl","shiftMeta","altCtrl","altMeta","ctrlMeta","shiftAltCtrl","shiftAltMeta","shiftCtrlMeta","altCtrlMeta","all"],Cb={},kb=function(t=tr){const e=(t=tr)=>{if(t&&t.target){let e=t.target,n="";for(;!n&&(Cb[e.id]&&(n=e.id),e.tagName!==Ft);)e=e.parentElement;const s=Cb[n];s?(s.onKeyDown(t),i=s.onKeyUp):i=qs}};let i=qs;const n=t=>{i(t)};return function(t=tr,e,i){let n=t.zone;if(!n)return new Error("keyboardZone constructor - no zone supplied");if(n.substring&&(n=o[n]),!n||!It.includes(n.type))return new Error("keyboardZone constructor - zone object is not a Stack or Canvas wrapper");const s=n.domElement;if(!s)return new Error("keyboardZone constructor - zone does not contain a target DOM element");let r=Cb[n.name];if(r||(Cb[n.name]={},r=Cb[n.name],e(s)),r.extraKeys||(r.extraKeys={Shift:!1,Control:!1,Alt:!1,Meta:!1}),!r.keyGroups){const t={};Ab.forEach((e=>t[e]={})),r.keyGroups=t}const a=r.keyGroups;return Ab.forEach((e=>{const i=t[e];null!=i&&dr(a[e],i)})),r.onKeyDown||(r.onKeyDown=(t=tr)=>{if(t&&t.key){t.preventDefault();const{extraKeys:e,keyGroups:i}=r,{key:n}=t;if("Tab"===n||"Escape"===n)return void s.blur();if(null!=e[n])return void(e[n]=!0);const{Shift:o,Control:a,Alt:l,Meta:c}=e;let h=i.none;(o||a||l||c)&&(h=o?l?a?c?i.all:i.shiftAltCtrl:c?i.shiftAltMeta:i.shiftAlt:a?c?i.shiftCtrlMeta:i.shiftCtrl:c?i.shiftMeta:i.shiftOnly:l?a?c?i.altCtrlMeta:i.altCtrl:c?i.altMeta:i.altOnly:a?c?i.ctrlMeta:i.ctrlOnly:c?i.altOnly:i.none),h[n]&&h[n]()}}),r.onKeyUp||(r.onKeyUp=(t=tr)=>{if(t&&t.key){t.preventDefault();const e=r.extraKeys,i=t.key;null!=e[i]&&(e[i]=!1)}}),r.kill||(r.kill=function(){delete Cb[n.name],i(s)}),{kill:r.kill,getMappedKeys:(t=Yi)=>null!=r.keyGroups[t]?ft(r.keyGroups[t]):[]}}(t,(t=>{Oo(bb,e,t),Oo(Sb,n,t)}),(t=>{xo(bb,e,t),xo(Sb,n,t)}))},vb=function(t=tr){if(!mr(t.event,t.origin,t.updates))return!1;const e=t.target.substring&&t.targetLibrarySection?tt[t.targetLibrarySection][t.target]:t.target;if(!e)return!1;const i=t.event,n=t.origin,s=t.useNativeListener?Oo:Ao,r=t.useNativeListener?xo:Co;let o=qs;t.preventDefault&&(o=t=>{t.preventDefault(),t.returnValue=!1});const a=ar(t.setup)?t.setup:qs,l=ar(t.callback)?t.callback:qs,c=function(i){o(i);const n=!(!i||!i.target)&&i.target.id;if(n){const s=t.updates[n];if(s){a();const t=s[0],n=s[1],r=i.target.value;let o,c=!0;switch(n){case"float":o=parseFloat(r);break;case"int":o=parseInt(r,10);break;case"round":o=vt(r);break;case"roundDown":o=ct(r);break;case"roundUp":o=st(r);break;case"raw":o=r;break;case"parse":o=r.substring?JSON.parse(r):r;break;case"string":o=`${r}`;break;case"boolean":o=!!gr(r)&&(r.substring?xs===r.toLowerCase()||"false"!==r.toLowerCase()&&!!parseFloat(r):!!r);break;default:n.substring?o=`${parseFloat(r)}${n}`:c=!1}c&&(e.type===Qn?e.setArtefacts({[t]:o}):e.set({[t]:o}),l(i))}}};return s(i,c,n),function(){r(i,c,n)}},Pb=(t=tr)=>vb(t),Ob=t=>{const e={};return t.forEach((t=>{const[i,n,s]=t;switch(i){case"input":if(s.substring){const t=document.querySelector(`#${n}`);t?(t.value=s,e[n]=t):e[n]={}}else e[n]={};break;case"select":if(s.toFixed){const t=document.querySelector(`#${n}`);t?(t.options.selectedIndex=s,e[n]=t):e[n]={}}else e[n]={};break;case"button":if(s.substring){const t=document.querySelector(`#${n}`);t?(t.textContent=s,e[n]=t):e[n]={}}else e[n]={};break;case"element":{const t=document.querySelector(`${n}`);e[n]=t||{};break}default:{const t=document.querySelector(`#${n}`);e[n]=t||{}}}})),e},xb=Xu;"undefined"!=typeof window&&Xu();export{Pu as addCanvas,Ao as addListener,Oo as addNativeListener,$u as addStack,X as checkFontIsLoaded,Nu as clear,zu as compile,Ec as createImageFromCell,Ic as createImageFromEntity,Hc as createImageFromGroup,Bo as currentCorePosition,G as findArtefact,N as findAsset,j as findCanvas,Z as findCell,Q as findElement,z as findEntity,K as findFilter,_ as findGroup,U as findPattern,q as findStack,V as findStyles,W as findTween,no as forceUpdate,Au as getCanvas,Y as getFontMetadata,Uo as getIgnorePixelRatio,bc as getLastUsedReducePalette,Vo as getPixelRatio,Mu as getStack,na as getTouchActionChoke,Tc as importDomImage,Jg as importDomVideo,Rc as importImage,tm as importMediaStream,em as importScreenCapture,rm as importSprite,im as importVideo,xb as init,Ob as initializeDomInputs,tt as library,rd as makeAction,Eo as makeAnimation,So as makeAnimationObserver,Od as makeBezier,ld as makeBlock,Td as makeCog,_l as makeColor,Xd as makeConicGradient,zd as makeCrescent,yb as makeDragZone,cf as makeEmitter,ep as makeEnhancedLabel,Op as makeFilter,Dp as makeForce,yp as makeGradient,$p as makeGrid,Gc as makeGroup,kb as makeKeyboardZone,zp as makeLabel,Vp as makeLine,Kp as makeLineSpiral,eg as makeLoom,og as makeMesh,vg as makeNet,jg as makeNoise,zg as makeNoiseAsset,Zg as makeOval,cm as makePattern,mm as makePicture,Am as makePolygon,Om as makePolyline,Tm as makeQuadratic,Bm as makeRadialGradient,Gm as makeRawAsset,Um as makeReactionDiffusionAsset,Py as makeRectangle,Uu as makeRender,xy as makeShape,Qu as makeSnippet,Ey as makeSpiral,cg as makeSpring,By as makeStar,Yy as makeTetragon,Ky as makeTicker,Jy as makeTracer,rb as makeTween,Pb as makeUpdater,hb as makeWheel,gb as makeWorld,vb as observeAndUpdate,M as purge,da as purgeFontMetadata,ba as recalculateFonts,ol as releaseCoordinate,Kh as releaseQuaternion,zh as releaseVector,Co as removeListener,xo as removeNativeListener,Vu as render,rl as requestCoordinate,Zh as requestQuaternion,Nh as requestVector,La as seededRandomNumberGenerator,vu as setCurrentCanvas,Ya as setFilterMemoizationChoke,Zo as setIgnorePixelRatio,_o as setPixelRatioChangeAction,sa as setTouchActionChoke,Xa as setWorkstoreLifetimeLength,Ua as setWorkstorePurgeChoke,ju as show,yo as startCoreAnimationLoop,ca as startCoreListeners,bo as stopCoreAnimationLoop,ha as stopCoreListeners};
