const t={},e=[],i={},n=[],s={},r=[],o={},a=[],l={},c=[],h={},u=[],d={},f=[],p={},g=[],m={},y=[],b={},S=[],k={},C=[],A={},v=[],P={},x={},O=[],w={},D=[],F={},R=[],T={},H=[],E={},I=[],B={},L=[],$={};function M(h=""){const u=function(t,e,i=!1){t.forEach((t=>{const n=e[t];n&&n.kill&&n.kill(i)}))};if(h){u(a.filter((t=>0===t.indexOf(h))),o);u(c.filter((t=>0===t.indexOf(h))),l);u(v.filter((t=>0===t.indexOf(h))),A,!0);u(L.filter((t=>0===t.indexOf(h))),B);u(I.filter((t=>0===t.indexOf(h))),E);u(n.filter((t=>0===t.indexOf(h))),i);u(r.filter((t=>0===t.indexOf(h))),s);u(S.filter((t=>0===t.indexOf(h))),b);u(e.filter((t=>0===t.indexOf(h))),t);u(O.filter((t=>0===t.indexOf(h))),x);u(D.filter((t=>0===t.indexOf(h))),w);u(R.filter((t=>0===t.indexOf(h))),F)}}function X(t=""){const e=`100px ${t}`;return C.includes(e)}function Y(t=""){const e=`100px ${t}`;return C.includes(e)?k[e]:null}function G(t=""){return a.includes(t)?o[t]:null}function j(t=""){return c.includes(t)?l[t]:null}function z(t=""){return y.includes(t)?m[t]:null}function N(t=""){return u.includes(t)?h[t]:null}function V(t=""){return L.includes(t)?B[t]:null}function W(t=""){return I.includes(t)?E[t]:null}function U(t=""){return L.includes(t)?B[t]:f.includes(t)?d[t]:null}function Z(t=""){return f.includes(t)?d[t]:null}function _(t=""){return S.includes(t)?b[t]:null}function K(t=""){return v.includes(t)?A[t]:null}function q(t=""){return H.includes(t)?T[t]:null}function Q(t=""){return g.includes(t)?p[t]:null}const J={};var tt=Object.freeze({__proto__:null,anchor:t,anchornames:e,animation:i,animationnames:n,animationtickers:s,animationtickersnames:r,artefact:o,artefactnames:a,asset:l,assetnames:c,canvas:h,canvasnames:u,cell:d,cellnames:f,checkFontIsLoaded:X,constructors:J,element:p,elementnames:g,entity:m,entitynames:y,filter:b,filternames:S,findArtefact:G,findAsset:j,findCanvas:N,findCell:Z,findElement:Q,findEntity:z,findFilter:_,findGroup:K,findPattern:U,findStack:q,findStyles:V,findTween:W,fontfamilymetadata:k,fontfamilymetadatanames:C,force:x,forcenames:O,getFontMetadata:Y,group:A,groupnames:v,palette:{},palettenames:[],particle:P,particlenames:[],purge:M,spring:w,springnames:D,stack:T,stacknames:H,styles:B,stylesnames:L,tween:E,tweennames:I,unstackedelement:$,unstackedelementnames:[],version:"8.14.0",world:F,worldnames:R});const et=Math.abs,it=Object.assign,nt=Math.atan2,st=Math.ceil,rt=window.getComputedStyle,ot=Math.cos,at=Object.create,lt=Object.entries,ct=Math.floor,ht=Math.hypot,ut=Array.isArray,dt=Number.isFinite,ft=Object.keys,pt=Math.max,gt=Math.min,mt=Date.now,yt=JSON.parse,bt=2*Math.PI,St=.5*Math.PI,kt=Math.pow,Ct=Math.PI/180,At=Math.random,vt=Math.round,Pt=Object.setPrototypeOf,xt=Math.sin,Ot=Math.sqrt,wt=.016,Dt=Object.values,Ft="BODY",Rt="image_",Tt="video_",Ht="2d",Et="absolute",It=["Canvas","Stack"],Bt="addEventListener",Lt="alpha-to-channels",$t="alphabetic",Mt="anchor",Xt="animation",Yt="anonymous",Gt="area-alpha",jt=",",zt="aria-hidden",Nt="aria-live",Vt="asset",Wt=/.*\/(.*?)\./,Ut="auto",Zt="autofocus",_t="average-channels",Kt="bezier",qt="rgb(0 0 0 / 1)",Qt="black-white",Jt="rgb(0 0 0 / 0)",te="blend",ee="block",ie="bluenoise",ne="blur",se="blurAction",re="border-box",oe="bottom",ae="canvas",le="center",ce="channels-to-alpha",he="chroma",ue="clamp-channels",de="clear",fe="click",pe="clickAction",ge="close",me="color",ye="colors-to-alpha",be="compose",Se="control",ke="coord",Ce=["topLeft","topRight","bottomRight","bottomLeft"],Ae='[data-scrawl-corner-div="sc"]',ve="corrode",Pe="data-scrawl-group",xe="data-tab-order",Oe="12px sans-serif",we="any_random_string_will_do",De="description",Fe="destination-out",Re="destination-over",Te="dimensions",He="disabled",Ee="displace",Ie="display-p3",Be="div",Le="down",$e="download",Me="element",Xe="emboss",Ye="end",Ge="endControl",je="enter",ze="entity",Ne="euler",Ve="fill",We="filter",Ue="flood",Ze="focus",_e="focusAction",Ke=["Label","EnhancedLabel"],qe="form",Qe="function",Je="gaussian-blur",ti="glitch",ei=["Cell","CellFragment"],ii="grayscale",ni="green",si="hanging",ri="height",oi="high",ai="href",li="hreflang",ci="ideographic",hi="img",ui=["RGB","HSL","HWB","XYZ","LAB","LCH","OKLAB","OKLCH"],di="invert-channels",fi="leave",pi="left",gi="lineDash",mi="linear",yi="lock-channels-to-levels",bi="ltr",Si="map-to-gradient",ki="matrix",Ci="mean",Ai="mimic",vi="middle",Pi="modify-ok-channels",xi="modulate-channels",Oi="modulate-ok-channels",wi="mouse",Di="mousedown",Fi="mouseenter",Ri="mouseleave",Ti="mousemove",Hi="mouseup",Ei="move",Ii="mozOsxFontSmoothing",Bi="multiply",Li="name",$i="negative",Mi="never",Xi="newsprint",Yi="none",Gi="normal",ji="offset",zi="particle",Ni="path",Vi="%",Wi="0%",Ui="100%",Zi="50%",_i="ping",Ki="pivot",qi="pixelate",Qi="pointerdown",Ji="pointerenter",tn="pointerleave",en="pointermove",nn="pointerup",sn="polite",rn="process-image",on="0px",an="quadratic",ln=["radiusX"],cn=["radiusX","radiusY"],hn=["radiusY"],un="random",dn="random-noise",fn="rect-grid",pn="rectangle",gn="red",mn="reduce-palette",yn="referrerpolicy",bn="rel",Sn="relative",kn="removeEventListener",Cn="reverseByDelta",An="RGB",vn="right",Pn="role",xn="root",On="rotate-hue",wn="round",Dn="set-channel-to-level",Fn="smoothFont",Rn="source",Tn="source-in",Hn="source-out",En="source-over",In=" ",Bn="srgb",Ln="start",$n="startControl",Mn=["direction","fillStyle","filter","font","fontKerning","fontStretch","fontVariantCaps","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","letterSpacing","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","textAlign","textBaseline","textRendering","wordSpacing"],Xn=["fillStyle","filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle"],Yn=["direction","font","fontKerning","fontStretch","fontVariantCaps","letterSpacing","textRendering","wordSpacing"],Gn="step-channels",jn="styles",zn="subscribe",Nn="swirl",Vn="Bezier",Wn="Canvas",Un="Cell",Zn="Color",_n="Coordinate",Kn="EnhancedLabel",qn="Filter",Qn="Group",Jn="Image",ts="Label",es="Line",is="Noise",ns="Palette",ss="Particle",rs="Picture",os="Polyline",as="Quadratic",ls="Quaternion",cs="RawAsset",hs="RdAsset",us="RenderAnimation",ds="Sprite",fs="Stack",ps="Tween",gs="Vector",ms="Video",ys="World",bs="tabOrder",Ss="target",ks="threshold",Cs="tiles",As="tint-channels",vs="top",Ps="touchcancel",xs="touchend",Os="touchmove",ws="touchstart",Ds="true",Fs="tween",Rs="type",Ts="undefined",Hs="unknown",Es="up",Is="updateByDelta",Bs="user-defined-legacy",Ls="value",$s="vary-channels-by-weights",Ms="video",Xs="webkitFontSmoothing",Ys="rgb(255 255 255 / 1)",Gs="width",js="M0,0",zs="",Ns=Math.PI,Vs="ms",Ws=(t,e)=>{if(null!=e){pi===t||vs===t?t=Wi:vn===t||oe===t?t=Ui:le===t&&(t=Zi);const i=!(!t.substring&&!e.substring);return ar(t)?t+=ar(e)?e:parseFloat(e):t=parseFloat(t)+(ar(e)?e:parseFloat(e)),i?t+Vi:t}return t},Us=function(t,e,i){return t<e?e:t>i?i:t},Zs=t=>{if(ar(t))return[Vs,t];if(t.substring){const e=t.match(/^\d+\.?\d*(\D*)/);let i=e[1].toLowerCase?e[1].toLowerCase():Vs,n=parseFloat(t);if(dt(n)){switch(i){case"s":n*=1e3;break;case"%":break;default:i=Vs}return[i,n]}return[Vs,0]}},_s=t=>dt(t)?((t%=360)<0&&(t+=360),t):0,Ks=t=>{if(dt(t)){if(t<-1e-6)return t;if(t>1e-6)return t}return 0},qs=()=>{},Qs=function(t){return t},Js=function(){return this},tr={},er=()=>performance.now().toString(36)+At().toString(36).substr(2),ir=function(t,e,i){return e+t*(i-e)},nr=t=>"boolean"==typeof t,sr=t=>"[object HTMLCanvasElement]"===Object.prototype.toString.call(t),rr=t=>!!(t&&t.querySelector&&t.dispatchEvent),or=t=>typeof t===Qe,ar=t=>!!dt(t),lr=t=>"[object Object]"===Object.prototype.toString.call(t),cr=t=>!(!t||!t.type||t.type!==ls),hr=(t,e)=>{if(lr(t)&&lr(e))for(const i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},ur=(t,e)=>(lr(t)&&lr(e)&&lt(e).forEach((([i,n])=>{null==n?delete t[i]:t[i]=e[i]})),t),dr=(t,e)=>(ut(t)&&(ut(e)?e.forEach((e=>dr(t,e))):t.includes(e)||t.push(e)),t),fr=(t,e)=>{if(ut(t)){const i=t.indexOf(e);i>=0&&t.splice(i,1)}return t},pr=t=>typeof t!==Ts,gr=(...t)=>t.every((t=>typeof t!==Ts)),mr=(...t)=>t.find((t=>typeof t!==Ts)),yr=(...t)=>!!t.find((t=>typeof t!==Ts)),br={out:t=>1-ot(t*Ns/2),in:t=>xt(t*Ns/2),easeIn:t=>{const e=1-t;return 1-e*e},easeIn3:t=>{const e=1-t;return 1-e*e*e},easeIn4:t=>{const e=1-t;return 1-e*e*e*e},easeIn5:t=>{const e=1-t;return 1-e*e*e*e*e},easeOutIn:t=>t<.5?2*t*t:1-kt(-2*t+2,2)/2,easeOutIn3:t=>t<.5?4*t*t*t:1-kt(-2*t+2,3)/2,easeOutIn4:t=>t<.5?8*t*t*t*t:1-kt(-2*t+2,4)/2,easeOutIn5:t=>t<.5?16*t*t*t*t*t:1-kt(-2*t+2,5)/2,easeInOut:t=>{const e=.5-t;return t<.5?.5+-2*e*e:.5+kt(2*(t-.5),2)/2},easeInOut3:t=>{const e=.5-t;return t<.5?.5+-4*e*e*e:.5+kt(2*(t-.5),3)/2},easeInOut4:t=>{const e=.5-t;return t<.5?.5+-8*e*e*e*e:.5+kt(2*(t-.5),4)/2},easeInOut5:t=>{const e=.5-t;return t<.5?.5+-16*e*e*e*e*e:.5+kt(2*(t-.5),5)/2},easeOut:t=>t*t,easeOut3:t=>t*t*t,easeOut4:t=>t*t*t*t,easeOut5:t=>t*t*t*t*t,none:t=>t,linear:t=>t,cosine:t=>.5*(1+ot((1-t)*Ns)),hermite:t=>t*t*(2*-t+3),quintic:t=>t*t*t*(t*(6*t-15)+10),easeOutSine:t=>1-ot(t*Ns/2),easeInSine:t=>xt(t*Ns/2),easeOutInSine:t=>-(ot(Ns*t)-1)/2,easeOutQuad:t=>t*t,easeInQuad:t=>1-(1-t)*(1-t),easeOutInQuad:t=>t<.5?2*t*t:1-kt(-2*t+2,2)/2,easeOutCubic:t=>t*t*t,easeInCubic:t=>1-kt(1-t,3),easeOutInCubic:t=>t<.5?4*t*t*t:1-kt(-2*t+2,3)/2,easeOutQuart:t=>t*t*t*t,easeInQuart:t=>1-kt(1-t,4),easeOutInQuart:t=>t<.5?8*t*t*t*t:1-kt(-2*t+2,4)/2,easeOutQuint:t=>t*t*t*t*t,easeInQuint:t=>1-kt(1-t,5),easeOutInQuint:t=>t<.5?16*t*t*t*t*t:1-kt(-2*t+2,5)/2,easeOutExpo:t=>0===t?0:kt(2,10*t-10),easeInExpo:t=>1===t?1:1-kt(2,-10*t),easeOutInExpo:t=>0===t||1===t?t:t<.5?kt(2,20*t-10)/2:(2-kt(2,-20*t+10))/2,easeOutCirc:t=>1-Ot(1-kt(t,2)),easeInCirc:t=>Ot(1-kt(t-1,2)),easeOutInCirc:t=>t<.5?(1-Ot(1-kt(2*t,2)))/2:(Ot(1-kt(-2*t+2,2))+1)/2,easeOutBack:t=>2.70158*t*t*t-1.70158*t*t,easeInBack:t=>1+2.70158*kt(t-1,3)+1.70158*kt(t-1,2),easeOutInBack:t=>{const e=2.5949095;return t<.5?kt(2*t,2)*(7.189819*t-e)/2:(kt(2*t-2,2)*((e+1)*(2*t-2)+e)+2)/2},easeOutElastic:t=>{const e=2*Ns/3;return 0===t||1===t?t:-kt(2,10*t-10)*xt((10*t-10.75)*e)},easeInElastic:t=>{const e=2*Ns/3;return 0===t||1===t?t:kt(2,-10*t)*xt((10*t-.75)*e)+1},easeOutInElastic:t=>{const e=2*Ns/4.5;return 0===t||1===t?t:t<.5?-kt(2,20*t-10)*xt((20*t-11.125)*e)/2:kt(2,-20*t+10)*xt((20*t-11.125)*e)/2+1},easeOutBounce:t=>{const e=7.5625,i=2.75;return(t=1-t)<1/i?1-e*t*t:t<2/i?1-(e*(t-=1.5/i)*t+.75):t<2.5/i?1-(e*(t-=2.25/i)*t+.9375):1-(e*(t-=2.625/i)*t+.984375)},easeInBounce:t=>{const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeOutInBounce:t=>{const e=7.5625,i=2.75;let n;return t<.5?(n=(t=1-2*t)<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375,(1-n)/2):(n=(t=2*t-1)<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375,(1+n)/2)}},Sr=()=>at(Object.prototype);let kr=!1;const Cr=()=>kr,Ar=t=>kr=t;let vr=!1;const Pr=()=>vr,xr=t=>vr=t;let Or=!1;const wr=()=>Or,Dr=t=>Or=t;let Fr=!1;let Rr=!1;const Tr=()=>Rr,Hr=t=>Rr=t;let Er=!1;const Ir=()=>Er,Br=t=>Er=t;let Lr=!1;const $r=()=>Lr,Mr=t=>Lr=t;let Xr=!1;const Yr=()=>Xr,Gr=t=>Xr=t;let jr=!0;const zr=t=>jr=t;let Nr=!1;const Vr=t=>Nr=t;let Wr=!0;const Ur=t=>Wr=t,Zr=function(){vr=!0,Or=!0},_r="GenericArray",Kr=function(){const t=[];return Pt(t,Kr.prototype),t};J.GenericArray=Kr;const qr=Kr.prototype=at(Array.prototype);qr.constructor=Kr,qr.type=_r;const Qr=[],Jr=function(){return Qr.length||Qr.push(new Kr),Qr.shift()},to=function(...t){t.forEach((t=>{t&&t.type===_r&&(t.length=0,Qr.push(t),Qr.length>20&&(console.log("purging genericArrayPool"),Qr.length=10))}))},eo=[],io=[],no=t=>{dr(io,t),zr(!0)},so=t=>{fr(io,t),zr(!0)},ro=t=>io.includes(t),oo=()=>{jr&&(zr(!1),(()=>{const t=Jr();let e,n,s,r;for(s=0,r=io.length;s<r;s++)e=i[io[s]],e&&(n=ct(e.order)||0,t[n]||(t[n]=Jr()),t[n].push(e));for(eo.length=0,s=0,r=t.length;s<r;s++)e=t[s],e&&(eo.push(...e),to(e));to(t)})());for(let t=0,e=eo.length;t<e;t++){const e=eo[t],i=mt();e.chokedAnimation?e.lastRun+825/e.maxFrameRate<i&&(e.fn(),e.lastRun=i):e.fn()}Nr&&window.requestAnimationFrame(oo)},ao=()=>{Vr(!0),oo()},lo=()=>Vr(!1),co=function(t,e,i=tr){if(typeof window.IntersectionObserver===Qe&&t&&t.run){const n=new IntersectionObserver((e=>{let i,n,s;for(i=0,n=e.length;i<n;i++)s=e[i],s.isIntersecting&&!t.isRunning()?t.run():!s.isIntersecting&&t.isRunning()&&t.halt()}),i);return e&&e.domElement&&n.observe(e.domElement),function(){n.disconnect()}}return qs},ho=function(t,e,i){return t&&or(e)&&i?(fo(t,e,i,kn),fo(t,e,i,Bt),function(){uo(t,e,i)}):qs},uo=function(t,e,i){t&&or(e)&&i&&fo(t,e,i,kn)},fo=function(t,e,i,n){const s=Jr(),r=Jr();ut(t)?s.push(...t):s.push(t),i.substring?r.push(...document.body.querySelectorAll(i)):ut(i)?r.push(...i):r.push(i),navigator.pointerEnabled||navigator.msPointerEnabled?go(s,e,r,n):po(s,e,r,n),to(r,s)},po=function(t,e,i,n){let s,r,o,a,l,c;for(s=0,r=t.length;s<r;s++)for(l=t[s],o=0,a=i.length;o<a;o++)if(c=i[o],rr(c)||c.document||c.characterSet)switch(l){case Ei:c[n](Ti,e,!1),c[n](Os,e,{passive:!1}),c[n]("touchfollow",e,{passive:!1});break;case Es:c[n](Hi,e,!1),c[n](xs,e,{passive:!1});break;case Le:c[n](Di,e,!1),c[n](ws,e,{passive:!1});break;case fi:c[n](Ri,e,!1),c[n]("touchleave",e,{passive:!1});break;case je:c[n](Fi,e,!1),c[n]("touchenter",e,{passive:!1})}},go=function(t,e,i,n){let s,r,o,a,l,c;for(s=0,r=t.length;s<r;s++)for(l=t[s],o=0,a=i.length;o<a;o++)if(c=i[o],rr(c)||c.document||c.characterSet)switch(l){case Ei:c[n](en,e,!1);break;case Es:c[n](nn,e,!1);break;case Le:c[n](Qi,e,!1);break;case fi:c[n](tn,e,!1);break;case je:c[n](Ji,e,!1)}},mo=function(t,e,i){return t&&or(e)&&i?(bo(t,e,i,kn),bo(t,e,i,Bt),function(){yo(t,e,i)}):qs},yo=function(t,e,i){t&&or(e)&&i&&bo(t,e,i,kn)},bo=function(t,e,i,n){const s=Jr(),r=Jr();let o,a,l,c,h,u;for(ut(t)?s.push(...t):s.push(t),i.substring?r.push(...document.body.querySelectorAll(i)):ut(i)?r.push(...i):r.push(i),o=0,a=s.length;o<a;o++)for(h=s[o],l=0,c=r.length;l<c;l++)u=r[l],(rr(u)||u.document||u.characterSet)&&u[n](h,e,!1);to(r,s)},So="~~~",ko=["Image","Sprite","Video","Canvas","Stack"];function Co(t=tr){t.defs={},t.getters={},t.setters={},t.deltaSetters={},t.get=function(t){let e,i;if(pr(t)){if(i=this.getters[t],i)return i.call(this);{const i=this.defs[t];if(typeof i!==Ts)return e=this[t],typeof e!==Ts?e:i}}return null},t.set=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==Li&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Ts&&(this[i]=n))}return this},t.setDelta=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.deltaSetters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==Li&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Ts&&(this[i]=Ws(this[i],n)))}return this};t.defs=hr(t.defs,{name:""});const e=t.getters;e.type=function(){return this.type},e.isArtefact=function(){return this.isArtefact},e.isAsset=function(){return this.isAsset},t.packetExclusions=[],t.packetExclusionsByRegex=[],t.packetCoordinates=[],t.packetObjects=[],t.packetFunctions=[],t.saveAsPacket=function(t=tr){nr(t)&&t&&(t={includeDefaults:!0});const e=this.defs,i=ft(e),n=this.packetExclusions,s=this.packetExclusionsByRegex,r=this.packetCoordinates,o=this.packetObjects,a=this.packetFunctions;let l=t.includeDefaults||!1,c={};return l&&!ut(l)?l=ft(e):l||(l=[]),lt(this).forEach((([t,e])=>{let h,u=!0;if(i.includes(t)||(u=!1),u&&n.includes(t)&&(u=!1),u&&(h=s.some((e=>new RegExp(e).test(t))),h&&(u=!1)),u)if(a.includes(t)){if(pr(e)&&null!=e){const i=this.stringifyFunction(e);i&&i.length&&(c[t]=i)}}else o.includes(t)&&this[t]&&this[t].name?c[t]=this[t].name:r.includes(t)?(l.includes(t)||e[0]||e[1])&&(c[t]=e):(h=this.processPacketOut(t,e,l),h&&(c[t]=e))}),this),c=this.finalizePacketOut(c,t),JSON.stringify([this.name,this.type,this.lib,c])},t.stringifyFunction=function(t){const e=t.toString().match(/\(([\s\S]*?)\)[\s\S]*?\{([\s\S]*)\}/),i=e[1],n=e[2];return!!gr(i,n)&&`${i}${So}${n}`},t.processPacketOut=function(t,e,i){let n=!0;return i.includes(t)||e!==this.defs[t]||(n=!1),n},t.finalizePacketOut=function(t){return t},t.importPacket=function(t){const e=this,i=function(t){return new Promise(((i,n)=>{let s;t.substring||n(new Error("Packet url supplied for import is not a string")),"["===t[0]?(s=e.actionPacket(t),s&&s.lib?i(s):n(s)):t.includes('"name":')?n(new Error("Bad packet supplied for import")):fetch(t).then((t=>{if(!t.ok)throw new Error(`Packet import from server failed - ${t.status}: ${t.statusText} - ${t.url}`);return t.text()})).then((t=>{if(s=e.actionPacket(t),!s||!s.lib)throw s;i(s)})).catch((t=>n(t)))}))};if(ut(t)){const e=[];return t.forEach((t=>e.push(i(t)))),new Promise(((t,i)=>{Promise.all(e).then((e=>t(e))).catch((t=>i(t)))}))}if(t.substring)return i(t);Promise.reject(new Error("Argument supplied for packet import is not a string or array of strings"))},t.actionPacket=function(t){try{if(t&&t.substring){if("["===t[0]){let e,i,n,s;try{[e,i,n,s]=yt(t)}catch(t){throw new Error(`Failed to process packet due to JSON parsing error - ${t.message}`)}if(gr(e,i,n,s)){if(ko.includes(i))throw new Error("Failed to process packet - Stacks, Canvases and visual assets are excluded from the packet system");let t=tt[n][e];if(t)t.set(s);else{if(s.outerHTML&&s.host){const t=document.querySelector(`#${s.host}`);if(t){const i=document.createElement("div");i.innerHTML=s.outerHTML;const n=i.firstElementChild;n&&(n.id=e,t.appendChild(n),s.domElement=n)}}if(t=new J[i](s),!t)throw new Error("Failed to create Scrawl-canvas object from supplied packet")}if(t.packetFunctions.forEach((e=>this.actionPacketFunctions(t,e))),s.anchor&&t.anchor&&t.anchor.packetFunctions.forEach((e=>{t.anchor[e]=s.anchor[e],this.actionPacketFunctions(t.anchor,e),t.anchor.build()})),s.button&&t.button&&t.button.packetFunctions.forEach((e=>{t.button[e]=s.button[e],this.actionPacketFunctions(t.button,e),t.button.build()})),t)return t;throw new Error("Failed to process supplied packet")}throw new Error("Failed to process packet - JSON string holds incomplete data")}throw new Error("Failed to process packet - JSON string does not represent an array")}throw new Error("Failed to process packet - not a JSON string")}catch(t){return console.log(t),t}},t.actionPacketFunctions=function(t,e){const i=t[e];if(pr(i)&&null!=i&&i.substring)if(i===So)t[e]=qs;else{let n,s,r;[n,s]=i.split(So),n=n.split(jt),n=n.map((t=>t.trim())),s.includes("[native code]")?t[e]=qs:(r=new Function(...n,s),t[e]=r.bind(t))}},t.clone=function(t=tr){const e=this.name;let i,n,s,r;this.name=t.name||zs,t.useNewTicker?(n=this.ticker,this.ticker=null,i=this.saveAsPacket(),this.ticker=n):(this.anchor&&(s=this.anchor,this.anchor=null),this.button&&(r=this.button,this.button=null),i=this.saveAsPacket(),s&&(this.anchor=s),r&&(this.button=r)),this.name=e;let o=this.actionPacket(i);return this.packetFunctions.forEach((t=>{this[t]&&(o[t]=this[t])})),o=this.postCloneAction(o,t),o.set(t),o},t.postCloneAction=function(t){return t},t.kill=function(){return this.deregister()},t.makeName=function(t){return t&&t.substring&&!tt[`${this.lib}names`].includes(t)?this.name=t:this.name=er(),this},t.register=function(){if(!pr(this.name))throw new Error(`core/base error - register() name not set: ${this}`);const t=tt[`${this.lib}names`],e=tt[this.lib];return this.isArtefact&&(dr(a,this.name),o[this.name]=this),this.isAsset&&(dr(c,this.name),l[this.name]=this),dr(t,this.name),e[this.name]=this,this},t.deregister=function(){if(!pr(this.name))throw new Error(`core/base error - deregister() name not set: ${this}`);const t=tt[`${this.lib}names`],e=tt[this.lib];return this.isArtefact&&(fr(a,this.name),delete o[this.name]),this.isAsset&&(fr(c,this.name),delete l[this.name]),fr(t,this.name),delete e[this.name],this}}const Animation=function(t=tr){return this.makeName(t.name),this.order=pr(t.order)?t.order:this.defs.order,this.fn=t.fn||qs,this.onRun=t.onRun||qs,this.onHalt=t.onHalt||qs,this.onKill=t.onKill||qs,this.maxFrameRate=t.maxFrameRate||60,this.lastRun=0,this.chokedAnimation=!0,this.register(),t.delay||this.run(),this},Ao=Animation.prototype=Sr();Ao.type="Animation",Ao.lib=Xt,Ao.isArtefact=!1,Ao.isAsset=!1,Co(Ao);Ao.defs=hr(Ao.defs,{order:1,maxFrameRate:60,fn:null,onRun:null,onHalt:null,onKill:null}),Ao.stringifyFunction=qs,Ao.processPacketOut=qs,Ao.finalizePacketOut=qs,Ao.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Ao.clone=Js,Ao.run=function(){return this.onRun(),no(this.name),setTimeout((()=>Zr()),20),this},Ao.isRunning=function(){return ro(this.name)},Ao.halt=function(){return this.onHalt(),so(this.name),this},Ao.kill=function(){return this.onKill(),so(this.name),this.deregister(),!0};const vo=function(t){return!!t&&new Animation(t)};J.Animation=Animation;const Po="change",xo="touch",Oo=[],wo={x:0,y:0,scrollX:0,scrollY:0,w:0,h:0,type:wi,prefersReducedMotion:!1,prefersDarkColorScheme:!1,prefersReduceTransparency:!1,prefersContrast:!1,prefersReduceData:!1,displaySupportsP3Color:!1,canvasSupportsP3Color:!1,devicePixelRatio:0,rawTouches:[]},Do=window.matchMedia("(prefers-contrast: more)");Do.addEventListener(Po,(()=>{const t=Do.matches;wo.prefersContrast!==t&&(wo.prefersContrast=t,Fr=!0)})),wo.prefersContrast=Do.matches;const Fo=window.matchMedia("(prefers-reduced-motion: reduce)");Fo.addEventListener(Po,(()=>{const t=Fo.matches;wo.prefersReducedMotion!==t&&(wo.prefersReducedMotion=t,Hr(!0))})),wo.prefersReducedMotion=Fo.matches;const Ro=window.matchMedia("(prefers-color-scheme: dark)");Ro.addEventListener(Po,(()=>{const t=Ro.matches;wo.prefersDarkColorScheme!==t&&(wo.prefersDarkColorScheme=t,Br(!0))})),wo.prefersDarkColorScheme=Ro.matches;const To=window.matchMedia("(prefers-reduced-transparency: reduce)");To.addEventListener(Po,(()=>{const t=To.matches;wo.prefersReduceTransparency!==t&&(wo.prefersReduceTransparency=t,Mr(!0))})),wo.prefersReduceTransparency=To.matches;const Ho=window.matchMedia("(prefers-reduced-data: reduce)");Ho.addEventListener(Po,(()=>{const t=Ho.matches;wo.prefersReduceData!==t&&(wo.prefersReduceData=t,Gr(!0))})),wo.prefersReduceData=Ho.matches;const Eo=window.matchMedia("(color-gamut: p3)");Eo.addEventListener(Po,(()=>{const t=Eo.matches;wo.displaySupportsP3Color!==t&&(wo.displaySupportsP3Color=t)})),wo.displaySupportsP3Color=Eo.matches;wo.canvasSupportsP3Color=(()=>{const t=document.createElement("canvas");try{return t.getContext("2d",{colorSpace:Ie}).getContextAttributes().colorSpace===Ie}catch{console.log("checkCanvasSupportsDisplayP3 errored")}return!1})();const Io=()=>wo.devicePixelRatio;let Bo=!1;const Lo=()=>Bo,$o=t=>Bo=t;let Mo=qs;const Xo=t=>Mo=t,Yo=()=>{const t=window.devicePixelRatio;wo.devicePixelRatio=t,Dt(h).forEach((t=>t.dirtyDimensions=!0)),Dt(d).forEach((t=>t.dirtyDimensions=!0)),Dt(m).forEach((t=>t.dirtyHost=!0)),Bo||Mo(),matchMedia(`(resolution: ${t}dppx)`).addEventListener(Po,Yo,{once:!0})};Yo();const Go=function(){const t=document.documentElement.clientWidth,e=document.documentElement.clientHeight;wo.w===t&&wo.h===e||(wo.w=t,wo.h=e,xr(!0),Dr(!0))},jo=function(){const t=window.pageXOffset,e=window.pageYOffset;wo.scrollX===t&&wo.scrollY===e||(wo.x+=t-wo.scrollX,wo.y+=e-wo.scrollY,wo.scrollX=t,wo.scrollY=e,xr(!0))},zo=function(t){const e=vt(t.pageX),i=vt(t.pageY);wo.x===e&&wo.y===i||(wo.type=navigator.pointerEnabled?"pointer":wi,wo.x=e,wo.y=i,xr(!0))};let No=0,Vo=16;const Wo=function(){return Vo},Uo=function(t){dt(t)&&(Vo=t)},Zo=function(t,e=!0){if(wo.rawTouches.length=0,t.touches&&t.touches.length){wo.rawTouches.push(...t.touches);const e=t.touches[0],i=vt(e.pageX),n=vt(e.pageY);wo.x===i&&wo.y===n||(wo.type=xo,wo.x=i,wo.y=n)}else wo.type=xo,e&&(wo.x=0,wo.y=0);const i=mt();i>No+Vo&&(No=i,_o())},_o=function(){for(let t=0,e=Oo.length;t<e;t++)Ko(Oo[t])},Ko=function(t){const e=o[t];if(e){e.here||(e.here={});const{here:t,domElement:i}=e;if(t.prefersContrast=wo.prefersContrast,t.prefersReducedMotion=wo.prefersReducedMotion,t.prefersDarkColorScheme=wo.prefersDarkColorScheme,t.prefersReduceTransparency=wo.prefersReduceTransparency,t.prefersReduceData=wo.prefersReduceData,t.devicePixelRatio=wo.devicePixelRatio,Fr&&e.contrastActions(),Tr()&&e.reducedMotionActions(),Ir()&&e.colorSchemeActions(),$r()&&e.reducedTransparencyActions(),Yr()&&e.reducedDataActions(),i){const n=i.getBoundingClientRect(),s=vt(n.left+window.pageXOffset),r=vt(n.top+window.pageYOffset),o=n.top,a=n.height,l=window.innerHeight;t.w=vt(n.width),t.h=vt(a),t.type=wo.type;const c=o/l,h=(o+a)/l,u=(c+h)/2;t.inViewportTop=c,t.inViewportBase=h,t.inViewportCenter=u,e.localMouseListener?(t.localListener=!0,t.active=!1,t.normX=!!t.originalWidth&&t.x/t.originalWidth,t.normY=!!t.originalHeight&&t.y/t.originalHeight,t.offsetX=s,t.offsetY=r,t.x>e.activePadding&&t.x<t.originalWidth-e.activePadding&&t.y>0+e.activePadding&&t.y<t.originalHeight-e.activePadding&&(t.active=!0)):(t.localListener=!1,t.active=!0,t.x=vt(wo.x-s),t.y=vt(wo.y-r),t.normX=!!t.w&&t.x/t.w,t.normY=!!t.h&&t.y/t.h,t.offsetX=s,t.offsetY=r,(t.normX<0||t.normX>1||t.normY<0||t.normY>1)&&(t.active=!1));const d=wo.rawTouches;if(d.length){t.touches||(t.touches=[]),t.touches.length=0;for(let e=0,i=d.length;e<i;e++){const i=d[e];t.touches.push([vt(i.pageX-s),vt(i.pageY-r)])}}if(e.type===Wn&&e.updateBaseHere(t,e.fit),e.checkForResize&&!e.dirtyDimensions&&!e.dirtyDomDimensions){const[i,n]=e.currentDimensions;if(e.type===Wn){const s=e.computedStyles,r=ct(t.w-parseFloat(s.borderLeftWidth)-parseFloat(s.borderRightWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)),o=ct(t.h-parseFloat(s.borderTopWidth)-parseFloat(s.borderBottomWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom));i===r&&n===o||e.set({dimensions:[r,o]})}else i===t.w&&n===t.h||e.set({dimensions:[t.w,t.h]})}}}},qo=vo({name:"SC-core-listeners-tracker",order:0,delay:!0,fn:function(){const t=Cr(),e=Pr(),i=wr(),n=Tr(),s=Ir(),r=$r(),o=Yr();if(!Oo.length)return!1;(t&&e||n||s||r||o)&&_o(),t&&e&&xr(!1),n&&Hr(!1),s&&Br(!1),r&&Mr(!1),o&&Gr(!1),i&&(Dr(!1),Dt(m).forEach((t=>{Ke.includes(t.type)&&t.recalculateFont(!0)})))}}),Qo=function(){ta(kn),ta(Bt),Ar(!0),xr(!0),qo.run()},Jo=function(){Ar(!1),xr(!1),qo.halt(),ta(kn)},ta=function(t){navigator.pointerEnabled||navigator.msPointerEnabled?(window[t](en,zo,!1),window[t](nn,zo,!1),window[t](Qi,zo,!1),window[t](tn,zo,!1),window[t](Ji,zo,!1)):(window[t](Ti,zo,!1),window[t](Hi,zo,!1),window[t](Di,zo,!1),window[t](Ri,zo,!1),window[t](Fi,zo,!1),window[t](Os,Zo,{passive:!0}),window[t](ws,Zo,{passive:!0}),window[t](xs,Zo,{passive:!0}),window[t](Ps,Zo,{passive:!0})),window[t]("scroll",jo,{passive:!0}),window[t]("resize",Go,!1)},ea=function(){Go(),xr(!0),Dr(!0)},ia=function(){const{fontfamilymetadata:t,fontfamilymetadatanames:e}=tt;e.forEach((e=>delete t[e])),e.length=0},na=["all","background","backgroundAttachment","backgroundBlendMode","backgroundClip","backgroundColor","backgroundOrigin","backgroundPosition","backgroundRepeat","border","borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderCollapse","borderColor","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderSpacing","borderStyle","borderTop","borderTopColor","borderTopStyle","borderTopWidth","borderWidth","clear","color","columns","content","counterIncrement","counterReset","cursor","direction","display","emptyCells","float","font","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontSynthesis","fontVariant","fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition","fontWeight","grid","gridArea","gridAutoColumns","gridAutoFlow","gridAutoPosition","gridAutoRows","gridColumn","gridColumnStart","gridColumnEnd","gridRow","gridRowStart","gridRowEnd","gridTemplate","gridTemplateAreas","gridTemplateRows","gridTemplateColumns","imageResolution","imeMode","inherit","inlineSize","isolation","letterSpacing","lineBreak","lineHeight","listStyle","listStyleImage","listStylePosition","listStyleType","margin","marginBlockStart","marginBlockEnd","marginInlineStart","marginInlineEnd","marginBottom","marginLeft","marginRight","marginTop","marks","mask","maskType","maxWidth","maxHeight","maxBlockSize","maxInlineSize","maxZoom","minWidth","minHeight","minBlockSize","minInlineSize","minZoom","mixBlendMode","objectFit","objectPosition","offsetBlockStart","offsetBlockEnd","offsetInlineStart","offsetInlineEnd","orphans","overflow","overflowWrap","overflowX","overflowY","pad","padding","paddingBlockStart","paddingBlockEnd","paddingInlineStart","paddingInlineEnd","paddingBottom","paddingLeft","paddingRight","paddingTop","pageBreakAfter","pageBreakBefore","pageBreakInside","pointerEvents","position","prefix","quotes","rubyAlign","rubyMerge","rubyPosition","scrollBehavior","scrollSnapCoordinate","scrollSnapDestination","scrollSnapPointsX","scrollSnapPointsY","scrollSnapType","scrollSnapTypeX","scrollSnapTypeY","shapeImageThreshold","shapeMargin","shapeOutside","tableLayout","textAlign","textDecoration","textIndent","textOrientation","textOverflow","textRendering","textShadow","textTransform","textUnderlinePosition","unicodeRange","unset","verticalAlign","widows","willChange","wordBreak","wordSpacing","wordWrap","zIndex"],sa=["alignContent","alignItems","alignSelf","animation","animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction","backfaceVisibility","backgroundImage","backgroundSize","borderBottomLeftRadius","borderBottomRightRadius","borderImage","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderRadius","borderTopLeftRadius","borderTopRightRadius","boxDecorationBreak","boxShadow","boxSizing","columnCount","columnFill","columnGap","columnRule","columnRuleColor","columnRuleStyle","columnRuleWidth","columnSpan","columnWidth","filter","flex","flexBasis","flexDirection","flexFlow","flexGrow","flexShrink","flexWrap","fontFeatureSettings","fontKerning","fontLanguageOverride","hyphens","imageRendering","imageOrientation","initial","justifyContent","linearGradient","opacity","order","orientation","outline","outlineColor","outlineOffset","outlineStyle","outlineWidth","resize","tabSize","textAlignLast","textCombineUpright","textDecorationColor","textDecorationLine","textDecorationStyle","touchAction","transformStyle","transition","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction","unicodeBidi","whiteSpace","writingMode"],ra=[];let oa=!1;const aa=function(t=zs){if(oa||t){const e=Jr();let i,n,s,r,a,l,c,h,u,d,f,p,g,m,y,b;t&&t.substring?e.push(t):(oa=!1,e.push(...ra),ra.length=0);const S=Lo(),k=Io();for(i=0,n=e.length;i<n;i++)if(s=o[e[i]],s&&(r=s.domElement,r&&(a=r.style,a))){if(s.dirtyPerspective&&(s.dirtyPerspective=!1,l=s.perspective,a.perspectiveOrigin=`${l.x} ${l.y}`,a.perspective=`${l.z}px`),s.dirtyPosition&&(s.dirtyPosition=!1,a.position=s.position),s.dirtyDomDimensions&&(s.dirtyDomDimensions=!1,c=s.currentDimensions,h=c[0],u=c[1],s.type===Wn?(S?(r.width=h,r.height=u):(s.ignoreCanvasCssDimensions||(a.width=`${h}px`,a.height=`${u}px`),r.width=h*k,r.height=u*k),s.renderOnResize&&s.render()):(a.width=`${h}px`,a.height=u?`${u}px`:Ut)),s.dirtyTransformOrigin&&(s.dirtyTransformOrigin=!1,a.transformOrigin=s.currentTransformOriginString),s.dirtyTransform&&(s.dirtyTransform=!1,a.transform=s.currentTransformString),s.dirtyVisibility&&(s.dirtyVisibility=!1,a.display=s.visibility?ee:Yi),s.dirtySmoothFont&&(s.dirtySmoothFont=!1,s.smoothFont?(a[Xs]=Ut,a[Ii]=Ut,a[Fn]=Ut):(a[Xs]=Yi,a[Ii]=ii,a[Fn]=Mi)),s.dirtyCss)for(s.dirtyCss=!1,p=s.css||tr,g=ft(p),d=0,f=g.length;d<f;d++)m=g[d],b=p[m],sa.includes(m)?(y=`${m[0].toUpperCase}${m.substr(1)}`,a[`webkit${y}`]=b,a[`moz${y}`]=b,a[`ms${y}`]=b,a[`o${y}`]=b,a[m]=b):na.includes(m)&&(a[m]=b);s.dirtyClasses&&(s.dirtyClasses=!1,r.className.substring&&(r.className=s.classes))}to(e)}},la=(t=100)=>{setTimeout((()=>{y.forEach((t=>{const e=m[t];Ke.includes(e.type)&&e.recalculateFont()}))}),t)},ca=[],ha=[],ua=t=>{dr(ca,t),Ur(!0)},da=t=>{fr(ca,t),Ur(!0)},fa=()=>(Wr&&pa(),ha),pa=function(){Ur(!1);const t=Jr();let e,i,n,s;for(n=0,s=ca.length;n<s;n++)e=o[ca[n]],e&&(i=ct(e.order)||0,t[i]||(t[i]=Jr()),t[i].push(e.name));for(ha.length=0,n=0,s=t.length;n<s;n++)e=t[n],e&&(ha.push(...e),to(e));to(t)},ga=["lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit"],ma=["filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality"],ya=["shadowBlur","shadowOffsetX","shadowOffsetY"],ba=["fillStyle","shadowColor","strokeStyle"],State=function(){return this.set(this.defs),this.lineDash=[],this},Sa=State.prototype=Sr();Sa.type="State",Co(Sa),Sa.defs={fillStyle:qt,strokeStyle:qt,globalAlpha:1,globalCompositeOperation:En,lineWidth:1,lineCap:"butt",lineJoin:"miter",lineDash:null,lineDashOffset:0,miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:qt,font:Oe,direction:bi,fontKerning:Gi,textRendering:Ut,letterSpacing:on,wordSpacing:on,fontStretch:Gi,fontVariantCaps:Gi,filter:Yi,imageSmoothingEnabled:!0,imageSmoothingQuality:oi,textAlign:pi,textBaseline:vs},Sa.processPacketOut=function(t,e,i){let n=!0;if(t===gi)e.length||(n=!!i.includes(gi));else i.includes(t)||e!==this.defs[t]||(n=!1);return n},Sa.finalizePacketOut=function(t){const e=t.fillStyle,i=t.strokeStyle;return e&&!e.substring&&(t.fillStyle=e.name),i&&!i.substring&&(t.strokeStyle=i.name),t};const ka=Sa.getters,Ca=Sa.setters;ka.canvasFont=function(){return this.font},Ca.canvasFont=function(t){this.font=t},Sa.getChanges=function(t,e){let i,n,s,r,o,a,l,c,h;const u=this.defs,d={},f=function(t,e){return typeof t[e]!==Ts?t[e]:u[e]};for(t.substring&&(t=m[t]),s=0,r=ma.length;s<r;s++)i=ma[s],c=f(this,i),h=f(e,i),h!==c&&(d[i]=c);for(s=0,r=ya.length;s<r;s++)i=ya[s],c=f(this,i),h=f(e,i),t.scaleShadow?(n=(c||0)*(t.scale||1),n!==h&&(d[i]=n)):c!==h&&(d[i]=c);if(this.lineWidth||e.lineWidth)for(s=0,r=ga.length;s<r;s++)if(i=ga[s],c=f(this,i),h=f(e,i),i===gi){if(c.length||h.length)if(c.length!==h.length)d.lineDash=c;else{for(l=!1,o=0,a=c.length;o<a;o++)if(c[o]!==h[o]){l=!0;break}l&&(d.lineDash=c)}}else"lineWidth"===i?t.scaleOutline?(n=(c||1)*(t.scale||1),n!==h&&(d.lineWidth=n)):c!==h&&(d.lineWidth=c):h!==c&&(d[i]=c);for(s=0,r=ba.length;s<r;s++)i=ba[s],h=f(e,i),c=f(this,i),c.substring&&h!==c?d[i]=c:c.type===Zn?(c=c.getData(),h!==c&&(d[i]=c)):d[i]=c;if(Ke.includes(t.type))for(s=0,r=Yn.length;s<r;s++)i=Yn[s],c=f(this,i),h=f(e,i),h!==c&&(d[i]=c);return d},Sa.setStateFromEngine=function(t){let e;for(let i=0,n=Mn.length;i<n;i++)e=Mn[i],this[e]=t[e];return this.lineDash=pr(t.lineDash)?t.lineDash:[],this.lineDashOffset=mr(t.lineDashOffset,0),t.textAlign=pi,this.textAlign=pi,t.textBaseline=vs,this.textBaseline=vs,this};const Aa=function(t){return!!t&&new State};J.State=State;var va=function(){var t=4022871197;return function(e){if(e){e=e.toString();for(var i=0;i<e.length;i++){var n=.02519603282416938*(t+=e.charCodeAt(i));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}t=4022871197}},Pa=function(t){return function(){var e,i,n=48,s=1,r=n,o=new Array(n),a=0,l=new va;for(e=0;e<n;e++)o[e]=l(Math.random());var c=function(){++r>=n&&(r=0);var t=1768863*o[r]+2.3283064365386963e-10*s;return o[r]=t-(s=0|t)},h=function(t){return Math.floor(t*(c()+11102230246251565e-32*(2097152*c()|0)))};h.string=function(t){var e,i="";for(e=0;e<t;e++)i+=String.fromCharCode(33+h(94));return i};return h.cleanString=function(t){return t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[\x00-\x1F]/gi,"")).replace(/\n /,"\n")},h.hashString=function(t){for(t=h.cleanString(t),l(t),e=0;e<t.length;e++)for(a=t.charCodeAt(e),i=0;i<n;i++)o[i]-=l(a),o[i]<0&&(o[i]+=1)},h.seed=function(t){var e,i,n,s;void 0!==t&&null!=t||(t=Math.random()),"string"!=typeof t&&(e=t,i=function(t,e){return"function"==typeof e?e.toString():e},t=JSON.stringify(e,function(t,e){var i=[],n=[];return null==e&&(e=function(t,e){return i[0]===e?"[Circular ~]":"[Circular ~."+n.slice(0,i.indexOf(e)).join(".")+"]"}),function(s,r){if(i.length>0){var o=i.indexOf(this);~o?i.splice(o+1):i.push(this),~o?n.splice(o,1/0,s):n.push(s),~i.indexOf(r)&&(r=e.call(this,s,r))}else i.push(r);return null==t?r:t.call(this,s,r)}}(i,s),n)),h.initState(),h.hashString(t)},h.addEntropy=function(){var t=[];for(e=0;e<arguments.length;e++)t.push(arguments[e]);!function(){var t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++)for(i=0;i<n;i++)o[i]-=l(t[e]),o[i]<0&&(o[i]+=1)}(a+++(new Date).getTime()+t.join("")+Math.random())},h.initState=function(){for(l(),e=0;e<n;e++)o[e]=l(" ");s=1,r=n},h.done=function(){l=null},void 0!==t&&h.seed(t),h.range=function(t){return h(t)},h.random=function(){return h(Number.MAX_VALUE-1)/Number.MAX_VALUE},h.floatBetween=function(t,e){return h.random()*(e-t)+t},h.intBetween=function(t,e){return Math.floor(h.random()*(e-t+1))+t},h}()};const xa=function(t){return new Pa(t)},Oa={},wa={};let Da=1e3;const Fa=t=>{dt(t)&&t>=200&&t<=1e4&&(Da=t)},Ra=t=>{dt(t)&&t>=200&&t<=1e4&&(Da=t)},Ta=t=>!!Oa[t],Ha=t=>Oa[t]?(wa[t]=mt(),Oa[t]):null,Ea=(t,e)=>{Oa[t]=e,wa[t]=mt()},Ia=function(t,e=[]){const i=mt();return Oa[t]?(wa[t]=i,Oa[t]):(Oa[t]=e,wa[t]=i,Oa[t])};let Ba=200,La=0;const $a=t=>{dt(t)&&t>=10&&t<=5e3&&(Ba=t)};vo({name:"SC-core-workstore-hygeine",order:998,fn:()=>(()=>{const t=mt();if(La<t-Ba){const e=ft(Oa),i=t-Da;for(let t,n=0,s=e.length;n<s;n++)t=e[n],wa[t]<i&&(delete Oa[t],delete wa[t]);La=t}})()});const Ma=["Gradient","RadialGradient","Pattern"];function Xa(t=tr){t.setEngineFromState=function(t){const e=this.state,i=Mn.length;let n,s,r,o;for(n=0;n<i;n++)s=Mn[n],r=t[s],o=e[s],s===gi?(t.lineDash=o,t.setLineDash(t.lineDash)):r!==o&&(t[s]=o);return t.textAlign!==pi&&(t.textAlign=pi),t.textBaseline!==vs&&(t.textBaseline=vs),this},t.setToDefaults=function(){const t=this.state.defs,e=this.state,i=this.engine;return lt(t).forEach((([t,n])=>{t===gi?(ut(i.lineDash)?i.lineDash.length=0:i.lineDash=[],ut(e.lineDash)?e.lineDash.length=0:e.lineDash=[]):(i[t]=n,e[t]=n)})),i.textAlign=e.textAlign=pi,i.textBaseline=e.textBaseline=vs,this},t.setEngine=function(t){const e=this.state,i=t.state;if(i){const n=i.getChanges(t,e),s=this.setEngineActions;if(ft(n).length){const i=this.engine;for(const r in n)s[r](n[r],i,Ma,t,this),e[r]=n[r]}}return t},t.setEngineActions={fillStyle:function(t,e,i,n,s){if(t.substring){let i=!1;L.includes(t)?i=B[t]:f.includes(t)&&(i=d[t]),i?(n.state.fillStyle=i,e.fillStyle=i.getData(n,s)):e.fillStyle=t}else e.fillStyle=t.getData(n,s)},filter:function(t,e){e.filter=t},font:function(t,e){e.font=t},globalAlpha:function(t,e){e.globalAlpha=t},globalCompositeOperation:function(t,e){e.globalCompositeOperation=t},imageSmoothingEnabled:function(t,e){e.imageSmoothingEnabled=t},imageSmoothingQuality:function(t,e){e.imageSmoothingQuality=t},lineCap:function(t,e){e.lineCap=t},lineDash:function(t,e){e.lineDash=t,e.setLineDash&&e.setLineDash(t)},lineDashOffset:function(t,e){e.lineDashOffset=t},lineJoin:function(t,e){e.lineJoin=t},lineWidth:function(t,e){e.lineWidth=t},miterLimit:function(t,e){e.miterLimit=t},shadowBlur:function(t,e){e.shadowBlur=t},shadowColor:function(t,e){e.shadowColor=t},shadowOffsetX:function(t,e){e.shadowOffsetX=t},shadowOffsetY:function(t,e){e.shadowOffsetY=t},strokeStyle:function(t,e,i,n,s){if(t.substring){let i=!1;L.includes(t)?i=B[t]:f.includes(t)&&(i=d[t]),i?(n.state.strokeStyle=i,e.strokeStyle=i.getData(n,s)):e.strokeStyle=t}else e.strokeStyle=t.getData(n,s)},direction:function(t,e){e.direction=t},fontKerning:function(t,e){e.fontKerning=t},fontStretch:function(t,e){e.fontStretch=t},fontVariantCaps:function(t,e){e.fontVariantCaps=t},letterSpacing:function(t,e){e.letterSpacing=t},textAlign:function(t,e){e.textAlign=pi},textBaseline:function(t,e){e.textBaseline=vs},textRendering:function(t,e){e.textRendering=t},wordSpacing:function(t,e){e.wordSpacing=t}},t.clearShadow=function(){return this.engine.shadowOffsetX=0,this.engine.shadowOffsetY=0,this.engine.shadowBlur=0,this.state.shadowOffsetX=0,this.state.shadowOffsetY=0,this.state.shadowBlur=0,this},t.restoreShadow=function(t){const e=t.state;return this.engine.shadowOffsetX=e.shadowOffsetX,this.engine.shadowOffsetY=e.shadowOffsetY,this.engine.shadowBlur=e.shadowBlur,this.state.shadowOffsetX=e.shadowOffsetX,this.state.shadowOffsetY=e.shadowOffsetY,this.state.shadowBlur=e.shadowBlur,this},t.setToClearShape=function(){return this.engine.fillStyle=Jt,this.engine.strokeStyle=Jt,this.engine.shadowColor=Jt,this.state.fillStyle=Jt,this.state.strokeStyle=Jt,this.state.shadowColor=Jt,this},t.saveEngine=function(){return this.engine.save(),this},t.restoreEngine=function(){return this.engine.restore(),this},t.getEntityHits=function(){const t=[],e=Jr(),i=Jr();return this.groupBuckets&&this.groupBuckets.forEach((t=>{t.visibility&&e.push(...t.getAllArtefactsAt(this.here))}),this),e.forEach((e=>{const n=e.artefact;n.visibility&&!i.includes(n.name)&&(i.push(n.name),t.push(n))})),to(i,e),t},t.rotateDestination=function(t,e,i,n){const s=n||this,r=s.mimic,o=s.pivot;let a,l,c=s.currentRotation;if(r&&r.name&&s.useMimicFlip?(a=r.flipReverse?-1:1,l=r.flipUpend?-1:1):(a=s.flipReverse?-1:1,l=s.flipUpend?-1:1),r&&r.name&&s.useMimicRotation?c=r.currentRotation:o&&o.name&&s.addPivotRotation&&(c=o.currentRotation),c){c*=Ct;const n=ot(c),s=xt(c);t.setTransform(n*a,s*a,-s*l,n*l,e,i)}else t.setTransform(a,0,0,l,e,i);return this}}const Ya="CellFragment",Ga=function(t,e=Bn){this.name=t;const i=this.element=document.createElement(ae);this.engine=i.getContext(Ht,{willReadFrequently:!0,colorSpace:e}),i.width=1,i.height=1;return(this.state=Aa(tr)).setStateFromEngine(this.engine),this},ja=Ga.prototype=Sr();ja.type=Ya,Co(ja),Xa(ja),ja.stringifyFunction=qs,ja.processPacketOut=qs,ja.finalizePacketOut=qs,ja.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},ja.clone=Js,ja.setDimensions=function(t,e){this.w=t,this.h=e,this.element.width=t,this.element.height=e,this.engine.textAlign=pi,this.engine.textBaseline=vs},ja.clearCell=function(){this.engine.clearRect(0,0,this.w,this.h)};const za=[];let Na=0;const Va=function(t=1,e=1,i=Bn){za.length||za.push(new Ga("pool_"+Na++,Fh(i===Ie)));const n=za.shift();return n.setDimensions(t,e),n.engine.save(),n},Wa=function(...t){t.forEach((t=>{t&&t.type===Ya&&(t.setDimensions(1,1),t.engine.restore(),t.state.setStateFromEngine(t.engine),za.push(t))}))},Coordinate=function(t,e){const i=[0,0];return Pt(i,Coordinate.prototype),t&&i.set(t,e),i},Ua=Coordinate.prototype=at(Array.prototype);Ua.constructor=Coordinate,Ua.type=_n,Ua.set=function(t,e){return pr(t)&&(t.type===_n?this.setFromArray(t):t.type===gs?this.setFromVector(t):t.type===ls?this.setFromVector(t.v):ut(t)?this.setFromArray(t):pr(e)&&this.setFromArray([t,e])),this},Ua.setFromArray=function(t){return this[0]=t[0],this[1]=t[1],this},Ua.setFromVector=function(t){return this[0]=t.x,this[1]=t.y,this},Ua.zero=function(){return this[0]=0,this[1]=0,this},Ua.vectorAdd=function(t){return this[0]+=t.x,this[1]+=t.y,this},Ua.vectorSubtract=function(t){return this[0]-=t.x,this[1]-=t.y,this},Ua.add=function(t){return this[0]+=t[0],this[1]+=t[1],this},Ua.subtract=function(t){return this[0]-=t[0],this[1]-=t[1],this},Ua.multiply=function(t){return this[0]*=t[0],this[1]*=t[1],this},Ua.divide=function(t){const[e,i]=t;return e&&i&&(this[0]/=e,this[1]/=i),this},Ua.scalarMultiply=function(t){return this[0]*=t,this[1]*=t,this},Ua.scalarDivide=function(t){return t&&t.toFixed&&(this[0]/=t,this[1]/=t),this},Ua.getMagnitude=function(){return ht(...this)},Ua.rotate=function(t){const[e,i]=this;let n=nt(i,e);n+=.01745329251*t;const s=ht(e,i);return this[0]=s*ot(n),this[1]=s*xt(n),this},Ua.reverse=function(){return this[0]=-this[0],this[1]=-this[1],this},Ua.getDotProduct=function(t){return this[0]*t[0]+this[1]*t[1]},Ua.normalize=function(){const t=this.getMagnitude();return t>0&&(this[0]/=t,this[1]/=t),this};const Za=[],_a=function(t,e){Za.length||Za.push(new Coordinate);const i=Za.shift();return i.set(t,e),i},Ka=function(...t){t.forEach((t=>{t&&t.type===_n&&Za.push(t.zero())}))},qa=function(t,e){return new Coordinate(t,e)};J.Coordinate=Coordinate;const Qa=180/Math.PI,Ja="0",tl="hwb",el="lab",il="lch",nl="_max",sl="_min",rl="oklab",ol="oklch",al="xyz",ll=["HSL","HWB"],cl="HSL",hl="HWB",ul="LAB",dl="LCH",fl="OKLAB",pl="OKLCH",gl=["RGB","HSL","HWB","LAB","LCH","OKLAB","OKLCH"],ml="XYZ",yl=216/24389,bl=24389/27,Sl=Math.cbrt,kl=null!=Sl?Sl:t=>kt(t,1/3),Cl=[.3457/.3585,1,.2958/.3585],Al=[[1.0479298208405488,.022946793341019088,-.05019222954313557],[.029627815688159344,.990434484573249,-.01707382502938514],[-.009243058152591178,.015055144896577895,.7518742899580008]],vl=[[.9554734527042182,-.023098536874261423,.0632593086610217],[-.028369706963208136,1.0099954580058226,.021041398966943008],[.012314001688319899,-.020507696433477912,1.3303659366080753]],Pl=[[506752/1228815,87881/245763,12673/70218],[87098/409605,175762/245763,12673/175545],[7918/409605,87881/737289,1001167/1053270]],xl=[[12831/3959,-329/214,-1974/3959],[-851781/878810,1648619/878810,36519/878810],[705/12673,-2585/12673,705/667]],Ol=[[.8190224432164319,.3619062562801221,-.12887378261216414],[.0329836671980271,.9292868468965546,.03614466816999844],[.048177199566046255,.26423952494422764,.6335478258136937]],wl=[[.2104542553,.793617785,-.0040720468],[1.9779984951,-2.428592205,.4505937099],[.0259040371,.7827717662,-.808675766]],Dl=[[1.2268798733741557,-.5578149965554813,.28139105017721583],[-.04057576262431372,1.1122868293970594,-.07171106666151701],[-.07637294974672142,-.4214933239627914,1.5869240244272418]],Fl=[[.9999999984505198,.39633779217376786,.2158037580607588],[1.0000000088817609,-.10556134232365635,-.06385417477170591],[1.0000000546724108,-.08948418209496575,-1.2914855378640917]],Rl=document.createElement(ae);Rl.width=1,Rl.height=1;const Tl=Rl.getContext(Ht,{willReadFrequently:!0});Tl.globalAlpha=1,Tl.globalCompositeOperation=En;const Color=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.rgb=[],this.rgb_max=[],this.rgb_min=[],this.hsl=[],this.hsl_max=[],this.hsl_min=[],this.hwb=[],this.hwb_max=[],this.hwb_min=[],this.xyz=[],this.xyz_max=[],this.xyz_min=[],this.lab=[],this.lab_max=[],this.lab_min=[],this.lch=[],this.lch_max=[],this.lch_min=[],this.oklab=[],this.oklab_max=[],this.oklab_min=[],this.oklch=[],this.oklch_max=[],this.oklch_min=[],this.easingFunction=Qs,this.dirtyFilterIdentifier=!1,this.convert(Jt),this.convert(qt,sl),this.convert(Ys,nl),this.set(t),this},Hl=Color.prototype=Sr();Hl.type=Zn,Hl.lib=jn,Hl.isArtefact=!1,Hl.isAsset=!1,Co(Hl);const El={rgb:null,rgb_max:null,rgb_min:null,hsl:null,hsl_max:null,hsl_min:null,hwb:null,hwb_max:null,hwb_min:null,xyz:null,xyz_max:null,xyz_min:null,lab:null,lab_max:null,lab_min:null,lch:null,lch_max:null,lch_min:null,oklab:null,oklab_max:null,oklab_min:null,oklch:null,oklch_max:null,oklch_min:null,easing:mi,easingFunction:null,colorSpace:An,returnColorAs:An};Hl.defs=hr(Hl.defs,El),Hl.packetFunctions=dr(Hl.packetFunctions,["easingFunction"]),Hl.kill=function(){const t=this.name;return Dt(m).forEach((e=>{const i=e.state;if(i){const e=i.fillStyle,n=i.strokeStyle,s=i.shadowColor;lr(e)&&e.name===t&&(i.fillStyle=i.defs.fillStyle),lr(n)&&n.name===t&&(i.strokeStyle=i.defs.strokeStyle),lr(s)&&s.name===t&&(i.shadowColor=i.defs.shadowColor)}})),this.deregister(),this},Hl.get=function(t){if(pr(t)){if(t.toFixed)return this.getRangeColor(t);if("min"===t)return this.getMinimumColor();if("max"===t)return this.getMaximumColor();if(t===un)return this.generateRandomColor(),this.getCurrentColor();{const e=this.getters[t];if(e)return e.call(this);{const e=this.defs[t];if(typeof e!==Ts){const i=this[t];return typeof i!==Ts?i:e}return}}}return this.getCurrentColor()},Hl.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==Li&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Ts&&(this[a]=l));t.random&&this.generateRandomColor()}return this};const Il=Hl.setters;Il.color=function(t){this.convert(t)},Hl.setColor=function(t){return this.convert(t),this},Il.minimumColor=function(t){this.convert(t,sl)},Hl.setMinimumColor=function(t){return this.convert(t,sl),this},Il.maximumColor=function(t){this.convert(t,nl)},Hl.setMaximumColor=function(t){return this.convert(t,nl),this},Il.easing=function(t){this.setEasingHelper(t)},Il.easingFunction=Il.easing,Hl.setEasing=function(t){return this.setEasingHelper(t),this},Hl.setEasingFunction=Hl.setEasing,Hl.setEasingHelper=function(t){or(t)?(this.easing=Qe,this.easingFunction=t):t.substring&&br[t]?(this.easing=t,this.easingFunction=Qs):(this.easing=mi,this.easingFunction=Qs)},Il.colorSpace=function(t){this.setColorSpaceHelper(t)},Hl.setColorSpace=function(t){return this.setColorSpaceHelper(t),this},Hl.setColorSpaceHelper=function(t){if(t.substring&&(t=t.toUpperCase(),ui.includes(t))){const e=this.getCurrentColor(),i=this.getMinimumColor(),n=this.getMaximumColor();this.colorSpace=t.toUpperCase(),this.updateColorConversions(e,i,n)}},Il.returnColorAs=function(t){this.setReturnColorAsHelper(t)},Hl.setReturnColorAs=function(t){return this.setReturnColorAsHelper(t),this},Hl.setReturnColorAsHelper=function(t){if(t.substring&&(t=t.toUpperCase(),gl.includes(t))){const e=this.getCurrentColor(),i=this.getMinimumColor(),n=this.getMaximumColor();this.returnColorAs=t.toUpperCase(),this.updateColorConversions(e,i,n)}},Hl.updateColorConversions=function(t,e,i){this.convert(t),this.convert(e,sl),this.convert(i,nl)},Hl.getData=function(){return this.getCurrentColor()},Hl.getCurrentColor=function(){const{rgb:t,hsl:e,hwb:i,lab:n,lch:s,oklab:r,oklch:o}=this;return this.returnColor(t,e,i,n,s,r,o)},Hl.getMinimumColor=function(){const{rgb_min:t,hsl_min:e,hwb_min:i,lab_min:n,lch_min:s,oklab_min:r,oklch_min:o}=this;return this.returnColor(t,e,i,n,s,r,o)},Hl.getMaximumColor=function(){const{rgb_max:t,hsl_max:e,hwb_max:i,lab_max:n,lch_max:s,oklab_max:r,oklch_max:o}=this;return this.returnColor(t,e,i,n,s,r,o)},Hl.returnColor=function(t,e,i,n,s,r,o){null==t&&({rgb:t,hsl:e,hwb:i,lab:n,lch:s,oklab:r,oklch:o}=this);const{buildColorString:a,returnColorAs:l}=this;switch(l){case An:return a(...t,An);case cl:return a(...e,cl);case hl:return Bl?a(...i,hl):a(...t,An);case ul:return Ll?a(...n,ul):a(...t,An);case dl:return $l?a(...s,dl):a(...t,An);case fl:return Ml?a(...r,fl):a(...t,An);case pl:return Xl?a(...o,pl):a(...t,An);default:return Jt}},Hl.returnColorFromValues=function(t,e,i,n){const{colorSpace:s,returnColorAs:r}=this,o=this.buildColorString(t,e,i,n,s);let a=!1;return ml===s||s!==r?a=!0:(hl!==r||Bl)&&(ul!==r||Ll)&&(dl!==r||$l)&&(fl!==r||Ml)&&(pl!==r||Xl)||(a=!0),a?(this.setColor(o),this.returnColor()):o},Hl.buildColorString=function(t,e,i,n,s){switch(s||(s=this.returnColorAs),s){case An:return`rgb(${vt(t)} ${vt(e)} ${vt(i)} / ${n})`;case cl:return`hsl(${t} ${e}% ${i}% / ${n})`;case hl:return`hwb(${t} ${e}% ${i}% / ${n})`;case ul:return`lab(${t}% ${e} ${i} / ${n})`;case dl:return`lch(${t}% ${e} ${i} / ${n})`;case fl:return`oklab(${100*t}% ${e} ${i} / ${n})`;case pl:return`oklch(${100*t}% ${e} ${i} / ${n})`;case ml:return`xyz(${t} ${e} ${i} / ${n})`;default:return Jt}},Hl.generateRandomColor=function(){let t=ct(256*At()),e=ct(256*At()),i=ct(256*At());t>255&&(t=255),e>255&&(e=255),i>255&&(i=255),this.setColor(`rgb(${t} ${e} ${i})`)},Hl.checkColor=function(t){if(t.substring){let e=An;return t.includes("hsl")?e=cl:t.includes(tl)?e=hl:t.includes(rl)?e=fl:t.includes(ol)?e=pl:t.includes(el)?e=ul:t.includes(il)?e=dl:t.includes(al)&&(e=ml),An===e||cl===e?t:(this.colorSpace=e,this.returnColorAs=e,this.convert(t),this.returnColor())}return Jt},Hl.getRangeColor=function(t,e=!1){if(pr(t)&&t.toFixed){let i=this.colorSpace;e&&(ll.includes(i)?i=An:dl===i?i=ul:pl===i&&(i=fl));const n=this.calculateRangeColorValues(t,e),s=this.buildColorString(...n,i);this.setColor(s)}return this.getCurrentColor()},Hl.calculateRangeColorValues=function(t,e=!1){const{colorSpace:i,easing:n,easingFunction:s}=this;let r,o,a,l,c,h=i.toLowerCase();e&&(ll.includes(i)?h="rgb":dl===i?h=el:pl===i&&(h=rl));const[u,d,f,p]=this[`${h}_min`],[g,m,y,b]=this[`${h}_max`];let S=s;!e&&n!==Qe&&br[n]&&(S=br[n]);const k=e?t:S(t);switch(h){case"hsl":case tl:return c=g-u,o=u===g?u:ir(k,c>180||c<-180?c>0?u+360:u-360:u,g),r=p===b?p:ir(k,p,b),a=d===m?d:ir(k,d,m),l=f===y?f:ir(k,f,y),[o,a,l,r];case il:case ol:return c=y-f,l=f===y?f:ir(k,c>180||c<-180?c>0?f+360:f-360:f,y),r=p===b?p:ir(k,p,b),a=d===m?d:ir(k,d,m),o=u===g?u:ir(k,u,g),[o,a,l,r];default:return r=p===b?p:ir(k,p,b),o=u===g?u:ir(k,u,g),a=d===m?d:ir(k,d,m),l=f===y?f:ir(k,f,y),[o,a,l,r]}},Hl.getAlphaValue=function(t){let e=1;return null!=t&&(e=t.includes(Vi)?parseFloat(t)/100:parseFloat(t)),dt(e)?e>1?e=1:e<0&&(e=0):e=1,e},Hl.getHueValue=function(t){return t===Yi?0:(t=t.includes("deg")?parseFloat(t):t.includes("rad")?parseFloat(t)/Ct:t.includes("grad")?parseFloat(t)/400*360:t.includes("turn")?360*parseFloat(t):parseFloat(t),dt(t)?_s(t):0)},Hl.getColorValuesFromString=function(t,e){const i=(t=(t=(t=(t=t.replace(e,zs)).replace("(",zs)).replace(")",zs)).replace("/",zs)).split(In).filter((t=>null!=t&&t!==zs));return null!=i[0]&&i[0]!==Yi||(i[0]=Ja),null!=i[1]&&i[1]!==Yi||(i[1]=Ja),null!=i[2]&&i[2]!==Yi||(i[2]=Ja),i},Hl.extractFromHwbColorString=function(t){const{getAlphaValue:e,getHueValue:i,getColorValuesFromString:n}=this;let s,r,o;const a=n(t,tl),l=i(a[0]),c=parseFloat(a[1]),h=parseFloat(a[2]),u=e(a[3]);return[s,r,o]=this.convertHWBtoRGB(l,c,h),s=ct(255*s),s>255&&(s=255),s<0&&(s=0),r=ct(255*r),r>255&&(r=255),r<0&&(r=0),o=ct(255*o),o>255&&(o=255),o<0&&(o=0),[u,s,r,o]},Hl.extractFromXyzColorString=function(t){const{getAlphaValue:e,getColorValuesFromString:i}=this,n=i(t,al),s=parseFloat(n[0]),r=parseFloat(n[1]),o=parseFloat(n[2]);return[e(n[3]),s,r,o]},Hl.extractFromLabColorString=function(t){const{getAlphaValue:e,getColorValuesFromString:i}=this;let n,s,r;const o=i(t,el);n=parseFloat(o[0]),n>100&&(n=100),n<0&&(n=0),s=o[1].includes(Vi)?1.25*parseFloat(o[1]):parseFloat(o[1]),s>160&&(s=160),s<-160&&(s=-160),r=o[2].includes(Vi)?1.25*parseFloat(o[2]):parseFloat(o[2]),r>160&&(r=160),r<-160&&(r=-160);return[e(o[3]),n,s,r]},Hl.extractFromOklabColorString=function(t){const{getAlphaValue:e,getColorValuesFromString:i}=this;let n,s,r;const o=i(t,rl);n=o[0].includes(Vi)?parseFloat(o[0])/100:parseFloat(o[0]),n>1&&(n=1),n<0&&(n=0),s=o[1].includes(Vi)?parseFloat(o[1])/100*.4:parseFloat(o[1]),s>.5&&(s=.5),s<-.5&&(s=-.5),r=o[2].includes(Vi)?parseFloat(o[2])/100*.4:parseFloat(o[2]),r>.5&&(r=.5),r<-.5&&(r=-.5);return[e(o[3]),n,s,r]},Hl.extractFromLchColorString=function(t){const{getAlphaValue:e,getHueValue:i,getColorValuesFromString:n}=this;let s,r;const o=n(t,il);s=parseFloat(o[0]),s>100&&(s=100),s<0&&(s=0),r=o[1].includes(Vi)?1.5*parseFloat(o[1]):parseFloat(o[1]),r>230&&(r=230),r<0&&(r=0);const a=i(o[2]);return[e(o[3]),s,r,a]},Hl.extractFromOklchColorString=function(t){const{getAlphaValue:e,getHueValue:i,getColorValuesFromString:n}=this;let s,r;const o=n(t,ol);s=s=o[0].includes(Vi)?parseFloat(o[0])/100:parseFloat(o[0]),s>1&&(s=1),s<0&&(s=0),r=o[1].includes(Vi)?parseFloat(o[1])/100*.4:parseFloat(o[1]),r>.4&&(r=.4),r<0&&(r=0);const a=i(o[2]);return[e(o[3]),s,r,a]},Hl.convert=function(t,e=zs){t=t.toLowerCase();const i=this[`rgb${e}`],n=this[`hsl${e}`],s=this[`hwb${e}`],r=this[`xyz${e}`],o=this[`lab${e}`],a=this[`lch${e}`],l=this[`oklab${e}`],c=this[`oklch${e}`];if(!i)return this;let h,u,d,f;return i.length=0,n.length=0,s.length=0,r.length=0,o.length=0,a.length=0,l.length=0,c.length=0,t.includes(tl)&&!Bl?([h,u,d,f]=this.extractFromHwbColorString(t),i.push(u,d,f,h),n.push(...this.convertRGBtoHSL(u,d,f),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),r.push(...this.convertRGBtoXYZ(u,d,f),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):t.includes(al)?([h,u,d,f]=this.extractFromXyzColorString(t),i.push(...this.convertXYZtoRGB(u,d,f),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),r.push(u,d,f,h),o.push(...this.convertXYZtoLAB(u,d,f),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):t.includes(rl)&&!Ml?([h,u,d,f]=this.extractFromOklabColorString(t),l.push(u,d,f,h),c.push(...this.convertOKLABtoOKLCH(u,d,f),h),r.push(...this.convertOKLABtoXYZ(u,d,f),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h)):t.includes(ol)&&!Xl?([h,u,d,f]=this.extractFromOklchColorString(t),c.push(u,d,f,h),l.push(...this.convertOKLCHtoOKLAB(u,d,f),h),r.push(...this.convertOKLABtoXYZ(l[0],l[1],l[2]),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h)):t.includes(el)&&!Ll?([h,u,d,f]=this.extractFromLabColorString(t),o.push(u,d,f,h),r.push(...this.convertLABtoXYZ(u,d,f),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),a.push(...this.convertLABtoLCH(u,d,f),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):t.includes(il)&&!$l?([h,u,d,f]=this.extractFromLchColorString(t),a.push(u,d,f,h),o.push(...this.convertLCHtoLAB(u,d,f),h),r.push(...this.convertLABtoXYZ(o[0],o[1],o[2]),h),i.push(...this.convertXYZtoRGB(r[0],r[1],r[2]),h),n.push(...this.convertRGBtoHSL(i[0],i[1],i[2]),h),s.push(...this.convertRGBHtoHWB(i[0],i[1],i[2],n[0]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)):([u,d,f,h]=this.getColorFromCanvas(t),i.push(u,d,f,h),n.push(...this.convertRGBtoHSL(u,d,f),h),s.push(...this.convertRGBHtoHWB(u,d,f,n[0]),h),r.push(...this.convertRGBtoXYZ(u,d,f),h),o.push(...this.convertXYZtoLAB(r[0],r[1],r[2]),h),a.push(...this.convertLABtoLCH(o[0],o[1],o[2]),h),l.push(...this.convertXYZtoOKLAB(r[0],r[1],r[2]),h),c.push(...this.convertOKLABtoOKLCH(l[0],l[1],l[2]),h)),this},Hl.extractRGBfromColor=function(t){let e,i,n,s;return(t=t.toLowerCase()).includes(tl)&&!Bl?([e,i,n,s]=this.extractFromHwbColorString(t),[i,n,s,e]):t.includes(al)?([e,i,n,s]=this.extractFromXyzColorString(t),[...this.convertXYZtoRGB(i,n,s),e]):t.includes(rl)&&!Ml?([e,i,n,s]=this.extractFromOklabColorString(t),[...this.convertXYZtoRGB(...this.convertOKLABtoXYZ(i,n,s)),e]):t.includes(ol)&&!Xl?([e,i,n,s]=this.extractFromOklchColorString(t),[...this.convertXYZtoRGB(...this.convertOKLABtoXYZ(...this.convertOKLCHtoOKLAB(i,n,s))),e]):t.includes(el)&&!Ll?([e,i,n,s]=this.extractFromLabColorString(t),[...this.convertXYZtoRGB(...this.convertLABtoXYZ(i,n,s)),e]):t.includes(il)&&!$l?([e,i,n,s]=this.extractFromLchColorString(t),[...this.convertXYZtoRGB(...this.convertLABtoXYZ(...this.convertLCHtoLAB(i,n,s))),e]):this.getColorFromCanvas(t)},Hl.convertRGBtoHex=function(t,e,i){if(t.substring&&(t=parseInt(t,10)),e.substring&&(e=parseInt(e,10)),i.substring&&(i=parseInt(i,10)),dt(t)&&dt(e)&&dt(i)){return`#${(Ja+t.toString(16)).slice(-2)}${(Ja+e.toString(16)).slice(-2)}${(Ja+i.toString(16)).slice(-2)}`}return"#000000"},Hl.getColorFromCanvas=function(t){let e=0,i=0,n=0,s=0;Tl.clearRect(0,0,1,1),Tl.fillStyle=t,Tl.fillRect(0,0,1,1);const r=Tl.getImageData(0,0,1,1);return r&&r.data&&([e,i,n,s]=r.data,s/=255),[e,i,n,s]},Hl.convertRGBtoHSL=function(t,e,i){const n=pt(t/=255,e/=255,i/=255),s=gt(t,e,i),r=(s+n)/2,o=n-s;let a=0,l=0;if(0!==o){switch(l=0===r||1===r?0:(n-r)/gt(r,1-r),n){case t:a=(e-i)/o+(e<i?6:0);break;case e:a=(i-t)/o+2;break;case i:a=(t-e)/o+4}a*=60}return[a,100*l,100*r]},Hl.convertHSLtoRGB=function(t,e,i){t=_s(t),e/=100,i/=100;const n=function(n){const s=(n+t/30)%12,r=e*gt(i,1-i);return i-r*pt(-1,gt(s-3,9-s,1))};return[n(0),n(8),n(4)]},Hl.convertRGBtoHWB=function(t,e,i){const n=this.convertRGBtoHSL(t,e,i),s=gt(t/=256,e/=256,i/=256),r=1-pt(t,e,i);return[n[0],100*s,100*r]},Hl.convertRGBHtoHWB=function(t,e,i,n){return[n,100*gt(t/=256,e/=256,i/=256),100*(1-pt(t,e,i))]},Hl.convertHWBtoRGB=function(t,e,i){if((e/=100)+(i/=100)>=1){const t=e/(e+i);return[t,t,t]}const n=this.convertHSLtoRGB(t,100,50);for(let t=0;t<3;t++)n[t]*=1-e-i,n[t]+=e;return n},Hl.multiplyMatrices=function(t,e){const i=t.length;ut(t[0])||(t=[t]),ut(e[0])||(e=e.map((t=>[t])));const n=e[0].length,s=e[0].map(((t,i)=>e.map((t=>t[i]))));let r=t.map((t=>s.map((e=>ut(t)?t.reduce(((t,i,n)=>t+i*(e[n]||0)),0):e.reduce(((e,i)=>e+i*t),0)))));return 1===i&&(r=r[0]),1===n?r.map((t=>t[0])):r},Hl.lin_sRGB=function(t){return t.map((t=>{const e=t<0?-1:1,i=et(t);return i<.04045?t/12.92:e*kt((i+.055)/1.055,2.4)}))},Hl.convertRGBtoXYZ=function(t,e,i){const n=Jr();n.push(t/255,e/255,i/255);const s=Jr();s.push(...this.lin_sRGB(n));const r=Jr();r.push(...Pl);const o=this.multiplyMatrices(r,s);return to(n,s,r),o},Hl.convertRGBtoOKLAB=function(t,e,i){const n=Jr();n.push(t/255,e/255,i/255);const[s,r,o]=this.lin_sRGB(n),a=.2119034982*s+.6806995451*r+.1073969566*o,l=.0883024619*s+.2817188376*r+.6299787005*o,c=kl(.4122214708*s+.5363325363*r+.0514459929*o),h=kl(a),u=kl(l);return to(n),[.2104542553*c+.793617785*h-.0040720468*u,1.9779984951*c-2.428592205*h+.4505937099*u,.0259040371*c+.7827717662*h-.808675766*u]},Hl.convertOKLABtoRGB=function(t,e,i){const n=t+.3963377774*e+.2158037573*i,s=t-.1055613458*e-.0638541728*i,r=t-.0894841775*e-1.291485548*i,o=n*n*n,a=s*s*s,l=r*r*r,c=Jr();c.push(4.0767416621*o-3.3077115913*a+.2309699292*l,-1.2684380046*o+2.6097574011*a-.3413193965*l,-.0041960863*o-.7034186147*a+1.707614701*l);const[h,u,d]=this.gam_sRGB(c),f=vt(255*h),p=vt(255*u),g=vt(255*d);return to(c),[f,p,g]},Hl.gam_sRGB=function(t){return t.map((t=>{const e=t<0?-1:1,i=et(t);return i>.0031308?e*(1.055*kt(i,1/2.4)-.055):12.92*t}))},Hl.convertXYZtoRGB=function(t,e,i){const n=Jr();n.push(...xl);const s=Jr();s.push(t,e,i);const r=this.multiplyMatrices(n,s),o=this.gam_sRGB(r);return to(n,s),[vt(255*o[0]),vt(255*o[1]),vt(255*o[2])]},Hl.convertXYZtoLAB=function(t,e,i){const n=Jr();n.push(...Al);const s=Jr();s.push(t,e,i);const r=this.multiplyMatrices(n,s).map(((t,e)=>t/Cl[e])).map((t=>t>yl?kl(t):(bl*t+16)/116));return to(n,s),[116*r[1]-16,500*(r[0]-r[1]),200*(r[1]-r[2])]},Hl.convertLABtoXYZ=function(t,e,i){const n=(t+16)/116,s=e/500+n,r=n-i/200,o=Jr();o.push(kt(s,3)>yl?kt(s,3):(116*s-16)/bl,t>8?kt((t+16)/116,3):t/bl,kt(r,3)>yl?kt(r,3):(116*r-16)/bl);const a=Jr();a.push(...vl);const l=Jr();l.push(...o.map(((t,e)=>t*Cl[e])));const c=this.multiplyMatrices(a,l);return to(o,a,l),c},Hl.convertLABtoLCH=function(t,e,i){const n=nt(i,e)*Qa;return[t,Ot(kt(e,2)+kt(i,2)),n>=0?n:n+360]},Hl.convertLCHtoLAB=function(t,e,i){return[t,e*ot(i*Ct),e*xt(i*Ct)]},Hl.convertXYZtoOKLAB=function(t,e,i){const n=Jr();n.push(...Ol);const s=Jr();s.push(t,e,i);const r=Jr();r.push(...wl);const o=this.multiplyMatrices(n,s),a=this.multiplyMatrices(r,o.map((t=>kl(t))));return to(n,s,r),a},Hl.convertOKLABtoXYZ=function(t,e,i){const n=Jr();n.push(...Fl);const s=Jr();s.push(t,e,i);const r=Jr();r.push(...Dl);const o=this.multiplyMatrices(n,s),a=this.multiplyMatrices(r,o.map((t=>t**3)));return to(n,s,r),a},Hl.convertOKLABtoOKLCH=function(t,e,i){const n=nt(i,e)*Qa;return[t,Ot(e**2+i**2),n>=0?n:n+360]},Hl.convertOKLCHtoOKLAB=function(t,e,i){return[t,e*ot(i*Ct),e*xt(i*Ct)]};let Bl=!1,Ll=!1,$l=!1,Ml=!1,Xl=!1;!function(){let t,e=0,i=0,n=0;Tl.save(),Tl.fillStyle="hwb(90 10% 10%)",Tl.fillRect(0,0,1,1),t=Tl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Bl=!0),Tl.restore(),Tl.save(),Tl.fillStyle="lab(29.2345% 39.3825 20.0664)",Tl.fillRect(0,0,1,1),t=Tl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Ll=!0),Tl.restore(),Tl.save(),Tl.fillStyle="lch(52.2345% 72.2 56.2)",Tl.fillRect(0,0,1,1),t=Tl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&($l=!0),Tl.restore(),Tl.save(),Tl.fillStyle="oklab(59.686% 0.1009 0.1192)",Tl.fillRect(0,0,1,1),t=Tl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Ml=!0),Tl.restore(),Tl.save(),Tl.fillStyle="oklch(59.686% 0.15619 49.7694)",Tl.fillRect(0,0,1,1),t=Tl.getImageData(0,0,1,1),t&&t.data&&([e,i,n]=t.data),(e||i||n)&&(Xl=!0),Tl.restore()}();const Yl=function(t){return!!t&&new Color(t)};J.Color=Color;const Gl=new Float32Array([.37,.69,.62,.78,.06,.84,.27,.14,.46,1,.58,.28,.62,.8,.3,.7,.93,.53,.76,.24,.15,.51,.79,.28,.99,.16,.22,.45,.03,.73,.34,.96,.5,.3,.07,.84,.51,.27,.89,.8,.66,.25,.54,.94,.08,.66,.36,.85,.69,.93,.26,.79,.68,.36,.23,.5,.83,.34,.64,.91,.73,.8,.95,.59,.1,.76,.82,.03,.62,.47,.09,.55,.33,.22,.45,.04,.76,.52,.69,.24,.78,.12,.59,.37,.03,.82,.93,.69,.42,.34,.89,.62,.27,1,.53,.09,.38,.71,.13,.52,.19,.66,.33,.42,.63,.28,.36,.61,.73,.06,.56,.97,.35,.72,.91,.3,.98,.53,.2,.08,.5,.22,.87,.93,.08,.44,.91,.56,.12,.99,.01,.49,.37,.68,.89,.55,.3,.84,.17,.67,.1,.48,.89,.23,.47,.06,.29,.61,.67,.91,.2,.47,.64,.05,.77,.94,.62,.09,.58,.12,.77,.47,.93,.39,.73,.09,.47,.58,.15,.39,.02,.64,.32,.77,.98,.03,.28,.44,.11,.01,.73,.44,.88,.02,.76,.53,.41,.05,.25,.36,.02,.31,.52,.39,.28,.57,.91,.7,.98,0,.76,.94,.66,.85,.33,.18,.88,.01,.99,.46,.69,.94,.32,.51,.45,.07,.55,.22,.11,.8,.42,.17,.87,.47,.81,.23,.88,.43,.6,.11,.75,.06,.88,.72,.47,.92,.13,.31,.84,.47,.27,.16,.5,.09,.78,.44,.34,.56,.95,.69,.36,.13,.64,.29,.04,.87,.41,.53,.31,.87,.22,.6,.09,.77,.22,.72,.4,.88,.37,.75,.06,.58,.65,.86,.99,.42,.37,.58,.04,.74,.35,.57,.83,.39,.5,.91,.42,.27,.69,.02,.8,.22,.63,.97,.04,.34,.69,.97,.51,.83,.45,.24,.56,.49,.64,.81,.99,.55,.31,.17,.62,.1,.69,.15,.86,.2,.52,.67,.77,.19,.7,.85,.45,.18,.12,.4,.3,.82,.37,.53,.07,.27,.56,.64,.44,.34,.56,.25,.2,.08,.76,.64,.15,.78,.95,.72,.87,.51,.36,.02,.74,.3,.07,.64,.34,0,.82,.28,.97,.22,.5,.81,.02,.25,.41,.69,.2,.03,.76,.42,.69,.85,.59,.14,.91,.76,.28,.06,.61,.47,.73,.8,.55,.25,.61,.82,.19,.72,.13,.98,.41,.03,.64,.96,.12,.52,.27,.17,.97,.42,.13,.35,.2,.78,.11,.86,.82,.24,.95,.49,.14,.25,.17,.69,.85,.21,.95,.58,.35,.15,.44,.29,.78,.84,.2,.28,.88,.09,.2,.92,.13,.75,.17,.37,.23,.52,.89,.82,.47,1,.39,.29,.75,.59,.96,.14,.42,.92,.63,.04,1,.67,.78,.5,.24,.61,.17,.71,.92,.41,.11,.96,.74,.07,.83,.66,.89,.4,.85,.23,.55,.36,.27,.19,.04,.67,.94,.58,.63,.2,.97,.75,.55,.92,.72,.46,.55,.69,.34,.17,.67,.56,.88,.96,.52,.62,.94,.88,.21,.04,.37,.25,.72,.02,.81,.16,.91,.4,.21,1,.16,.7,.94,.1,.78,.55,.45,.7,.51,.86,.29,.48,.05,.93,.59,.81,.72,.29,.83,.59,.73,0,.49,.3,.64,.39,.11,.71,.32,.97,.78,.34,.05,.37,.49,.12,.9,.68,.56,.92,.49,.14,.55,.76,.6,.34,.72,.64,.4,.03,.88,.6,.71,.13,.65,.05,.27,.56,.22,.94,.47,.09,.33,.84,.47,.27,.09,.57,.23,.34,.07,.95,.56,.87,.11,.46,.2,.77,.87,.5,.18,.29,.79,.14,.61,.51,.29,.99,.01,.91,.65,.47,.58,.3,.23,.13,.83,.4,.49,.15,.25,.36,.17,.84,.13,.41,.07,1,.44,.77,.09,.35,.73,.3,.11,.34,.57,.47,.93,.63,.41,.53,.49,.32,.86,.55,.02,.84,.51,.34,.26,.04,.39,.92,.33,.25,.84,.17,.35,.8,.43,.67,.31,.03,.51,.47,.08,.94,.25,.55,.91,.71,.15,.45,.58,.89,.67,.02,.47,.57,.62,.82,.73,.53,.27,.81,.07,.19,.65,.4,.92,0,.44,.16,1,.53,.8,.33,.96,.29,.07,.44,.94,.34,.74,.84,.67,0,.84,.64,.71,.04,.55,.89,.39,.72,.53,.82,.42,.65,.02,.36,.94,.29,.63,0,.37,.25,.67,.93,.51,.37,.04,.74,.12,.68,.44,.81,.11,.38,.78,.99,.45,.71,.89,.33,.59,.91,.69,.51,.05,.64,.27,.89,.61,.84,.31,.24,.5,.04,.18,.44,.8,.66,.14,.75,.82,.11,.18,.99,.65,.12,.77,.25,.62,.32,.09,.75,.65,.47,.58,.16,.05,.65,.08,.94,.56,.73,.25,.84,.14,.38,.87,.64,.16,.78,.4,.64,.2,.33,.99,.02,.86,.2,.53,.42,.86,.1,.94,.14,.23,.99,.03,.4,.88,.72,.24,.07,.8,.32,.69,.83,.04,.25,.68,.22,.48,.55,.76,.86,.39,.17,.53,.09,.42,.34,.5,.26,.23,1,.18,.77,.31,.94,.15,.88,.29,.73,.21,.8,.69,.53,.95,.76,.56,.11,.6,.05,.44,.23,.96,.82,.56,.35,.21,.72,.52,.88,.16,.82,.08,.52,.27,.8,.1,.02,.84,.3,.78,.98,.43,.73,.19,.52,.14,.89,.65,.79,.6,.92,.52,.07,.98,.27,.51,.3,.78,.88,.23,.42,.7,.1,.91,.77,.43,.96,.22,.87,.71,.8,.95,.55,.76,.45,.15,.02,.99,.54,.2,.73,.96,.24,.55,.36,.05,.95,.13,.75,.55,.77,.25,.36,.13,.8,.19,.29,.71,.36,.45,.65,.33,.61,.51,.37,1,.56,.46,.89,.23,.5,.4,.91,.58,.07,.83,.65,.12,.25,.61,.79,.14,.97,.63,.78,.12,.89,.43,.38,.61,.69,0,.45,.19,.6,.02,.92,.5,.42,.09,.24,.42,.16,.89,.48,.99,.76,.66,.87,.27,.45,.16,.62,.89,.25,.04,.33,.22,.62,.37,0,.67,.18,.45,.75,.62,.42,.18,.57,.01,.36,.8,.05,.68,.4,1,.27,.86,.4,.22,.37,.83,.44,.68,.05,.56,.35,.06,.59,.94,.49,.38,.58,.16,.53,.13,.29,.36,.51,.2,.26,.36,.89,.69,.31,.42,.63,.91,.5,.04,.31,.85,.72,.47,.83,.61,.36,.48,.07,.93,.64,.72,1,.6,.49,.89,.54,.08,.76,.92,.16,.09,.82,.29,.14,.61,.18,.75,.65,.11,.29,.78,.15,.42,.36,.99,.01,.49,.69,.31,.89,.25,.18,.94,.58,.7,.85,.09,.5,.22,.85,.69,.39,.33,.78,.15,.58,.85,.04,.72,.35,.84,.28,.4,.16,.33,.56,.01,.69,.96,.06,.47,.83,.56,.69,.93,.54,.74,.94,.86,.53,.98,.38,.24,.95,.11,.67,.86,.51,.3,.96,.46,.57,.34,.05,.15,.71,.31,.77,.03,.6,.2,.94,.72,.45,.82,.17,.31,.8,.2,.05,.69,.84,.76,.01,1,.09,.84,.44,.62,.11,.22,.5,.81,.05,.29,.45,.77,.68,.09,.91,.2,.28,0,.89,.18,.69,.32,.51,.44,.03,.35,.25,.67,.03,.84,.2,.56,.46,.89,.23,.69,.78,.95,.37,.09,.55,.87,.44,.73,.95,.52,.82,.23,.73,.91,.44,.04,.55,.46,.73,.41,.03,.31,.14,.78,.36,.97,.56,.8,.11,.99,.52,.27,.91,.64,.95,.49,.19,.66,.03,.55,.85,.13,.62,.8,.41,.29,.75,.39,.13,.99,.45,.05,.27,.47,.12,.41,.63,.29,.15,.84,.54,.32,.74,.22,.13,.64,.85,.08,.16,.75,.51,.47,.64,.95,.58,.14,.91,.51,.39,.13,.25,.97,.69,.01,.56,.87,.28,.93,.38,.62,.44,.67,.57,.7,.01,.8,.98,.6,.89,.73,.16,.71,.12,.59,.36,.54,.15,.57,.67,.45,.25,.95,.83,.11,.22,.84,.09,.77,.92,.16,.41,.96,.35,.25,.75,.65,0,.44,.53,.06,.28,.83,.99,.23,0,.59,.24,.05,.63,.28,.55,.36,.16,.83,.72,.31,.08,.66,.81,.53,.22,.9,.62,.28,.05,.45,.64,.22,.71,.07,.35,.45,.31,.1,.77,.6,.95,.24,.73,.49,.99,.22,.1,.55,.91,.63,.24,.74,.41,.79,.16,.81,.33,.22,.04,.81,.67,.48,.04,.8,.44,.99,.41,.78,.25,.6,.94,.28,.82,.91,.2,.11,.44,.73,.34,.79,.06,.85,.63,.51,.42,.9,.73,.44,.64,.05,.49,.24,.9,.2,.33,.93,.15,.48,.34,.19,0,.45,.34,.97,.84,.21,.95,.26,.41,.82,.98,.72,.54,.34,.62,.39,.57,.93,.69,.53,.44,.8,.64,.53,.71,.11,.94,.37,.58,.87,.2,.73,.47,.42,.67,.34,.49,.91,.38,.72,.13,.89,.77,.08,.96,.64,.19,1,.85,.47,.25,.96,.71,.47,.12,.76,.16,.91,.3,.51,.85,.8,.15,.75,.55,.89,.36,.46,.07,.89,.43,.04,.36,.87,.48,.85,.17,.02,.52,.31,.09,.87,.64,.97,.58,.71,.91,.51,.1,.9,.59,.27,.16,.62,.57,.01,.49,.38,.73,.42,0,.6,.38,.86,.28,.64,.24,1,.56,.3,.76,.18,.1,.35,.23,.14,.98,.31,.8,.72,.15,.84,.53,.25,.4,.73,.85,.55,.67,.91,.25,.55,.51,.03,.69,.88,.75,.03,.34,.09,.16,.78,.05,.75,.88,.28,.2,.37,.13,.3,.22,.04,.87,.44,.54,.15,.25,1,.32,.64,.93,.25,.13,.64,.8,.16,.55,.97,.41,.48,.24,.61,.4,.27,.53,.12,.36,.16,.6,.36,.05,.4,.58,.82,.37,.69,.95,0,.56,.39,.66,.23,0,.81,.18,.69,.32,.8,.28,.67,.62,.26,.73,.58,.27,.67,.83,.94,.55,.2,.36,.5,.08,.84,.42,.35,.2,.74,.38,.93,.71,.08,.3,.97,.83,.19,.88,.15,.67,.24,.8,.07,.51,.84,.02,.18,.69,.45,.04,.91,.58,.8,.47,.71,.6,.08,.56,.41,.04,.36,.77,.09,.9,.58,.05,.31,.39,.09,.75,.63,.31,.82,.45,.12,.61,.51,.22,.63,.93,.51,.2,.47,.32,.06,.66,.59,.97,.9,.69,.58,.16,.31,.82,.06,.76,.41,.1,.82,.02,.58,.89,.05,.28,.84,.08,.3,.77,.02,.67,.33,.81,.02,.67,.75,.57,.91,.8,.09,.85,.67,.99,.25,.51,.13,.45,.25,.12,.88,.46,.95,.6,.28,.98,.49,.16,.57,.18,.95,.81,.16,.04,.98,.44,.35,.77,.04,.61,.7,.29,.01,.67,.16,.27,.99,.63,.47,0,.2,.83,.47,.88,.13,.66,.54,.08,.98,.5,.32,.56,.97,.69,.4,.61,.48,.94,.37,.83,.6,.29,.94,.03,.87,.37,.16,.91,.65,.49,.97,.45,.64,.67,.22,.13,1,.84,.49,.16,.94,.07,.42,.19,.28,.94,.36,.89,.46,.83,.29,.7,.91,.14,.42,.8,.73,.07,.47,.75,.38,.97,.63,.69,.91,.47,.69,.56,.14,.47,.76,.52,.97,.44,.75,.5,.64,.19,.84,.99,.13,.5,.91,.86,.32,.05,.23,.42,.52,.3,.17,.33,.04,.89,.61,.73,.34,.93,.75,.15,.31,.7,.41,.07,.64,.84,.75,.41,.08,.48,.32,.39,.7,.11,.87,.14,.47,.27,.95,.77,.47,.93,.62,.53,.77,.12,.31,.96,.67,.49,.38,.73,.24,.4,.33,.6,.78,.39,.85,.15,.44,.2,.11,.89,.78,.09,.24,.73,.14,.45,.67,.22,.53,.83,.27,.75,.3,.2,.85,0,.28,.83,.37,.52,.78,.71,.6,.22,.37,.89,.66,.78,.57,.03,.68,.74,.17,.38,.03,.59,.81,.63,.98,.52,.22,.35,.27,.12,.85,.01,.25,.35,.19,.6,.3,.92,.8,.35,.3,.17,.36,.7,.23,.1,.88,.38,.55,.28,.72,.57,.17,.38,.47,.98,.72,.63,.89,.75,.55,.93,.64,.08,.78,.82,.19,.62,.53,.37,.05,.84,.49,.94,.23,.35,.01,.99,.53,.66,.76,.95,.57,.23,.64,.31,.89,.4,.12,.86,.16,.41,.31,.81,.03,.86,.56,.81,.25,.11,.58,.19,.8,.93,.05,.84,.25,.11,.73,.02,.67,.93,.36,.55,.31,.66,.2,.51,.41,.86,.06,.33,.63,.42,.01,.98,.59,.1,.7,.57,.18,.44,.92,.64,.27,.42,.04,.81,.54,.71,.25,.99,.49,.82,.11,.25,.55,.66,.95,.12,.24,.38,.03,.28,.88,.57,.92,.42,.53,.59,.77,.44,.12,.88,.02,.24,.7,.09,.86,.67,.03,.93,.58,.33,.95,.6,.06,.44,.9,.08,.24,.63,.14,.79,.28,.16,.02,.39,.12,.8,.44,.36,.28,.49,.42,.02,.24,.91,.66,.13,.59,.2,.73,.47,.6,.3,.21,.89,.26,.07,.48,.79,.01,.95,.52,.66,.07,.55,.73,.89,.07,.2,.49,.38,.61,.17,.4,.78,.97,.01,.62,.48,.69,.22,.47,.97,.59,.52,.8,.26,.72,.05,.42,.89,.8,.03,1,.76,.17,.93,.78,.09,.69,.45,.89,.39,.82,.34,.98,.75,.1,.04,.34,.17,.9,.32,.11,.49,.05,.15,.33,.38,.61,.97,.07,.85,.34,.44,.77,.54,.73,.17,.69,.8,.05,.65,.19,.93,.09,.83,.51,.97,.36,.53,.43,.62,.97,.51,.81,.16,.45,.03,.75,.27,.16,.8,.35,.67,.77,.85,.53,.11,.56,.36,.96,.6,.24,.48,.69,.23,.91,.12,1,.69,.8,.55,.44,.98,.31,.8,.08,.89,.69,.84,.39,.12,.62,.18,.88,.31,.7,.56,.2,.78,.35,.62,.24,.58,.97,.65,.7,.95,.04,.49,.91,.33,.68,.47,.29,.38,.95,.16,.67,.37,.29,.19,.89,.49,.61,.16,.95,.56,.48,.27,.62,.34,.56,.48,.28,.92,.55,.15,.77,.05,.63,.24,.12,.49,.59,.84,.97,.53,.75,.64,.97,.44,.86,.62,.91,.22,.79,.44,.31,.72,.52,.19,.93,.09,.88,.49,.41,.11,.98,.31,.72,.28,.41,.58,.3,.74,.66,.15,.84,.05,.2,.41,.27,.62,.87,.82,.53,.67,.47,.86,.58,.04,.42,.94,.33,.69,.88,.45,.83,.67,.05,.86,.98,.01,.66,.57,.3,.85,.05,.22,.27,.71,.03,.37,.53,.27,.16,.03,.57,.69,.82,.42,.53,.99,.36,.09,.83,.28,.98,.02,.46,.15,.33,.43,.18,.28,.75,.24,.82,.08,.22,.89,.85,.13,.76,.58,.07,.89,.77,.07,.42,.04,.83,.22,.7,.34,.13,.9,.7,.06,.25,.74,.11,.83,.35,.25,.52,.43,.94,.53,.86,.72,.31,.2,.7,.56,.36,.27,.2,.58,.36,.74,.1,.5,.69,.16,.93,.04,.78,.6,.28,.65,.34,.96,.23,.62,.36,.47,.88,.06,.72,.95,.21,.04,.79,.27,.91,.59,.33,.77,.1,.69,.31,.21,.36,.12,.95,.31,.2,1,.28,.48,.03,.24,.76,.07,.19,.34,.76,.15,.33,.55,.39,.76,.16,.48,.37,.94,.51,.84,.62,.92,.67,.42,.94,.79,.45,.97,.36,.03,.75,.13,.24,.46,.73,.14,.4,.85,.69,.5,.83,.76,.09,.89,.45,.68,.56,.4,.64,.52,.05,.23,.53,.34,.81,.44,.24,.67,.56,.98,.37,.52,.78,.02,.4,.21,.81,.45,.87,.59,.4,.2,.66,1,.08,.29,.2,.67,.01,.39,.27,.79,.45,.09,0,.78,.94,.07,.8,.28,.66,.02,.88,.39,.58,.23,.42,.91,.13,.38,.82,.03,.56,.77,.16,.82,.54,.16,.61,.33,.12,.63,.44,.37,.48,.73,0,.91,.56,1,.44,.07,.92,.63,0,.77,.52,.12,.8,.18,.59,.4,.99,.29,.56,.52,.94,.42,.62,.84,.08,.95,.25,.6,.74,.65,.11,.16,.45,.21,.06,.76,.32,.49,.18,.07,.66,.27,.61,.86,.66,.91,.48,.61,.89,.19,.75,.29,.04,.91,.54,.6,.34,.01,.99,.14,.31,.72,.81,.41,.99,.62,.05,.49,.96,.73,.33,.13,.67,.27,.88,.59,.94,.65,.16,.37,.99,.05,.81,.53,0,.73,.6,.85,.8,.36,.47,.09,.94,.64,.13,.91,.84,.47,.67,.53,.22,.42,.96,.55,.34,.76,.12,.48,.69,.04,.75,.53,.47,.2,.71,.9,.26,0,.67,.85,.42,.91,.78,.55,.87,.19,.11,.97,.66,.37,.48,.16,.65,.8,.56,.27,.72,.4,.61,.47,.71,.92,.67,.83,.15,.64,.92,.05,.47,.12,.28,.73,.2,.51,.82,.42,0,.32,.77,.56,.29,.8,.98,.59,.11,.63,.27,.87,.54,.92,.19,.42,.02,.8,.18,.07,.53,.32,.13,.99,.63,.38,.24,.15,.84,.77,.18,.85,.49,.93,.59,.16,.69,.27,.84,.12,.59,.18,.89,.45,.83,.19,.44,.11,.75,.5,.56,.09,.31,.65,.25,.92,.44,.35,.7,.13,.55,.97,.76,.59,.86,.55,.36,.25,.62,.17,.32,.11,.61,.85,.13,.45,.23,.64,.84,.99,.34,.86,.29,.98,.78,.09,.63,.31,.5,1,.38,.22,.08,.49,.26,.02,.99,.71,.59,.31,.22,.13,.84,.24,.04,.35,.84,.44,.17,.89,.05,.86,.38,.25,.07,.53,.45,.36,.25,.7,.8,.66,.91,.5,.36,.06,.69,.89,.2,.82,1,.39,.7,.09,.36,.19,.91,.72,.37,.78,.16,.47,.81,.34,.56,.29,.95,.37,.8,.67,.44,.58,.2,.49,.71,.96,.29,.49,.71,.44,.25,.11,.34,.01,.46,.91,.22,.37,.55,.28,.01,.79,.59,.05,.98,.36,.29,.23,.85,.78,.71,.47,.11,.76,.87,.22,.96,.39,.28,.09,.23,.17,.31,.05,.46,1,.69,.39,.88,.77,.98,.36,.05,.73,.94,.06,.18,.44,.57,.1,.17,.59,.25,.35,.94,.42,.08,.59,.74,.33,.95,.61,.81,.41,.33,.08,.52,.79,.45,.91,.72,.58,.95,.75,.49,.17,.99,.33,.23,.65,.15,.55,.31,.84,0,.76,.87,.17,.38,.22,0,.87,.99,.63,.3,.11,.54,.5,.05,.24,.86,.52,.64,.47,.4,0,1,.61,.33,.69,.08,.98,.52,.12,.71,.43,.25,.92,.02,.86,.35,.78,.05,.65,.41,.1,.63,.05,.77,.65,.96,.4,.81,.66,.09,.78,.71,.86,.42,.35,.22,.72,.52,.86,.71,.04,.97,.4,.19,.95,.15,.37,.57,.06,.79,.46,.65,.72,.51,.93,.69,.82,.74,.07,.57,.28,.03,.43,.72,.56,.3,.81,.52,.4,.7,.28,.81,.66,.42,.91,.67,.12,.82,.55,.87,.18,.45,.77,.09,.69,.16,.77,.65,.24,.92,.39,.64,.08,.51,.32,.41,.23,.09,.7,.58,.8,.49,.1,.79,.96,.72,.2,.95,.53,.09,.61,.98,.52,.33,.54,.15,.78,.39,.94,.73,.17,.66,.6,.12,.92,.77,.27,.83,.57,.11,.23,.43,.03,.87,.25,.75,.63,.84,.08,.61,.76,.15,.53,.94,.27,.08,.91,.53,.22,.94,.36,.9,.5,.21,.56,.16,.56,.34,.97,.49,.1,.62,.67,.93,.49,.14,.62,.2,.58,.12,.34,.63,.55,.84,.68,.3,.51,.2,.91,.02,.89,.38,.45,.13,.27,.41,.18,.79,.94,.52,.11,.25,.19,.66,.89,.14,.59,.88,.02,.49,.21,.78,.51,0,.47,.75,.21,.03,.7,.84,.27,.54,.38,.22,.91,.56,.84,.02,.73,.18,.28,.83,.02,.92,.64,.88,.29,.04,.44,.75,.93,.45,.39,.61,.11,.67,.42,.28,.47,.82,.06,.75,.69,.43,.23,.04,.58,.33,.45,.96,.32,.41,.22,.05,.32,.16,.91,.49,.81,.95,.65,.55,.38,.21,.47,.17,1,.31,.49,.22,.69,.42,.69,.56,.84,.34,.73,.82,.56,.13,.3,.84,.73,.89,.29,.44,.03,.24,.92,.21,.84,.06,.28,.38,.81,.42,.94,.48,.82,.27,.01,.44,.23,.94,.05,.56,.33,.62,.3,.05,.8,.98,.61,.51,.86,.14,.36,.62,.81,.94,.48,.08,.4,.22,.31,.95,.73,.35,.99,.06,.3,.87,.62,.37,.27,.92,.36,.12,.64,.02,.88,.47,.29,.13,.44,.36,.88,.49,.99,.6,.7,.12,.47,.8,.36,.95,.65,.28,.19,.02,.27,.86,.49,.27,.77,.92,.15,.63,.43,.29,.12,.84,.94,.48,.8,.86,.06,.77,.37,.58,.8,.98,.62,.75,.68,.27,.18,.35,.73,.14,.9,.8,.01,.35,.56,.89,.36,.08,.84,.3,.12,.21,.44,.16,0,.29,.47,.17,.71,.04,.27,.06,.94,.62,.83,.69,.53,.36,.15,.56,.77,.97,0,.25,.75,.09,.67,.76,.89,.09,.72,.59,.83,.69,.23,.84,.16,.72,.56,.33,0,.25,.91,.67,.47,.22,.74,.38,.59,.96,.7,.77,.55,.11,.62,.14,.82,.58,.27,.72,.15,.98,.58,.67,.52,.43,.99,.57,.76,.95,.03,.61,.78,.18,.58,.09,.23,.42,.36,.2,.55,.25,.6,.18,.13,.55,.84,.63,.7,.06,.18,.84,.35,.04,.7,.2,.88,.97,.36,.62,.08,.64,.19,.27,.1,.63,.89,.01,.71,.53,.47,.04,.4,.58,.78,.51,.08,.26,.68,.49,.6,.83,.7,.11,.67,.57,.97,.64,.76,.48,1,.6,.76,.66,.88,.99,.61,.4,.47,.69,.51,.17,.13,.32,.58,.78,1,.45,.33,.59,.88,.52,.31,1,.37,.14,.59,.96,.42,.32,.12,.99,.42,.54,.95,.49,.18,.83,.64,.73,.37,.09,.84,.03,.3,.16,.84,.34,.01,.84,.17,.44,.29,.54,.39,.66,.89,.43,.11,.83,.06,.78,.2,.88,.3,.15,.41,.33,.73,.51,.97,.67,.31,.92,.65,.75,.84,.98,.74,0,.9,.49,.77,.36,.89,.4,.52,.96,.75,.42,.58,1,.5,.33,.01,.67,.18,.53,.33,.7,.39,.55,.93,.22,.51,.15,.28,.35,.23,.89,.13,.96,0,.88,.44,.99,.33,.09,.95,.28,.21,.45,.78,.16,.33,0,.91,.36,.82,.08,.4,.53,.09,.35,.53,.78,.93,.34,.84,.76,.43,.87,.08,.27,.02,.66,.22,.69,.1,.16,.64,.55,.22,.47,.31,.51,.18,.78,.46,.09,.8,.03,.67,.26,.4,.88,.12,.45,.28,.58,.97,.48,.79,.65,.11,.5,.27,.47,.94,.67,.86,.94,.19,.06,.8,.2,.53,.33,.47,.41,.09,.71,.81,.23,.71,.1,.83,.25,.14,.37,.81,.03,.51,.11,.33,.06,.42,.82,.31,.69,1,.08,.25,.12,.81,.33,.09,.65,.24,.09,.75,.86,.58,.47,.78,.27,.89,.06,1,.47,.79,.68,.42,.86,.95,.06,.83,.77,.55,.31,.23,.67,.63,.8,.2,.73,.41,.65,.04,.98,.84,.27,.47,.53,.09,.24,.69,.31,.94,.2,.24,.85,.03,.16,.22,.1,.38,.01,.66,.95,.48,.73,.88,.4,.12,.89,.45,.8,.4,.85,.03,.89,.8,.66,.01,.88,.25,.58,.18,.36,.75,.91,.08,.52,.76,.97,.18,.75,.24,.42,.55,1,.22,.77,.63,.38,.05,.58,.23,.02,.75,.48,.35,.59,.93,.74,.24,.96,.62,.02,.52,.46,.88,.22,.56,.42,.05,.86,.58,.45,.18,.88,.27,.63,.58,.41,.09,.21,.44,.58,.73,.47,.2,.92,.56,.37,.91,.46,.17,.26,.38,.95,.09,.83,.42,.74,.15,.6,.31,.04,.33,.73,.56,.46,.66,.18,.44,.73,.48,.16,.38,.51,.03,.59,.13,.88,.52,.35,.14,.62,.95,.8,.73,.44,.57,.15,.76,.59,.73,.44,.78,.89,.66,.6,1,.27,.55,.22,.36,.16,.53,.63,.84,.35,.28,.95,.05,.7,.61,.13,.7,.25,.95,.55,.69,.92,.49,.86,.14,.31,.58,.22,.33,.04,.55,.68,.12,.88,.06,.35,.45,.93,.83,.15,.7,.32,.77,.42,.69,.98,.12,.86,0,.66,.16,.82,.44,.33,.93,.58,.05,.99,.64,.75,.93,.26,.71,.34,1,.69,.51,.92,.7,.16,.95,.64,.81,.02,.86,.68,.59,.28,.02,.84,.69,.31,.82,.63,.06,.69,.16,.56,.63,.36,.22,.87,.09,.97,.18,.62,.11,.32,1,.02,.64,.94,.84,.11,.91,.22,.84,.93,.45,.73,.31,.58,.71,.05,.38,.29,.19,.97,.87,0,.46,.93,.11,.39,.57,.28,.49,.73,.45,.8,.06,.72,.84,.78,.31,.92,.05,.57,.73,.53,.24,.33,.98,.49,.41,.34,.06,.44,.31,.71,.07,.64,.44,.81,.7,.95,.65,.42,.91,.81,.33,.62,.16,.72,.59,.28,.09,.51,.97,.88,.12,.53,.28,.61,.25,.4,.52,.3,.58,.89,.22,.76,.18,.38,.7,.29,.36,.47,.18,.55,.11,.22,.8,.39,.14,.05,.24,.86,.53,.33,.51,.27,.37,.11,.98,.4,.75,.14,.49,.02,.92,.54,.73,.31,.96,.45,.02,.84,.49,.67,.44,.53,.84,.89,.25,.52,.8,.39,.25,.06,.77,.29,.67,.61,.42,.34,.25,.8,.07,.18,.91,.49,.87,.67,.12,.62,.33,.52,.81,.32,.66,.19,.96,.06,.35,.08,.2,.9,.64,.48,.13,.05,.44,.22,.5,.18,.65,.13,.45,.78,.16,.25,.76,.92,.63,.84,.15,.38,.22,.98,.27,.53,.01,.16,.79,.62,.27,.06,.41,.53,.94,.26,.03,.87,.42,.24,.6,.35,.21,.83,.56,.04,.78,.7,.97,.07,.37,.11,.53,.65,.08,.85,.5,.12,.8,.01,.87,.41,.75,.63,.01,.56,.77,.36,.45,.8,.04,.69,.14,.95,.44,.83,.16,.53,.67,.24,.99,.61,.41,.23,.12,.38,.78,.21,.3,.92,.11,.8,.27,.72,.37,.45,.04,.73,.87,.16,.6,.51,.34,.56,.02,.76,.12,.69,0,.63,1,.42,.77,.24,.56,.02,.46,.84,.27,.69,.07,.23,.84,.48,.76,.68,.85,.94,.53,.16,.31,.38,.98,.6,.67,.76,.96,.08,.88,.38,.95,.67,.56,.87,.06,.2,.52,.11,.77,.47,.55,.69,.09,.91,.39,.48,.24,.13,.45,.91,.19,.84,.75,.48,.78,.55,.66,.75,.02,.44,.65,.96,.16,.91,.34,.45,.19,.84,.7,.78,.41,.28,.93,.42,.74,.24,.91,.6,.68,.31,.84,.95,.48,.29,.86,.94,.61,.29,.41,.72,.87,.2,.58,.77,.3,.05,.88,.44,.35,.19,.77,.96,.49,.91,.62,.53,.7,.38,.58,.31,.95,.06,.16,.65,.93,.21,.42,.67,.95,.21,.89,.46,.97,.27,.49,.95,.88,.17,.51,.36,.84,.16,.31,.7,.96,.2,.75,.42,.15,.98,.55,.01,.31,.22,.42,.6,.25,.76,.44,.89,.23,.55,.16,.33,.85,.28,.71,.59,.03,.3,.09,.63,.34,.58,.7,.23,.96,0,.33,.82,.18,.74,.31,.87,.98,.56,.77,.7,.58,.06,.3,.12,.98,.19,.13,.95,.31,.8,.09,.49,.39,.76,.08,.55,.28,.62,.46,1,.13,.84,.57,.03,.64,.34,.52,.09,.22,.46,.16,.07,.24,.66,.18,.12,.7,.21,.99,.07,.34,.62,.04,.73,.38,.94,.62,.81,.09,.69,.07,.66,.27,0,.83,.09,.99,.66,.05,.19,.75,.61,.5,.78,.31,.56,.08,.48,.33,.82,.12,.71,.16,.86,.2,.36,.55,.45,.28,.69,.09,.61,.94,.78,.37,.53,.05,.9,.57,.71,.36,.88,.63,.09,.48,.82,.02,.72,.67,.11,.74,.84,.4,0,.62,.47,.36,.2,.82,.49,.92,.41,.82,1,.45,.31,.88,.66,.14,.94,.45,.58,.64,.07,.69,.37,.02,.33,.96,.43,.67,.56,.35,.4,.84,.5,.56,.71,.9,.26,.67,.23,.64,.82,.93,.04,.23,.34,.07,.49,.31,.96,.17,.83,.39,.73,.99,.8,.36,.55,.92,.73,.44,.53,.02,.85,.56,.47,.79,.26,.97,.49,.22,.12,.57,.28,.38,.87,.53,.84,.44,.57,.35,.24,.14,.77,.47,.91,.41,.25,1,.35,.13,.73,.96,.61,0,.73,.24,.59,.42,.62,.75,.08,.82,.1,.74,.96,.01,.5,.42,.17,.09,.3,.63,.45,.81,.28,.11,.44,.77,1,.71,.36,.18,.96,.49,.03,.29,.93,.52,.7,.89,.13,.54,.99,.76,.13,.69,.25,.17,0,.77,.09,.59,.55,.42,.71,.24,.05,.93,.19,.44,.82,.14,.51,.23,.82,.16,.91,.61,.04,.7,.24,.05,.17,.34,.55,.03,.98,.5,.13,.39,.71,.57,.91,.64,.75,.21,.7,.11,.45,.92,.26,.04,.51,.63,.87,.02,.33,.8,.93,.39,.31,.65,.15,.43,.87,.11,.67,.35,.85,.72,.01,.95,.45,.31,.13,.19,.75,.68,.86,.44,.26,.58,.86,.09,.55,.83,.02,.88,.53,.38,.16,.9,.53,.37,.95,.09,.3,.55,.67,.33,.23,.86,.4,.62,.25,.85,.58,.66,.98,.86,.12,.19,.66,.94,.2,.53,.16,.06,.58,.87,.33,.54,.86,.36,.17,.11,.45,.23,.79,.07,.42,.27,.48,.36,.88,.55,.66,.4,.22,.84,.18,.29,.87,.5,.33,.78,.51,.27,.95,.62,.88,.09,.4,.77,.27,.47,.8,.91,.32,.64,.98,.41,.84,.78,.42,.31,.88,.1,.77,.43,.18,.85,.55,.39,.88,.78,.56,.15,.64,.3,.75,.18,.69,.42,.21,.6,.15,.74,.25,.89,.05,.71,.3,.56,.92,.44,.78,.2,.5,.69,.22,.64,1,.38,.93,.05,.53,.95,.35,.02,.69,.33,.15,.67,.45,.27,.81,.23,.84,.31,.66,.05,.83,.49,.89,.01,.44,1,.6,.48,.14,.91,.32,.74,.03,.45,.24,.72,.35,.41,.51,.04,.74,.33,.84,.27,.75,.44,.24,.16,.61,.76,.64,.99,.75,.31,.94,.65,.85,.05,.64,.96,.07,.32,.57,.92,.49,.92,.7,.05,.99,.11,.6,.88,.04,.72,.11,.47,.75,.64,.53,0,.71,.22,.08,.53,.43,.76,.5,.13,.61,.06,.18,.58,.67,.25,.53,.3,.81,.02,.11,.43,.29,.04,.34,.85,.6,.44,.91,.12,.27,.5,.99,.06,.69,.45,.52,.94,.61,.79,.39,.19,.01,.61,.07,.39,.96,.16,.76,.04,.6,.78,.28,.49,.11,.64,.21,.8,.5,.96,.39,.77,.62,.08,.42,.68,.11,.49,.42,.78,.19,.71,.23,.93,.8,.18,.7,.05,.55,.77,.2,.95,.36,.82,.49,.02,.94,.57,.88,.84,.59,.41,.93,.5,.63,.02,.8,.89,.39,.47,.28,.55,.03,.6,.38,.16,.54,.31,.72,.19,.79,.84,.27,.75,.06,.34,.81,.56,.37,.75,.19,.45,.39,.85,.59,.22,.36,.27,.94,.34,.97,.59,.86,.17,.97,.03,.22,.88,.29,.7,.95,.82,.34,.92,.06,.97,.49,.34,.93,.77,.64,.96,.51,.21,.82,.02,.99,.35,.56,.88,.76,.36,.27,.87,0,.35,.12,.22,.67,1,.81,.26,.65,.89,.29,.53,.36,.86,.45,.08,.22,.67,.83,.4,.73,.91,.23,.12,.58,.89,.2,1,.55,.76,.94,.59,.15,1,.63,.35,.57,.13,.28,.41,.87,.24,.35,.69,.07,.5,.11,.89,.6,.21,.7,.08,.3,.15,.26,.04,.67,.13,.39,.98,.7,.09,.67,.05,.89,.15,.84,.48,.71,.12,.77,.95,.57,.03,.44,.58,.12,.17,.43,.63,.11,.22,.66,.31,.94,.69,.24,.33,.95,.05,.78,.13,.85,.18,.49,.42,.3,.66,.37,.59,.78,.68,.36,.52,.24,.03,.45,.15,.59,.65,.21,.7,.59,.15,.23,.67,.08,.36,.7,.23,.47,.63,.73,.04,.17,.53,.64,.8,.19,.44,.83,.57,.46,.32,.5,.75,.11,.47,.8,.03,.7,.25,.91,.51,.73,.97,.33,.05,.56,.08,.42,.78,.27,.02,.49,.3,.14,.33,.03,.88,.25,.32,0,.45,.75,.64,.51,.09,.64,.96,.45,.84,.6,.42,.66,.16,.28,.78,.43,.84,.64,.47,.73,.96,.22,.83,.29,.17,.52,.34,.22,.96,.31,.78,.36,.22,.96,.28,.44,.22,.67,.4,.98,.48,.67,.86,.97,.51,.86,.95,.45,.55,.08,.79,.15,.55,.67,.5,.91,.59,.45,.66,.09,.81,.73,.13,.84,.27,.08,.46,.91,.12,.64,.55,.75,.83,.4,.87,.27,.08,.96,.33,.83,.43,.91,.78,.14,.52,.84,.09,.22,.43,.84,.97,.09,.31,.73,.99,.66,.03,.87,.08,.16,.95,.35,.22,.58,.78,.42,.19,.65,.33,.16,.42,.58,.18,.95,.35,.66,.62,.85,.36,.75,.92,.84,.64,.47,.38,.74,.55,.89,.81,.16,.98,.38,.78,.57,.11,.31,.19,.87,.25,.98,.73,.39,.55,.11,.99,.18,.38,.89,.53,.45,.76,.58,.87,.46,.78,.58,.73,.5,.42,.67,.08,.63,.87,.5,.09,.91,.14,.29,.21,.36,.77,.24,.3,.74,.15,.03,.83,.27,.63,.99,0,.41,.26,.73,.04,.25,.56,.9,0,.22,.55,.48,.94,.64,.33,.17,.83,.4,.99,.21,.33,.11,.73,.53,.43,.78,.48,.09,.55,.31,.59,.95,.31,.75,.4,.92,.67,.33,.24,.43,.61,.53,.15,.41,.28,.94,.71,.61,.38,.83,.7,.09,.98,.51,.11,.94,.8,.03,.87,.27,.75,.86,.48,.15,.99,.07,.44,.68,.11,.56,.22,.86,.18,.64,.8,.08,.39,.27,.05,.84,.23,.91,.73,.5,.01,.76,.33,.09,.46,.02,.91,.27,.49,.73,.01,.56,.09,.31,.7,.02,.24,.1,.93,.39,.01,.62,.11,.89,.55,.73,.02,.81,.35,.77,.62,.83,.73,.01,.55,.06,.38,.48,.67,.35,.89,.42,.49,.33,.77,.88,.18,.46,.98,.38,.76,.29,.63,1,.4,.76,.2,.01,.98,.58,.77,.05,.3,.68,.5,0,.94,.19,.65,.05,.88,.37,.73,0,.18,.47,.07,.65,.27,.86,.13,.51,.71,.87,.03,.92,.24,.77,.49,.34,.2,.78,.02,.49,.91,.16,.32,.75,.59,.28,.39,.55,.95,.65,.46,0,.7,.31,.23,.8,.2,.53,.25,.39,0,.51,.95,.11,.22,.5,.94,.62,.69,.47,.33,.16,.41,.96,.64,.54,.91,.59,.8,.69,.87,.62,.31,.67,.8,.28,.85,.15,.48,1,.6,.66,.29,.15,.86,.2,.99,.27,.33,.16,.4,.66,.19,.58,.07,.54,.94,.45,.63,.81,.59,.04,.25,.57,.76,.08,.18,.59,.8,.09,.29,.64,.81,.15,.53,.86,.45,.32,.05,.89,.66,.42,.72,.24,.48,.35,.88,.61,.81,.45,.58,.84,.36,.25,.63,.22,.99,.66,.84,.36,.91,.56,.15,.45,.59,.02,.79,.2,.47,.37,.82,.59,.06,.86,.44,.56,.31,.53,.25,.62,.44,.01,.82,.2,.69,.48,.09,.37,.21,.82,.42,.9,.58,.45,.93,.64,.87,.98,.75,.7,.29,.44,.58,.31,.72,.18,.55,.88,0,.61,.27,.82,.19,.38,.13,.27,.45,.19,.34,.15,.08,.4,.96,.23,.64,.91,.41,.2,.81,.42,.92,.75,.49,.35,.75,.52,.45,.89,.96,.29,.45,.94,.24,.33,.13,.27,.99,.19,.9,.79,.96,.22,.71,.86,.94,.24,.45,.69,.91,.58,.33,.07,.69,.18,.12,.71,.59,.14,.52,.3,.83,.15,.86,.62,.09,.16,.97,.23,.29,.91,.12,.78,.94,.44,.15,.53,.8,.24,.72,.05,.96,.81,.29,.37,1,.64,.27,.07,.69,.15,.97,.64,.11,.8,.98,.07,.88,.73,.37,.89,.55,1,.06,.77,.15,.88,.55,.07,.63,.11,.34,.75,.05,.33,.12,.46,.36,.05,.62,.82,.97,.03,.87,.11,.28,.42,.78,.93,.7,.06,.45,.67,.9,.63,.07,.97,.53,.77,.92,.48,.12,.36,.53,.8,.04,.7,.34,.06,.53,.23,.66,.59,.08,.82,.69,.05,.55,.09,.86,.69,.43,.78,.86,.7,.38,.14,.33,.63,.52,.4,.13,.31,.67,.04,.39,.52,.21,.02,.75,.92,.61,.42,.95,.8,.25,.86,.34,.94,.05,.45,.69,.22,.75,.44,.38,.71,.05,.66,.46,.53,.7,.03,.57,.29,.11,.61,.42,.52,.19,.69,.92,.07,.55,.85,.41,.95,.79,.45,.3,.4,.24,.69,.15,.42,.79,.2,.11,.67,.14,.28,.42,.61,.31,.69,.98,.3,.76,.94,.52,.85,.09,.59,.7,.19,.57,.91,.23,.15,.75,.37,.47,.79,.99,.62,.09,.5,.36,.56,.86,.01,.25,.75,.39,.81,.65,.22,.58,.87,.72,.02,.62,.44,.28,.92,.5,.12,.85,.33,.04,.94,.4,.14,.23,.6,.8,.24,.73,.02,.16,.6,.5,.04,.55,.72,.44,.07,.86,0,.6,.47,.54,.84,.95,.14,.86,.41,.48,.24,.29,.54,.01,.65,.48,.09,.74,.2,.61,.37,1,.31,.91,.55,.06,.86,.58,.4,.21,.09,.31,.82,.4,.87,.49,.93,.76,.33,.11,.44,.64,.22,.14,.73,.32,.12,.58,.5,.01,.86,.93,.51,.36,.6,.3,.56,.95,.34,.48,.85,.73,.92,.24,.81,.41,.57,.15,.22,.68,.27,.41,.78,.95,.29,.84,.68,.49,.41,.09,.65,.58,.24,.05,.38,.84,.23,.13,.97,.3,.77,.51,.96,.31,.1,.46,.03,.39,.29,.18,.82,.97,.3,.17,.67,.76,.6,.99,.44,.8,.26,.89,.31,.73,.38,.92,.34,.52,.39,.99,.3,.91,.23,.67,.94,.28,.17,.73,.36,1,.77,.27,.07,.75,.28,.61,.99,.8,.11,.84,.91,.36,.22,.98,.38,.68,.56,.78,.11,.53,0,.66,.25,.76,.17,.49,.99,.81,.89,.6,.25,.95,.75,.05,.17,.27,.84,.56,.88,.35,.84,.45,.52,.62,.2,.86,.27,.73,.59,.17,.75,.05,.92,.71,.09,.51,.75,.63,.09,.36,.02,.5,.13,.04,.49,.87,.38,.02,.99,.54,.23,.5,.39,.02,.13,.8,.27,.9,.51,.19,.85,.69,.54,.17,.76,.64,.43,.6,.18,.45,.13,.58,.91,.27,.8,.99,.67,.51,.72,.08,.88,.56,.08,.39,.28,.2,.7,.09,.56,.64,.51,1,.08,.48,.13,.63,.87,.54,.09,.8,.35,.1,.58,.81,.48,.92,.57,.22,.15,.9,.42,.48,.68,.09,.36,.17,.64,.58,.73,.16,.78,.55,.29,.03,.93,.27,.85,.72,.17,.81,.45,.92,.31,.64,0,.28,.72,.16,.53,.08,.36,.69,.59,1,.01,.49,.16,.76,.06,.27,.95,.02,.99,.68,.36,.11,.67,.08,.47,.81,.26,.44,.86,.02,.25,.91,.19,.56,.84,.65,.95,.73,.31,.8,.62,.45,.72,.16,.87,.09,.76,.61,.99,.34,.71,.95,.03,.73,.3,.42,.94,.58,.88,.33,.09,.94,.85,.34,.66,.87,.18,.72,.62,.16,.08,.42,.24,.34,.47,.69,.85,.96,.02,.5,.89,.36,.17,.75,.01,.82,.2,.67,.96,.04,.75,.27,.15,.63,.47,.89,.39,.23,.65,.35,.83,.04,.66,.79,.32,.18,.55,.77,.25,.53,.39,.05,.33,.45,.09,.62,.89,.48,.14,.44,.33,.95,.41,.6,.35,.11,.7,.22,.84,.38,.47,.44,.66,.82,.22,.45,.54,.38,.86,.69,.28,.95,.55,.68,.81,.39,.16,.77,.42,.91,.84,.42,.32,.64,.13,.19,.98,.61,.39,.8,.69,.3,.46,.26,.37,.6,.22,.95,.05,.31,.89,.59,.36,.66,.88,.43,.22,.56,.45,.17,.61,.34,.91,.12,.07,.24,.47,.8,.56,.05,.69,.23,.06,.53,.4,.48,.36,.84,.56,.91,.64,.97,.13,.2,.43,.24,.79,.62,.72,.4,.97,.47,.24,.58,.42,.3,.81,.22,.45,.69,.36,.84,.71,.15,1,.02,.52,.11,.29,.43,.49,.11,.61,.95,.86,.01,.92,.71,.88,.97,.27,.69,.93,.84,.17,.35,.78,.65,.05,.51,.14,.88,.04,.73,.96,.43,.58,.13,.96,.04,.86,.31,.94,.14,.77,.23,.09,.64,.2,.47,.37,.12,.6,.31,.49,.09,.56,.3,.22,.52,.97,.87,.56,.74,.38,.28,.12,.53,.98,.14,.75,.09,.87,.17,.55,.69,.12,.52,.8,.19,.05,.29,.51,.15,.73,.03,.86,.38,.11,.8,.47,.66,.77,.41,.01,.71,.18,.27,.49,.79,1,.75,.25,0,.95,.2,.76,.33,.03,.8,.59,.75,.55,.34,.89,.15,.55,.22,.07,.78,.33,.94,.72,.59,.35,.55,.85,.03,.98,.5,.05,.31,.6,.76,.18,.69,.88,.75,.97,.24,.71,.37,.14,.43,.32,.6,.12,.22,.75,.5,.02,.24,.44,.7,.56,.89,.21,.69,.76,.28,.62,.22,.53,.07,.82,.67,.25,.75,.59,.4,.49,.91,.72,.32,.42,.94,.8,.02,.91,.71,.2,.84,.91,.63,.03,1,.8,.06,.16,.72,.01,.48,.78,.66,.89,.43,.03,.36,.93,.67,.81,.01,.44,.92,.24,.65,.4,.47,.74,.96,.23,.8,.92,.32,.65,.25,.58,.97,.19,.28,.61,.86,.99,.36,.61,.94,.41,.58,.31,.15,.95,.68,.44,.09,.48,.72,.16,.4,.29,.91,.03,.67,.47,.07,.3,.91,.68,.6,.85,.12,.05,.77,.08,.93,.29,.13,.57,.2,.75,.26,.44,.85,.95,.41,.63,.15,.55,.84,.04,.46,.75,.53,.83,.05,.47,.56,.82,.36,.59,.75,.13,.95,.08,.28,.85,.55,.08,.99,.48,.88,.37,.75,.3,.91,.2,.36,.07,.64,.17,.01,.62,.85,.55,.15,.58,.34,.85,.44,.07,.55,.26,.73,.38,.6,.45,.67,.37,.27,.43,.1,.94,.19,.07,.73,.63,.21,.53,.58,.3,.48,.77,.37,.84,.15,.96,.08,.89,.69,.37,.57,.07,.48,.78,.88,.7,.43,.05,.94,.55,.14,.22,.5,.76,.11,.88,.04,.46,.64,.53,.82,.29,.61,.91,.24,.84,.52,.65,.11,.95,.19,.56,.99,.83,.42,.02,.52,.19,.39,.51,.84,.15,.47,.62,.8,.42,.89,.65,.95,.37,.08,.22,.48,.01,.27,.36,.19,.64,.28,1,.18,.24,.67,.96,.36,.06,.16,.97,.31,.52,.78,.38,.48,.16,.4,.83,.36,.19,.65,.12,.18,.45,.61,.5,.95,.82,.23,.78,.45,.27,.05,.96,.39,.69,.23,.53,.17,.77,.98,.36,.14,.84,.2,.12,.73,.58,.99,.81,.62,.32,.24,.56,.81,.27,.87,.41,.05,.92,.25,.62,.08,.76,.56,.33,.62,.42,0,.16,.63,.39,.97,.19,.16,.03,.53,.33,.74,.39,.69,.09,.84,.44,.17,.67,.73,.2,.36,.09,.89,.16,.69,.37,.06,.58,.97,.24,.36,.8,.4,.26,.77,.36,.16,.75,.31,.98,.65,.27,.97,.41,.68,.25,.73,.32,.12,.51,.02,.72,.58,.88,.82,.67,.93,.42,.91,.8,.11,.58,.89,.38,.76,.31,.71,.92,.64,.44,.84,.2,.62,.02,.99,.72,.64,.45,.03,.71,.8,.6,1,.02,.72,.09,.42,.71,.32,.98,.88,.37,.73,.18,.51,.77,.03,1,.62,.41,0,.67,.47,.94,.52,.32,.89,.48,.23,.14,.89,.52,.78,.39,1,.49,.12,.77,.18,.68,.13,1,.2,.52,.05,.27,.78,.22,.54,.82,.92,.11,.27,.53,.37,.77,.89,.24,.85,.03,.47,.31,.96,.57,.25,.34,.97,.85,.27,.76,.59,.03,.5,.99,.74,.44,0,.73,.47,.6,.71,.01,.49,.66,.59,.25,.88,.45,.1,.71,.21,.55,0,.9,.09,1,.48,.18,.82,.63,.29,.34,.11,.53,.75,.05,.7,.49,.33,.69,0,.84,.44,.09,.19,.5,.27,.04,.69,.15,.5,.66,.33,.24,.12,.91,.56,.26,.42,.91,.51,.3,.38,.89,.16,.54,.02,.41,.58,.66,.11,.81,.28,.88,.13,.66,.82,.29,.87,.57,.09,.77,.26,.03,.93,.09,.41,.66,.02,.47,.67,.05,.16,.31,.72,.96,.61,.36,.84,.55,.42,.67,.93,.89,.7,.13,1,.35,.47,.68,.75,.6,.94,.45,.63,.16,.58,.78,.9,.63,.73,.03,.81,.53,.59,.03,.49,.98,.41,.23,.8,.34,.16,.82,.2,.93,.3,.14,.86,.95,.21,.11,.94,.78,.06,.55,.81,.36,.9,.74,.37,.83,.28,.59,.69,.25,.92,.4,.17,.65,1,.18,.59,.29,.14,.58,.97,.27,.51,.15,.58,.95,.63,.41,.88,.77,.34,.92,.42,.81,.88,.59,.79,.31,.96,.15,.06,.35,.23,.86,.67,.78,.25,.63,.84,.11,.21,.51,.97,.59,.44,.2,.38,.48,.34,.13,.52,.2,.89,.39,.63,.7,.55,.18,.73,.86,.3,.96,.21,.89,.44,.64,.55,.02,.47,.25,.73,.05,.8,.35,.18,.47,.38,.51,.74,.27,.07,.86,.31,.02,.83,.09,.28,.98,.11,.41,.19,.26,.13,.39,.89,.22,.42,.12,.67,.32,.72,.11,.91,.64,.27,.38,.66,.51,.8,.05,.34,.45,.55,.85,.33,.4,.17,.7,.59,.13,.09,.63,.16,.51,.42,.03,.76,.39,.52,.05,.78,.45,.23,.39,.85,.47,.22,.87,.09,.36,.77,.71,.33,.01,.8,.55,.11,.58,1,.05,.27,.19,.09,.52,.05,.69,.47,.82,.71,.63,.75,.56,.04,.21,.99,.47,.31,.75,.8,.27,.33,0,.72,.91,.56,.93,.05,.74,.96,.3,.72,.07,.36,.97,.42,.8,.35,.59,.51,.13,.35,.6,.81,.08,.25,.83,.33,.9,.51,.29,.1,.88,.59,.03,.84,.07,.62,.42,.78,.15,.53,.24,.39,.67,.48,.71,.36,.67,.53,.87,.5,.67,.09,.62,.93,.8,.87,.2,.62,.47,.84,.53,.07,.59,.88,.12,.27,.58,.93,.67,.27,.03,.7,.48,.91,.28,.96,.42,.49,.31,.97,.78,.64,.22,.85,.12,.97,.71,.53,.87,.73,.04,.92,.67,.78,.42,.63,.2,.91,.44,1,.22,.76,.34,.25,.16,.45,.63,.55,.75,.36,.95,.42,.22,.36,.89,.52,.07,.95,.13,.47,.36,.58,.07,.9,.68,.05,.91,.42,.15,.64,.08,.78,.19,.69,.6,.4,.8,.53,.17,.83,.22,.05,.64,.27,.98,.07,.73,.78,.52,.93,.31,.75,.96,.17,.11,.64,.97,.4,.71,.25,.66,.31,.95,.22,.92,.55,.64,.98,.77,.9,.17,.03,.83,.24,.94,.02,.79,.34,1,.77,.29,.07,.36,.55,.09,.9,.36,0,.21,.79,.44,.94,.36,.72,.64,.41,.15,.78,.89,.57,.12,.63,.02,.23,.77,.88,.7,.25,.1,.94,.34,.56,.65,.31,.22,.08,.32,.63,.13,.55,.28,0,.95,.73,.51,.05,.27,.66,.47,.09,.94,.65,.73,.83,.31,.92,.69,.12,.84,.63,.73,.09,.25,.39,.2,.44,.3,.91,.82,.75,.16,.45,.37,.61,.53,.75,.87,.5,.33,.28,.42,.84,.23,.12,.03,.45,.93,.59,.5,.88,.11,.55,.16,.83,.41,.25,.16,.02,.38,.59,.49,.68,.42,.8,.56,.19,.77,.97,.53,.16,.77,.48,.02,.31,.38,.12,.44,.59,.34,.96,.58,.47,.74,.11,.6,.22,.45,.16,.58,.71,.25,.45,.77,.28,.56,.74,1,.69,.33,.03,.17,.47,.99,.2,.09,.51,.36,.22,.76,.86,.51,.37,.66,.2,.03,.45,.37,.68,.06,.89,.46,.4,.8,.93,.49,.69,.19,.8,.36,.49,.16,.34,.82,.61,.12,.86,.56,.38,.9,.49,.03,.38,.09,.2,.57,.47,.27,.15,.92,.57,1,.76,.6,.84,.7,.64,.08,.32,.55,.97,.22,.14,.28,1,.2,.67,.83,.98,0,.55,.48,.88,.64,.27,.76,.13,.32,.4,.71,.89,.47,.68,.57,.97,.66,.84,.71,.12,.22,.86,.01,.28,.33,.14,.49,.08,.44,.87,.36,.59,.82,.71,.95,.05,.25,.62,.12,.78,.22,.13,.42,.31,.71,.86,.04,.39,.9,.48,.97,.64,.05,.95,.18,.42,.28,.14,.86,.63,.76,.84,.01,.87,.76,.65,.97,.05,.44,.31,1,.1,.83,.56,.91,.59,.84,.55,.27,.16,.75,0,.58,.15,.37,.91,.42,.98,.65,.87,.58,.1,.42,.98,.35,.76,.18,.69,.14,.31,.6,.95,.78,.42,0,.99,.81,.3,.49,.04,.45,.15,.3,.02,.49,.23,.4,.69,.85,0,.67,.83,.48,.08,.39,.11,.45,.58,.15,.79,.34,.71,1,.38,.2,.67,.96,.78,.27,.2,.37,0,.29,.09,.34,.55,.45,1,.36,.6,.76,.92,.69,.88,.64,.37,.81,.21,.69,.11,.4,.18,.5,.67,.86,.74,.5,.36,.69,.87,.65,.98,.18,.52,.95,.66,.8,.2,.11,.83,.33,.69,.5,.86,.65,.55,.39,.23,.5,.27,.39,.55,.33,.25,.47,.82,.2,.61,.71,.16,.3,.73,.34,.14,.2,.76,.99,.62,.25,.95,.67,.27,.05,.78,.09,.3,.05,.24,.7,.92,.22,.69,.49,.03,.31,.8,.44,.85,.2,.71,.51,.87,.34,.67,.07,.4,.87,.71,.82,.67,.95,.55,.78,.12,1,.19,.49,.78,.28,.94,.73,.56,.8,.25,.36,.73,.66,.91,.29,.17,.04,.81,.58,.08,.46,.03,.55,.87,.75,.95,.8,.5,.86,.2,.04,.78,.31,.08,.51,.18,.44,.84,.03,.27,.67,.05,1,.26,.9,.86,.34,.22,.97,.42,.06,.92,.27,.02,.77,.49,.26,.57,.1,.3,0,.59,.27,.41,.54,.21,.82,.11,.02,.48,.78,.92,.07,.61,.7,.11,.92,.59,.15,.72,.9,.05,.58,.48,.42,.06,.97,.64,.44,.02,.37,.51,.83,.13,.54,.83,.22,.56,.63,.75,.46,.81,.55,.4,.13,.85,.25,.92,.62,.95,.08,.56,.36,.12,.25,.59,.17,.75,.53,.61,.12,.37,.29,.22,.07,.88,.35,.58,.89,.03,.56,.38,.11,.45,.33,.03,.64,.95,.84,.03,.21,.42,.06,.61,.52,.43,.87,.33,.89,.64,.14,.42,.09,.6,.2,.4,.74,.92,.28,.64,.83,.91,.39,.13,.59,.25,.53,.93,.79,.57,.45,.51,.65,.08,.61,.57,.16,.29,.82,.16,.55,.61,.35,.06,.84,.42,.69,.34,.76,.52,.85,.91,.02,.75,.38,.6,.31,.95,.11,.67,.35,.97,.45,.19,.85,.03,.38,.55,.28,.35,.94,.75,.89,.25,.49,.8,.31,.91,.71,.06,.42,.35,.74,.45,.86,.97,.52,.19,.14,.98,.31,.05,.77,.47,.57,.06,.41,.51,.25,.91,.64,.8,.08,.45,.94,.84,.24,.93,.2,.96,.52,.59,.41,.18,.46,.27,.75,.65,.31,.95,.62,.18,.75,.89,.48,.15,.53,.31,.95,.56,.76,.94,.7,.13,.23,.73,.53,.25,.97,.69,.31,.51,.65,.16,.05,.59,.53,.13,.22,.67,.56,.79,.99,.09,.75,.17,.39,.12,.33,.77,.03,.73,.4,.8,.01,.72,.47,.67,1,.45,.89,.16,.76,.92,.2,.82,.95,.45,.09,.67,.47,.97,.25,.89,.73,.19,.43,.74,.17,.86,.24,.73,.49,.77,1,.65,.08,.79,.23,.14,.62,0,.59,.73,.09,.23,.55,.87,.18,.59,.93,.13,.4,.33,.28,.69,.41,.84,.63,.25,.95,.67,.35,.75,.2,.67,.76,0,.48,.99,.73,.3,.14,.37,.05,.47,.78,.65,0,.76,.95,.72,.84,.09,.51,.43,.14,.87,.52,.81,.22,.31,.11,.42,.76,.63,.09,.49,.24,.35,.78,.29,.94,.04,.8,.38,.19,.75,.88,.11,.98,.78,.38,.69,.97,.43,.47,.03,.34,.27,.66,.44,.32,.48,.7,.89,.2,.96,.44,.23,.92,.44,.88,.64,.35,.24,.12,.7,.21,.53,.38,.03,.64,.47,.16,.25,.71,.31,.18,.59,.14,.45,.53,.84,.29,.57,.01,.52,.64,.09,.37,.28,.21,.88,.44,.51,.69,.38,.84,.95,.34,.16,.85,.64,.47,.76,.96,.3,.64,.02,.77,.07,.82,.95,.01,.57,.18,.73,.43,.09,.16,.99,.84,.12,.37,.32,.18,.41,.87,.52,.7,.64,.56,.27,.41,.1,.33,.85,.48,.04,.63,.2,.97,.8,.25,.7,.01,.47,.99,.68,.58,.89,.24,.39,.78,.87,.13,.4,0,.55,.64,.45,.11,.6,.48,.03,.54,.34,.44,.27,.87,.31,0,.82,.75,.94,.88,.2,.78,.02,.92,.85,.08,.59,.82,.1,.67,.29,.11,.51,.19,.09,.95,.78,.4,.07,.81,.95,.68,.31,.55,.07,.88,.37,.55,.09,.78,.85,.41,.07,.69,.05,1,.39,.79,.31,.81,.92,.69,.58,.12,.63,.16,.95,.05,.29,.47,.18,.53,.42,.98,.37,.13,.32,.07,.22,.49,.71,.17,.56,.65,.46,.35,.89,.08,.51,.87,.81,.54,.29,.47,.92,.59,.87,.67,.56,.04,.22,.94,.09,.82,.98,.72,.89,.58,.15,.26,.31,.55,.89,.35,.04,.59,.93,.38,.09,.56,.36,.02,.72,.96,.05,.69,.19,.98,.58,.82,.89,.2,.73,.31,.92,.85,.28,.95,.22,.81,.64,.09,.55,.18,.36,.26,.6,.13,.72,.47,.55,.63,.22,.28,.52,.35,.72,.53,.88,.59,.98,.69,.29,.55,.89,.52,.31,.61,.46,.25,.12,1,.75,.27,.67,.89,.99,.52,.3,.64,.93,.32,.2,.61,.89,.47,.23,.13,.42,.05,.86,.75,.41,.32,.72,.91,.59,.75,.11,.69,.78,.27,.02,.51,.73,.8,.57,.92,.45,.28,1,.11,.22,.78,.28,.67,.39,.24,0,.36,.65,.09,.53,.04,.8,.27,.17,.62,.34,.77,.42,.31,.15,.66,.2,.45,.98,.7,.39,.77,.13,.67,.47,.16,.33,.67,.28,.76,.84,.2,.48,.14,.56,.35,.51,.67,.29,.47,.09,.38,1,.56,.05,.64,.42,.7,.58,.05,.71,.5,.93,.77,.64,.11,.53,.4,.05,.95,.36,.14,.69,.99,.41,0,.47,.17,.79,.02,.35,.75,.44,.14,.02,.73,.2,.85,.09,.76,.91,.4,.49,.79,.02,.45,.34,.19,0,.72,.88,.48,.77,.26,.08,.71,.59,.99,.55,.27,.49,.94,0,.81,.27,.56,.16,.81,.24,.91,.08,.62,.84,.93,.68,.43,.06,.37,.84,.23,.87,.44,.73,.53,.16,1,.76,.6,.95,.71,.83,.24,.73,.33,.45,.92,.71,.82,.48,.1,.92,.55,0,.5,.34,.06,.78,.53,.03,.95,.43,.28,.95,.55,.78,.89,.61,.17,.43,.94,.33,.81,.22,.45,.91,.09,.74,.16,.69,.26,.83,.51,.15,.23,.78,.14,.36,.89,.16,.41,.22,.88,.44,1,.84,.67,.25,.85,.29,.79,.44,.16,.77,.86,.96,.27,.39,.83,.05,.25,.84,.5,.63,.98,.36,.64,.42,.58,.19,.68,.34,.22,.62,.16,.76,.68,.42,.25,.56,.13,.37,.53,.92,.05,.36,.84,.72,.17,.35,.56,.2,.64,.49,.08,.35,.99,.41,.47,.31,.67,.21,.33,.15,.27,.98,.12,.64,.03,.58,.37,.05,.91,.64,.44,.11,.33,.18,.48,.42,.15,.99,.17,.51,.09,.39,1,.27,.2,.73,.61,.27,.95,.84,.64,.28,.9,.66,.15,.84,.6,.73,.04,.22,.13,.5,.97,.08,.52,.67,.61,.86,.73,.03,.4,.84,.94,.63,.42,.05,.76,.3,.87,.53,.02,.47,.99,.3,.69,.03,.57,.29,.07,.33,.16,.5,.73,.07,.58,.89,.09,.64,.3,.58,.15,.67,.45,.56,.64,.94,.31,.7,.25,.13,.93,0,.29,.84,.04,.94,.11,.86,.56,.95,.09,.89,.8,.04,.97,.67,.82,.3,.42,.65,.23,.02,.8,.91,.7,.12,.76,.87,.42,.71,.64,.03,.57,.87,.44,.11,.56,.48,.85,.63,.75,.51,.8,.93,.7,.31,.83,.25,.06,.8,.55,.84,.04,.91,.56,.77,.67,.86,.22,.02,.56,.67,.06,.39,.84,.69,.12,.77,.41,.09,.21,.35,.49,.24,.09,.4,.86,.47,.33,.81,.6,.25,.79,.04,.37,.09,.98,.3,.57,.23,.33,.54,.14,.92,.63,.38,.96,.6,.74,.82,.25,.55,.8,.73,.13,.48,.69,.78,.91,.63,.44,.2,.93,.35,.7,.23,.52,.07,.75,.91,.33,.97,.09,.16,.78,.09,.4,.55,.8,.51,.73,.39,.62,.53,.79,.27,.38,.3,.61,.51,.35,.28,.58,.21,.07,.73,.19,.87,.5,.41,.63,.3,.45,1,.38,.05,.95,.2,.28,.84,.75,.15,1,.69,.78,.89,.04,.31,.38,.16,.29,.45,.13,.19,.48,.57,.39,.94,.65,.23,.69,.34,.27,.05,.45,.61,.31,.73,.89,.49,.79,.97,.45,.33,.2,.58,.47,.71,.82,.58,.98,.72,.34,.64,.96,.55,.7,.02,.39,.72,.2,.89,.29,.48,.17,.67,.79,.51,.01,.89,.8,.19,.69,.47,.09,.33,.22,.42,.64,.09,.34,.96,.38,.86,.22,.56,.01,.36,.83,.65,.03,.48,.37,.81,1,.41,.84,.2,.6,.27,.71,.38,.58,.84,.45,.89,.22,.33,.96,.1,.23,.45,.99,.7,.49,.06,.8,.16,.45,.72,.91,.4,.49,.96,.56,.11,.68,.94,.11,.58,.06,.23,.54,.3,.8,.45,.53,.1,.23,.36,.3,.01,.39,.22,.72,.47,.93,.7,.05,.55,.91,.66,.77,.85,.17,.31,.45,.75,.09,.6,.92,.4,.15,.95,.83,.44,.13,.35,.16,.22,.03,.53,.92,.04,.96,.31,.14,.41,0,.8,.46,.2,.11,.27,.92,.16,.32,.99,.45,.57,.72,.8,.6,.39,.11,.96,.64,.36,.3,.59,.25,.02,.85,.15,.69,.94,.04,.86,.19,.5,.66,.27,.97,.41,.11,.29,1,.15,.28,.56,.85,.19,.03,.58,.37,.11,.53,0,.87,.48,.23,1,.04,.71,.62,.13,.67,.91,.58,.31,.16,.01,.64,.91,.24,1,.2,.85,.11,.32,.78,.62,.28,.89,.33,.2,.48,.71,.88,.82,.67,.61,.14,.9,.68,.96,.72,.51,.81,.92,.64,.33,.07,.56,.2,.83,.63,.41,.24,.98,.1,.34,.71,.04,1,.36,.88,.44,.82,.69,.2,.55,.05,.67,.29,.65,.87,.58,.68,.85,.37,.65,.23,.87,.62,.69,.93,.14,.58,.89,.67,.42,.78,.61,.86,.65,.12,.34,.94,0,.22,.91,.47,.2,.08,.75,.43,.95,.53,.77,.9,.56,.49,.28,.77,.59,.43,.91,.1,.05,.62,.74,.88,.6,.51,.77,.69,.96,.11,.61,.73,.28,.69,.96,.79,.42,.81,.67,.12,.31,.53,.11,.26,.84,.47,.03,.79,.71,.88,.38,.2,.75,.42,.58,.68,.01,.56,.83,.14,.03,.37,.71,.06,.78,.98,.25,.36,.17,.41,.74,.02,.25,.34,.4,.63,.07,.6,.11,.53,.86,.78,.99,.14,.35,.75,.83,.33,.03,.52,.43,.89,.59,.08,.53,.26,.17,.02,.49,.91,.33,.18,.93,.46,.95,.07,.42,.76,.15,.27,.81,.44,.18,.53,.23,.37,.28,.52,.82,.04,.25,.52,.09,.47,.04,.24,.78,.42,.09,.88,.31,.71,.83,.62,.85,.16,.07,.35,.63,.42,.25,.97,.36,.67,.12,.23,.7,.33,.81,.53,.33,.2,.25,.05,.89,.41,.22,.46,.33,.92,.49,.23,.16,.63,.07,.34,.95,.59,.76,.36,.94,.78,.41,.55,.2,.28,.51,.11,.6,.83,.53,.07,.31,.77,.39,.65,.51,.25,1,.47,.82,.53,.41,.12,.54,.63,.05,.95,.49,.87,.56,.08,.87,.18,.31,.85,.47,.25,.17,.66,.44,.53,.88,.05,.15,.48,.68,.79,.27,.65,.22,.84,.77,.63,.97,.31,.58,.75,.41,.8,.56,.22,.75,.52,.3,.97,.1,.49,.73,.59,.03,.76,.95,.09,.67,.75,.4,.33,1,.73,.35,.79,.94,.55,.67,.17,.51,.63,.56,.06,.36,.28,.48,.69,.99,.83,.12,.19,.71,0,.1,.84,.54,1,.39,.76,.16,.47,.94,.67,.78,.48,.31,.07,.64,.77,.15,.87,.06,.76,.39,.92,.55,.24,.18,.04,.67,.5,.23,.7,.01,.34,.95,.81,.41,.93,.47,.27,.88,.14,.49,.96,.27,.2,.92,.75,.66,.11,.22,.58,.3,.87,.75,.45,.82,.28,.2,.36,.8,.64,.47,.77,.94,.2,.73,.97,.38,.01,.31,.22,.66,.27,.97,.6,.86,.18,.97,.11,.5,.33,.4,.13,.47,.67,.84,.09,.27,.66,.11,.38,0,.82,.2,.56,.4,.89,.05,.98,.32,.39,.82,.44,.2,.92,.09,.16,.58,.89,.2,.26,.4,.86,.32,.98,.83,.38,.78,.17,.99,.53,0,.24,.57,.31,.47,.88,.6,.8,.47,.2,.31,.8,.01,.58,.93,.29,.06,.11,.64,.39,.85,.58,.95,.35,.56,.66,.4,.58,.83,.3,.47,.75,.84,.42,.91,.83,.17,.57,.88,.64,.07,.72,.15,.65,.05,.34,.62,.73,.9,.09,.82,.45,.05,.58,.36,.87,.92,.67,.01,.67,.22,.09,.92,.58,.7,.11,.99,.16,.27,0,.66,.4,.05,.67,.56,.82,.75,.93,.5,.38,.77,.11,.28,.55,.37,.77,.67,.93,.03,.73,.9,.21,.38,.04,.98,.48,.86,.69,.91,.34,.65,.88,.6,.25,.69,.2,.55,.89,.62,0,.56,.85,.63,.49,.69,0,.56,.12,.71,.49,.08,.22,.72,.27,.12,.89,.43,.75,.91,.38,.79,.08,.67,.93,.33,.38,.95,.74,.61,.08,.49,.2,.65,.84,.42,.55,.99,.13,.72,.2,.01,.83,.24,.09,.99,.19,.03,.69,.09,.88,.58,.28,.07,.31,.45,1,.08,.5,.25,.56,.86,.23,.75,.99,.19,.41,.24,.67,.6,.13,.86,.41,.28,.06,.43,.17,.97,.37,.89,.33,.51,.01,.42,.76,.31,.5,.92,.55,.84,.35,.49,.11,.9,.47,.15,.09,.57,.2,.91,.42,.72,.05,.45,.06,.28,.85,.56,.35,.05,.55,.93,.44,.58,.16,.29,.53,.14,.23,.45,.05,.15,.35,.84,.47,.11,.28,.16,.73,.33,.41,.24,.8,.37,.97,.44,.63,.76,.05,.35,.59,.45,.03,.49,.67,.31,.11,.62,.16,.73,.52,.22,.06,.53,.16,.23,.67,.44,.95,.87,.37,.14,.72,.31,.78,.24,.88,.51,.28,.67,.46,.77,.31,.7,.5,.59,.95,.15,.36,.71,.48,.81,.13,.73,.2,.38,.78,.92,.43,.32,.51,.07,.8,.56,.01,.53,.36,.31,.97,.77,.19,.64,.8,.52,.73,.27,.47,.62,.8,.25,.67,.88,.19,.61,.73,.39,.24,.11,.61,.86,.2,.31,.25,.61,.82,.72,.01,.51,.25,.64,.85,.92,.62,.53,.15,.22,.67,.8,.28,.76,.7,.24,.77,.93,.44,.63,1,.78,.71,.95,.45,.77,.66,.95,.78,.69,.51,.99,.13,.91,.28,.07,.8,.33,.92,.18,.97,.81,.66,.94,.84,.58,.94,.2,.8,.47,.9,.34,.97,.84,.3,.69,.56,.86,.04,.36,.16,.26,.56,.98,.52,.19,.59,0,.34,.45,.95,.12,.57,.91,.16,.87,.35,.27,.78,.44,.22,0,.97,.6,.68,.53,.85,.29,.66,.12,.18,.97,.6,.48,.38,.29,.85,.95,.76,.47,.05,.68,.49,.93,.13,.57,.34,.84,.08,.55,.14,.41,.96,.34,.54,.1,.91,.03,.67,.95,.29,.79,.66,1,.54,.4,.95,.31,.66,.81,.98,.35,.08,.22,.79,.41,1,.44,.91,.49,.17,.11,.52,.87,.02,.37,.73,.06,.2,.51,.3,.11,.55,.02,.28,.4,.06,.34,.24,.82,.04,.58,.71,.53,.2,.11,.68,.38,.25,.53,.14,.31,.08,.4,.73,.06,.53,.27,.03,.4,.11,.61,.45,.99,.76,.11,.48,.83,.77,.69,.07,.8,.05,.94,.47,.81,.7,.09,.63,.85,.37,.05,.62,.41,.8,.05,.91,.52,.63,.83,.17,.34,.25,.95,.04,.59,.81,.47,.01,.67,.83,.14,.92,.72,.63,.1,.16,.83,.2,.55,.36,.02,.87,.23,.97,.03,.69,.92,.73,.06,.82,.14,.27,.83,.44,.32,.8,.16,.48,.41,.02,.8,.07,.73,.13,.44,.61,.09,.16,.7,.5,.31,.66,.02,.76,.29,.09,.62,.95,.41,.31,.64,.09,.48,.28,.84,.6,.38,.88,.63,.23,.97,.59,.18,.87,.56,.43,.62,.78,.47,.15,.88,.43,.84,.57,.49,.08,.88,.42,.76,.28,.17,.65,.37,1,.84,.69,.56,.77,.17,.36,0,.25,.41,.92,.55,.31,.47,.61,.38,.35,.64,.27,.89,.55,.22,.78,.34,.49,.73,.22,.47,.12,.57,.65,.32,.75,.93,.41,.06,.87,.41,.15,.34,.9,.53,.35,.75,.28,.2,.44,.07,.26,.42,.58,.91,.65,.29,.83,.3,.7,.42,.64,.2,.38,.31,.22,.51,.63,.7,.59,.97,.19,.63,.51,.91,.08,.56,.23,.35,.62,.18,.29,.9,.36,.49,.27,.78,.42,.96,.55,.15,.87,.69,.36,0,.85,.67,.25,.99,.58,.84,.68,.17,.91,.09,.8,.35,.73,.13,.85,.53,.71,.98,.09,.19,.37,.97,.31,.61,.75,0,.28,.95,.73,.59,.2,.52,.81,.95,.78,.42,.13,.6,.09,.22,.95,.51,.69,.89,.8,.16,.66,.22,.01,.91,.16,.85,.22,.74,.1,.16,.39,.95,.02,.27,.18,1,.85,.69,.97,.18,.4,.04,.13,.25,.53,.73,.66,.78,.48,.2,.71,.26,.99,.1,.58,.89,.66,.97,.51,.78,.34,.03,.43,.11,.96,.61,.17,.47,.81,.51,.89,.66,.44,1,.19,.3,.38,.47,.06,.78,.25,.38,.75,.64,.95,.88,.49,.85,.56,.78,.02,.86,.94,.57,.12,.85,.2,.47,.28,.58,.78,.2,.47,.58,.13,.75,.18,.39,.96,.34,.5,.44,.04,.53,.9,.47,.38,.24,0,.77,.29,.85,.67,.03,.25,.12,.97,.45,.69,.16,.35,.04,.99,.7,.1,.56,0,.25,.51,.76,.33,.88,.64,.28,.08,.6,.47,.33,.64,.99,.38,.69,.25,.94,.45,.58,.85,.49,.66,.6,.75,.89,.55,.64,.03,.31,.33,.88,.71,.49,.96,.61,.45,.08,.31,.58,.1,.91,.62,.05,.84,.42,.52,.34,.02,.73,.16,.88,.29,.99,.75,.51,.77,.39,.06,.91,.1,.59,.05,.77,.11,.56,.87,.01,.92,.75,.14,.87,.56,.01,.84,.31,.16,.42,.69,.05,.96,.24,.67,.41,.18,.64,.05,.73,.34,.64,.93,.09,.51,.98,.29,.8,.06,.89,.45,.01,.55,.12,.75,.7,.27,.18,.69,.05,.62,.81,.34,.47,.16,.5,.93,.55,.8,.65,.36,.51,.24,.79,.84,.65,.46,.25,.35,.46,.89,.71,.92,.2,.45,.39,.04,.82,.91,.22,.53,.85,.07,.73,.09,.58,.51,.73,.02,.37,.99,.3,.06,.35,.45,.14,.43,.36,.1,.53,.62,.78,.23,.85,.16,.69,.89,.21,1,.83,.38,.75,.45,.31,.18,.64,.8,.16,.54,.39,.6,.09,.49,.64,.14,.2,.86,.55,.25,.76,.28,.36,.16,.91,.26,.35,.78,.69,.23,.6,.32,.66,.42,1,.22,.47,.78,.1,.25,.33,.42,.16,.75,.53,.33,.99,.25,.39,.91,.01,.8,.41,.19,.88,.33,.71,.41,.54,.27,.73,.64,.25,.94,.62,.84,.99,.4,.29,.12,.96,.64,.92,.59,.73,.09,.42,.2,.91,.06,.86,.11,.4,.53,.32,.12,.91,.72,.62,.13,.33,.65,.03,.97,.72,.53,.16,.35,.72,.12,.95,.29,.48,.88,.81,.19,.32,.63,.07,.69,.2,.81,.87,.23,.72,.8,.91,.76,.45,.16,.06,.43,.58,.3,.38,.79,.02,.34,.69,.23,0,.96,.56,.73,.87,.09,.95,.3,.85,.94,.24,.7,.83,.35,.59,.08,.32,.69,.98,.66,.83,.45,.69,.6,.42,.51,.07,.47,.54,.95,.08,.28,.7,.08,.58,.54,.95,.71,.81,.62,.89,.28,.8,.01,.45,.83,.52,.6,.7,.31,.45,.75,.64,.03,.13,.61,.92,.34,.87,.8,.08,.41,.15,.35,.55,.78,.89,.73,.53,.21,.09,.37,.25,.31,.84,.48,.71,.29,.56,.96,.62,.03,.93,.78,.37,.06,.86,.21,.42,.84,.57,.27,.12,.9,.62,.44,.78,.02,.4,.59,.23,.43,.34,.09,.95,.81,.53,.91,.42,.61,.52,.95,.08,.31,.58,.2,.92,.85,.64,1,0,.75,.11,.51,.63,.48,.16,.9,.52,.13,.37,.25,.47,.23,.63,.7,.45,.11,.56,.39,.01,.25,.95,.42,.9,.49,.01,.4,.22,.54,.95,.02,.21,.97,.14,.82,.36,.18,.83,.49,.91,.75,.34,.87,.19,.01,.59,.49,.1,.96,.62,.12,.7,.77,.1,.2,.14,.99,.08,.23,.56,.48,.95,.22,.65,.09,.18,.49,.29,.89,.53,.01,.22,.09,.49,.17,.27,.42,.88,.8,.66,.98,.02,.6,.14,.43,.75,.2,.27,.49,.71,.2,.52,.27,.8,.55,.97,.08,.38,.78,.69,.47,.25,.99,.31,.67,.9,.78,.16,.94,.64,.77,.26,.45,.11,.25,.77,0,.16,.38,.64,.02,.5,.24,.68,.27,.35,.5,.22,.86,.93,.25,.74,.96,.31,.6,.78,.64,.84,.93,.04,.41,.76,.08,.26,.78,.17,.93,.88,.5,.73,.79,.18,.64,.14,.56,.89,.11,.31,.73,.86,.64,.28,.9,.76,0,.62,.37,.16,.25,.44,.65,.41,.28,.94,.2,.38,.47,.24,.91,.42,.27,.95,.37,.48,.57,.83,.91,.37,.8,.42,.84,.31,.55,1,.67,.44,.59,.96,.72,.63,.34,.94,.67,.56,.75,.01,.49,.14,.45,.77,.27,.95,.05,.82,.67,.36,.84,.09,.59,.98,.65,.44,.16,.7,.49,.62,.16,.33,.02,.84,.09,.55,.19,.51,.06,.69,.53,.01,.4,.58,.69,.85,.33,.48,.98,.29,.72,.83,.34,.96,.73,.4,.09,.55,.84,.67,.45,.58,.4,.19,.05,.86,.42,.21,.08,.31,.7,.58,.99,.53,.87,.36,.49,.73,.33,.64,.12,.22,.04,.38,.28,.85,.76,.45,.25,.67,.17,.47,.35,.71,.59,.44,.25,.72,.97,.58,.02,.81,.13,.91,.73,.42,.84,.05,.71,.86,.2,.55,.06,.62,.87,.78,.67,.32,.02,.7,.27,.16,.05,.75,.4,.07,.82,.2,.1,.28,.78,.44,.89,.05,.38,.1,.97,.34,.62,.92,.18,.36,.88,.66,.39,.49,.12,.91,.42,.78,.25,.31,.02,.9,.09,.28,.78,.24,.97,.87,.52,.39,.66,.79,.45,.95,.31,.24,.61,.84,.09,.89,.17,.37,.74,.09,.67,.44,.85,.55,.48,.14,.8,.62,.04,.94,.18,.29,.08,.15,.66,.83,.53,.12,.69,.45,.9,.15,.5,.12,.33,.19,.67,.01,.97,.63,.08,.44,.55,.84,.67,.99,.53,.71,.33,.04,.99,.8,.4,.54,.04,.23,.09,.94,.12,.33,.45,.86,.69,.53,.33,.04,.61,.15,.53,.78,.02,.38,.64,1,.35,.71,.05,.26,.11,.42,.19,.64,.98,.55,.69,.9,.51,.25,.63,.75,.91,.36,.16,.85,.26,.6,.8,.45,.86,.22,.71,.3,.56,.73,.13,.53,.2,.33,1,.03,.62,.16,.89,.47,.76,.62,.35,.93,.45,.04,.59,.44,.74,.18,.92,.27,.13,.85,.37,.75,.97,.3,.21,.52,1,.05,.59,.91,.54,.12,.27,.2,.08,.89,.31,.44,.91,.77,.38,.72,.89,.97,.33,.77,.36,.27,.78,.98,.56,.37,.75,.81,.24,.84,.44,.56,.2,.83,.25,.39,.95,.31,.6,.42,.07,.94,.2,.65,.49,.61,.12,.86,.75,.98,.46,.66,.53,.81,.22,.09,.28,.95,.77,.56,.99,.26,.65,.33,.57,.29,.12,.79,.51,.16,.45,.89,.95,.58,.5,.88,.11,.33,.45,.21,.95,.13,.34,.55,.01,.49,.66,.08,.53,.2,.72,.31,.16,.54,.08,.82,.05,.47,.94,.25,.69,.8,.58,.24,.71,.37,.55,.12,.82,.22,.56,.84,.67,.15,.89,.29,.07,.71,.35,.01,.71,.58,.05,.48,.12,.43,.71,.35,.78,.45,.28,.18,.83,.34,.95,.78,.58,.67,.17,.52,.25,.13,.58,.46,.24,.53,.02,.46,.93,.62,.15,.34,.04,.86,.42,.64,.04,.72,.92,.12,.3,.72,.89,.05,.75,.19,.1,.8,.25,.47,.13,.88,.36,.24,.95,.31,.42,.78,.18,.38,.84,.05,.62,.75,.38,.17,.47,.22,.34,.81,.11,.95,.89,.45,.75,.04,.9,.58,.65,.2,.36,.73,.07,.77,.4,.8,.59,.01,.66,.83,.44,.96,.71,.33,.58,.99,.75,.43,.93,.01,.67,.88,.42,.98,.42,.63,.83,0,.44,.87,.07,.46,.93,.66,.29,.96,.4,.51,.02,.28,.39,.72,.51,.22,.8,.55,.98,.48,.6,.89,.19,.67,.9,.79,.6,.06,.65,.23,.94,.7,.42,.62,.02,.72,.39,1,.05,.87,.7,.35,.82,.06,.63,.82,.69,.2,.87,.07,.52,.73,.22,.61,.11,.96,.27,.55,.37,.8,.47,.52,.15,.6,.82,.48,.37,.91,.61,.68,.55,.78,.03,.7,.17,.64,.08,.61,.25,.9,.51,.3,1,.43,.58,.84,.66,.08,.45,.85,.5,.19,.43,.61,.83,.23,.31,.42,.1,.82,.52,.85,.3,.23,.64,.17,.89,.28,.71,.37,.05,.2,.82,.88,.23,.05,.33,.13,.49,.78,.36,.58,.21,.76,.25,.13,.35,.6,.75,.15,.63,.31,.19,.77,.03,.85,.14,.71,.78,.17,.99,.32,.64,.92,.47,.15,.83,.22,.41,.29,.8,.53,.04,.27,.15,.87,.53,.83,.12,.47,.06,.91,.5,.27,.47,.35,.22,.59,.48,.96,.19,.92,.44,.35,.11,.58,.25,.44,.67,.84,.29,.91,.2,.34,.49,.76,.08,.23,.99,.05,.69,.43,.28,.89,.21,.73,0,.32,.4,.96,.3,.46,.84,.53,.92,.34,.05,.71,.15,.67,.24,.89,.02,.13,.78,.91,.63,0,.29,.74,.06,.15,.36,.53,.67,.96,.76,.28,.04,.15,.45,.96,.5,.93,.11,.41,.79,.5,.59,.29,.12,.41,.48,.64,.9,.84,.61,.27,.95,.12,.31,.67,.53,.91,.18,.97,.29,.39,.94,.81,.07,.45,.58,.24,.63,.31,.91,.47,.55,.09,.01,.37,.65,.31,.05,.75,.07,.95,.16,.35,.42,.98,.74,.31,.41,.02,.77,.57,.31,.77,.15,.86,.09,.75,.82,.41,.01,.67,.11,.27,.73,.16,.78,.91,.39,.75,.97,.01,.36,.78,.53,.69,.83,.15,.65,.61,.39,.85,.32,.95,.03,.65,.55,.44,.86,.18,.84,.08,.58,.76,.38,.13,.69,.43,.81,.56,.41,.09,.49,.82,.56,.31,.27,.4,.72,.35,.56,.91,.23,.69,.98,.11,.86,.16,.5,.69,.63,.89,.58,.67,.01,.35,.53,.23,.97,.16,.91,.76,.65,.95,.16,.8,.28,.55,.18,.05,.69,.47,.84,.02,.73,.37,.8,.64,.51,.11,.69,.53,.89,.35,.5,.74,.95,.37,.06,.67,.86,.75,.81,.23,.97,.58,.89,.53,.69,.47,.65,.84,.59,.5,.66,.19,.47,.91,.27,.68,.98,.22,.38,.64,.93,.53,.92,.14,.72,.38,.85,.55,.9,.48,.65,.31,.55,.16,.11,.58,.48,.66,.14,.97,.03,.43,.95,.29,.74,.19,.78,.56,.4,.15,.79,.09,1,.24,.66,.52,.2,.94,.02,.25,.84,.5,.2,.97,.86,.76,.35,.19,.64,.97,.52,.08,.99,.22,.8,.66,.36,.5,.78,.45,.61,0,.37,.22,1,.4,.34,.13,.75,.83,.62,.67,.05,.47,.2,.55,.31,.5,0,.7,.37,.07,.46,.91,.38,.8,.16,.95,.58,.1,.44,.06,.89,.22,.37,.25,.72,.15,.87,.01,.41,.54,.15,.28,.22,.42,.53,.12,.71,.19,.44,.35,.13,.89,.27,.05,.22,.11,.82,.05,.96,.6,.37,.11,.44,.81,.6,.3,.05,.2,.62,.27,.78,.31,.46,.6,.24,.01,1,.05,.84,.34,.8,.26,.92,.06,.41,.24,.33,.56,.9,0,.52,.11,.48,.24,.71,.92,.29,.48,.59,.35,.74,.44,.88,.31,.68,.55,.98,.09,.3,.63,0,.25,.94,.71,.04,.44,.75,.6,.16,.45,.12,.86,.56,.03,.19,.27,.34,.89,.56,.84,.08,.78,.2,.86,.27,.45,.16,.88,.3,.84,.69,.39,.08,.84,.56,.22,.98,.74,.85,.65,.25,.55,.34,.27,.44,.23,.7,.31,.77,.56,.84,.03,.62,.3,.99,.2,.69,.82,.93,.46,.62,.98,.3,.89,.46,.05,.64,.99,.21,.78,.58,.93,.76,.89,.34,.54,.69,.24,.87,.17,.54,0,.88,.73,.51,.42,.37,.07,.52,.98,.15,.09,.77,.37,.42,.2,.72,.48,.63,.86,.18,.7,.83,.62,.75,.22,.8,.35,.64,.84,.98,.06,.62,.83,.4,.2,.69,.05,.82,.11,.15,.61,.8,.29,.74,.38,.15,.68,.53,.44,.61,.15,.88,.35,.22,.83,.67,.89,.52,.31,.95,.88,.73,.93,.64,.73,.19,.43,.53,.03,.66,.59,.98,.04,.75,.51,.36,.01,.81,.99,.26,.77,.93,.42,.11,.52,.33,.12,1,.05,.62,.74,.92,.84,.6,1,.15,.45,.75,.96,.44,.51,.66,.1,.25,.59,.16,.8,.71,.04,.17,.58,.76,.85,.29,.73,.51,.01,.31,.4,.52,.43,.29,.79,.14,.43,.75,.64,.96,.47,.24,.14,.98,.81,.87,.69,.91,.22,.82,.72,.93,.53,.82,.6,.1,.95,.04,.44,.3,.58,.36,.91,.06,.5,.7,.12,.41,.27,.67,.33,.17,.53,.02,.88,.94,.55,.29,.97,.5,.39,.05,.46,.05,.64,.78,.92,.23,.06,.83,.31,.55,.11,.91,.29,.01,.35,.73,.08,.66,.15,.55,.4,.05,.13,.96,.29,.72,.92,.47,.31,.53,.4,.13,.96,.61,.58,.44,.16,.12,.62,.36,.18,.67,.8,.28,.6,.42,.69,.83,.13,.51,.05,.27,.4,.02,.64,.28,.11,.18,.81,.76,.33,.47,.73,.39,.09,.33,.84,.39,.67,.24,.36,.07,.4,.81,.63,.18,.72,.07,.17,.64,.99,.01,.51,.31,.08,.74,.34,.42,.69,.08,.31,.59,0,.45,.58,.4,.04,.33,.67,.16,.92,.41,.23,.53,.75,.98,.01,.51,.16,.94,.27,.58,1,.17,.53,.8,.89,.42,.75,.23,.65,.13,.45,.23,.64,.91,.73,.19,.95,.88,.5,.35,.89,.41,.74,.38,.96,.68,.78,.48,.39,.55,.94,.22,.42,.27,.84,.36,.24,.51,.66,.85,.57,.36,.16,.89,.07,.24,.81,.73,.28,.09,.23,.91,.52,.72,.47,.29,.9,.56,.03,.95,.2,.87,.08,.33,.37,.18,.66,.83,.53,.92,.88,.33,.58,.92,.05,.36,.91,.83,.02,.97,.24,.52,.59,.94,.02,.45,.98,.6,.16,.93,.45,.85,.98,.67,.82,.25,.6,.37,.84,.94,.26,.61,.2,.91,.76,.55,.22,.75,.28,.13,.33,.65,.26,.49,.14,.27,.77,.73,.33,.67,.15,.8,.23,.66,.4,.76,.45,.03,.85,.72,.09,.38,.03,.58,.99,.31,.81,.37,.77,.71,0,.36,.25,.82,.59,.22,.14,.56,.03,.19,.67,.13,.47,.2,.04,.65,.71,.14,.81,.61,.48,.76,.08,.61,.99,.76,.47,.22,.01,.62,.25,.69,.77,.61,.93,.45,.53,.85,.76,.33,.67,.95,.02,.82,.08,.48,.37,.72,.45,.78,.53,.95,.47,.89,.76,.31,.11,.7,.5,.22,.67,.47,.55,.23,.62,.15,.52,.64,.89,.75,.13,.28,.8,.17,.71,.87,.55,.24,.08,.36,.26,.55,.03,.47,.91,.72,.19,.56,.05,.83,.52,.11,.86,.16,.39,1,.81,.68,.87,.95,.75,.84,.98,.45,0,.57,.09,.85,.36,.45,.58,.87,.09,.66,.22,.36,.64,.31,.51,.96,.22,.7,.11,.49,.59,.07,.53,.16,.86,.56,.11,.69,.34,.43,.7,.28,.99,.6,.83,.25,.58,.93,.33,.18,.99,.27,.04,.86,.18,.32,.57,.03,.88,.3,.09,.41,.89,.8,.46,.41,.12,.34,.19,0,.67,.14,.42,.05,.22,.37,.6,.25,.69,1,.22,.65,.05,.34,.14,.65,.22,.01,.58,.44,.25,.15,.8,.08,.84,.29,.73,.09,.44,.96,.21,.33,.42,.17,.48,.93,.63,.33,.52,.11,.29,.67,.73,.6,.14,.87,.41,.76,.31,.11,.45,.71,.4,.99,.44,.3,.6,.47,.64,.44,.1,.51,.18,.02,.44,.09,.62,.35,.88,.49,.94,.2,.96,.07,.73,.26,.33,.97,.83,.58,.9,.24,.75,.61,.8,.29,.41,.91,.19,.87,1,.41,.3,.94,.45,.49,.97,0,.78,.85,.36,.1,.49,.9,.02,.74,.55,.81,.47,.37,.69,.52,.98,.71,.93,.45,.18,.69,.6,.95,.75,.09,.52,1,.84,.66,.5,.89,.38,.8,.5,1,.8,.13,.44,.86,.77,.12,.42,.85,.91,.26,.56,.85,.71,.29,.94,.55,.96,.36,.6,.4,1,.14,.91,.8,.29,.69,.56,.05,.81,.67,.06,.56,.42,.07,.84,.77,.37,.47,.9,.79,.32,.51,.94,.2,.06,.62,.89,.25,.78,.14,.73,0,.68,.95,.05,.24,.92,.35,.62,.37,.55,.22,.7,.19,.65,.25,.6,.43,.29,.63,.12,.91,.54,.18,0,.49,.14,.06,.46,.35,.16,.65,.85,0,.67,.35,.25,.58,.66,.05,.88,.17,.75,.08,.64,.45,.54,.76,.31,.71,.42,.37,.88,.08,.62,.91,.3,.1,.41,.64,.12,.25,.55,.84,.16,.34,.54,.19,.29,.02,.56,.25,.96,.06,.3,.62,.25,.69,.58,.93,.53,.18,.33,.53,.58,.16,.78,.38,.98,.08,.42,.79,.16,.04,.85,.73,.28,.52,0,.64,.39,.51,.05,.77,.88,.47,1,.36,.79,.22,.71,.96,.25,.16,1,.01,.19,.45,.04,.71,.65,.34,.58,.97,.51,.33,.07,.59,.36,.89,.2,.34,.77,.58,.83,.48,.75,.88,.28,.79,.94,.42,.05,.8,.16,.72,.55,.78,.48,.82,.44,.62,.75,.4,.8,1,.7,.04,.93,.49,.56,.24,.44,.75,.12,.8,.09,.76,.24,.61,.33,.91,.25,.21,.15,.92,.06,.22,.17,.64,.28,.13,.22,.73,.55,.85,.22,.47,.88,.39,.77,.48,.05,.42,.64,.85,.73,.92,.17,.39,.75,.58,.8,.94,.1,.35,.04,.3,.64,.73,.01,.92,.28,.08,.48,.7,.03,.61,.52,.35,.69,.65,.45,.07,.89,.66,.77,.25,.55,.18,.94,.35,.14,.27,.11,.63,.29,.92,.03,.61,.45,.69,.59,.81,.29,.63,.98,.16,.25,.84,.78,.12,.42,.83,.65,.95,.27,.45,.8,.53,.14,.7,.02,.22,.14,.98,.7,.06,.53,.34,.75,1,.09,.34,.88,.02,.24,.37,.05,.29,.95,.25,.67,.41,.53,.21,.84,.37,.09,.78,.63,.93,.52,.91,.47,.34,.55,.82,.38,.48,.59,.96,.4,.68,.61,.84,.99,.78,.53,.68,.93,.4,.16,.04,.78,.53,.72,.01,.98,.27,.92,.79,.23,.05,.6,.32,.78,.64,.08,.45,.2,.16,.53,.77,.45,.83,.09,.39,.69,.45,.83,.64,.72,.24,.31,.89,.23,.11,1,.22,.34,.56,.12,.18,.36,.95,.11,.83,.62,.41,.56,.67,.85,.4,.15,.48,.86,.35,.21,.49,.12,.36,.73,.52,.84,.07,.53,.45,0,.28,.73,.19,.48,.11,.56,.85,.07,.41,.28,.97,.36,.65,.43,.1,.58,.47,.16,.91,.58,.44,.52,.84,.4,.17,.99,.67,.87,.72,.56,.09,.18,.88,.31,.75,.27,.63,1,.33,.15,.05,.28,.39,.19,.64,.99,.14,.05,.87,.71,.02,.82,.28,.37,.55,.44,.07,.34,.83,.02,.49,.97,.64,.27,.19,.33,.11,.62,.68,.12,.58,.98,.44,.38,.12,.47,.87,.25,.51,.85,.67,.42,.9,.23,.98,.61,.25,.89,.2,.97,.36,.13,.54,.95,.43,.77,.84,.51,.37,.94,.82,.45,.86,.5,.69,.31,.47,.02,.73,.95,.2,.51,.78,.7,.56,.09,.66,.78,.95,.88,.07,.92,.22,.41,.33,.76,.9,.38,.98,.63,.05,.93,.3,.76,.16,.61,.67,.89,.46,.56,.85,.78,.23,.35,.87,.64,.25,.11,.2,.69,.25,.64,.74,.59,.5,.15,.22,.46,.91,.35,.6,.06,.81,.47,.05,.72,.42,.89,.56,.67,.84,.01,.73,.27,.44,.65,.17,.33,.78,.1,.52,.73,.03,.2,.94,.42,.59,.26,.66,.76,.38,.91,.95,.6,.84,.22,.41,.36,.52,.17,.76,.88,.53,.23,.97,.03,.71,.36,.95,.02,.32,.72,.15,.49,.76,.11,.56,.03,.44,.78,.86,.18,.66,.06,.27,.59,.01,.75,.16,.28,.94,.04,.6,.77,.9,.23,.83,.3,.09,.89,0,.24,.97,.82,.27,.03,.42,.3,.64,.45,.13,.69,.97,.6,.19,.66,.22,.52,.87,.42,.69,.39,.99,.3,.06,.75,.18,.1,.3,.49,.95,.71,.02,.81,.4,.73,.86,.05,.95,.11,.42,.29,.08,.93,.41,.83,0,.76,.52,.98,.13,.58,.89,.19,.53,.82,.33,.22,.76,.52,.95,.09,.78,.91,.56,.29,.47,.64,.95,.18,.88,.72,.63,.12,.9,.2,.33,.08,.45,.11,.68,.42,.53,.79,.9,.71,.02,.84,.27,.04,.69,.83,.57,.31,.75,.12,.25,.78,.63,.55,.05,.42,.87,.33,.52,.71,.24,.61,.3,.02,.57,.74,.47,.87,.09,.66,.51,.71,.56,.08,.4,.16,.53,.12,.6,.41,.68,.45,.31,.63,.36,.44,.18,.59,.7,.23,.53,.77,.86,.27,.05,.5,.09,.31,.78,.11,.34,.8,.02,.21,.64,.49,.92,.24,.82,.62,.03,.89,.17,.61,.22,.53,.95,.34,.63,.48,.36,.55,.82,.89,.25,.76,.56,.65,.27,.71,.45,.22,.34,.69,.4,.11,.25,.66,.08,.95,.42,.16,.33,.6,.5,.22,.76,.98,.16,.85,.24,.42,.33,.49,.28,.76,.53,.86,.72,.56,.8,.23,.77,.07,.29,.16,.1,.96,.6,.32,.64,.92,.35,.07,.19,.39,.95,.59,.49,.19,.37,.81,.27,.94,.64,.18,.82,.91,.09,.98,.47,.41,.92,.35,.25,.96,.34,.78,.11,.37,.23,.82,.96,.27,.87,.35,.7,.49,.17,.8,.93,.56,.06,.75,.94,.49,.84,.99,.15,.04,.59,.37,.8,.9,.42,.71,.94,.48,.58,.25,.9,.55,.12,.78,.36,.44,.55,.99,.39,.66,.46,.12,.75,.44,.06,.18,.78,.28,.9,.2,.06,.7,.36,.61,.07,.33,.18,.95,.06,.64,.85,.28,.78,.97,.47,.73,.04,.47,.61,.86,.25,.7,.36,.04,.42,.09,.58,.37,.05,.67,.78,.89,.09,.36,.05,.42,.94,.02,.51,.86,.27,.63,.99,.55,.44,.25,.75,.46,.15,.43,.5,.61,.8,.46,.85,.56,.07,.86,1,.51,.11,.74,.46,.02,.6,.38,.15,.75,.65,.22,.8,.15,.69,.42,.17,.87,.44,.61,.91,.32,.64,.67,.45,.09,1,.89,.03,.27,.73,.14,.22,.87,.52,.13,.06,.35,.67,.42,.95,.2,.64,.24,.56,.03,.83,.17,.66,.05,.73,.45,.86,.27,0,.69,.13,.33,.71,.27,.77,.37,.31,.91,.67,.59,.93,.11,.75,.6,.42,.95,.5,.16,1,.85,.6,.38,.82,.17,.94,.53,.02,.61,.36,.88,.3,.8,.12,.55,.91,.07,.81,.63,.89,.69,.49,.71,.94,.54,0,.59,.24,1,.68,.17,.63,.29,.38,.15,.92,.37,0,.83,.67,.4,.06,.87,.2,1,.78,.24,.93,.05,.14,.28,.68,.43,.7,.16,.6,.36,.23,.97,.29,.69,.45,.34,.88,.08,.84,.54,0,.63,.58,.27,.99,.03,.75,.15,.5,0,.55,.76,.21,.62,.54,.85,.41,.49,.8,.31,.66,.25,.38,.6,.91,.3,.51,.71,.12,.31,.99,.63,.38,.27,.89,.42,.33,1,.19,.61,.94,.75,.57,.22,.92,.08,.55,1,.83,.1,.48,.25,.4,.01,.52,.68,.22,.1,.78,.4,.73,.45,.12,.52,.75,.49,.11,.45,.2,.84,.13,.58,.24,.98,.36,.66,.2,.45,.97,.16,.27,.85,.3,.19,.81,.37,.16,.45,.84,.56,.8,.47,.22,.97,.69,.6,.21,.71,.5,.78,.19,.94,.53,.81,.69,.55,.13,.28,.66,.38,.74,.98,.33,.24,0,.3,.91,.86,.58,.76,.12,.83,.55,.05,.27,.57,.44,.29,.75,.92,.09,.5,.72,.23,.54,.42,.87,.17,.82,.31,.05,.42,.33,.11,.6,.98,.07,.62,.42,.89,.7,.82,.21,.79,.07,.41,.87,.76,.45,.2,.09,.96,.55,.77,.14,.69,.39,.56,.11,.39,.8,.05,.87,.45,.69,.02,.62,.2,.75,.86,.69,.47,.99,.34,.85,.28,.57,.01,.21,.27,.91,.04,.31,.24,.62,.79,.33,.93,.39,.7,.18,.49,.72,0,.27,.77,.5,.35,.56,.03,.44,.08,.62,.27,.97,.73,.33,.11,.27,.72,.34,.83,.06,.46,.09,.81,.33,.12,.28,.63,.09,.36,.3,.01,.41,.89,.49,.56,.21,.61,.78,.89,.58,.75,.47,.17,.06,.5,.41,.96,.2,.79,.92,.73,.11,.98,.33,.83,.19,.67,.37,.81,.27,.06,.99,.71,.37,.94,.65,.79,.95,.19,.7,.35,.23,.91,.03,.17,.53,.02,.47,.15,.59,.93,.02,.53,.15,.84,.73,.51,.22,.01,.82,.49,.05,.26,.84,.47,.3,.52,.6,.16,.23,.4,.51,.95,.36,.04,.31,.82,.17,.09,.93,.64,.53,.89,.82,.63,.77,.68,.95,.87,.4,.72,.05,.65,.53,.92,.05,.8,.33,.6,.95,.43,.06,.73,.62,.95,.78,.91,.53,.11,.88,.68,.19,.41,.94,.03,.58,.13,.89,.55,.96,.61,.41,.94,.84,.47,.22,.97,.65,.83,.71,.18,.95,.03,.82,.11,.45,.09,.52,.79,.4,.67,.33,.89,.65,.01,.31,.62,.51,.38,.19,.61,.47,.23,.41,.88,.04,.95,.57,.64,.36,.26,.53,.12,.5,.27,.71,.46,.07,.84,.58,.46,.73,.98,.33,.85,.25,.95,.66,.37,.22,.68,.28,.43,.65,.34,.6,.94,.31,.62,.9,.69,.94,.16,.66,.96,.35,.78,.94,.72,.29,.16,.58,.91,.64,.22,.55,.4,.75,.44,.2,.69,.32,.08,.44,.36,.18,.58,.14,.99,.5,.25,.09,.29,.64,.44,.92,.13,.84,.64,.22,.86,.13,.36,.25,.69,.32,.42,.55,.06,.5,.62,.91,.66,.51,.8,.42,.31,.77,.13,.23,.7,.56,.01,.78,.44,.15,.5,.26,.61,.44,.33,.93,.5,.37,.2,.96,.25,.04,1,.22,.78,.44,.73,.16,.87,.42,.04,.78,.89,.05,.77,.56,.31,.47,.13,.7,.44,.84,.1,.61,.8,.17,.08,.88,.53,.92,.15,.3,.8,.39,.12,.65,.44,.56,.74,.3,.5,.82,.59,.91,.96,.02,.81,.11,.45,.4,.19,.78,.44,.33,.2,.02,.74,.25,.09,.49,.05,.88,.8,.43,.11,.49,.77,.86,.61,.03,.26,.12,.99,.46,.56,.15,.86,.51,.05,.83,.35,.18,.76,.86,.39,.8,.2,.24,.56,.37,.16,.48,.32,.69,.45,.17,.84,.02,.73,.24,.82,.3,.76,.17,.25,.39,.19,.67,.27,.64,.51,.07,.73,.34,.64,.89,.7,.57,.06,.9,.77,.08,.7,.24,.66,.86,.71,.33,.65,.13,.71,.6,.09,.25,.36,.59,.97,.67,.25,.55,.27,.69,.13,.97,.62,.8,.25,.9,.18,.01,.74,.91,.41,.96,.56,.35,.25,.41,.66,.01,.52,.19,.6,.76,.07,.39,.1,.89,.16,.1,.38,.06,.49,.17,.26,.87,.71,1,.11,.54,.04,.6,.8,.55,.87,.42,.58,.84,.63,.33,.55,.67,.25,.99,.03,.29,.47,.95,.8,.37,.86,.07,.65,.95,.27,.75,.45,.29,.62,.91,.56,.67,.13,.99,.53,.69,.05,.89,.72,1,.81,.08,.93,.55,.6,.98,.49,.89,.36,.97,0,.47,.88,.08,1,.83,.03,.92,.87,.42,1,.18,.11,.3,.19,.38,.99,.34,.2,.53,.87,.16,.59,.28,.02,.55,.86,.49,.4,.88,.53,.95,.82,.48,.07,.14,.82,.94,.43,.5,.37,.19,.72,.01,.53,.38,.77,.56,.49,.22,.28,.68,.64,.02,.78,.74,.6,.98,.86,.69,.26,.87,.94,.2,.69,.45,.98,.79,.72,.64,.32,.76,.53,.66,.06,.57,.31,.85,.27,.72,.39,.99,.06,.67,.15,.38,.22,.95,.07,.19,.74,.43,.35,.13,.7,.19,.53,.58,.73,.24,.39,.73,.02,.87,.64,.22,.7,.02,.44,.22,.35,.74,.06,.33,.76,.47,.27,.02,.58,.42,.75,.06,.34,.14,.27,.62,.09,.67,.41,.59,.73,.33,.55,.49,.37,.57,.33,.27,.79,.52,.4,.93,.5,.81,.09,.47,.69,.38,.8,.42,.1,.99,.8,.44,.16,.93,.29,.33,.18,.02,.67,.22,.3,.52,.34,.63,0,.75,.84,.25,.94,.43,.09,.98,.33,.64,.94,.35,.05,.83,.47,.22,.94,.12,.44,.31,.08,.41,.15,.46,.31,.81,.61,.03,.53,.27,.47,.22,.84,.92,.44,.36,.23,.77,.16,.66,.92,.11,.18,.47,.3,.52,.91,.05,.75,.47,.37,.85,.9,.6,.55,.83,.89,.33,.64,.03,.29,.94,.5,.18,.6,.35,.1,.95,.8,.47,.09,.95,.61,.44,.58,.91,.41,.61,.2,.36,.64,.25,.89,.28,.81,.71,.42,.8,.18,.53,.27,.93,.21,.8,.65,.09,.16,.78,.12,.65,.01,.61,.85,.71,.04,.62,.75,.88,.56,.01,.28,.91,.5,.67,.36,.22,.75,.05,.8,.55,.73,.64,.37,.93,.76,.88,.7,.16,.22,.9,.58,.15,.53,.84,.67,.6,.16,.25,.86,.14,.55,.76,.14,.52,.85,.28,.17,.48,.77,.91,.55,.01,.65,.48,.24,.34,.67,.14,.9,.01,.56,.11,.14,.83,.95,.45,.88,.4,.49,.83,.64,.78,.24,.84,.6,.8,.27,.58,.71,0,.29,.14,.23,.69,.41,.09,1,.45,.13,.63,.81,.29,.98,.55,.4,.14,.51,.33,.89,.27,.78,0,.2,.83,.12,.53,.96,.8,.13,.5,.19,.63,.46,.9,.06,.51,.92,.74,.83,.14,.05,.43,.94,.25,.71,.95,.2,.38,.94,.47,.24,.16,.55,.31,.28,.13,.16,.96,.74,.61,.21,.06,.53,.96,.6,.67,.09,.47,.99,.12,.83,.43,.58,.04,.42,1,.31,.47,.09,.34,.65,.29,.21,.81,.45,.05,.79,.67,.41,.99,.33,.71,.37,.56,.67,.84,.25,.63,.35,.98,.77,.11,.88,.95,.78,.51,.4,.75,.61,.29,.71,.49,.01,.28,.6,.05,.23,.58,.36,.01,.95,.12,.34,.44,.97,.13,.89,.51,.63,.8,.99,.03,.49,.26,.78,.87,.35,.71,.05,.44,.08,.78,.67,.24,.98,.73,.16,.51,.67,.97,.39,.24,.88,.05,.73,.44,.85,.7,.98,0,.54,.21,.67,.33,.03,.25,.47,.36,.67,.52,.29,.87,.42,.49,.55,.71,.82,.07,.34,.7,.89,.45,.94,.66,.41,.52,.09,.34,.77,.25,.88,.11,.32,.41,.19,.89,.25,.31,.51,.19,.09,.24,.66,.53,.78,.69,.92,.82,.49,.05,.73,.36,.95,.52,.59,.19,.89,.07,.25,.64,.01,.9,.09,1,.03,.72,.19,.83,.38,.17,.58,.39,.04,.85,.18,.99,.34,.8,.9,.21,.64,.75,.13,.79,.99,.08,.91,.42,.65,.54,.74,.03,.19,.67,.35,.25,.43,.11,.33,.76,.62,.15,.72,.51,.21,.56,.84,.91,.49,.31,.86,.61,.08,.6,.41,.72,.11,.3,.44,.65,.71,.35,.29,.61,.09,.4,.33,.75,.13,.95,.84,.6,.44,.99,.63,.91,.61,.83,.16,0,.63,.08,.89,.15,.29,.56,.75,.96,0,.22,.53,.82,.71,.23,.84,.55,.96,.62,.44,.72,.47,.84,.56,.73,.64,0,.8,.69,.95,.87,.47,.12,.37,.03,.25,.41,.98,.13,.91,.57,0,.72,.29,.35,.47,.58,.81,.92,.49,.75,.34,.39,.47,.54,.3,.05,.69,.45,.74,.2,.62,.29,.69,.08,.23,.47,.41,.07,.53,.92,.37,.43,.69,.28,.51,.73,.18,.27,.87,.49,.61,.82,.05,.96,.72,.46,.87,.57,.37,.96,.29,.09,.94,.42,.13,.25,.73,.18,.02,.45,.36,.82,.05,.23,.56,.84,.78,.54,.09,.49,.92,.16,.24,.9,.47,.84,.44,.25,.36,.15,.78,.11,.31,.04,.17,.37,.97,.67,.32,.8,.25,.44,.93,.19,.49,.39,.63,.77,.08,.35,.04,.94,.45,.15,.01,.37,.18,.83,.03,.95,.35,.08,.42,.89,.55,.36,.58,.28,.81,.19,.87,.6,.7,.19,.58,.68,.33,.19,.42,.92,.1,.84,.73,.16,.42,.23,.11,.55,.18,.61,.86,.14,.95,.58,.93,.28,.07,.98,.47,.13,.45,.53,.88,.15,.66,.98,.33,.23,.84,.17,.65,.87,.13,.58,1,.36,.08,.92,.4,.3,.53,.83,.16,.65,.27,.2,.03,.83,.66,.49,0,.75,.67,.33,.59,.95,.58,.92,.28,.78,.99,.48,.89,.15,.04,.99,.22,.81,.41,.67,.77,.05,.58,.18,.64,.04,.72,.89,.67,.42,.81,.55,.73,.25,.51,.77,.18]),jl=Math.exp,zl="blue",Nl="color-point-arrays",Vl=["black-white","monochrome-4","monochrome-8","monochrome-16"],Wl="hex-grid",Ul="monochrome-16",Zl="monochrome-4",_l="monochrome-8",Kl="points-array",ql="random-points",Ql="source-alpha",Jl="unset",tc=new Float32Array([0,.5,.13,.63,.03,.53,.16,.66,.75,.25,.88,.38,.78,.28,.91,.41,.19,.69,.06,.56,.22,.72,.09,.59,.94,.44,.81,.31,.97,.47,.84,.34,.05,.55,.17,.67,.02,.52,.14,.64,.8,.3,.92,.42,.77,.27,.89,.39,.23,.73,.11,.61,.2,.7,.08,.58,.98,.48,.86,.36,.95,.45,.83,.33]),ec=[new Uint8Array([0,0,0,0]),new Uint8Array([0,0,0,180]),new Uint8Array([180,0,0,0]),new Uint8Array([180,0,0,180]),new Uint8Array([0,180,180,180]),new Uint8Array([180,180,180,0]),new Uint8Array([180,180,180,180]),new Uint8Array([180,180,180,255]),new Uint8Array([255,180,180,180]),new Uint8Array([255,180,180,255]),new Uint8Array([180,255,255,255]),new Uint8Array([255,255,255,180]),new Uint8Array([255,255,255,255])],ic={[Qt]:[255,0],[Zl]:[255,187,102,0],[_l]:[255,221,187,153,119,85,51,0],[Ul]:[255,238,221,204,187,170,153,136,119,102,85,68,51,34,17,0]},nc=new Uint8Array([0,255,0]),sc=new Uint8Array([0,255,255]),rc=Yl({name:"SC-core-color-engine"});let oc="black-white";const ac=t=>oc=t,lc=()=>oc,FilterEngine=function(){return this.cache=null,this.actions=[],this},cc=FilterEngine.prototype=Sr();cc.type="FilterEngine",cc.action=function(t){const{identifier:e,filters:i,image:n}=t,{actions:s,theBigActionsObject:r}=this;let o,a,l,c;const h=Ha(e);if(h)return h;for(s.length=0,o=0,a=i.length;o<a;o++)s.push(...i[o].actions);const u=s.length;if(u){for(this.unknit(n),o=0;o<u;o++)l=s[o],c=r[l.action],c&&c.call(this,l);return e&&Ea(e,this.cache.work),this.cache.work}return n},cc.unknit=function(t){this.cache={};const e=this.cache,{width:i,height:n,data:s}=t;e.source=new ImageData(s,i,n),e.work=new ImageData(s,i,n)},cc.getAlphaData=function(t){const{width:e,height:i,data:n}=t,s=n.length,r=new ImageData(e,i),o=r.data;let a,l;for(l=0;l<s;l+=4)a=n[l+3],o[l]=0,o[l+1]=0,o[l+2]=0,o[l+3]=a>0?255:0;return r},cc.buildImageGrid=function(t){const{cache:e}=this;t||(t=e.source);const{width:i,height:n}=t;if(i&&n){const t=`grid-${i}-${n}`,e=Ha(t);if(e)return e;const s=[];let r,o,a,l=0;for(a=0;a<n;a++){for(r=[],o=0;o<i;o++)r.push(l),l++;s.push(r)}return Ea(t,s),s}return!1},cc.getRandomNumbers=function(t={}){const{seed:e=we,length:i=0,imgWidth:n=0,type:s=un}=t,r=`random-${e}-${i}-${s}`,o=Ha(r);if(o)return o;const a=Jr();let l,c,h,u,d;if(s===ie&&n){const t=Gl.length,e=Ot(t),s=i/n,r=Jr();for(l=0;l<t;l+=e)u=Gl.slice(l,l+e),r.push(u);for(l=s;l>0;l-=e)for(c=0;c<e;c++)for(d=r[c],h=n;h>0;h-=e)h<e?a.push(...d.slice(0,h)):a.push(...d);to(r)}else if("ordered"===s&&n){const t=tc.length,e=Ot(t),s=i/n,r=Jr();for(l=0;l<t;l+=e)u=tc.slice(l,l+e),r.push(u);for(l=s;l>0;l-=e)for(c=0;c<e;c++)for(d=r[c],h=n;h>0;h-=e)h<e?a.push(...d.slice(0,h)):a.push(...d);to(r)}else{const t=xa(e);for(l=0;l<i;l++)a.push(t.random())}const f=new Float32Array(a);return to(a),Ea(r,f),f},cc.buildImageCoordinateLookup=function(t){const{cache:e}=this;t||(t=e.source);const{width:i,height:n}=t;if(i&&n){const t=`coords-lookup-${i}-${n}`,e=Ha(t);if(e)return e;const s=[];for(let t=0;t<n;t++)for(let e=0;e<i;e++)s.push([e,t]);return Ea(t,s),s}return!1},cc.buildAlphaTileSets=function(t,e,i,n,s,r,o,a){const{cache:l}=this;a||(a=l.source);const{width:c,height:h}=a;if(c&&h){(t=dt(t)?t:1)<1&&(t=1),(e=dt(e)?e:1)<1&&(e=1),t+(i=dt(i)?i:1)>=c&&(t=c-i-1),e+(n=dt(n)?n:1)>=h&&(e=h-n-1),t<1&&(t=1),e<1&&(e=1),t+i>=c&&(i=c-t-1),e+n>=h&&(n=h-e-1);const o=t+i,a=e+n;(s=dt(s)?s:0)<0&&(s=0),s>=o&&(s=o-1),(r=dt(r)?r:0)<0&&(r=0),r>=a&&(r=a-1);const l=`alphatileset-${c}-${h}-${t}-${e}-${i}-${n}-${s}-${r}`,u=Ha(l);if(u)return u;const d=[];let f,p,g,m,y,b,S,k,C;for(m=r-a,y=h;m<y;m+=a)for(p=s-o,g=c;p<g;p+=o){for(f=[],k=m,C=m+e;k<C;k++)if(k>=0&&k<h)for(b=p,S=p+t;b<S;b++)b>=0&&b<c&&f.push(4*(k*c+b)+3);for(d.push([].concat(f)),f=[],k=m+e,C=m+e+n;k<C;k++)if(k>=0&&k<h)for(let e=p,i=p+t;e<i;e++)e>=0&&e<c&&f.push(4*(k*c+e)+3);for(d.push([].concat(f)),f=[],k=m,C=m+e;k<C;k++)if(k>=0&&k<h)for(let e=p+t,n=p+t+i;e<n;e++)e>=0&&e<c&&f.push(4*(k*c+e)+3);for(d.push([].concat(f)),f=[],k=m+e,C=m+e+n;k<C;k++)if(k>=0&&k<h)for(let e=p+t,n=p+t+i;e<n;e++)e>=0&&e<c&&f.push(4*(k*c+e)+3);d.push([].concat(f))}return Ea(l,d),d}return!1},cc.buildImageTileSets=function(t,e,i,n,s){const{cache:r}=this;s||(s=r.source);const{width:o,height:a}=s;if(o&&a){(t=dt(t)?t:1)<1&&(t=1),t>=o&&(t=o-1),(e=dt(e)?e:1)<1&&(e=1),e>=a&&(e=a-1),(i=dt(i)?i:0)<0&&(i=0),i>=t&&(i=t-1),(n=dt(n)?n:0)<0&&(n=0),n>=e&&(n=e-1);const s=`simple-tileset-${o}-${a}-${t}-${e}-${i}-${n}`,r=Ha(s);if(r)return r;const l=[];let c,h,u,d,f,p,g,m,y;for(u=n-e,d=a;u<d;u+=e)for(c=i-t,h=o;c<h;c+=t){for(y=[],g=u,m=u+e;g<m;g++)if(g>=0&&g<a)for(f=c,p=c+t;f<p;f++)f>=0&&f<o&&y.push(4*(g*o+f));y.length&&l.push(y)}return Ea(s,l),l}return!1},cc.buildGeneralTileSets=function(t,e,i,n,s,r,o,a,l){const{cache:c}=this;l||(l=c.source);const{width:h,height:u}=l;if(h&&u){let l=1,c=1,d=1,f=0,p=0,g=0,m=Jl;if(t.substring?m=t:ut(t)?m=Kl:dt(t)&&(m=ql),m===Jl)return[];e.substring?l=vt(parseFloat(e)/100*h):dt(e)&&(l=e),l<1&&(l=1),i.substring?c=vt(parseFloat(i)/100*u):dt(i)&&(c=i),c<1&&(c=1),n.substring?d=vt(parseFloat(n)/100*h):dt(n)&&(d=n),d<1&&(d=1),s.substring?f=vt(parseFloat(s)/100*h):dt(s)&&(f=s),f<0?f=0:f>=h&&(f=h-1),r.substring?p=vt(parseFloat(r)/100*u):dt(r)&&(p=r),p<0?p=0:p>=u&&(p=u-1),dt(o)&&(g=o);let y=`${m}-tileset-${h}-${u}-${l}-${c}-${d}-${f}-${p}-${g}`;m===Kl?y+=`-${t.join(jt)}`:m===ql&&(y+=`-${t}-${a}`);const b=Ha(y);if(b)return b;if(m===fn&&1===l&&1===c)return Ia(y);const S=_a(),k=[f,p],C=[0,0];let A,v=[];const P=[],x=[];let O,w,D,F,R,T,H,E,I=zs;m===Wl&&c/d<1.05&&(c=1.05*d);const B=ct(l/2),L=ct(c/2),$=2*d,M=vt(c/d*d);let X,Y,G,j,z,N,V,W,U,Z=0,_=0;switch(m){case fn:if(I=`rect-grid-points-${h}-${u}-${l}-${c}-${f}-${p}`,A=Ha(I),!A){const t=[];for(H=p-2*u+L,E=p+2*u+L;H<E;H+=c)for(R=f-2*h+B,T=f+2*h+B;R<T;R+=l)t.push(R,H);A=Ia(I,t)}break;case Wl:if(I=`hex-grid-points-${h}-${u}-${d}-${f}-${p}`,A=Ha(I),!A){const t=[];for(Z=0,H=p-2*u+d,E=p+2*u+d;H<E;H+=M){for(_=Z%2==0?d:0,R=f-2*h+d+_,T=f+2*h+d;R<T;R+=$)t.push(R,H);Z++}A=Ia(I,t)}l=2*$,c=2*M;break;case ql:if(I=`random-points-${h}-${u}-${d}-${f}-${p}-${A}-${a}`,A=Ha(I),!A){const e=[],i=this.getRandomNumbers({seed:a,length:3*t});let n=-1;for(X=0;X<t;X++)S.zero().add([i[++n],i[++n]]).rotate(360*i[++n]).rotate(g).scalarMultiply(d),[R,H]=S,e.push(vt(R),vt(H));A=Ia(I,e)}l=d,c=d;break;case Kl:if(I=`defined-points-${h}-${u}-${d}-${t}`,A=Ha(I),!A){const e=[...t];A=Ia(I,e)}l=d,c=d}for(Z=0,X=0,Y=A.length;X<Y;X+=2)if(C[0]=A[X],C[1]=A[X+1],S.zero().add(C).rotate(g).add(k),[R,H]=S,R=vt(R),H=vt(H),R>-l&&R<h+l&&H>-c&&H<u+c){for(G=2*h*(2*u)+(H+ct(u/2))*h+(R+ct(h/2)),P[Z]=[R,H,G],v[G]=[],O=H-c,w=H+c;O<w;O++)for(D=R-l,F=R+l;D<F;D++)if(D>=0&&D<h&&O>=0&&O<u){if(m===ql&&S.zero().subtract(k).add([D,O]).getMagnitude()>d)continue;j=O*h+D,x[j]||(x[j]=[]),x[j].push(Z)}Z++}if(!P.length)return P;for(O=0;O<u;O++)for(D=0;D<h;D++)V=O*h+D,C[0]=D,C[1]=O,W=x[V],z=-1,N=0,W&&W.forEach((t=>{[R,H,G]=P[t],U=S.zero().add(C).subtract([R,H]).getMagnitude(),(z<0||U<N)&&(z=G,N=U)})),z>=0&&v[z].push(V);return Ka(S),v=v.filter((t=>null!=t)),Ea(y,v),v}return[]},cc.buildHorizontalBlur=function(t,e){dt(e)||(e=0);const i=t.length,n=t[0].length,s=`blur-h-${n}-${i}-${e}`,r=Ha(s);if(r)return r;const o=[];let a,l,c,h,u;for(l=0;l<i;l++)for(a=0;a<n;a++){for(u=[],c=a-e,h=a+e+1;c<h;c++)c>=0&&c<n&&u.push(4*t[l][c]);o[l*n+a]=u}return Ea(s,o),o},cc.buildVerticalBlur=function(t,e){dt(e)||(e=0);const i=t.length,n=t[0].length,s=`blur-v-${n}-${i}-${e}`,r=Ha(s);if(r)return r;const o=[];let a,l,c,h,u;for(a=0;a<n;a++)for(l=0;l<i;l++){for(u=[],c=l-e,h=l+e+1;c<h;c++)c>=0&&c<i&&u.push(4*t[c][a]);o[l*n+a]=u}return Ea(s,o),o},cc.buildMatrixGrid=function(t,e,i,n,s){const{cache:r}=this;s||(s=r.source);const{width:o,height:a,data:l}=s;(null==t||t<1)&&(t=1),(null==e||e<1)&&(e=1),null==i||i<0?i=0:i>=t&&(i=t-1),null==n||n<0?n=0:n>=e&&(n=e-1);const c=`matrix-${o}-${a}-${t}-${e}-${i}-${n}`,h=Ha(c);if(h)return h;const u=l.length,d=[],f=[];let p,g,m,y,b,S,k,C,A;for(m=-n,y=e-n;m<y;m++)for(p=-i,g=t-i;p<g;p++)d.push(4*(m*o+p));for(m=0;m<a;m++)for(p=0;p<o;p++){for(k=4*(m*o+p),C=[],b=0,S=d.length;b<S;b++)A=k+d[b],A<0?A+=u:A>=u&&(A-=u),C.push(A);f.push(C)}return Ea(c,f),f},cc.checkChannelLevelsParameters=function(t){const e=function(t,e=!1){if(t.toFixed)return t<0?[nc]:t>255?[sc]:dt(t)?[[0,255,t]]:e?[sc]:[nc];if(t.substring&&(t=t.split(jt)),ut(t)){if(!t.length)return t;if(ut(t[0]))return t;if((t=t.map((t=>parseInt(t,10)))).sort(((t,e)=>t-e)),1==t.length)return[[0,255,t[0]]];const e=[];let i,n,s,r;for(s=0,r=t.length;s<r;s++)i=0,n=255,0!==s&&(i=st(t[s-1]+(t[s]-t[s-1])/2)),s!==r-1&&(n=ct(t[s]+(t[s+1]-t[s])/2)),e.push([i,n,t[s]]);return e}return e?[sc]:[nc]};t.red=e(t.red),t.green=e(t.green),t.blue=e(t.blue),t.alpha=e(t.alpha,!0)},cc.cacheOutput=function(t,e){this.cache[t]=e},cc.getInputAndOutputLines=function(t){const{cache:e}=this,i=e.source;let n,s=e.work,r=!1,o=!1;return t.lineIn!==Ql&&t.lineMix!==Ql||(o=this.getAlphaData(i)),t.lineIn&&(t.lineIn===Rn?s=i:t.lineIn===Ql?s=o:e[t.lineIn]&&(s=e[t.lineIn])),t.lineMix&&(t.lineMix===Rn?r=i:t.lineMix===Ql?r=o:"current"===t.lineMix?r=e.work:e[t.lineMix]&&(r=e[t.lineMix])),t.lineOut&&e[t.lineOut]?n=e[t.lineOut]:(n=new ImageData(s.width,s.height),t.lineOut&&(e[t.lineOut]=n)),[s,n,r]},cc.getGrayscaleValue=function(t,e,i){return ct(.2126*t+.7152*e+.0722*i)},cc.retrieveColorPointLibraries=function(){return Ta(Nl)||Ea(Nl,{labColorLib:[],lchColorLib:[],rgbColorLib:[]}),Ha(Nl)},cc.getOkColorVals=function(t,e,i,n){const s=n.rgbColorLib;return s[t]&&s[t][e]&&null!=s[t][e][i]?s[t][e][i]:this.setOkColorVals(t,e,i,n)},cc.getRegularColorVals=function(t,e,i,n,s=!1){const{labColorLib:r,lchColorLib:o}=n;let a,l,c,h;return s?([a,l,c]=this.getColorLchIndices(t,e,i),o[a]&&o[a][l]&&null!=o[a][l][c]?o[a][l][c]:(h=rc.convertOKLABtoRGB(...rc.convertOKLCHtoOKLAB(t,e,i)),this.memoizeLch(t,e,i,h,o),h)):([a,l,c]=this.getColorLabIndices(t,e,i),r[a]&&r[a][l]&&null!=r[a][l][c]?r[a][l][c]:(h=rc.convertOKLABtoRGB(t,e,i),this.memoizeLab(t,e,i,h,r),h))},cc.setOkColorVals=function(t,e,i,n){const{rgbColorLib:s,labColorLib:r,lchColorLib:o}=n;s[t]||(s[t]=[]),s[t][e]||(s[t][e]=[]);const a=[],l=[t,e,i],c=rc.convertRGBtoOKLAB(...l),h=rc.convertOKLABtoOKLCH(...c);return a.push(...c,h[1],h[2]),s[t][e][i]=a,this.memoizeLab(...c,l,r),this.memoizeLch(...h,l,o),a},cc.memoizeLab=function(t,e,i,n,s){const[r,o,a]=this.getColorLabIndices(t,e,i);s[r]||(s[r]=[]),s[r][o]||(s[r][o]=[]),s[r][o][a]=n},cc.memoizeLch=function(t,e,i,n,s){const[r,o,a]=this.getColorLchIndices(t,e,i);s[r]||(s[r]=[]),s[r][o]||(s[r][o]=[]),s[r][o][a]=n},cc.getColorLabIndices=function(t,e,i){return[ct(500*t),ct(625*(e+.4)),ct(625*(i+.4))]},cc.getColorLchIndices=function(t,e,i){return[ct(500*t),ct(1250*e),ct(3*i)]},cc.processResults=function(t,e,i){const n=t.data,s=e.data;let r,o,a;if(1===i)for(o=0,a=n.length;o<a;o++)n[o]=s[o];else if(i>0)for(r=1-i,o=0,a=n.length;o<a;o++)n[o]=n[o]*r+s[o]*i},cc.getGradientData=function(t){const e=`gradient-data-${t.name}`,i=Ha(e);if(!i||t.dirtyFilterIdentifier||t.animateByDelta){const i=Va(),{engine:n,element:s}=i;s.width=256,s.height=1;const r=n.createLinearGradient(0,0,255,0);t.addStopsToGradient(r,t.paletteStart,t.paletteEnd,t.cyclePalette),n.fillStyle=r,n.fillRect(0,0,256,1);const o=n.getImageData(0,0,256,1).data;return Wa(i),function(t,e=[]){return Oa[t]=e,wa[t]=mt(),Oa[t]}(e,o)}return i||[]},cc.transferDataUnchanged=function(t,e,i){let n,s,r,o,a;for(a=0;a<i;a+=4)n=a,s=n+1,r=s+1,o=r+1,t[n]=e[n],t[s]=e[s],t[r]=e[r],t[o]=e[o]},cc.theBigActionsObject={[Lt]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,excludeRed:h=!0,excludeGreen:u=!0,excludeBlue:d=!0,lineOut:f}=t;let p,g,m,y,b,S;for(S=0;S<r;S+=4)p=S,g=p+1,m=g+1,y=m+1,b=n[y],b&&(s[p]=a?b:h?0:n[p],s[g]=l?b:u?0:n[g],s[m]=c?b:d?0:n[m],s[y]=255);f?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Gt]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,tileWidth:a=1,tileHeight:l=1,offsetX:c=0,offsetY:h=0,gutterWidth:u=1,gutterHeight:d=1,areaAlphaLevels:f=[255,0,0,0],lineOut:p}=t,g=this.buildAlphaTileSets(a,l,u,d,c,h,f);let m,y,b,S;this.transferDataUnchanged(s,n,r),g.forEach(((t,e)=>{for(m=f[e%4],y=0,b=t.length;y<b;y++)S=t[y],n[S]&&(s[S]=m)})),p?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[_t]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,excludeRed:h=!1,excludeGreen:u=!1,excludeBlue:d=!1,lineOut:f}=t;let p,g,m,y,b,S,k=0;for(a&&k++,l&&k++,c&&k++,p=0;p<r;p+=4)m=p,y=m+1,b=y+1,S=b+1,n[S]?k?(g=0,a&&(g+=n[m]),l&&(g+=n[y]),c&&(g+=n[b]),g=ct(g/k),s[m]=h?0:g,s[y]=u?0:g,s[b]=d?0:g,s[S]=n[S]):(s[m]=h?0:n[m],s[y]=u?0:n[y],s[b]=d?0:n[b],s[S]=n[S]):(s[m]=n[m],s[y]=n[y],s[b]=n[b],s[S]=n[S]);f?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[te]:function(t){const e=function(t,e,i){const n=t+1,s=n+1,r=s+1,o=e+1,a=o+1,l=a+1;u[e]=i[t],u[o]=i[n],u[a]=i[s],u[l]=i[r]},i=function(t,e){const i=t-y,n=e-b;let s=-1;return i>=0&&i<d&&n>=0&&n<f&&(s=4*(n*d+i)),[4*(e*l+t),s]},n=function(t,e){const i=t+1,n=i+1,s=n+1,r=e+1,o=r+1,a=o+1;return[h[t]/255,h[i]/255,h[n]/255,h[s]/255,p[e]/255,p[r]/255,p[o]/255,p[a]/255]},s=(t,e)=>255*(t+e*(1-t)),[r,o,a]=this.getInputAndOutputLines(t),{width:l,height:c,data:h}=r,{data:u}=o,{width:d,height:f,data:p}=a,{opacity:g=1,blend:m=zs,offsetX:y=0,offsetY:b=0,lineOut:S}=t,k=(t,e)=>1===e?255:0===t?0:255*(1-gt(1,(1-e)/t)),C=(t,e)=>0===e?0:1===t?255:255*gt(1,e/(1-t)),A=(t,e)=>t<e?t:e,v=(t,e)=>255*et(t-e),P=(t,e)=>255*(t+e-2*e*t),x=(t,e)=>t<=.5?t*e*255:255*(e+(t-e*t)),O=(t,e)=>t>e?t:e,w=(t,e)=>255*(t+e),D=(t,e)=>t*e*255,F=(t,e)=>t>=.5?t*e*255:255*(e+(t-e*t)),R=(t,e)=>255*(e+(t-e*t)),T=(t,e)=>{const i=e<=.25?((16*e-12)*e+4)*e:Ot(e);return t<=.5?255*(e-(1-2*t)*e*(1-e)):255*(e+(2*t-1)*(i-e))},H=(t,e,i,n)=>e*t+n*i*(1-e),E=this.retrieveColorPointLibraries();let I,B,L,$,M,X,Y,G,j,z,N,V,W,U,Z,_,K,q,Q,J,tt,it,nt,st,rt,ot,at;switch(m){case"color-burn":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,q=Z+3,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=k(L,Y),u[V]=k($,G),u[W]=k(M,j),u[U]=s(X,z)):e(N,N,h):e(Z,N,p));break;case"color-dodge":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,q=Z+3,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=C(L,Y),u[V]=C($,G),u[W]=C(M,j),u[U]=s(X,z)):e(N,N,h):e(Z,N,p));break;case"darken":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,q=Z+3,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?(V=N+1,W=V+1,_=Z+1,K=_+1,u[N]=A(h[N],p[Z]),u[V]=A(h[V],p[_]),u[W]=A(h[W],p[K]),u[U]=s(h[U]/255,p[q]/255)):e(N,N,h):e(Z,N,p));break;case"difference":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=v(L,Y),u[V]=v($,G),u[W]=v(M,j),u[U]=s(X,z)):e(Z,N,p));break;case"exclusion":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=P(L,Y),u[V]=P($,G),u[W]=P(M,j),u[U]=s(X,z)):e(Z,N,p));break;case"hard-light":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=x(L,Y),u[V]=x($,G),u[W]=x(M,j),u[U]=s(X,z)):e(Z,N,p));break;case"lighten":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[N]?(V=N+1,W=V+1,_=Z+1,K=_+1,q=K+1,u[N]=O(h[N],p[Z]),u[V]=O(h[V],p[_]),u[W]=O(h[W],p[K]),u[U]=s(h[U]/255,p[q]/255)):e(Z,N,p));break;case"lighter":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=w(L,Y),u[V]=w($,G),u[W]=w(M,j),u[U]=s(X,z)):e(Z,N,p));break;case Bi:for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,q=Z+3,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=D(L,Y),u[V]=D($,G),u[W]=D(M,j),u[U]=s(X,z)):e(N,N,h):e(Z,N,p));break;case"overlay":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=F(L,Y),u[V]=F($,G),u[W]=F(M,j),u[U]=s(X,z)):e(Z,N,p));break;case"screen":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=R(L,Y),u[V]=R($,G),u[W]=R(M,j),u[U]=s(X,z)):e(Z,N,p));break;case"soft-light":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,q=Z+3,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([L,$,M,X,Y,G,j,z]=n(N,Z),V=N+1,W=V+1,u[N]=T(L,Y),u[V]=T($,G),u[W]=T(M,j),u[U]=s(X,z)):e(N,N,h):e(Z,N,p));break;case me:for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),V=N+1,W=V+1,U=W+1,_=Z+1,K=_+1,q=K+1,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[N],h[V],h[W],E),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[_],p[K],E),[Q,J,tt]=this.getRegularColorVals(rt,nt,st,E,!0),u[N]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(N,N,h):e(Z,N,p));break;case"hue":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),V=N+1,W=V+1,U=W+1,_=Z+1,K=_+1,q=K+1,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[N],h[V],h[W],E),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[_],p[K],E),[Q,J,tt]=this.getRegularColorVals(rt,ot,st,E,!0),u[N]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(N,N,h):e(Z,N,p));break;case"luminosity":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),V=N+1,W=V+1,U=W+1,_=Z+1,K=_+1,q=K+1,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[N],h[V],h[W],E),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[_],p[K],E),[Q,J,tt]=this.getRegularColorVals(it,ot,at,E,!0),u[N]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(N,N,h):e(Z,N,p));break;case"saturation":for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),V=N+1,W=V+1,U=W+1,_=Z+1,K=_+1,q=K+1,h[U]&&(Z<0?e(N,N,h):h[U]?p[q]?([it,,,nt,st]=this.getOkColorVals(h[N],h[V],h[W],E),[rt,,,ot,at]=this.getOkColorVals(p[Z],p[_],p[K],E),[Q,J,tt]=this.getRegularColorVals(rt,nt,at,E,!0),u[N]=Q,u[V]=J,u[W]=tt,u[U]=s(h[U]/255,p[q]/255)):e(N,N,h):e(Z,N,p));break;default:for(B=0;B<c;B++)for(I=0;I<l;I++)[N,Z]=i(I,B),U=N+3,h[U]&&(Z<0?e(N,N,h):h[U]?(V=N+1,W=V+1,_=Z+1,K=_+1,q=K+1,X=h[U]/255,z=p[q]/255,u[N]=H(h[N],X,p[Z],z),u[V]=H(h[V],X,p[_],z),u[W]=H(h[W],X,p[K],z),u[U]=s(X,z)):e(Z,N,p))}S?this.processResults(o,r,1-g):this.processResults(this.cache.work,o,g)},[ne]:function(t){const e=function(t,e,i,n,s){if(t){const t=e[i];if(null!=t){const e=t.length;let i,r,o=0,a=0;for(r=0;r<e;r+=b)i=t[r]+s,a+=n[i],o++;return a/o}}return n[4*i+s]},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,a=ct(o/4),{opacity:l=1,radius:c=0,passes:h=1,processVertical:u=!0,processHorizontal:d=!0,includeRed:f=!0,includeGreen:p=!0,includeBlue:g=!0,includeAlpha:m=!1,excludeTransparentPixels:y=!1,step:b=1,lineOut:S}=t;let k,C;if(d||u){const t=this.buildImageGrid(i);d&&(k=this.buildHorizontalBlur(t,c)),u&&(C=this.buildVerticalBlur(t,c))}r.set(s);const A=new Uint8ClampedArray(s),v=y?function(t,e,i,n,s){if(t){const t=e[i];if(null!=t){const e=t.length;let i,r,o,a,l=0,c=0;for(r=0;r<e;r+=b)a=t[r],o=a+3,n[o]&&(i=a+s,c+=n[i],l++);if(l)return c/l}}return n[4*i+s]}:e;let P,x,O,w,D,F;for(F=0;F<h;F++){if(d){for(P=0;P<a;P++)x=4*P,O=x+1,w=O+1,D=w+1,(m||A[D])&&(r[x]=v(f,k,P,A,0),r[O]=v(p,k,P,A,1),r[w]=v(g,k,P,A,2),r[D]=e(m,k,P,A,3));(u||F<h-1)&&A.set(r)}if(u){for(P=0;P<a;P++)x=4*P,O=x+1,w=O+1,D=w+1,(m||A[D])&&(r[x]=v(f,C,P,A,0),r[O]=v(p,C,P,A,1),r[w]=v(g,C,P,A,2),r[D]=e(m,C,P,A,3));F<h-1&&A.set(r)}}S?this.processResults(n,i,1-l):this.processResults(this.cache.work,n,l)},[ce]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,lineOut:h}=t;let u,d,f,p,g,m,y,b,S,k=0;for(a&&k++,l&&k++,c&&k++,b=0;b<r;b+=4)u=b,d=u+1,f=d+1,p=f+1,g=n[u],m=n[d],y=n[f],s[u]=g,s[d]=m,s[f]=y,k?(S=0,a&&(S+=g),l&&(S+=m),c&&(S+=y),s[p]=ct(S/k)):s[p]=n[p];h?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[he]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,ranges:a=[],lineOut:l}=t;let c,h,u,d,f,p,g,m,y,b,S;for(b=0;b<r;b+=4){for(S=!1,c=b,h=c+1,u=h+1,d=u+1,f=n[c],p=n[h],g=n[u],m=0,y=a.length;m<y;m++){const[t,e,i,n,s,r]=a[m];if(f>=t&&f<=n&&p>=e&&p<=s&&g>=i&&g<=r){S=!0;break}}s[c]=f,s[h]=p,s[u]=g,s[d]=S?0:n[d]}l?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ue]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lowRed:a=0,lowGreen:l=0,lowBlue:c=0,highRed:h=255,highGreen:u=255,highBlue:d=255,lineOut:f}=t,p=h-a,g=u-l,m=d-c;let y,b,S,k,C,A,v,P,x;for(x=0;x<r;x+=4)y=x,b=y+1,S=b+1,k=S+1,C=n[y],A=n[b],v=n[S],P=n[k],P?(C/=255,A/=255,v/=255,s[y]=a+C*p,s[b]=l+A*g,s[S]=c+v*m):(s[y]=C,s[b]=A,s[S]=v),s[k]=P;f?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ye]:function(t){const e=function(t,e,i){const n=(et(l-t)+et(c-e)+et(h-i))/3;return n<g?0:n>m?255:(n-g)/y*255},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,red:l=0,green:c=255,blue:h=0,opaqueAt:u=1,transparentAt:d=0,lineOut:f}=t,p=pt((l+c+h)/3,(255-l+(255-c)+(255-h))/3),g=d*p,m=u*p,y=m-g;let b,S,k,C,A,v,P,x;for(x=0;x<o;x+=4)b=x,S=b+1,k=S+1,C=k+1,s[C]&&(A=s[b],v=s[S],P=s[k],r[b]=A,r[S]=v,r[k]=P,r[C]=e(A,v,P));f?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[be]:function(t){const e=function(t,e,i){const n=t+1,s=n+1,r=s+1,o=e+1,a=o+1,l=a+1;c[e]=i[t],c[o]=i[n],c[a]=i[s],c[l]=i[r]},i=function(t,e){const i=t-g,n=e-m;let s=-1;return i>=0&&i<h&&n>=0&&n<u&&(s=4*(n*h+i)),[4*(e*o+t),s]},[n,s,r]=this.getInputAndOutputLines(t),{width:o,height:a,data:l}=n,{data:c}=s,{width:h,height:u,data:d}=r,{opacity:f=1,compose:p=zs,offsetX:g=0,offsetY:m=0,lineOut:y}=t,b=(t,e,i,n)=>e*t*n+n*i*(1-e),S=(t,e,i)=>e*t*i,k=(t,e,i)=>e*t*(1-i),C=(t,e,i,n)=>e*t*(1-n)+n*i*e,A=(t,e,i,n)=>e*t*(1-n)+n*i,v=(t,e,i)=>e*t*i,P=(t,e,i)=>i*t*(1-e),x=(t,e,i,n)=>e*t*(1-n)+n*i*(1-e),O=(t,e,i,n)=>e*t+n*i*(1-e);let w,D,F,R,T,H,E,I,B,L,$,M;switch(p){case"source-only":s.data.set(l);break;case"source-atop":for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T>=0&&(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=b(l[w],$,d[T],M),c[D]=b(l[D],$,d[H],M),c[F]=b(l[F],$,d[E],M),c[R]=255*($*M+M*(1-$)));break;case Tn:for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T>=0&&(D=w+1,F=D+1,R=F+1,I=T+3,$=l[R]/255,M=d[I]/255,c[w]=S(l[w],$,M),c[D]=S(l[D],$,M),c[F]=S(l[F],$,M),c[R]=$*M*255);break;case Hn:for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T<0?e(w,w,l):(D=w+1,F=D+1,R=F+1,I=T+3,$=l[R]/255,M=d[I]/255,c[w]=k(l[w],$,M),c[D]=k(l[D],$,M),c[F]=k(l[F],$,M),c[R]=$*(1-M)*255);break;case"destination-only":for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T>=0&&e(T,w,d);break;case"destination-atop":for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T<0?e(w,w,l):(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=C(l[w],$,d[T],M),c[D]=C(l[D],$,d[H],M),c[F]=C(l[F],$,d[E],M),c[R]=255*($*(1-M)+M*$));break;case Re:for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T<0?e(w,w,l):(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=A(l[w],$,d[T],M),c[D]=A(l[D],$,d[H],M),c[F]=A(l[F],$,d[E],M),c[R]=255*($*(1-M)+M));break;case"destination-in":for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T>=0&&(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=v(d[T],$,M),c[D]=v(d[H],$,M),c[F]=v(d[E],$,M),c[R]=$*M*255);break;case Fe:for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T>=0&&(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=P(d[T],$,M),c[D]=P(d[H],$,M),c[F]=P(d[E],$,M),c[R]=M*(1-$)*255);break;case de:break;case"xor":for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T<0?e(w,w,l):(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=x(l[w],$,d[T],M),c[D]=x(l[D],$,d[H],M),c[F]=x(l[F],$,d[E],M),c[R]=255*($*(1-M)+M*(1-$)));break;default:for(L=0;L<a;L++)for(B=0;B<o;B++)[w,T]=i(B,L),T<0?e(w,w,l):(D=w+1,F=D+1,R=F+1,H=T+1,E=H+1,I=E+1,$=l[R]/255,M=d[I]/255,c[w]=O(l[w],$,d[T],M),c[D]=O(l[D],$,d[H],M),c[F]=O(l[F],$,d[E],M),c[R]=255*($+M*(1-$)))}y?this.processResults(s,n,1-f):this.processResults(this.cache.work,s,f)},[ve]:function(t){const e=function(t,e,i){let n,s,r=0,o=255;const a=e.length;for(s=0;s<a;s++)n=t[e[s]+i],n<o?o=n:n>r&&(r=n);switch(d){case"lowest":return o;case"highest":return r;default:return ct(o+(r-o)/2)}},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,includeRed:l=!1,includeGreen:c=!1,includeBlue:h=!1,includeAlpha:u=!0,operation:d=Ci,lineOut:f}=t;let p=t.width;(!dt(p)||p<1)&&(p=3),p=ct(p);let g=t.height;(!dt(g)||g<1)&&(g=3),g=ct(g);let m=t.offsetX;(!dt(m)||m<1)&&(m=1),m=ct(m);let y=t.offsetY;(!dt(y)||y<1)&&(y=1),y=ct(y);const b=this.buildMatrixGrid(p,g,m,y,i),S=ct(o/4);let k,C,A,v,P;for(P=0;P<S;P++)k=4*P,C=k+1,A=C+1,v=A+1,r[k]=l?e(s,b[P],0):s[k],r[C]=c?e(s,b[P],1):s[C],r[A]=h?e(s,b[P],2):s[A],r[v]=u?e(s,b[P],3):s[v];f?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Ee]:function(t){const e=function(t,e,i){t<0?c[e+3]=0:(c[e]=i[t],t++,e++,c[e]=i[t],t++,e++,c[e]=i[t],t++,e++,c[e]=i[t])},i=function(t,e){const i=t+b,n=e+S;let s=-1;return i>=0&&i<h&&n>=0&&n<u&&(s=4*(n*h+i)),[4*(e*o+t),s]},[n,s,r]=this.getInputAndOutputLines(t),{width:o,height:a,data:l}=n,{data:c}=s,{width:h,height:u,data:d}=r,{opacity:f=1,channelX:p=gn,channelY:g=ni,scaleX:m=1,scaleY:y=1,offsetX:b=0,offsetY:S=0,transparentEdges:k=!1,lineOut:C}=t;let A=3;p===gn?A=0:p===ni?A=1:p===zl&&(A=2);let v,P,x,O,w,D,F,R=3;for(g===gn?R=0:g===ni?R=1:g===zl&&(R=2),P=0;P<a;P++)for(v=0;v<o;v++)[D,F]=i(v,P),F>=0?(x=ct(v+(127-d[F+A])/127*m),O=ct(P+(127-d[F+R])/127*y),k?w=x<0||x>=o||O<0||O>=a?-1:4*(O*o+x):(x<0&&(x=0),x>=o&&(x=o-1),O<0&&(O=0),O>=a&&(O=a-1),w=4*(O*o+x)),e(w,D,l)):e(D,D,l);C?this.processResults(s,n,1-f):this.processResults(this.cache.work,s,f)},[Xe]:function(t){const e=function(t,e,i){let n=0;for(let s=0,r=e.length;s<r;s++)m[s]&&(n+=t[e[s]+i]*m[s]);return n},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,tolerance:l=0,keepOnlyChangedAreas:c=!1,postProcessResults:h=!1,lineOut:u}=t,d=et(t.strength||1),f=_s(t.angle||0),p=ct(f/45),g=f%45/45*d,m=new Array(9);m.fill(0,0,9),m[4]=1,0===p?(m[5]=d-g,m[8]=g,m[3]=-m[5],m[0]=-m[8]):1===p?(m[8]=d-g,m[7]=g,m[0]=-m[8],m[1]=-m[7]):2===p?(m[7]=d-g,m[6]=g,m[1]=-m[7],m[2]=-m[6]):3===p?(m[6]=d-g,m[3]=g,m[2]=-m[6],m[5]=-m[3]):4===p?(m[3]=d-g,m[0]=g,m[5]=-m[3],m[8]=-m[0]):5===p?(m[0]=d-g,m[1]=g,m[8]=-m[0],m[7]=-m[1]):6===p?(m[1]=d-g,m[2]=g,m[7]=-m[1],m[6]=-m[2]):(m[2]=d-g,m[5]=g,m[6]=-m[2],m[3]=-m[5]);const y=this.buildMatrixGrid(3,3,1,1,i);let b,S,k,C,A,v,P,x,O,w,D,F,R;for(b=0;b<o;b+=4)S=b,k=S+1,C=k+1,A=C+1,v=s[S],P=s[k],x=s[C],O=s[A],O&&(R=ct(b/4),r[S]=e(s,y[R],0),r[k]=e(s,y[R],1),r[C]=e(s,y[R],2),r[A]=s[A],h&&(w=r[S],D=r[k],F=r[C],w>=v-l&&w<=v+l&&D>=P-l&&D<=P+l&&F>=x-l&&F<=x+l&&(c?r[A]=0:(r[S]=127,r[k]=127,r[C]=127))));u?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Ue]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,red:a=0,green:l=0,blue:c=0,alpha:h=255,excludeAlpha:u=!1,lineOut:d}=t;let f,p,g;for(f=0;f<r;f+=4)g=f+3,n[g]&&(p=f,s[p]=a,p++,s[p]=l,p++,s[p]=c,p++,s[p]=u?n[g]:h);d?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Je]:function(t){let e,i,n,s,r,o,a,l;const c=function(t,e,i,n,s,r){let o,a,l,c,h,u,d,f,p,g,m,y,b,S,k,C,A,v,P,x,O,w,D,F,R,T,H,E,I,B;for(R=0;R<r;R++){for(w=R*s,D=R,F=0,o=t[w],a=255&o,l=o>>8&255,c=o>>16&255,h=o>>24&255,v=a*n[6],P=l*n[6],x=c*n[6],O=h*n[6],S=v,k=P,C=x,A=O,H=n[0],E=n[1],I=n[4],B=n[5],T=0;T<s;T++)o=t[w],u=255&o,d=o>>8&255,f=o>>16&255,p=o>>24&255,g=u*H+a*E+S*I+v*B,m=d*H+l*E+k*I+P*B,y=f*H+c*E+C*I+x*B,b=p*H+h*E+A*I+O*B,v=S,P=k,x=C,O=A,S=g,k=m,C=y,A=b,a=u,l=d,c=f,h=p,i[F]=S,i[F+1]=k,i[F+2]=C,i[F+3]=A,F+=4,w++;for(w--,F-=4,D+=r*(s-1),o=t[w],a=255&o,l=o>>8&255,c=o>>16&255,h=o>>24&255,v=a*n[7],P=l*n[7],x=c*n[7],O=h*n[7],S=v,k=P,C=x,A=O,u=a,d=l,f=c,p=h,H=n[2],E=n[3],T=s-1;T>=0;T--)g=u*H+a*E+S*I+v*B,m=d*H+l*E+k*I+P*B,y=f*H+c*E+C*I+x*B,b=p*H+h*E+A*I+O*B,v=S,P=k,x=C,O=A,S=g,k=m,C=y,A=b,a=u,l=d,c=f,h=p,o=t[w],u=255&o,d=o>>8&255,f=o>>16&255,p=o>>24&255,o=(i[F]+S|0)+(i[F+1]+k<<8)+(i[F+2]+C<<16)+(i[F+3]+A<<24),e[D]=o,w--,F-=4,D-=r}},[h,u]=this.getInputAndOutputLines(t),d=h.data,f=u.data,{width:p,height:g}=h,{opacity:m=1,radius:y=1,lineOut:b}=t,S=new Uint8ClampedArray(d),k=new Uint32Array(S.buffer),C=new Uint32Array(k.length),A=new Float32Array(4*pt(p,g)),v=function(t){t<.5&&(t=.5);const c=jl(.527076)/t,h=jl(-c),u=jl(-2*c),d=(1-h)*(1-h)/(1+2*c*h-u);return e=d,i=d*(c-1)*h,n=d*(c+1)*h,s=-d*u,r=2*h,o=-u,a=(e+i)/(1-r-o),l=(n+s)/(1-r-o),new Float32Array([e,i,n,s,r,o,a,l])}(y);c(k,C,A,v,p,g),c(C,k,A,v,g,p),f.set(S),b?this.processResults(u,h,1-m):this.processResults(this.cache.work,u,m)},[ti]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,o=e.width,a=e.height,{opacity:l=1,useMixedChannel:c=!0,seed:h=we,level:u=0,offsetMin:d=0,offsetMax:f=0,offsetRedMin:p=0,offsetRedMax:g=0,offsetGreenMin:m=0,offsetGreenMax:y=0,offsetBlueMin:b=0,offsetBlueMax:S=0,offsetAlphaMin:k=0,offsetAlphaMax:C=0,transparentEdges:A=!1,lineOut:v}=t;let P=ct(t.step);P<1&&(P=1);const x=this.getRandomNumbers({seed:h,length:5*a}),O=f-d,w=g-p,D=y-m,F=S-b,R=C-k;let T=-1;const H=[];let E,I,B,L,$,M,X,Y,G,j,z,N,V,W,U,Z,_,K,q,Q,J,tt,et,it,nt;for(E=0;E<a;E+=P)if(B=x[++T]<u,B)if(c)for(L=4*(d+ct(x[++T]*O)),I=0;I<P;I++)H.push(L,L,L,L);else for($=4*(p+ct(x[++T]*w)),M=4*(m+ct(x[++T]*D)),X=4*(b+ct(x[++T]*F)),Y=4*(k+ct(x[++T]*R)),I=0;I<P;I++)H.push($,M,X,Y);else for(I=0;I<P;I++)H.push(0,0,0,0);for(E=0;E<r;E+=4)G=E,j=G+1,z=j+1,N=z+1,V=4*o,W=ct(E/V),_=4*W,K=H[_],q=H[++_],Q=H[++_],J=H[++_],tt=G+K,et=j+q,it=z+Q,nt=N+J,s[G]=n[tt],s[j]=n[et],s[z]=n[it],A?(U=W*V,Z=U+V,s[N]=tt<U||tt>Z||et<U||et>Z||it<U||it>Z||nt<U||nt>Z?0:n[nt]):s[N]=n[nt];v?this.processResults(i,e,1-l):this.processResults(this.cache.work,i,l)},[ii]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t,l=this.getGrayscaleValue;let c,h,u,d,f,p;for(f=0;f<r;f+=4)c=f,h=c+1,u=h+1,d=u+1,p=l(n[c],n[h],n[u]),s[c]=p,s[h]=p,s[u]=p,s[d]=n[d];a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[di]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!0,includeGreen:l=!0,includeBlue:c=!0,includeAlpha:h=!1,lineOut:u}=t;let d,f,p,g,m;for(m=0;m<r;m+=4)d=m,f=d+1,p=f+1,g=p+1,s[d]=a?255-n[d]:n[d],s[f]=l?255-n[f]:n[f],s[p]=c?255-n[p]:n[p],s[g]=h?255-n[g]:n[g];u?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[yi]:function(t){const e=function(t,e){if(!e.length)return t;for(let i=0,n=e.length;i<n;i++){const[n,s,r]=e[i];if(t>=n&&t<=s)return r}};this.checkChannelLevelsParameters(t);const[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,red:l=[0],green:c=[0],blue:h=[0],alpha:u=[255],lineOut:d}=t;let f,p,g,m,y;for(y=0;y<o;y+=4)f=y,p=f+1,g=p+1,m=g+1,r[f]=e(s[f],l),r[p]=e(s[p],c),r[g]=e(s[g],h),r[m]=e(s[m],u);d?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Si]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,useNaturalGrayscale:a=!1,gradient:l=!1,lineOut:c}=t;if(l){let t,e,i,o,c,h,u;const d=this.getGradientData(l);if(d.length){const l=this.getGrayscaleValue;for(t=0;t<r;t+=4)i=t,o=i+1,c=o+1,h=c+1,n[h]&&(e=a?l(n[i],n[o],n[c]):ct(.3333*n[i]+.3333*n[o]+.3333*n[c]),u=4*e,s[i]=d[u],u++,s[o]=d[u],u++,s[c]=d[u],u++,s[h]=d[u])}else this.transferDataUnchanged(s,n,r)}else this.transferDataUnchanged(s,n,r);c?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[ki]:function(t){const e=function(t,e,i){let n,s=0;for(let r=0,o=e.length;r<o;r++)y[r]&&(n=e[r]+i,s+=t[n]*y[r]);return s},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,{opacity:a=1,includeRed:l=!0,includeGreen:c=!0,includeBlue:h=!0,includeAlpha:u=!1,offsetX:d=1,offsetY:f=1,lineOut:p}=t;let g=t.width;(!dt(g)||g<1)&&(g=3),g=ct(g);let m=t.height;(!dt(m)||m<1)&&(m=3),m=ct(m);let y=t.weights;y&&y.length===g*m||(y=[].fill(0,0,g*m-1),y[ct(y.length/2)+1]=1);const b=this.buildMatrixGrid(g,m,d,f,i);let S,k,C,A,v;const P=ct(o/4);for(v=0;v<P;v++)S=4*v,k=S+1,C=k+1,A=C+1,s[A]&&(r[S]=l?e(s,b[v],0):s[S],r[k]=c?e(s,b[v],1):s[k],r[C]=h?e(s,b[v],2):s[C],r[A]=u?e(s,b[v],3):s[A]);p?this.processResults(n,i,1-a):this.processResults(this.cache.work,n,a)},[Pi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,channelA:a=0,channelB:l=0,channelL:c=0,lineOut:h}=t,u=this.retrieveColorPointLibraries();let d,f,p,g,m,y,b,S,k,C,A;for(m=0;m<r;m+=4)d=m,f=d+1,p=f+1,g=p+1,n[g]?([y,b,S]=this.getOkColorVals(n[d],n[f],n[p],u),y+=c,y>1?y=1:y<0&&(y=0),b+=a,b>.4?b=.4:b<-.4&&(b=-.4),S+=l,S>.4?S=.4:S<-.4&&(S=-.4),[k,C,A]=this.getRegularColorVals(y,b,S,u),s[d]=k,s[f]=C,s[p]=A,s[g]=n[g]):(s[d]=n[d],s[f]=n[f],s[p]=n[p],s[g]=n[g]);h?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[xi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,red:a=1,green:l=1,blue:c=1,alpha:h=1,saturation:u=!1,lineOut:d}=t;let f,p,g,m,y,b,S,k,C;if(u){const t=this.getGrayscaleValue;for(C=0;C<r;C+=4)f=C,p=f+1,g=p+1,m=g+1,b=n[f],S=n[p],k=n[g],y=t(b,S,k),s[f]=y+(b-y)*a,s[p]=y+(S-y)*l,s[g]=y+(k-y)*c,s[m]=n[m]*h}else for(C=0;C<r;C+=4)f=C,p=f+1,g=p+1,m=g+1,s[f]=n[f]*a,s[p]=n[p]*l,s[g]=n[g]*c,s[m]=n[m]*h;d?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Oi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,channelA:a=1,channelB:l=1,channelL:c=1,lineOut:h}=t,u=this.retrieveColorPointLibraries();let d,f,p,g,m,y,b,S,k,C,A;for(m=0;m<r;m+=4)d=m,f=d+1,p=f+1,g=p+1,n[g]?([y,b,S]=this.getOkColorVals(n[d],n[f],n[p],u),y*=c,y>1?y=1:y<0&&(y=0),b*=a,b>.4?b=.4:b<-.4&&(b=-.4),S*=l,S>.4?S=.4:S<-.4&&(S=-.4),[k,C,A]=this.getRegularColorVals(y,b,S,u),s[d]=k,s[f]=C,s[p]=A,s[g]=n[g]):(s[d]=n[d],s[f]=n[f],s[p]=n[p],s[g]=n[g]);h?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[$i]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t,l=this.retrieveColorPointLibraries();let c,h,u,d,f,p,g,m,y,b,S;for(f=0;f<r;f+=4)c=f,h=c+1,u=h+1,d=u+1,n[d]?([p,,,g,m]=this.getOkColorVals(n[c],n[h],n[u],l),p=1-p,m+=180,[y,b,S]=this.getRegularColorVals(p,g,m,l,!0),s[c]=y,s[h]=b,s[u]=S,s[d]=n[d]):(s[c]=n[c],s[h]=n[h],s[u]=n[u],s[d]=n[d]);a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Xi]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,{opacity:r=1,lineOut:o}=t;let a=ct(t.width||1);a<1&&(a=1);const l=2*a,c=this.buildImageTileSets(l,l,0,0),h=this.getGrayscaleValue,u=ec,d=[],f=[];c.forEach((t=>function(t,e,i){d.length=0,f.length=0;let n,s,r,o,l,c,p=0;const g=i.length;for(n=0;n<g;n++)s=i[n],r=s+1,o=r+1,c=h(t[s],t[r],t[o]),p+=c;p/=g;const m=u[ct(p/255*13)];if(1===a)d.push(...m);else{for(c=m[0],n=0;n<a;n++)f.push(c);for(c=m[1],n=0;n<a;n++)f.push(c);for(n=0;n<a;n++)d.push(...f);for(c=m[2],f.length=0,n=0;n<a;n++)f.push(c);for(c=m[3],n=0;n<a;n++)f.push(c);for(n=0;n<a;n++)d.push(...f)}for(n=0;n<g;n++)c=d[n],s=i[n],r=s+1,o=r+1,l=o+1,e[s]=c,e[r]=c,e[o]=c,e[l]=t[l]}(n,s,t))),o?this.processResults(i,e,1-r):this.processResults(this.cache.work,i,r)},[ji]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,{opacity:r=1,offsetRedX:o=0,offsetRedY:a=0,offsetGreenX:l=0,offsetGreenY:c=0,offsetBlueX:h=0,offsetBlueY:u=0,offsetAlphaX:d=0,offsetAlphaY:f=0,lineOut:p}=t;if(o||l||h||d||a||c||u||f){let t=!1;o===l&&o===h&&o===d&&a===c&&a===u&&a===f&&(t=!0);const i=this.buildImageGrid(e),r=i[0].length,p=i.length;let g,m,y,b,S,k,C,A,v,P;for(let e=0;e<p;e++)for(let x=0;x<r;x++)v=4*i[e][x],t?(g=x+o,m=e+a,g>=0&&g<r&&m>=0&&m<p&&(P=4*i[m][g],s[P]=n[v],s[P+1]=n[v+1],s[P+2]=n[v+2],s[P+3]=n[v+3])):(g=x+o,m=e+a,y=x+l,b=e+c,S=x+h,k=e+u,C=x+d,A=e+f,g>=0&&g<r&&m>=0&&m<p&&(P=4*i[m][g],s[P]=n[v]),y>=0&&y<r&&b>=0&&b<p&&(P=4*i[b][y],s[P+1]=n[v+1]),S>=0&&S<r&&k>=0&&k<p&&(P=4*i[k][S],s[P+2]=n[v+2]),C>=0&&C<r&&A>=0&&A<p&&(P=4*i[A][C],s[P+3]=n[v+3]))}p?this.processResults(i,e,1-r):this.processResults(this.cache.work,i,r)},[qi]:function(t){const e=function(t,e,i,n){let s=i.reduce(((e,i)=>e+t[i+n]),0);s=ct(s/i.length);for(let t=0,r=i.length;t<r;t++)e[i[t]+n]=s},i=function(t,e,i,n){let s;for(let r=0,o=i.length;r<o;r++)s=i[r],e[s+n]=t[s+n]},[n,s]=this.getInputAndOutputLines(t),r=n.data,o=s.data,{opacity:a=1,tileWidth:l=1,tileHeight:c=1,offsetX:h=0,offsetY:u=0,includeRed:d=!0,includeGreen:f=!0,includeBlue:p=!0,includeAlpha:g=!1,lineOut:m}=t;this.buildImageTileSets(l,c,h,u).forEach((t=>{d?e(r,o,t,0):i(r,o,t,0),f?e(r,o,t,1):i(r,o,t,1),p?e(r,o,t,2):i(r,o,t,2),g?e(r,o,t,3):i(r,o,t,3)})),m?this.processResults(s,n,1-a):this.processResults(this.cache.work,s,a)},[rn]:function(t){const{assetData:e,lineOut:i}=t;if(i&&i.substring&&i.length){let{width:t,height:n,data:s}=e;if(t&&n&&s){const{width:e,height:r}=this.cache.source;if(e!==t||r!==n){const i=new ImageData(e,r).data;let o,a,l,c,h=(e-t)/2,u=(r-n)/2;for(h<0&&(h=0),u<0&&(u=0),a=0;a<r;a++)for(o=0;o<e;o++)o<t&&a<n&&(l=4*((a+u)*e+(o+h)),c=4*(a*t+o),i[l]=s[c],l++,c++,i[l]=s[c],l++,c++,i[l]=s[c],l++,c++,i[l]=s[c]);s=i,t=e,n=r}this.cache[i]=new ImageData(s,t,n)}}},[dn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,o=e.width,{opacity:a=1,width:l=1,height:c=1,level:h=.5,seed:u=we,noiseType:d=un,noWrap:f=!1,includeRed:p=!0,includeGreen:g=!0,includeBlue:m=!0,includeAlpha:y=!0,excludeTransparentPixels:b=!0,lineOut:S}=t,k=this.getRandomNumbers({seed:u,length:st(r/4*3),imgWidth:o,type:d});let C,A,v,P,x,O,w,D,F,R,T,H=-1;const E=l/2,I=c/2;for(D=0;D<r;D+=4){if(P=D,x=P+1,O=x+1,w=O+1,d===un)C=k[++H],A=k[++H],v=k[++H];else{const t=k[++H];C=t,A=t,v=t}C<h?(F=ct(A*l-E),R=ct(v*c-I),T=D+4*(R*o+F),f&&(T<0||T>=r)?(s[P]=n[P],s[x]=n[x],s[O]=n[O],s[w]=n[w]):(T<0?T+=r:T>=r&&(T-=r),!b||n[w]&&n[T+3]?(s[P]=p?n[T]:n[P],T++,s[x]=g?n[T]:n[x],T++,s[O]=m?n[T]:n[O],T++,s[w]=y?n[T]:n[w]):(s[P]=n[P],s[x]=n[x],s[O]=n[O],s[w]=n[w]))):(s[P]=n[P],s[x]=n[x],s[O]=n[O],s[w]=n[w])}S?this.processResults(i,e,1-a):this.processResults(this.cache.work,i,a)},[mn]:function(t){const e=(t,e,i)=>65536*t+256*e+i,[i,n]=this.getInputAndOutputLines(t),s=i.data,r=i.width,o=n.data,a=s.length,{opacity:l=1,seed:c=we,useBluenoise:h=!1,minimumColorDistance:u=500,lineOut:d}=t;let{palette:f=Qt}=t;const p=h?ie:t.noiseType||un,g=this.retrieveColorPointLibraries(),m=this.getRandomNumbers({seed:c,length:a/4,imgWidth:r,type:p});let y=-1;(null==f||f.substring&&!ic[f]||ut(f)&&f.length<2||f.toFixed&&(f<2||f>256))&&(f=Qt);const b=Vl.includes(f),S=ut(f),k=[];let C,A,v,P,x,O,w,D,F,R,T,H,E,I,B,L,$,M,X,Y,G,j,z,N,V,W,U,Z,_,K,q;if(b){const{getGrayscaleValue:t}=this;let e,i;for(C=ic[f],A=C.length,v=0;v<a;v+=4)if(O=v,w=O+1,D=w+1,F=D+1,s[F]){for(i=t(s[O],s[w],s[D]),k.length=0,x=0;x<A&&(e=C[x],I=et(e-i),k.push([e,I]),!(x&&I>=k[x-1][1]));x++);k.sort(((t,e)=>t[1]-e[1])),[$,B]=k[0],[M,L]=k[1],X=B+L,Y=X-B,G=m[++y]*X,j=G<Y?$:M,o[O]=j,o[w]=j,o[D]=j,o[F]=s[F]}else++y,o[O]=s[O],o[w]=s[w],o[D]=s[D],o[F]=s[F];ac(f)}else if(S){const t=f.join(jt);if(ic[t])C=ic[t];else{let e,i,n;for(C=[],v=0,P=f.length;v<P;v++)[e,i,n]=rc.getColorFromCanvas(f[v].trim()),E=this.getOkColorVals(e,i,n,g),C.push([e,i,n,...E]);ic[t]=C}for(A=C.length,v=0;v<a;v+=4)if(O=v,w=O+1,D=w+1,F=D+1,s[F]){for(k.length=0,[z,N,V]=this.getOkColorVals(s[O],s[w],s[D],g),x=0;x<A;x++)[,,,W,U,Z]=C[x],_=100*z-100*W,K=125*(N+.4)-125*(U+.4),q=125*(V+.4)-125*(Z+.4),I=Ot(_*_+K*K+q*q),k.push([x,I]);k.sort(((t,e)=>t[1]-e[1])),[$,B]=k[0],[M,L]=k[1],X=B+L,Y=X-B,G=m[++y]*X,j=G<Y?C[$]:C[M],[R,T,H]=j,o[O]=R,o[w]=T,o[D]=H,o[F]=s[F]}else++y,o[O]=s[O],o[w]=s[w],o[D]=s[D],o[F]=s[F];ac(f)}else{const t=Array(16777216);let i,n,r;for(v=0;v<a;v+=4)O=v,w=O+1,D=w+1,F=D+1,R=s[O],T=s[w],H=s[D],s[F]&&(i=e(R,T,H),t[i]?t[i][0]+=1:([_,K,q]=this.getOkColorVals(R,T,H,g),_*=100,K=125*(K+.4),q=125*(q+.4),t[i]=[1,R,T,H,_,K,q]));const l=t.filter((t=>null!=t));l.sort(((t,e)=>e[0]-t[0])),C=[[...l[0]]];const c=[];for(v=1,P=l.length;v<P;v++){for([,,,,z,N,V]=l[v],c.length=0,n=0,r=C.length;n<r;n++)[,,,,W,U,Z]=C[n],_=100*z-100*W,K=125*(N+.4)-125*(U+.4),q=125*(V+.4)-125*(Z+.4),I=Ot(_*_+K*K+q*q),c.push(I);if(c.sort(((t,e)=>t-e)),c[0]>u&&C.push([...l[v]]),C.length>=f)break}for(A=C.length,ac(C.map((t=>`rgb(${t[1]} ${t[2]} ${t[3]})`))),t.forEach((t=>{for([,,,,z,N,V]=t,k.length=0,x=0;x<A;x++)[,,,,W,U,Z]=C[x],_=100*z-100*W,K=125*(N+.4)-125*(U+.4),q=125*(V+.4)-125*(Z+.4),I=Ot(_*_+K*K+q*q),k.push([x,I]);k.sort(((t,e)=>t[1]-e[1])),[$,B]=k[0],[M,L]=k[1],X=B+L,Y=X-B,t.length=0,t.push(X,Y,C[$],C[M])})),v=0;v<a;v+=4)O=v,w=O+1,D=w+1,F=D+1,s[F]?(i=e(s[O],s[w],s[D]),[X,Y,$,M]=t[i],G=m[++y]*X,j=G<Y?$:M,[,R,T,H]=j,o[O]=R,o[w]=T,o[D]=H,o[F]=s[F]):(++y,o[O]=s[O],o[w]=s[w],o[D]=s[D],o[F]=s[F])}d?this.processResults(n,i,1-l):this.processResults(this.cache.work,n,l)},[On]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,angle:a=0,lineOut:l}=t;if(a){const t=this.retrieveColorPointLibraries();let e,i,o,l,c,h,u,d,f,p,g;for(c=0;c<r;c+=4)e=c,i=e+1,o=i+1,l=o+1,n[l]?([h,,,u,d]=this.getOkColorVals(n[e],n[i],n[o],t),d+=a,[f,p,g]=this.getRegularColorVals(h,u,d,t,!0),s[e]=f,s[i]=p,s[o]=g,s[l]=n[l]):(s[e]=n[e],s[i]=n[i],s[o]=n[o],s[l]=n[l])}else this.transferDataUnchanged(s,n,r);l?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Dn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,includeRed:a=!1,includeGreen:l=!1,includeBlue:c=!1,includeAlpha:h=!1,level:u=0,lineOut:d}=t;let f,p,g,m,y;for(y=0;y<r;y+=4)f=y,p=f+1,g=p+1,m=g+1,s[f]=a?u:n[f],s[p]=l?u:n[p],s[g]=c?u:n[g],s[m]=h?u:n[m];d?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Gn]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,red:a=1,green:l=1,blue:c=1,clamp:h=Le,lineOut:u}=t;let d,f,p,g,m;for(m=0;m<r;m+=4){switch(d=m,f=d+1,p=f+1,g=p+1,h){case Es:s[d]=st(n[d]/a)*a,s[f]=st(n[f]/l)*l,s[p]=st(n[p]/c)*c;break;case wn:s[d]=vt(n[d]/a)*a,s[f]=vt(n[f]/l)*l,s[p]=vt(n[p]/c)*c;break;default:s[d]=ct(n[d]/a)*a,s[f]=ct(n[f]/l)*l,s[p]=ct(n[p]/c)*c}s[g]=n[g]}u?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Nn]:function(t){const e=function(t,e){return t.substring?ct(parseFloat(t)/100*e):t},[i,n]=this.getInputAndOutputLines(t),s=i.data,r=n.data,o=s.length,a=i.width,l=i.height,c=new ImageData(a,l),h=c.data,u=c.width,d=c.height,{opacity:f=1,swirls:p=[],lineOut:g}=t;let m,y,b,S,k,C,A,v,P,x,O,w,D,F,R,T,H,E,I,B,L;for(w=0;w<o;w+=4)m=w,y=m+1,b=y+1,S=b+1,h[m]=s[m],h[y]=s[y],h[b]=s[b],h[S]=s[S],r[m]=s[m],r[y]=s[y],r[b]=s[b],r[S]=s[S];if(ut(p)&&p.length){const t=this.buildImageGrid(i);for(k=0,C=p.length;k<C;k++){const[i,n,s,o,c,f]=p[k],g=e(i,a),C=e(n,l);let $=e(o,a),M=e(s,a);if(M>$){const t=M;M=$,$=t}let X=$-M;if(0===X&&(X=.1),v=g-$,v<0&&(v=0),x=g+$,x>u&&(x=u),P=C-$,P<0&&(P=0),O=C+$,O>=d&&(O=d),v<x&&P<O&&v<u&&x>0&&P<d&&O>0){let e=f,u=f;or(e)?u=`ude-${e(0)}-${e(.1)}-${e(.2)}-${e(.3)}-${e(.4)}-${e(.5)}-${e(.6)}-${e(.7)}-${e(.8)}-${e(.9)}-${e(1)}`:e=null!=br[e]?br[e]:br.linear;const d=Ia(`swirl-${i}-${n}-${s}-${o}-${c}-${u}-${a}-${l}`);if(!d.length){const i=_a(),n=_a();for(i.setFromArray([g,C]),w=P;w<O;w++)for(D=v;D<x;D++)A=[D,w],m=4*t[w][D],F=n.set(A).subtract(i).getMagnitude(),F>$?R=m:F<M?(n.rotate(c).add(i),I=ct(n[0]),B=ct(n[1]),I<0?I+=a:I>=a&&(I-=a),B<0?B+=l:B>=l&&(B-=l),R=4*t[B][I]):(L=1-(F-M)/X,L=e(L),n.rotate(c*L).add(i),I=ct(n[0]),B=ct(n[1]),I<0?I+=a:I>=a&&(I-=a),B<0?B+=l:B>=l&&(B-=l),R=4*t[B][I]),d.push(R);Ka(n,i)}let p=-1;for(w=P;w<O;w++)for(D=v;D<x;D++)m=4*t[w][D],y=m+1,b=y+1,S=b+1,R=d[++p],T=R+1,H=T+1,E=H+1,r[m]=h[R],r[y]=h[T],r[b]=h[H],r[S]=h[E];for(w=P;w<O;w++)for(D=v;D<x;D++)m=4*t[w][D],y=m+1,b=y+1,S=b+1,h[m]=r[m],h[y]=r[y],h[b]=r[b],h[S]=r[S]}}}g?this.processResults(n,i,1-f):this.processResults(this.cache.work,n,f)},[ks]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,low:a=[0,0,0,0],high:l=[255,255,255,255],level:c=128,red:h=128,green:u=128,blue:d=128,alpha:f=128,includeRed:p=!0,includeGreen:g=!0,includeBlue:m=!0,includeAlpha:y=!1,useMixedChannel:b=!0,lineOut:S}=t,[k,C,A,v]=a,[P,x,O,w]=l,D=this.getGrayscaleValue;let F,R,T,H,E,I,B,L,$,M;for(E=0;E<r;E+=4)F=E,R=F+1,T=R+1,H=T+1,I=n[F],B=n[R],L=n[T],$=n[H],b?(M=D(I,B,L),M<c?(s[F]=p?k:I,s[R]=g?C:B,s[T]=m?A:L,s[H]=y?v:$):(s[F]=p?P:I,s[R]=g?x:B,s[T]=m?O:L,s[H]=y?w:$)):(s[F]=p?I<h?k:P:I,s[R]=g?B<u?C:x:B,s[T]=m?L<d?A:O:L,s[H]=y?$<f?v:w:$);S?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Cs]:function(t){const e=function(t,e,i,n){let s=i.reduce(((e,i)=>e+t[4*i+n]),0);s=ct(s/i.length);for(let t=0,r=i.length;t<r;t++)e[4*i[t]+n]=s},i=function(t,e,i,n){let s;for(let r=0,o=i.length;r<o;r++)s=4*i[r]+n,e[s]=t[s]},[n,s]=this.getInputAndOutputLines(t),r=n.data,o=s.data,a=r.length,{opacity:l=1,tileWidth:c=1,tileHeight:h=1,tileRadius:u=1,offsetX:d=0,offsetY:f=0,angle:p=0,points:g=fn,seed:m=we,includeRed:y=!0,includeGreen:b=!0,includeBlue:S=!0,includeAlpha:k=!1,lineOut:C}=t,A=this.buildGeneralTileSets(g,c,h,u,d,f,p,m);A.length?A.forEach((t=>{y?e(r,o,t,0):i(r,o,t,0),b?e(r,o,t,1):i(r,o,t,1),S?e(r,o,t,2):i(r,o,t,2),k?e(r,o,t,3):i(r,o,t,3)})):this.transferDataUnchanged(o,r,a),C?this.processResults(s,n,1-l):this.processResults(this.cache.work,s,l)},[As]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,redInRed:a=1,redInGreen:l=0,redInBlue:c=0,greenInRed:h=0,greenInGreen:u=1,greenInBlue:d=0,blueInRed:f=0,blueInGreen:p=0,blueInBlue:g=1,lineOut:m}=t;let y,b,S,k,C,A,v,P;for(C=0;C<r;C+=4)y=C,b=y+1,S=b+1,k=S+1,A=n[y],v=n[b],P=n[S],s[y]=ct(A*a+v*h+P*f),s[b]=ct(A*l+v*u+P*p),s[S]=ct(A*c+v*d+P*g),s[k]=n[k];m?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[Bs]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,lineOut:a}=t;this.transferDataUnchanged(s,n,r),a?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)},[$s]:function(t){const[e,i]=this.getInputAndOutputLines(t),n=e.data,s=i.data,r=n.length,{opacity:o=1,weights:a=[],useMixedChannel:l=!0,lineOut:c}=t;1024!==a.length&&(a.length=1024,a.fill(0));const h=this.getGrayscaleValue;let u,d,f,p,g,m,y,b,S,k,C,A,v,P;for(u=0;u<r;u+=4)d=u,f=d+1,p=f+1,g=p+1,m=n[d],y=n[f],b=n[p],S=n[g],l?(k=h(m,y,b),C=a[4*k+3],A=.2126*C,v=.7152*C,P=.0722*C,s[d]=m+A,s[f]=y+v,s[p]=b+P,s[g]=n[g]):(s[d]=m+a[4*m],s[f]=y+a[4*y+1],s[p]=b+a[4*b+2],s[g]=S+a[4*S+3]);c?this.processResults(i,e,1-o):this.processResults(this.cache.work,i,o)}},vo({name:"SC-core-filters-cleanup-action",order:999,fn:function(){S.forEach((t=>{const e=b[t];e&&(e.dirtyFilterIdentifier=!1)})),L.forEach((t=>{const e=B[t];e&&(e.dirtyFilterIdentifier=!1)}))}}),J.FilterEngine=FilterEngine;const hc=new FilterEngine;function uc(t=tr){t.defs=hr(t.defs,{sourceLoaded:!1,source:null,subscribers:null}),t.packetExclusions=dr(t.packetExclusions,["sourceLoaded","source","subscribers"]),t.finalizePacketOut=function(t){return this.subscribers&&this.subscribers.length&&(t.subscribers=this.subscribers.map((t=>t.name))),t},t.kill=function(t=!1){return t&&this.source&&this.source.remove(),this.deregister()};const e=t.setters;e.source=function(t){t&&this.sourceLoaded&&this.notifySubscribers()},e.subscribers=qs,t.assetConstructor=function(t){return this.makeName(t.name),this.register(),this.subscribers=[],this.set(this.defs),this.source=null,this.currentSrc=null,this.currentFile=null,this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this},t.subscribe=function(t){if(t&&t.name){const e=t.name;this.subscribers.every((t=>t.name!==e))&&this.subscribeAction(t)}},t.subscribeAction=function(t){t&&(this.subscribers.push(t),t.asset=this,t.source=this.source,this.notifySubscriber(t))},t.unsubscribe=function(t){if(t&&t.name){const e=t.name,i=this.subscribers.findIndex((t=>t.name===e));i>=0&&(t.source=null,t.asset=null,t.sourceNaturalHeight=0,t.sourceNaturalWidth=0,t.sourceLoaded=!1,this.subscribers.splice(i,1))}},t.notifySubscribers=function(){this.subscribers.forEach((t=>this.notifySubscriber(t)),this)},t.notifySubscriber=function(t){t.sourceNaturalWidth=this.sourceNaturalWidth,t.sourceNaturalHeight=this.sourceNaturalHeight,t.sourceLoaded=this.sourceLoaded,t.source=this.source,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0,t.dirtyImageSubscribers=!0,t.dirtyFilterIdentifier=!0}}const dc=["IMG","PICTURE"],fc="intrinsic",pc="zero",ImageAsset=function(t=tr){return this.assetConstructor(t)},gc=ImageAsset.prototype=Sr();gc.type=Jn,gc.lib=Vt,gc.isArtefact=!1,gc.isAsset=!0,Co(gc),uc(gc);gc.defs=hr(gc.defs,{intrinsicDimensions:null}),gc.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},gc.stringifyFunction=qs,gc.processPacketOut=qs,gc.finalizePacketOut=qs,gc.clone=Js;const mc=gc.getters,yc=gc.setters;mc.width=function(){return this.sourceNaturalWidth||this.source.naturalWidth||0},mc.height=function(){return this.sourceNaturalHeight||this.source.naturalHeight||0},yc.source=function(t){t&&(dc.includes(t.tagName.toUpperCase())&&(this.source=t,this.sourceNaturalWidth=t.naturalWidth,this.sourceNaturalHeight=t.naturalHeight,this.sourceLoaded=t.complete),this.sourceLoaded&&this.notifySubscribers())},yc.currentSrc=function(t){this.currentSrc=t,this.currentFile=this.currentSrc.split("/").pop()},gc.checkSource=function(t,e){const i=this.source;let n=Me;if(this.sourceLoaded){let s=this.intrinsicDimensions[this.currentFile];switch(this.currentSrc!==i.currentSrc?(this.set({currentSrc:i.currentSrc}),s=this.intrinsicDimensions[this.currentFile],n=s?fc:pc):s&&(n=fc),n){case pc:this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.notifySubscribers();break;case fc:this.sourceNaturalWidth===s[0]&&this.sourceNaturalHeight===s[1]||(this.sourceNaturalWidth=s[0],this.sourceNaturalHeight=s[1],this.notifySubscribers());break;default:this.sourceNaturalWidth===i.naturalWidth&&this.sourceNaturalHeight===i.naturalHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.naturalWidth,this.sourceNaturalHeight=i.naturalHeight,this.notifySubscribers())}}};const bc=[],Sc=[],kc=function(...t){const e=[];return t.forEach((t=>{let i,n,s,r,o=!1,a=!1;if(t.substring){const e=Wt.exec(t);i=e&&e[1]?e[1]:zs,n=t,s=zs,r=!1,a=!0}else(t=!!lr(t)&&t)&&t.src&&(i=t.name||zs,n=t.src,s=t.className||zs,r=t.visibility||!1,t.parent&&(o=document.querySelector(t.parent)),a=!0);if(a){const t=xc({name:i,intrinsicDimensions:{}}),a=document.createElement(hi);a.name=i,a.className=s,a.crossorigin=Yt,a.style.display=r?ee:Yi,o&&o.appendChild(a),a.onload=()=>{t.set({source:a})},a.src=n,t.set({source:a}),e.push(i)}else e.push(!1)})),e},Cc=function(t){document.querySelectorAll(t).forEach((t=>{let e;if(dc.includes(t.tagName.toUpperCase())){if(t.id||t.name)e=t.id||t.name;else{const i=Wt.exec(t.src);e=i&&i[1]?i[1]:zs}let i=t.dataset.dimensions||{};i.substring&&(i=yt(i));const n=xc({name:e,source:t,intrinsicDimensions:i,currentSrc:t.currentSrc});t.onload=()=>{n.set({source:t})}}}))},Ac=function(t,e=!1){let i=t.substring?d[t]||h[t]:t;i.type===Wn&&(i=i.base),i.type===Un&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=e))},vc=function(t,e=!1){let i;t&&!t.substring?t.type===Qn?i=t:t.type===Un?i=A[t.name]:t.type===Wn&&(i=A[t.base.name]):t&&t.substring&&(i=A[t]),i&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=e))},Pc=function(t,e=!1){const i=t.substring?o[t]:t;i.isArtefact&&(i.stashOutput=!0,e&&(i.stashOutputAsAsset=e))},xc=function(t){return!!t&&new ImageAsset(t)};function Oc(t=tr){t.defs=hr(t.defs,{filters:null,isStencil:!1,memoizeFilterOutput:!1});const e=t.setters;e.filters=function(t){t&&(this.filters.length=0,ut(t)||(t=[t]),t.forEach((t=>{t.substring?this.filters.push(t):t.type===qn&&this.filters.push(t.name)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},e.memoizeFilterOutput=function(t){this.memoizeFilterOutput=t,this.updateFilterIdentifier(!!t)},t.updateFilterIdentifier=function(t){this.dirtyFilterIdentifier=!1,this.state&&(this.state.dirtyFilterIdentifier=!1),this.memoizeFilterOutput&&t?this.filterIdentifier=(()=>{function t(){return ct(65536*(1+At())).toString(16).substring(1)}return`${t()}${t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`})():this.filterIdentifier=zs},t.cleanFilters=function(){this.dirtyFilters=!1,this.dirtyFiltersCache=!0;const{filters:t,currentFilters:e}=this;if(t.length){const i=Jr();let n,s,r,o,a,l;for(n=0,s=t.length;n<s;n++)o=t[n],r=b[o],r&&(a=ct(r.order)||0,i[a]||(i[a]=Jr()),i[a].push(r));for(e.length=0,n=0,s=i.length;n<s;n++)l=i[n],l&&(e.push(...l),to(l));to(i)}else e.length=0},t.addFilters=function(...t){return t.forEach((t=>{t&&t.type===qn&&(t=t.name),this.filters.push(t)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.removeFilters=function(...t){return t.forEach((t=>{t&&t.type===qn&&(t=t.name),fr(this.filters,t)}),this),this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.clearFilters=function(){return this.filters.length=0,this.dirtyFilters=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0,this},t.hasFilters=function(){return!!this.filters.length},t.preprocessFilters=function(t){let e,i,n,s,r,o,a,c,h,u,d,f,p,g,m,y;for(e=0,i=t.length;e<i;e++){h=t[e];for(let t=0,e=h.actions.length;t<e;t++)if(u=h.actions[t],u.action===rn){if(n=!0,s=l[u.asset],s&&(Jn!==s.type&&(s.checkSource(),this.dirtyFilterIdentifier=!0),s.type!==ms&&s.type!==ds&&s.type!==is&&s.type!==Un&&s.type!==cs&&s.type!==hs||s.checkSource(),r=s.sourceNaturalWidth,o=s.sourceNaturalHeight,a=s.sourceNaturalDimensions,c=s.currentDimensions,r&&o||(a&&a[0]&&a[1]?(r=r||a[0],o=o||a[1]):c&&c[0]&&c[1]&&(r=r||c[0],o=o||c[1])),r&&o)){n=!1,d=u.copyX||0,f=u.copyY||0,p=u.copyWidth||1,g=u.copyHeight||1,m=u.width||1,y=u.height||1,d.substring&&(d=parseFloat(d)/100*r),f.substring&&(f=parseFloat(f)/100*o),p.substring&&(p=parseFloat(p)/100*r),g.substring&&(g=parseFloat(g)/100*o),m.substring&&(m=parseFloat(m)/100*r),y.substring&&(y=parseFloat(y)/100*o),d=et(d),f=et(f),p=et(p),g=et(g),m=et(m),y=et(y),d>r&&(d=r-2,p=1),f>o&&(f=o-2,g=1),p>r&&(p=r-1,d=0),g>o&&(g=o-1,f=0),d+p>r&&(d=r-p-1),f+g>o&&(f=o-g-1);const t=Va(),e=t.engine,i=t.element;i.width=m,i.height=y,e.setTransform(1,0,0,1,0,0),e.globalCompositeOperation=En,e.globalAlpha=1;const a=s.source||s.element;e.drawImage(a,~~d,~~f,~~p,~~g,0,0,~~m,~~y),u.assetData=e.getImageData(0,0,~~m,~~y),Wa(t)}n&&(u.assetData={width:1,height:1,data:new Uint8ClampedArray(4)})}h.dirtyFilterIdentifier&&(this.dirtyFilterIdentifier=!0)}const b=this.state;if(b)if(b.dirtyFilterIdentifier)this.dirtyFilterIdentifier=!0;else{const{fillStyle:t,strokeStyle:e}=b;(B[t]&&B[t].dirtyFilterIdentifier||B[e]&&B[e].dirtyFilterIdentifier)&&(this.dirtyFilterIdentifier=!0)}(this.dirtyFilterIdentifier||this.state&&this.state.dirtyFilterIdentifier)&&this.updateFilterIdentifier(!0)}}J.ImageAsset=ImageAsset;const wc=["Cell","Stack"],Group=function(t=tr){return this.makeName(t.name),this.register(),this.artefacts=[],this.artefactCalculateBuckets=[],this.artefactStampBuckets=[],this.set(this.defs),this.onEntityHover=qs,this.onEntityNoHover=qs,this.isHovering=null,this.currentHost=null,this.dirtyFilters=!0,this.dirtyFiltersCache=!0,this.filters=[],this.currentFilters=[],this.batchResort=!0,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.dirtyImageSubscribers=!0,this.set(t),this},Dc=Group.prototype=Sr();Dc.type=Qn,Dc.lib="group",Dc.isArtefact=!1,Dc.isAsset=!1,Co(Dc),Oc(Dc);Dc.defs=hr(Dc.defs,{artefacts:null,order:0,visibility:!0,checkForEntityHover:!1,onEntityHover:null,onEntityNoHover:null}),Dc.packetExclusions=dr(Dc.packetExclusions,["artefactCalculateBuckets","artefactStampBuckets","batchResort"]),Dc.packetFunctions=dr(Dc.packetFunctions,["onEntityHover","onEntityNoHover"]),Dc.postCloneAction=function(t,e){let i;return e.host?e.host.substring?i=o[e.host]:e.host.type&&wc.includes(e.host.type)&&(i=e.host):this.currentHost?i=this.currentHost:this.host&&(this.host.substring?i=o[this.host]:this.host.type&&wc.includes(this.host.type)&&(i=this.host)),i&&(i.addGroups(t.name),t.host||(t.host=i.name)),this.onEntityHover&&(t.onEntityHover=this.onEntityHover),this.onEntityNoHover&&(t.onEntityNoHover=this.onEntityNoHover),t},Dc.kill=function(t=!1){t&&this.artefactCalculateBuckets.forEach((t=>t.kill()));const e=this.name;return Dt(o).forEach((t=>{ut(t.groups)&&t.groups.includes(e)&&(fr(t.groups,e),t.batchResort=!0)})),Dt(d).forEach((t=>{ut(t.groups)&&t.groups.includes(e)&&(fr(t.groups,e),t.batchResort=!0)})),this.deregister()},Dc.killArtefacts=function(){return this.artefactCalculateBuckets.forEach((t=>t.kill())),this};const Fc=Dc.getters,Rc=Dc.setters;Fc.artefacts=function(){return[].concat(this.artefacts)},Rc.artefacts=function(t){this.artefacts||(this.artefacts=[]),this.artefacts.length=0,this.addArtefacts(t)},Rc.host=function(t){const e=this.getHost(t);e&&e.addGroups&&(this.host=t,e.addGroups(this.name),this.dirtyHost=!0)},Rc.order=function(t){const e=this.getHost(this.host);this.order=t,e&&e.set({batchResort:!0})},Rc.noFilters=function(t){this.noFilters=t,this.dirtyFilterIdentifier=!0},Dc.getArtefactNames=function(){return[...this.artefacts]},Dc.getHost=function(t){if(t){if(t.type&&wc.includes(t.type))return t;if(t.substring)return o[t]||d[t]}const e=this.currentHost;return e&&e.substring?o[e]||d[e]:e},Dc.forceStamp=function(){const t=this.visibility;this.visibility=!0,this.stamp(),this.visibility=t},Dc.stamp=function(){if(this.dirtyHost||!this.currentHost){this.dirtyHost=!1;const t=this.getHost(this.host);t?this.currentHost=t:this.dirtyHost=!0}if(this.visibility){const{currentHost:t,stashOutput:e,noFilters:i,filters:n}=this;if(t){this.sortArtefacts();let s=null;e||!i&&n&&n.length?s=Va(t.element.width,t.element.height):t.engine&&t.engine.save(),this.prepareStamp(s),this.stampAction(s),s?Wa(s):t.engine&&(t.engine.restore(),t.setEngineFromState(t.engine))}}},Dc.sortArtefacts=function(){if(this.batchResort){this.batchResort=!1;const t=Jr(),e=Jr(),{artefacts:i,artefactCalculateBuckets:n,artefactStampBuckets:s}=this;let r,a,l,c,h,u;for(l=0,c=i.length;l<c;l++)h=i[l],r=o[h],r&&(a=ct(r.calculateOrder),t[a]||(t[a]=Jr()),t[a].push(r),a=ct(r.stampOrder),e[a]||(e[a]=Jr()),e[a].push(r));for(n.length=0,l=0,c=t.length;l<c;l++)u=t[l],u&&(n.push(...u),to(u));for(to(t),s.length=0,l=0,c=e.length;l<c;l++)u=e[l],u&&(s.push(...u),to(u));to(e)}},Dc.prepareStamp=function(t){let e=this.currentHost;t&&(e=t),this.artefactCalculateBuckets.forEach((i=>{i.lib===ze&&(i.currentHost&&i.currentHost.name===e.name||(i.currentHost=e,t||(i.dirtyHost=!0))),i.noDeltaUpdates||i.updateByDelta(),i.prepareStamp()}))},Dc.stampAction=function(t){const{dirtyFilters:e,currentFilters:i,artefactStampBuckets:n,noFilters:s,filters:r,stashOutput:o,currentHost:a}=this;if(!e&&i||this.cleanFilters(),n.forEach((t=>{t&&t.stamp&&t.stamp()})),t)if(!s&&r&&r.length){const e=this.applyFilters(t);o&&this.stashAction(e)}else if(o){const e=t.element,i=t.engine,n=!(!a||!a.engine)&&a.engine;if(n){n.save(),n.globalCompositeOperation=En,n.globalAlpha=1,n.setTransform(1,0,0,1,0,0),n.drawImage(e,0,0),n.restore();const t=i.getImageData(0,0,e.width,e.height);this.stashAction(t)}}},Dc.applyFilters=function(t){const e=this.currentHost,i=Io();if(!e||!t)return!1;const n=e.element,s=e.engine,r=t.element,o=t.engine;this.isStencil&&(o.save(),o.globalCompositeOperation=Tn,o.globalAlpha=1,o.setTransform(1,0,0,1,0,0),o.drawImage(n,0,0),o.restore(),this.dirtyFilterIdentifier=!0),o.setTransform(1,0,0,1,0,0);const a=o.getImageData(0,0,r.width,r.height);this.preprocessFilters(this.currentFilters);const l=hc.action({identifier:this.filterIdentifier,image:a,filters:this.currentFilters});return l&&(o.globalCompositeOperation=En,o.globalAlpha=1,o.setTransform(i,0,0,i,0,0),o.putImageData(l,0,0)),s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,0,0),s.restore(),l},Dc.stashAction=function(t){if(!t)return!1;if(this.stashOutput){this.stashOutput=!1;const[e,i,n,s]=this.getCellCoverage(t),r=Va(),o=r.engine,a=r.element;if(a.width=n,a.height=s,o.putImageData(t,-e,-i),this.stashedImageData=o.getImageData(0,0,n,s),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-groupimage`;if(this.stashOutputAsAsset=!1,this.stashedImage)this.stashedImage.src=a.toDataURL();else{const e=this.currentHost,i=e?e.getController():null;if(i){const e=this,n=document.createElement(hi);n.id=t,n.alt=`A cached image of the ${this.name} Group of entitys`,n.onload=function(){i.canvasHold.appendChild(n),e.stashedImage=n,Cc(`#${t}`)},n.src=a.toDataURL()}}}Wa(r)}},Dc.getCellCoverage=function(t){const{width:e,height:i,data:n}=t;let s,r,o,a,l=0,c=0,h=e,u=i,d=3;for(o=0,a=e*i;o<a;o++)n[d]&&(r=ct(o/e),s=o-r*e,h>s&&(h=s),l<s&&(l=s),u>r&&(u=r),c<r&&(c=r)),d+=4;return h<l&&u<c?[h,u,l-h,c-u]:[0,0,e,i]},Dc.addArtefacts=function(...t){return t&&ut(t[0])&&(t=t[0]),t.forEach((t=>{t&&(t.substring?dr(this.artefacts,t):t.name&&dr(this.artefacts,t.name))}),this),this.batchResort=!0,this},Dc.getArtefact=function(t){return this.artefacts.includes(t)&&o[t]||!1},Dc.removeArtefacts=function(...t){return t.forEach((t=>{t&&(t.substring?fr(this.artefacts,t):t.name&&fr(this.artefacts,t.name))}),this),this.batchResort=!0,this},Dc.moveArtefactsIntoGroup=function(...t){let e,i;return t.forEach((t=>{t&&(i=t.substring?o[t]:t,i&&i.isArtefact&&(e=i.group?i.group:!!i.host&&A[i.host]),e&&(e.removeArtefacts(t),e.batchResort=!0),dr(this.artefacts,t))}),this),this.batchResort=!0,this},Dc.clearArtefacts=function(){return this.artefacts.length=0,this.artefactCalculateBuckets.length=0,this.artefactStampBuckets.length=0,this.batchResort=!0,this},Dc.updateArtefacts=function(t){return this.cascadeAction(t,"setDelta"),this},Dc.setArtefacts=function(t){return this.cascadeAction(t,"set"),this},Dc.updateByDelta=function(){return this.cascadeAction(!1,Is),this},Dc.reverseByDelta=function(){return this.cascadeAction(!1,Cn),this},Dc.addArtefactClasses=function(t){return this.cascadeAction(t,"addClasses"),this},Dc.removeArtefactClasses=function(t){return this.cascadeAction(t,"removeClasses"),this},Dc.cascadeAction=function(t,e){let i;return this.artefacts.forEach((n=>{i=o[n],i&&i[e]&&i[e](t)})),this},Dc.setDeltaValues=function(t=tr){return this.artefactCalculateBuckets.forEach((e=>e.setDeltaValues(t))),this},Dc.addFiltersToEntitys=function(...t){let e;return this.artefacts.forEach((i=>{e=m[i],e&&e.addFilters&&e.addFilters(t)})),this},Dc.removeFiltersFromEntitys=function(...t){let e;return this.artefacts.forEach((i=>{e=m[i],e&&e.removeFilters&&e.removeFilters(t)})),this},Dc.clearFiltersFromEntitys=function(){let t;return this.artefacts.forEach((e=>{t=m[e],t&&t.clearFilters&&t.clearFilters()})),this},Dc.recalculateFonts=function(){let t;return this.artefacts.forEach((e=>{t=m[e],t&&t.recalculateFont&&t.recalculateFont()})),this},Dc.getArtefactAt=function(t){this.sortArtefacts();const e=this.artefactStampBuckets;let i,n;for(let s=e.length-1;s>=0;s--)if(i=e[s],i&&(n=i.checkHit(t),n))return n;return!1},Dc.getAllArtefactsAt=function(t){this.sortArtefacts();const e=this.artefactStampBuckets,i=Jr(),n=[];let s,r,o;for(let a=e.length-1;a>=0;a--)s=e[a],s&&(r=s.checkHit(t),r&&r.artefact&&(o=r.artefact,i.includes(o.name)||(i.push(o.name),n.push(r))));if(to(i),this.checkForEntityHover){const t=!!n.length;this.isHovering!==t&&(this.isHovering=t,t?this.onEntityHover():this.onEntityNoHover())}return n};const Tc=function(t){return!!t&&new Group(t)};J.Group=Group;const Hc="handle",Ec="lockTo",Ic="startX",Bc="startY";function Lc(t=tr){t.defs=hr(t.defs,{group:null,visibility:!0,calculateOrder:0,stampOrder:0,start:null,handle:null,offset:null,dimensions:null,pivoted:null,mimicked:null,particle:null,lockTo:null,bringToFrontOnDrag:!0,ignoreDragForX:!1,ignoreDragForY:!1,scale:1,roll:0,noUserInteraction:!1,noPositionDependencies:!1,noCanvasEngineUpdates:!1,noFilters:!1,noPathUpdates:!1,purge:null}),t.packetExclusions=dr(t.packetExclusions,["pathObject","mimicked","pivoted"]),t.packetExclusionsByRegex=dr(t.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),t.packetCoordinates=dr(t.packetCoordinates,["start","handle","offset"]),t.packetObjects=dr(t.packetObjects,["group"]),t.processPacketOut=function(t,e,i){let n=!0;if(t===Ec)e[0]===Ln&&e[1]===Ln&&(n=!!i.includes(Ec));else this.lib===ze?n=this.processEntityPacketOut(t,e,i):this.isArtefact&&(n=this.processDOMPacketOut(t,e,i));return n},t.handlePacketAnchor=function(t,e){if(this.anchor){const i=yt(this.anchor.saveAsPacket(e))[3];t.anchor=i}if(this.button){const i=yt(this.button.saveAsPacket(e))[3];t.button=i}return t},t.kill=function(t=!1,e=!1){const i=this.name;return Dt(A).forEach((t=>{t.artefacts.includes(i)&&t.removeArtefacts(i)})),this.anchor&&this.demolishAnchor(),this.button&&this.demolishButton(),Dt(o).forEach((t=>{t.name!==i&&(t.pivot&&t.pivot.name===i&&t.set({pivot:!1}),t.mimic&&t.mimic.name===i&&t.set({mimic:!1}),t.path&&t.path.name===i&&t.set({path:!1}),t.generateAlongPath&&t.generateAlongPath.name===i&&t.set({generateAlongPath:!1}),t.generateInArea&&t.generateInArea.name===i&&t.set({generateInArea:!1}),t.artefact&&t.artefact.name===i&&t.set({artefact:!1}),ut(t.pins)&&t.pins.forEach(((e,n)=>{lr(e)&&e.name===i&&t.removePinAt(n)})))})),Dt(E).forEach((t=>{t.checkForTarget(i)&&t.removeFromTargets(this)})),this.factoryKill(t,e),this.deregister(),this},t.factoryKill=qs;const e=t.getters,i=t.setters,n=t.deltaSetters;e.positionX=function(){return this.currentStampPosition[0]},e.positionY=function(){return this.currentStampPosition[1]},e.position=function(){return[].concat(this.currentStampPosition)},e.startX=function(){return this.currentStart[0]},e.startY=function(){return this.currentStart[1]},e.start=function(){return[].concat(this.currentStart)},i.startX=function(t){null!=t&&(this.start[0]=t,this.dirtyStart=!0)},i.startY=function(t){null!=t&&(this.start[1]=t,this.dirtyStart=!0)},i.start=function(t,e){this.setCoordinateHelper(Ln,t,e),this.dirtyStart=!0},n.startX=function(t){const e=this.start;e[0]=Ws(e[0],t),this.dirtyStart=!0},n.startY=function(t){const e=this.start;e[1]=Ws(e[1],t),this.dirtyStart=!0},n.start=function(t,e){this.setDeltaCoordinateHelper(Ln,t,e),this.dirtyStart=!0},e.handleX=function(){return this.currentHandle[0]},e.handleY=function(){return this.currentHandle[1]},e.handle=function(){return[].concat(this.currentHandle)},i.handleX=function(t){null!=t&&(this.handle[0]=t,this.dirtyHandle=!0)},i.handleY=function(t){null!=t&&(this.handle[1]=t,this.dirtyHandle=!0)},i.handle=function(t,e){this.setCoordinateHelper(Hc,t,e),this.dirtyHandle=!0},n.handleX=function(t){const e=this.handle;e[0]=Ws(e[0],t),this.dirtyHandle=!0},n.handleY=function(t){const e=this.handle;e[1]=Ws(e[1],t),this.dirtyHandle=!0},n.handle=function(t,e){this.setDeltaCoordinateHelper(Hc,t,e),this.dirtyHandle=!0},e.offsetX=function(){return this.currentOffset[0]},e.offsetY=function(){return this.currentOffset[1]},e.offset=function(){return[].concat(this.currentOffset)},i.offsetX=function(t){null!=t&&(this.offset[0]=t,this.dirtyOffset=!0)},i.offsetY=function(t){null!=t&&(this.offset[1]=t,this.dirtyOffset=!0)},i.offset=function(t,e){this.setCoordinateHelper(ji,t,e),this.dirtyOffset=!0},n.offsetX=function(t){const e=this.offset;e[0]=Ws(e[0],t),this.dirtyOffset=!0},n.offsetY=function(t){const e=this.offset;e[1]=Ws(e[1],t),this.dirtyOffset=!0},n.offset=function(t,e){this.setDeltaCoordinateHelper(ji,t,e),this.dirtyOffset=!0},e.width=function(){return this.currentDimensions[0]},e.height=function(){return this.currentDimensions[1]},e.dimensions=function(){return[].concat(this.currentDimensions)},i.width=function(t){null!=t&&(this.dimensions[0]=t,this.dirtyDimensions=!0)},i.height=function(t){null!=t&&(this.dimensions[1]=t,this.dirtyDimensions=!0)},i.dimensions=function(t,e){this.setCoordinateHelper(Te,t,e),this.dirtyDimensions=!0},n.width=function(t){const e=this.dimensions;e[0]=Ws(e[0],t),this.dirtyDimensions=!0},n.height=function(t){const e=this.dimensions;e[1]=Ws(e[1],t),this.dirtyDimensions=!0},n.dimensions=function(t,e){this.setDeltaCoordinateHelper(Te,t,e),this.dirtyDimensions=!0},e.order=function(){return this.stampOrder},i.order=function(t){this.calculateOrder=t,this.stampOrder=t},i.particle=function(t){nr(t)&&!t?(this.particle=null,this.lockTo[0]===zi&&(this.lockTo[0]=Ln),this.lockTo[1]===zi&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0):(this.particle=t,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)},i.lockTo=function(t){ut(t)?(this.lockTo[0]=t[0],this.lockTo[1]=t[1]):(this.lockTo[0]=t,this.lockTo[1]=t),this.dirtyLock=!0,this.dirtyStampPositions=!0},i.lockXTo=function(t){this.lockTo[0]=t,this.dirtyLock=!0,this.dirtyStampPositions=!0},i.lockYTo=function(t){this.lockTo[1]=t,this.dirtyLock=!0,this.dirtyStampPositions=!0},e.roll=function(){return this.currentRotation},i.roll=function(t){this.roll=t,this.dirtyRotation=!0},n.roll=function(t){this.roll+=t,this.dirtyRotation=!0},e.scale=function(){return this.currentScale},i.scale=function(t){this.scale=t,this.dirtyScale=!0},n.scale=function(t){this.scale+=t,this.dirtyScale=!0},i.host=function(t){if(t){const e=o[t];e&&e.here?this.host=e.name:this.host=t}else this.host=zs;this.dirtyDimensions=!0,this.dirtyHandle=!0,this.dirtyStart=!0,this.dirtyOffset=!0},i.group=function(t){if(t)if(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring){const e=A[t];this.group=e||t}else if(t.type===Un){const e=A[t.name];this.group=e||t}else this.group=t;this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},i.noFilters=function(t){this.noFilters=t,this.dirtyFilterIdentifier=!0},t.purgeArtefact=function(t){return t.substring&&(t="all"===t?[Ki,Ai,Ni,We]:[t]),ut(t)&&t.forEach((t=>function(t,e){switch(e){case Ki:delete t.pivot,delete t.pivotCorner,delete t.pivotPin,delete t.pivotIndex,delete t.addPivotHandle,delete t.addPivotOffset,delete t.addPivotRotation;break;case Ai:delete t.mimic,delete t.useMimicDimensions,delete t.useMimicScale,delete t.useMimicStart,delete t.useMimicHandle,delete t.useMimicOffset,delete t.useMimicRotation,delete t.useMimicFlip,delete t.addOwnDimensionsToMimic,delete t.addOwnScaleToMimic,delete t.addOwnStartToMimic,delete t.addOwnHandleToMimic,delete t.addOwnOffsetToMimic,delete t.addOwnRotationToMimic;break;case Ni:delete t.path,delete t.pathPosition,delete t.addPathHandle,delete t.addPathOffset,delete t.addPathRotation;break;case We:delete t.filter,delete t.filters,delete t.isStencil}}(this,t))),this},t.initializePositions=function(){this.dimensions=qa(),this.start=qa(),this.handle=qa(),this.offset=qa(),this.currentDimensions=qa(),this.currentStart=qa(),this.currentHandle=qa(),this.currentOffset=qa(),this.currentDragOffset=qa(),this.currentDragCache=qa(),this.currentStartCache=qa(),this.currentStampPosition=qa(),this.currentStampHandlePosition=qa(),this.delta={},this.deltaConstraints={},this.lockTo=[Ln,Ln],this.pivot=null,this.pivoted=[],this.mimic=null,this.mimicked=[],this.relativeCoordinates=[],this.dirtyDimensions=!0,this.dirtyLock=!0,this.dirtyStart=!0,this.dirtyOffset=!0,this.dirtyHandle=!0,this.pathObject=null,this.dirtyPathObject=!0,this.currentHost=null,this.dirtyHost=!0,this.currentScale=1,this.dirtyScale=!0,this.currentRotation=0,this.dirtyRotation=!0,this.dirtyPositionSubscribers=!0,this.dirtyMimicScale=!1,this.dirtyMimicDimensions=!1,this.dirtyMimicOffset=!1,this.dirtyMimicHandle=!1,this.dirtyMimicRotation=!1,this.isBeingDragged=!1,this.initializeDomPositions()},t.initializeDomPositions=qs,t.setCoordinateHelper=function(t,e,i){const n=this[t];ut(e)?(n[0]=e[0],n[1]=e[1]):lr(e)?yr(e.x,e.y)?(n[0]=mr(e.x,n[0]),n[1]=mr(e.y,n[1])):(n[0]=mr(e.width,e.w,n[0]),n[1]=mr(e.height,e.h,n[1])):(n[0]=e,n[1]=i)},t.setDeltaCoordinateHelper=function(t,e,i){const n=this[t],s=n[0],r=n[1];ut(e)?(n[0]=Ws(s,e[0]),n[1]=Ws(r,e[1])):lr(e)?yr(e.x,e.y)?(n[0]=Ws(s,mr(e.x,0)),n[1]=Ws(r,mr(e.y,0))):(n[0]=Ws(s,mr(e.width,e.w,0)),n[1]=Ws(r,mr(e.height,e.h,0))):(n[0]=Ws(s,e),n[1]=Ws(r,i))},t.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=o[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return wo},t.getHere=function(){const t=this.getHost();if(t){if(t.here&&ft(t.here))return t.here;if(t.currentDimensions){const e=t.currentDimensions;if(e)return{w:e[0],h:e[1]}}}return wo},t.cleanPosition=function(t,e,i){for(let n=0;n<2;n++){const s=e[n],r=i[n];s.toFixed?t[n]=s:s===pi||s===vs?t[n]=0:s===vn||s===oe?t[n]=r:s===le?t[n]=r/2:dt(parseFloat(s))?t[n]=parseFloat(s)/100*r:t[n]=0}this.dirtyFilterIdentifier=!0},t.cleanScale=function(){this.dirtyScale=!1;const t=this.scale,e=this.mimic,i=this.currentScale;let n=0;e&&this.useMimicScale?e.currentScale?(n=e.currentScale,this.addOwnScaleToMimic&&(n+=t)):(n=t,this.dirtyMimicScale=!0):n=t,this.currentScale=n,this.dirtyDimensions=!0,this.dirtyHandle=!0,i!==this.currentScale&&(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicScale=!0),this.dirtyFilterIdentifier=!0},t.cleanDimensions=function(){this.dirtyDimensions=!1;const t=this.getHost(),e=this.currentDimensions;if(t){let i,n,s;i=t.currentDimensions?t.currentDimensions:[t.w,t.h],[n,s]=this.dimensions;const[r,o]=e;n.substring&&(n=parseFloat(n)/100*i[0]),s.substring&&(s=s===Ut?0:parseFloat(s)/100*i[1]);const a=this.mimic;i=a&&a.name&&this.useMimicDimensions?a.currentDimensions:null,i?(e[0]=this.addOwnDimensionsToMimic?i[0]+n:i[0],e[1]=this.addOwnDimensionsToMimic?i[1]+s:i[1]):(e[0]=n,e[1]=s),this.cleanDimensionsAdditionalActions(),this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,r===e[0]&&o===e[1]||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0),this.dirtyFilterIdentifier=!0}else this.dirtyDimensions=!0},t.cleanDimensionsAdditionalActions=qs,t.cleanLock=function(){this.dirtyLock=!1,this.dirtyStart=!0,this.dirtyHandle=!0},t.cleanStart=function(){const t=this.getHost();let e=0,i=0;t&&(this.dirtyStart=!1,gr(t.w,t.h)?(e=t.w,i=t.h):t.currentDimensions?[e,i]=t.currentDimensions:this.dirtyStart=!0),this.dirtyStart||(this.cleanPosition(this.currentStart,this.start,[e,i]),this.dirtyStampPositions=!0)},t.cleanOffset=function(){const t=this.getHost();let e=0,i=0;t&&(this.dirtyOffset=!1,gr(t.w,t.h)?(e=t.w,i=t.h):t.currentDimensions?[e,i]=t.currentDimensions:this.dirtyOffset=!0),this.dirtyOffset||(this.cleanPosition(this.currentOffset,this.offset,[e,i]),this.dirtyStampPositions=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicOffset=!0))},t.cleanHandle=function(){this.dirtyHandle=!1,this.cleanPosition(this.currentHandle,this.handle,this.currentDimensions),this.dirtyStampHandlePositions=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicHandle=!0)},t.cleanRotation=function(){this.dirtyRotation=!1;const t=this.roll,e=this.currentRotation,i=this.path,n=this.mimic,s=this.pivot,r=this.lockTo;let o=0;if(i&&r.includes(Ni)){if(o=t,this.addPathRotation){const t=this.getPathData();t&&(o+=t.angle)}}else n&&this.useMimicRotation&&r.includes(Ai)?pr(n.currentRotation)?(o=n.currentRotation,this.addOwnRotationToMimic&&(o+=t)):this.dirtyMimicRotation=!0:(o=t,s&&this.addPivotRotation&&r.includes(Ki)&&(s.type===Kn?o+=s.getUnitAlignment(this.pivotIndex):pr(s.currentRotation)?o+=s.currentRotation:this.dirtyPivotRotation=!0));this.currentRotation=o,o!==e&&(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicRotation=!0),this.dirtyFilterIdentifier=!0},t.cleanStampPositions=function(){this.dirtyStampPositions=!1;const{currentDragOffset:t,currentOffset:e,currentStampPosition:i,currentStart:n,currentStartCache:s}=this,[r,o]=i;if(this.noPositionDependencies)i[0]=n[0],i[1]=n[1];else{const{addOwnOffsetToMimic:r,addOwnStartToMimic:o,addPathOffset:a,addPivotOffset:l,ignoreDragForX:c,ignoreDragForY:h,isBeingDragged:u,lockTo:d,mimic:f,path:p,pivot:g,pivotCorner:m,pivotPin:y,pivotIndex:b,useMimicOffset:S,useMimicStart:k}=this;let C,A=this.particle;const v=function(t){return(t!==Ki||g)&&(t!==Ni||p)&&(t!==Ai||f)&&(t!==zi||P)?t:Ln},x={[Ln]:function(t){t.setFromArray(n).add(e)},[Ni]:function(t){F?(t.setFromVector(F),a||t.subtract(p.currentOffset)):t.setFromArray(n).add(e)},[Ki]:function(t){m&&g.getCornerCoordinate?t.setFromArray(g.getCornerCoordinate(m)):g.type===os?t.setFromArray(g.getPinAt(y)):g.type===Kn?b<0?t.setFromArray(g.layoutTemplate.currentStampPosition):(C=g.getUnitStartAt(b),null!=C?t.setFromArray(C):t.setFromArray(n).add(e)):t.setFromArray(g.currentStampPosition),l||t.subtract(g.currentOffset),t.add(e)},[Ai]:function(t){k||S?(t.setFromArray(f.currentStampPosition),k&&o&&t.add(n),S&&r&&t.add(e),k||t.subtract(f.currentStart).add(n),S||t.subtract(f.currentOffset).add(e)):t.setFromArray(n).add(e)},[zi]:function(t){A.substring&&(A=P[A]),A?t.setFromVector(A.position):t.setFromArray(n).add(e)},[wi]:function(i){i.setFromVector(D),u&&(s.setFromArray(i),i.add(t)),i.add(e)}},O=_a();let w,D,F,R=!1;if(u)O[0]=c?v(d[0]):wi,O[1]=h?v(d[1]):wi,R=!0,this.getCornerCoordinate&&this.cleanPathObject();else for(let t=0;t<2;t++)w=v(d[t]),w===wi&&(R=!0),Ln!==w&&(this.dirtyFilterIdentifier=!0),O[t]=w;R&&(D=this.getHere()),O.includes(Ni)&&(F=this.getPathData());const[T,H]=O,E=_a(),I=_a();x[T](E),T===H?I.setFromArray(E):x[H](I),i[0]=E[0],i[1]=I[1],Ka(O,E,I)}r===i[0]&&o===i[1]||(this.dirtyPositionSubscribers=!0)},t.cleanStampHandlePositions=function(){this.dirtyStampHandlePositions=!1;const t=this.currentStampHandlePosition,e=this.currentHandle,[i,n]=t;if(this.noPositionDependencies)t[0]=e[0],t[1]=e[1];else{const i=this.lockTo,n=this.pivot,s=this.path,r=this.mimic;let o,a;for(let l=0;l<2;l++){switch(o=i[l],o!==Ki||n||(o=Ln),o!==Ni||s||(o=Ln),o!==Ai||r||(o=Ln),a=e[l],Ln!==o&&(this.dirtyFilterIdentifier=!0),o){case Ki:this.addPivotHandle&&(a+=n.currentHandle[l]);break;case Ni:this.addPathHandle&&(a+=s.currentHandle[l]);break;case Ai:this.useMimicHandle&&(a=r.currentHandle[l],this.addOwnHandleToMimic&&(a+=e[l]))}t[l]=a}}this.cleanStampHandlePositionsAdditionalActions(),i===t[0]&&n===t[1]||(this.dirtyPositionSubscribers=!0)},t.cleanStampHandlePositionsAdditionalActions=qs,t.checkHit=function(t=[]){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const e=ut(t)?t:[t];let i=0,n=0;const s=Va(),r=s.engine,o=this.currentStampPosition,a=this.pathObject,l=this.winding;return e.some((t=>{if(ut(t))i=t[0],n=t[1];else{if(!gr(t,t.x,t.y))return!1;i=t.x,n=t.y}return!(!dt(i)||!dt(n))&&(s.rotateDestination(r,...o,this),r.isPointInPath(a,i,n,l))}),this)?(Wa(s),this.checkHitReturn(i,n)):(Wa(s),!1)},t.checkHitReturn=function(t,e){return{x:t,y:e,artefact:this}},t.pickupArtefact=function(t=tr){const{x:e,y:i}=t;if(gr(e,i)){const{bringToFrontOnDrag:t,currentDragOffset:n,currentStart:s,group:r,lockTo:o,mimic:a,pivot:l}=this;this.isBeingDragged=!0,this.currentDragCache.set(this.currentDragOffset),this.relativeCoordinates=[...this.start],o[0]===Ln?n[0]=s[0]-e:o[0]===Ki&&l?n[0]=l.get(Ic)-e:o[0]===Ai&&a&&(n[0]=a.get(Ic)-e),o[1]===Ln?n[1]=s[1]-i:o[1]===Ki&&l?n[1]=l.get(Bc)-i:o[1]===Ai&&a&&(n[1]=a.get(Bc)-i),t&&(this.stampOrder+=9999,r.batchResort=!0),pr(this.dirtyPathObject)&&(this.dirtyPathObject=!0)}return this},t.dropArtefact=function(){const{bringToFrontOnDrag:t,currentDragCache:e,currentDragOffset:i,currentHost:n,currentStartCache:s,group:r,ignoreDragForX:o,ignoreDragForY:a,relativeCoordinates:l,start:c}=this;let h,u,d,f,p,g;return o||(c[0]=s[0]+i[0]),a||(c[1]=s[1]+i[1]),this.dirtyStart=!0,n&&([d,f]=n.get(Te),[h,u]=c,[p,g]=l,!o&&p.substring&&(c[0]=h/d*100+"%"),!a&&g.substring&&(c[1]=u/f*100+"%")),this.relativeCoordinates.length=0,i.set(e),t&&(this.stampOrder-=9999,this.stampOrder<0&&(this.stampOrder=0),r.batchResort=!0),pr(this.dirtyPathObject)&&(this.dirtyPathObject=!0),this.isBeingDragged=!1,this},t.updatePositionSubscribers=function(){this.dirtyPositionSubscribers=!1,this.pivoted&&this.pivoted.length&&this.updatePivotSubscribers(),this.mimicked&&this.mimicked.length&&this.updateMimicSubscribers(),this.pathed&&this.pathed.length&&this.updatePathSubscribers()},t.updatePivotSubscribers=qs,t.updateMimicSubscribers=qs,t.updatePathSubscribers=qs,t.updateImageSubscribers=qs}const $c=["startX","startY","handleX","handleY","offsetX","offsetY","width","height"],Mc="loop",Xc="reverse",Yc=["startY","handleY","offsetY","height"];function Gc(t=tr){t.defs=hr(t.defs,{delta:null,noDeltaUpdates:!1,deltaConstraints:null,checkDeltaConstraints:!1,performDeltaChecks:!1});const e=t.setters;e.delta=function(t=tr){t&&(this.delta=ur(this.delta,t))},e.deltaConstraints=function(t=tr){t&&(this.deltaConstraints=ur(this.deltaConstraints,t))},t.updateByDelta=function(){return this.setDelta(this.delta),this.checkDeltaConstraints&&this.performDeltaConstraintsChecks(),this},t.reverseByDelta=function(){const t={},e=this.delta,i=ft(e),n=i.length;let s,r,o;for(s=0;s<n;s++)r=i[s],o=e[r],o=o.substring?-parseFloat(o)+Vi:-o,t[r]=o;return this.setDelta(t),this.checkDeltaConstraints&&this.performDeltaConstraintsChecks(),this},t.performDeltaConstraintsChecks=function(){const{delta:t,deltaConstraints:e}=this;if(this.performDeltaChecks){const i=ft(e),n=i.length;let s,r,o,a,l,c,h,u,d,f,p,g,m,y,b;for(g=0;g<n;g++)if(s=i[g],o=e[s],ut(o)&&3===o.length)if([a,l,c]=e[s],a.substring){if(r=$c.indexOf(s),d=!1,f=0,r>=0?(r<2?d=this.start:r<4?d=this.handle:r<6?d=this.offset:r<8&&(d=this.dimensions),Yc.includes(s)&&(f=1),p=d[f]):p=this.get(s),m=parseFloat(a),y=parseFloat(l),b=parseFloat(p),h=zs,b<m?(h=c,u=0):b>y&&(h=c,u=1),h)switch(h){case Xc:t[s]=-parseFloat(t[s])+Vi,this.set({[s]:b+parseFloat(t[s])+Vi});break;case Mc:u?this.set({[s]:b-(y-m)+Vi}):this.set({[s]:b+(y-m)+Vi})}}else if(p=this.get(s),h=zs,p<a?(h=c,u=0):p>l&&(h=c,u=1),h)switch(h){case Xc:t[s]=-t[s],this.set({[s]:p+t[s]});break;case Mc:u?this.set({[s]:p-(l-a)}):this.set({[s]:p+(l-a)})}}else this.performDeltaChecks=!0},t.setDeltaValues=function(t=tr){const e=this.delta,i=ft(t),n=i.length;let s,r,o,a,l,c;for(s=0;s<n;s++)switch(r=i[s],o=t[r],c=e[r],o.includes(":")?[a,l]=o.split(":"):(a=o,l=!1),a){case"newString":null!=l&&(e[r]=l);break;case"newNumber":null!=l&&(e[r]=parseFloat(l));break;case"remove":delete e[r];break;case"update":null!=l&&(e[r]=c.substring?l:parseFloat(l));break;case Xc:l=c.substring?-parseFloat(c)+Vi:-c,e[r]=l;break;case"add":c.substring?l=parseFloat(c)+parseFloat(l)+Vi:l+=c,e[r]=l;break;case Bi:c.substring?l=parseFloat(c)*parseFloat(l)+Vi:l*=c,e[r]=l}return this}}function jc(t=tr){const e={pivot:zs,pivotCorner:zs,pivotPin:0,pivotIndex:-1,addPivotHandle:!1,addPivotOffset:!0,addPivotRotation:!1};t.defs=hr(t.defs,e),t.packetObjects=dr(t.packetObjects,["pivot"]);const i=t.setters;i.pivot=function(t){if(nr(t)&&!t)this.pivot=null,this.lockTo[0]===Ki&&(this.lockTo[0]=Ln),this.lockTo[1]===Ki&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.pivot,i=this.name;let n=t.substring?o[t]:t;n||(n=l[t],n&&n.type!==Un&&(n=!1)),n&&n.name&&(e&&e.name!==n.name&&fr(e.pivoted,i),dr(n.pivoted,i),this.pivot=n,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}},i.pivotCorner=function(t){Ce.includes(t)&&(this.pivotCorner=t),this.dirtyStart=!0},i.pivotIndex=function(t){this.pivotIndex=t,this.dirtyStart=!0},i.addPivotHandle=function(t){this.addPivotHandle=t,this.dirtyHandle=!0},i.addPivotOffset=function(t){this.addPivotOffset=t,this.dirtyOffset=!0},i.addPivotRotation=function(t){this.addPivotRotation=t,this.dirtyRotation=!0},t.updatePivotSubscribers=function(){let t;this.pivoted.forEach((e=>{t=o[e],t||(t=l[e],t&&t.type===Un||(t=!1)),t&&(t.dirtyStart=!0,t.addPivotHandle&&(t.dirtyHandle=!0),t.addPivotOffset&&(t.dirtyOffset=!0),t.addPivotRotation&&(t.dirtyRotation=!0),t.type===os?t.dirtyPins=!0:t.type!==es&&t.type!==as&&t.type!==Vn||t.dirtyPins.push(this.name))}),this)}}function zc(t=tr){const e={mimic:zs,useMimicDimensions:!1,useMimicScale:!1,useMimicStart:!1,useMimicHandle:!1,useMimicOffset:!1,useMimicRotation:!1,useMimicFlip:!1,addOwnDimensionsToMimic:!1,addOwnScaleToMimic:!1,addOwnStartToMimic:!1,addOwnHandleToMimic:!1,addOwnOffsetToMimic:!1,addOwnRotationToMimic:!1};t.defs=hr(t.defs,e),t.packetObjects=dr(t.packetObjects,["mimic"]);const i=t.setters;i.mimic=function(t){if(nr(t)&&!t)this.mimic=null,this.lockTo[0]===Ai&&(this.lockTo[0]=Ln),this.lockTo[1]===Ai&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.mimic,i=this.name;let n=t.substring?o[t]:t;n||(n=l[t],n&&n.type!==Un&&(n=!1)),n&&n.name&&(e&&e.name!==n.name&&fr(e.mimicked,i),dr(n.mimicked,i),this.mimic=n,this.useMimicDimensions&&(this.dirtyDimensions=!0),this.useMimicScale&&(this.dirtyScale=!0),this.useMimicStart&&(this.dirtyStart=!0),this.useMimicHandle&&(this.dirtyHandle=!0),this.useMimicOffset&&(this.dirtyOffset=!0),this.useMimicRotation&&(this.dirtyRotation=!0))}},i.useMimicDimensions=function(t){this.useMimicDimensions=t,this.dirtyDimensions=!0},i.useMimicScale=function(t){this.useMimicScale=t,this.dirtyScale=!0},i.useMimicStart=function(t){this.useMimicStart=t,this.dirtyStart=!0},i.useMimicHandle=function(t){this.useMimicHandle=t,this.dirtyHandle=!0},i.useMimicOffset=function(t){this.useMimicOffset=t,this.dirtyOffset=!0},i.useMimicRotation=function(t){this.useMimicRotation=t,this.dirtyRotation=!0},i.addOwnDimensionsToMimic=function(t){this.addOwnDimensionsToMimic=t,this.dirtyDimensions=!0},i.addOwnScaleToMimic=function(t){this.addOwnScaleToMimic=t,this.dirtyScale=!0},i.addOwnStartToMimic=function(t){this.addOwnStartToMimic=t,this.dirtyStart=!0},i.addOwnHandleToMimic=function(t){this.addOwnHandleToMimic=t,this.dirtyHandle=!0},i.addOwnOffsetToMimic=function(t){this.addOwnOffsetToMimic=t,this.dirtyOffset=!0},i.addOwnRotationToMimic=function(t){this.addOwnRotationToMimic=t,this.dirtyRotation=!0},t.updateMimicSubscribers=function(){const t=this.dirtyMimicHandle,e=this.dirtyMimicOffset,i=this.dirtyMimicRotation,n=this.dirtyMimicScale,s=this.dirtyMimicDimensions;let r;this.mimicked.forEach((a=>{r=o[a],r||(r=l[a],r&&r.type===Un||(r=!1)),r&&(r.useMimicStart&&(r.dirtyStart=!0),t&&r.useMimicHandle&&(r.dirtyHandle=!0),e&&r.useMimicOffset&&(r.dirtyOffset=!0),i&&r.useMimicRotation&&(r.dirtyRotation=!0),n&&r.useMimicScale&&(r.dirtyScale=!0),s&&r.useMimicDimensions&&(r.dirtyDimensions=!0))})),this.dirtyMimicHandle=!1,this.dirtyMimicOffset=!1,this.dirtyMimicRotation=!1,this.dirtyMimicScale=!1,this.dirtyMimicDimensions=!1}}function Nc(t=tr){const e={path:zs,pathPosition:0,addPathHandle:!1,addPathOffset:!0,addPathRotation:!1,constantSpeedAlongPath:!1};t.defs=hr(t.defs,e),t.packetObjects=dr(t.packetObjects,["path"]);const i=t.setters,n=t.deltaSetters;i.path=function(t){if(nr(t)&&!t)this.path=null,this.lockTo[0]===Ni&&(this.lockTo[0]=Ln),this.lockTo[1]===Ni&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.path,i=t.substring?o[t]:t,n=this.name;i&&i.name&&i.useAsPath&&(e&&e.name!==i.name&&fr(e.pathed,n),dr(i.pathed,n),this.path=i,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}},i.pathPosition=function(t){t<0&&(t=et(t)),t>1&&(t%=1),this.pathPosition=t,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0,this.currentPathData=!1},n.pathPosition=function(t){let e=this.pathPosition+t;e<0&&(e+=1),e>1&&(e%=1),this.pathPosition=e,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0,this.currentPathData=!1},i.addPathHandle=function(t){this.addPathHandle=t,this.dirtyHandle=!0},i.addPathOffset=function(t){this.addPathOffset=t,this.dirtyOffset=!0},i.addPathRotation=function(t){this.addPathRotation=t,this.dirtyRotation=!0},t.getPathData=function(){if(this.currentPathData)return this.currentPathData;const t=this.path;if(t){const e=t.getPathPositionData(this.pathPosition,this.constantSpeedAlongPath);return this.addPathRotation&&(this.dirtyRotation=!0),this.currentPathData=e,e}return!1}}const Vc=["anchor","anchorHref","anchorName","anchorDescription","anchorType","anchorTarget","anchorTabOrder","anchorDisabled","anchorRel","anchorReferrerPolicy","anchorPing","anchorHreflang","anchorDownload","anchorFocusAction","anchorBlurAction","anchorClickAction"],Wc=["button","buttonName","buttonAutofocus","buttonDescription","buttonDisabled","buttonTabOrder","buttonForm","buttonFormAction","buttonFormEnctype","buttonFormMethod","buttonFormNoValidate","buttonFormTarget","buttonElementName","buttonPopoverTarget","buttonPopoverTargetAction","buttonElementType","buttonElementValue","buttonFocusAction","buttonBlurAction","buttonClickAction"];function Uc(t=tr){t.getCanvasNavElement=function(){const t=this.currentHost;if(t){if(t.type===Wn)return t.navigation;if(t.type===Un){const e=t.currentHost?t.currentHost:h[t.host];if(e&&e.type===Wn)return e.navigation}}return null},t.getCanvasWrapper=function(){const t=this.currentHost;if(t){if(t.type===Wn)return t;if(t.type===Un){const e=t.currentHost?t.currentHost:h[t.host];if(e&&e.type===Wn)return e}}return null},t.prepareStampTabsHelper=function(){this.anchor&&this.rebuildAnchor(),this.button&&this.rebuildButton()},t.modifyConstructorInputForAnchorButton=function(t){const e=ft(t);let i=!1;for(let t=0,n=Vc.length;t<n;t++)if(e.includes(Vc[t])){i=!0;break}let n=!1;for(let t=0,i=Wc.length;t<i;t++)if(e.includes(Wc[t])){n=!0;break}if(i){const e=t.anchor||{};null!=t.anchorHref&&(e.href=t.anchorHref,delete t.anchorHref),null!=t.anchorName&&(e.name=t.anchorName,delete t.anchorName),null!=t.anchorDescription&&(e.description=t.anchorDescription,delete t.anchorDescription),null!=t.anchorType&&(e.anchorType=t.anchorType,delete t.anchorType),null!=t.anchorTarget&&(e.target=t.anchorTarget,delete t.anchorTarget),null!=t.anchorTabOrder&&(e.tabOrder=t.anchorTabOrder,delete t.anchorTabOrder),null!=t.anchorDisabled&&(e.disabled=t.anchorDisabled,delete t.anchorDisabled),null!=t.anchorRel&&(e.rel=t.anchorRel,delete t.anchorRel),null!=t.anchorReferrerPolicy&&(e.referrerPolicy=t.anchorReferrerPolicy,delete t.anchorReferrerPolicy),null!=t.anchorPing&&(e.ping=t.anchorPing,delete t.anchorPing),null!=t.anchorHreflang&&(e.hrefLang=t.anchorHreflang,delete t.anchorHreflang),null!=t.anchorDownload&&(e.download=t.anchorDownload,delete t.anchorDownload),null!=t.anchorFocusAction&&(e.focusAction=t.anchorFocusAction,delete t.anchorFocusAction),null!=t.anchorBlurAction&&(e.blurAction=t.anchorBlurAction,delete t.anchorBlurAction),null!=t.anchorClickAction&&(e.clickAction=t.anchorClickAction,delete t.anchorClickAction),t.anchor=e}if(n){const e=t.button||{};null!=t.buttonName&&(e.name=t.buttonName,delete t.buttonName),null!=t.buttonAutofocus&&(e.autofocus=t.buttonAutofocus,delete t.buttonAutofocus),null!=t.buttonDescription&&(e.description=t.buttonDescription,delete t.buttonDescription),null!=t.buttonDisabled&&(e.disabled=t.buttonDisabled,delete t.buttonDisabled),null!=t.buttonTabOrder&&(e.tabOrder=t.buttonTabOrder,delete t.buttonTabOrder),null!=t.buttonForm&&(e.form=t.buttonForm,delete t.buttonForm),null!=t.buttonFormAction&&(e.formAction=t.buttonFormAction,delete t.buttonFormAction),null!=t.buttonFormEnctype&&(e.formEncType=t.buttonFormEnctype,delete t.buttonFormEnctype),null!=t.buttonFormMethod&&(e.formMethod=t.buttonFormMethod,delete t.buttonFormMethod),null!=t.buttonFormNoValidate&&(e.formNoValidate=t.buttonFormNoValidate,delete t.buttonFormNoValidate),null!=t.buttonFormTarget&&(e.formTarget=t.buttonFormTarget,delete t.buttonFormTarget),null!=t.buttonElementName&&(e.elementName=t.buttonElementName,delete t.buttonElementName),null!=t.buttonPopoverTarget&&(e.popoverTarget=t.buttonPopoverTarget,delete t.buttonPopoverTarget),null!=t.buttonPopoverTargetAction&&(e.popoverTargetAction=t.buttonPopoverTargetAction,delete t.buttonPopoverTargetAction),null!=t.buttonElementType&&(e.elementType=t.buttonElementType,delete t.buttonElementType),null!=t.buttonElementValue&&(e.elementValue=t.buttonElementValue,delete t.buttonElementValue),null!=t.buttonFocusAction&&(e.focusAction=t.buttonFocusAction,delete t.buttonFocusAction),null!=t.buttonBlurAction&&(e.blurAction=t.buttonBlurAction,delete t.buttonBlurAction),null!=t.buttonClickAction&&(e.clickAction=t.buttonClickAction,delete t.buttonClickAction),t.button=e}}}const Anchor=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.host=t.host,this.controller=t.controller,this.hold=t.hold,this.clickAction=null,this.domElement=null,this.hasBeenRecentlyClicked=null,this.set(t),this.dirtyAnchor=!0,this},Zc=Anchor.prototype=Sr();Zc.type="Anchor",Zc.lib=Mt,Zc.isArtefact=!1,Zc.isAsset=!1,Co(Zc);const _c={host:null,description:zs,disabled:!1,tabOrder:0,download:zs,href:zs,hreflang:zs,ping:zs,referrerpolicy:zs,rel:"noreferrer",target:"_blank",anchorType:zs,clickAction:null,focusAction:!0,blurAction:!0};Zc.defs=hr(Zc.defs,_c),Zc.packetExclusions=dr(Zc.packetExclusions,["domElement"]),Zc.packetObjects=dr(Zc.packetObjects,["host"]),Zc.packetFunctions=dr(Zc.packetFunctions,["clickAction"]),Zc.demolish=function(){const{host:t,controller:e,domElement:i,hold:n,clickAction:s,focusAction:r,blurAction:o}=this;i&&s&&i.removeEventListener(fe,s,!1),t&&i&&r&&i.removeEventListener(Ze,(()=>t.onEnter()),!1),t&&i&&o&&i.removeEventListener(ne,(()=>t.onLeave()),!1),n&&i&&n.removeChild(i),e&&(e.dirtyNavigationTabOrder=!0),t&&(t.anchor=null),this.deregister()},Zc.set=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==Li&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Ts&&(this[i]=n));this.dirtyAnchor=!0}return this},Zc.build=function(){const{host:t}=this;if(t){this.controller||(this.controller=t.getCanvasWrapper()),this.hold||(this.hold=t.getCanvasNavElement());const{hold:e,controller:i}=this;if(e&&i){const{anchorType:n,blurAction:s,clickAction:r,description:o,disabled:a,download:l,focusAction:c,href:h,hreflang:u,name:d,ping:f,referrerpolicy:p,rel:g,tabOrder:m,target:y}=this;let b=this.domElement;b&&(r&&b.removeEventListener(fe,r,!1),c&&b.removeEventListener(Ze,(()=>t.onEnter()),!1),s&&b.removeEventListener(ne,(()=>t.onLeave()),!1),e.removeChild(b),this.domElement=null),a||(b=document.createElement("a"),b.id=d,l&&b.setAttribute($e,l),h&&b.setAttribute(ai,h),u&&b.setAttribute(li,u),f&&b.setAttribute(_i,f),p&&b.setAttribute(yn,p),g&&b.setAttribute(bn,g),y&&b.setAttribute(Ss,y),n&&b.setAttribute(Rs,n),b.setAttribute(xe,m),r&&or(r)&&b.addEventListener(fe,r,!1),o&&(b.textContent=o),c&&b.addEventListener(Ze,(()=>t.onEnter()),!1),s&&b.addEventListener(ne,(()=>t.onLeave()),!1),this.domElement=b,e.appendChild(b)),i.dirtyNavigationTabOrder=!0}}},Zc.rebuild=function(){this.dirtyAnchor&&(this.build(),this.dirtyAnchor=!1)},Zc.click=function(){if(this.hasBeenRecentlyClicked)return!1;{const t=new MouseEvent(fe,{view:window,bubbles:!0,cancelable:!0});this.hasBeenRecentlyClicked=!0;const e=this;return setTimeout((()=>e.hasBeenRecentlyClicked=!1),200),this.domElement.dispatchEvent(t)}};J.Anchor=Anchor;const Kc="anchorType";function qc(t=tr){t.defs=hr(t.defs,{anchor:null}),t.demolishAnchor=function(){this.anchor&&this.anchor.demolish()};const e=t.getters,i=t.setters;e.anchorName=function(){return this.anchorGetHelper(Li)},e.anchorDescription=function(){return this.anchorGetHelper(De)},i.anchorDescription=function(t){this.anchorSetHelper(De,t)},e.anchorType=function(){return this.anchorGetHelper(Kc)},i.anchorType=function(t){this.anchorSetHelper(Kc,t)},e.anchorTarget=function(){return this.anchorGetHelper(Ss)},i.anchorTarget=function(t){this.anchorSetHelper(Ss,t)},e.anchorTabOrder=function(){return this.anchorGetHelper(bs)},i.anchorTabOrder=function(t){this.anchorSetHelper(bs,t)},e.anchorDisabled=function(){return this.anchorGetHelper(He)},i.anchorDisabled=function(t){this.anchorSetHelper(He,t)},e.anchorRel=function(){return this.anchorGetHelper(bn)},i.anchorRel=function(t){this.anchorSetHelper(bn,t)},e.anchorReferrerPolicy=function(){return this.anchorGetHelper(yn)},i.anchorReferrerPolicy=function(t){this.anchorSetHelper(yn,t)},e.anchorPing=function(){return this.anchorGetHelper(_i)},i.anchorPing=function(t){this.anchorSetHelper(_i,t)},e.anchorHreflang=function(){return this.anchorGetHelper(li)},i.anchorHreflang=function(t){this.anchorSetHelper(li,t)},e.anchorHref=function(){return this.anchorGetHelper(ai)},i.anchorHref=function(t){this.anchorSetHelper(ai,t)},e.anchorDownload=function(){return this.anchorGetHelper($e)},i.anchorDownload=function(t){this.anchorSetHelper($e,t)},i.anchorFocusAction=function(t){this.anchorSetHelper(_e,t)},i.anchorBlurAction=function(t){this.anchorSetHelper(se,t)},i.anchorClickAction=function(t){this.anchorSetHelper(pe,t)},i.anchor=function(t){this.anchor?this.anchor.set(t):this.buildAnchor(t)},t.anchorGetHelper=function(t){return this.anchor?this.anchor.get(t):null},t.anchorSetHelper=function(t,e){this.anchor||this.buildAnchor({[t]:e}),this.anchor&&this.anchor.set({[t]:e})},t.buildAnchor=function(t={}){this.anchor&&this.anchor.demolish(),t.anchorName||(t.anchorName=`${this.name}-anchor`),t.description||(t.description=`Anchor link for ${this.name} ${this.type}`),t.host=this,t.controller=this.getCanvasWrapper(),t.hold=this.getCanvasNavElement(),this.anchor=function(t){return!!t&&new Anchor(t)}(t)},t.rebuildAnchor=function(){this.anchor&&this.anchor.rebuild()},t.clickAnchor=function(){this.anchor&&this.anchor.click()}}const Qc="button",Button=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.host=t.host,this.controller=t.controller,this.hold=t.hold,this.clickAction=null,this.domElement=null,this.hasBeenRecentlyClicked=!1,this.set(t),this.dirtyButton=!0,this},Jc=Button.prototype=Sr();Jc.type="Button",Jc.lib=Mt,Jc.isArtefact=!1,Jc.isAsset=!1,Co(Jc);const th={host:null,description:zs,tabOrder:0,autofocus:!1,disabled:!1,form:zs,formAction:zs,formEnctype:zs,formMethod:zs,formNoValidate:!1,formTarget:zs,popoverTarget:zs,popoverTargetAction:zs,elementType:Qc,elementValue:zs,clickAction:null,focusAction:!0,blurAction:!0};Jc.defs=hr(Jc.defs,th),Jc.packetExclusions=dr(Jc.packetExclusions,["domElement"]),Jc.packetObjects=dr(Jc.packetObjects,["host"]),Jc.packetFunctions=dr(Jc.packetFunctions,["clickAction"]),Jc.demolish=function(){const{host:t,controller:e,domElement:i,hold:n,clickAction:s,focusAction:r,blurAction:o}=this;i&&s&&i.removeEventListener(fe,s,!1),t&&i&&r&&i.removeEventListener(Ze,(()=>t.onEnter()),!1),t&&i&&o&&i.removeEventListener(ne,(()=>t.onLeave()),!1),n&&i&&n.removeChild(i),e&&(e.dirtyNavigationTabOrder=!0),t&&(t.button=null),this.deregister()},Jc.set=function(t=tr){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!==Li&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!==Ts&&(this[i]=n));this.dirtyButton=!0}return this},Jc.build=function(){const{host:t}=this;if(t){this.controller||(this.controller=t.getCanvasWrapper()),this.hold||(this.hold=t.getCanvasNavElement());const{hold:e,controller:i}=this;if(e&&i){const{autofocus:n,blurAction:s,clickAction:r,description:o,disabled:a,elementType:l,elementValue:c,focusAction:h,form:u,formAction:d,formEnctype:f,formMethod:p,formNoValidate:g,formTarget:m,name:y,popoverTarget:b,popoverTargetAction:S,tabOrder:k}=this;let C=this.domElement;C&&e&&(r&&C.removeEventListener(fe,r,!1),h&&C.removeEventListener(Ze,(()=>t.onEnter()),!1),s&&C.removeEventListener(ne,(()=>t.onLeave()),!1),e.removeChild(C),this.domElement=null),a||(C=document.createElement(Qc),C.id=y,n&&C.setAttribute(Zt,zs),a&&C.setAttribute(He,zs),u&&C.setAttribute(qe,u),d&&C.setAttribute("formaction",d),f&&C.setAttribute("formenctype",f),p&&C.setAttribute("formmethod",p),g&&C.setAttribute("formnovalidate",zs),m&&C.setAttribute(Ss,m),b&&C.setAttribute("popovertarget",b),S&&C.setAttribute("popovertargetaction",S),null!=c&&C.setAttribute(Ls,c),l?C.setAttribute(Rs,l):C.setAttribute(Rs,Qc),C.setAttribute(xe,k),r&&or(r)&&C.addEventListener(fe,r,!1),o&&(C.textContent=o),h&&C.addEventListener(Ze,(()=>t.onEnter()),!1),s&&C.addEventListener(ne,(()=>t.onLeave()),!1),this.domElement=C,e.appendChild(C)),i.dirtyNavigationTabOrder=!0}}},Jc.rebuild=function(){this.dirtyButton&&(this.build(),this.dirtyButton=!1)},Jc.click=function(){if(this.hasBeenRecentlyClicked)return!1;{const t=new MouseEvent(fe,{view:window,bubbles:!0,cancelable:!0});this.hasBeenRecentlyClicked=!0;const e=this;return setTimeout((()=>e.hasBeenRecentlyClicked=!1),200),this.domElement.dispatchEvent(t)}};J.Button=Button;const eh="elementType",ih="elementValue",nh="formAction",sh="formEnctype",rh="formMethod",oh="formNoValidate",ah="formTarget",lh="popoverTarget",ch="popoverTargetAction";function hh(t=tr){t.defs=hr(t.defs,{button:null}),t.demolishButton=function(){this.button&&this.button.demolish()};const e=t.getters,i=t.setters;e.buttonName=function(){return this.buttonGetHelper(Li)},e.buttonAutofocus=function(){return this.buttonGetHelper(Zt)},i.buttonAutofocus=function(t){this.buttonSetHelper(Zt,t)},e.buttonDescription=function(){return this.buttonGetHelper(De)},i.buttonDescription=function(t){this.buttonSetHelper(De,t)},e.buttonDisabled=function(){return this.buttonGetHelper(He)},i.buttonDisabled=function(t){this.buttonSetHelper(He,t)},e.buttonTabOrder=function(){return this.buttonGetHelper(bs)},i.buttonTabOrder=function(t){this.buttonSetHelper(bs,t)},e.buttonForm=function(){return this.buttonGetHelper(qe)},i.buttonForm=function(t){this.buttonSetHelper(qe,t)},e.buttonFormAction=function(){return this.buttonGetHelper(nh)},i.buttonFormAction=function(t){this.buttonSetHelper(nh,t)},e.buttonFormEnctype=function(){return this.buttonGetHelper(sh)},i.buttonFormEnctype=function(t){this.buttonSetHelper(sh,t)},e.buttonFormMethod=function(){return this.buttonGetHelper(rh)},i.buttonFormMethod=function(t){this.buttonSetHelper(rh,t)},e.buttonFormNoValidate=function(){return this.buttonGetHelper(oh)},i.buttonFormNoValidate=function(t){this.buttonSetHelper(oh,t)},e.buttonFormTarget=function(){return this.buttonGetHelper(ah)},i.buttonFormTarget=function(t){this.buttonSetHelper(ah,t)},e.buttonPopoverTarget=function(){return this.buttonGetHelper(lh)},i.buttonPopoverTarget=function(t){this.buttonSetHelper(lh,t)},e.buttonPopoverTargetAction=function(){return this.buttonGetHelper(ch)},i.buttonPopoverTargetAction=function(t){this.buttonSetHelper(ch,t)},e.buttonElementType=function(){return this.buttonGetHelper(eh)},i.buttonElementType=function(t){this.buttonSetHelper(eh,t)},e.buttonElementValue=function(){return this.buttonGetHelper(ih)},i.buttonElementValue=function(t){this.buttonSetHelper(ih,t)},i.buttonFocusAction=function(t){this.buttonSetHelper(_e,t)},i.buttonBlurAction=function(t){this.buttonSetHelper(se,t)},i.buttonClickAction=function(t){this.buttonSetHelper(pe,t)},i.button=function(t){this.button?this.button.set(t):this.buildButton(t)},t.buttonGetHelper=function(t){return this.button?this.button.get(t):null},t.buttonSetHelper=function(t,e){this.button||this.buildButton({[t]:e}),this.button&&this.button.set({[t]:e})},t.buildButton=function(t={}){this.button&&this.button.demolish(),t.buttonName||(t.buttonName=`${this.name}-button`),t.description||(t.description=`Button for ${this.name} ${this.type}`),t.host=this,t.controller=this.getCanvasWrapper(),t.hold=this.getCanvasNavElement(),this.button=function(t){return!!t&&new Button(t)}(t)},t.rebuildButton=function(){this.button&&this.button.rebuild()},t.clickButton=function(){this.button&&this.button.click()}}function uh(t=tr){t.defs=hr(t.defs,{groups:null,groupBuckets:null,batchResort:!0});const e=t.getters,i=t.setters;e.groups=function(){return[].concat(this.groups)},i.groups=function(t){this.groups.length=0,this.addGroups(t)},t.sortGroups=function(){if(this.batchResort){this.batchResort=!1;const{groups:t,groupBuckets:e}=this,i=Jr();let n,s,r,o,a,l;for(n=0,s=t.length;n<s;n++)o=t[n],r=A[o],r&&(a=ct(r.order)||0,i[a]||(i[a]=Jr()),i[a].push(r));for(e.length=0,n=0,s=i.length;n<s;n++)l=i[n],l&&(e.push(...l),to(l));to(i)}},t.initializeCascade=function(){this.groups=[],this.groupBuckets=[]},t.addGroups=function(...t){const e=this.groups;return t.forEach((t=>{t.substring?dr(e,t):A[t]&&dr(e,t.name)}),this),this.batchResort=!0,this},t.removeGroups=function(...t){const e=this.groups;return t.forEach((t=>{t.substring?fr(e,t):A[t]&&fr(e,t.name)}),this),this.batchResort=!0,this},t.cascadeAction=function(t,e){let i;return this.groups.forEach((n=>{i=A[n],i&&i[e](t)}),this),this},t.updateArtefacts=function(t){return this.cascadeAction(t,"updateArtefacts"),this},t.setArtefacts=function(t){return this.cascadeAction(t,"setArtefacts"),this},t.addArtefactClasses=function(t){return this.cascadeAction(t,"addArtefactClasses"),this},t.removeArtefactClasses=function(t){return this.cascadeAction(t,"removeArtefactClasses"),this},t.updateByDelta=function(){return this.cascadeAction(!1,Is),this},t.reverseByDelta=function(){return this.cascadeAction(!1,Cn),this},t.getArtefactAt=function(t){if(t=mr(t,this.here,!1)){let e,i;for(let n=this.groups.length-1;n>=0;n--)if(e=A[this.groups[n]],e&&(i=e.getArtefactAt(t),i))return i}return!1},t.getAllArtefactsAt=function(t){const e=[];if(t=mr(t,this.here,!1)){let i,n;for(let s=this.groups.length-1;s>=0;s--)i=A[this.groups[s]],i&&(n=i.getAllArtefactsAt(t),n&&e.push(...n))}return e}}const dh="a",fh="b",ph="c",gh="d",mh="e",yh="f",bh=["a","b","c","d","e","f"],Sh=["repeat","repeat-x","repeat-y","no-repeat"];function kh(t=tr){const e={repeat:"repeat",patternMatrix:null};t.defs=hr(t.defs,e);const i=t.setters,n=t.getters;i.repeat=function(t){Sh.includes(t)?this.repeat=t:this.repeat=this.defs.repeat},t.checkMatrixExists=function(){this.patternMatrix||(this.patternMatrix=new DOMMatrix)},t.updateMatrixNumber=function(t,e){this.checkMatrixExists(),t=t.substring?parseFloat(t):t;const i=bh.includes(e);ar(t)&&i&&(this.patternMatrix[e]=t)},i.matrixA=function(t){this.updateMatrixNumber(t,dh)},i.matrixB=function(t){this.updateMatrixNumber(t,fh)},i.matrixC=function(t){this.updateMatrixNumber(t,ph)},i.matrixD=function(t){this.updateMatrixNumber(t,gh)},i.matrixE=function(t){this.updateMatrixNumber(t,mh)},i.matrixF=function(t){this.updateMatrixNumber(t,yh)},i.stretchX=function(t){this.updateMatrixNumber(t,dh)},i.skewY=function(t){this.updateMatrixNumber(t,fh)},i.skewX=function(t){this.updateMatrixNumber(t,ph)},i.stretchY=function(t){this.updateMatrixNumber(t,gh)},i.shiftX=function(t){this.updateMatrixNumber(t,mh)},i.shiftY=function(t){this.updateMatrixNumber(t,yh)},t.retrieveMatrixNumber=function(t){return this.checkMatrixExists(),this.patternMatrix[t]},n.matrixA=function(){return this.retrieveMatrixNumber(dh)},n.matrixB=function(){return this.retrieveMatrixNumber(fh)},n.matrixC=function(){return this.retrieveMatrixNumber(ph)},n.matrixD=function(){return this.retrieveMatrixNumber(gh)},n.matrixE=function(){return this.retrieveMatrixNumber(mh)},n.matrixF=function(){return this.retrieveMatrixNumber(yh)},n.stretchX=function(){return this.retrieveMatrixNumber(dh)},n.skewY=function(){return this.retrieveMatrixNumber(fh)},n.skewX=function(){return this.retrieveMatrixNumber(ph)},n.stretchY=function(){return this.retrieveMatrixNumber(gh)},n.shiftX=function(){return this.retrieveMatrixNumber(mh)},n.shiftY=function(){return this.retrieveMatrixNumber(yh)},i.patternMatrix=function(t){if(ut(t)){const e=this.updateMatrixNumber;e(t[0],dh),e(t[1],fh),e(t[2],ph),e(t[3],gh),e(t[4],mh),e(t[5],yh)}},t.buildStyle=function(t){if(t){t.substring&&(t=d[t]);let e=this.source,i=this.sourceLoaded;const n=this.repeat,s=t.engine;if(this.type!==Un&&this.type!==is||(e=this.element,i=!0),s&&i){const t=s.createPattern(e,n);return t.setTransform(this.patternMatrix),t}}return Jt}}const Ch="contain",Ah="cover",vh=["rgb(0 0 0 / 0)","rgba(0 0 0 / 0)","rgba(0,0,0,0)","rgba(0, 0, 0, 0)","transparent","#00000000","#0000"],Cell=function(t=tr){this.makeName(t.name),this.register(),this.initializePositions(),this.initializeCascade(),this.modifyConstructorInputForAnchorButton(t);let e=t.element;return delete t.element,sr(e)||(e=document.createElement(ae),e.id=this.name,e.width=300,e.height=150),this.set(this.defs),this.dirtyAssetSubscribers=!0,this.basePaste=null,this.dirtyFilters=!0,this.dirtyFiltersCache=!0,this.filters=[],this.currentFilters=[],this.dirtyImageSubscribers=!0,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.paste=null,this.patternMatrix=null,this.pivot=null,this.set(t),this.installElement(e,t.canvasColorSpace),this.state.setStateFromEngine(this.engine),Tc({name:this.name,host:this.name}),this.subscribers=[],this.sourceNaturalDimensions=qa(),this.dirtyDimensionsOverride=!0,this.sourceLoaded=!0,this.here={},this},Ph=Cell.prototype=Sr();Ph.type=Un,Ph.lib="cell",Ph.isArtefact=!1,Ph.isAsset=!0,Co(Ph),Xa(Ph),uc(Ph),Lc(Ph),Gc(Ph),jc(Ph),zc(Ph),Nc(Ph),Uc(Ph),qc(Ph),hh(Ph),uh(Ph),kh(Ph),Oc(Ph);const xh={cleared:!0,compiled:!0,shown:!0,compileOrder:0,showOrder:0,backgroundColor:zs,clearAlpha:0,alpha:1,composite:En,scale:1,flipReverse:!1,flipUpend:!1,filter:Yi,isBase:!1,controller:null,includeInCascadeEventActions:!1,willReadFrequently:!0,setRelativeDimensionsUsingBase:!1};Ph.defs=hr(Ph.defs,xh),delete Ph.defs.source,delete Ph.defs.sourceLoaded,Ph.stringifyFunction=qs,Ph.processPacketOut=qs,Ph.finalizePacketOut=qs,Ph.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Ph.clone=Js,Ph.factoryKill=function(){const t=this.name;Dt(h).forEach((e=>{e.cells.includes(t)&&e.removeCell(t),e.base&&e.base.name===t&&e.set({visibility:!1})})),Dt(o).forEach((e=>{if(e.name!==t){const i=e.state;if(i){const e=i.fillStyle,n=i.strokeStyle;e.name&&e.name===t&&(i.fillStyle=i.defs.fillStyle),n.name&&n.name===t&&(i.strokeStyle=i.defs.strokeStyle)}}})),A[t]&&A[t].kill()};const Oh=Ph.getters,wh=Ph.setters,Dh=Ph.deltaSetters;Ph.get=function(t){const e=this.getters[t];if(e)return e.call(this);{let e,i=this.defs[t];const n=this.state;return null!=i?(e=this[t],null!=e?e:i):(i=n.defs[t],null!=i?(e=n[t],null!=e?e:i):void 0)}},Oh.width=function(){return this.currentDimensions[0]||this.element.getAttribute(Gs)},wh.width=function(t){null!=t&&(this.dimensions[0]=t,this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0)},Oh.height=function(){return this.currentDimensions[1]||this.element.getAttribute(ri)},wh.height=function(t){null!=t&&(this.dimensions[1]=t,this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0)},Oh.dimensions=function(){return[this.currentDimensions[0]||this.element.getAttribute(Gs),this.currentDimensions[1]||this.element.getAttribute(ri)]},wh.dimensions=function(t,e){this.setCoordinateHelper(Te,t,e),this.dirtyDimensions=!0,this.dirtyDimensionsOverride=!0},wh.source=function(){},wh.engine=function(){},wh.state=function(){},wh.element=function(t){sr(t)&&this.installElement(t)},wh.backgroundColor=function(t){vh.includes(t)&&(t=zs),this.backgroundColor=t},wh.cleared=function(t){this.cleared=t,this.updateControllerCells()},wh.compiled=function(t){this.compiled=t,this.updateControllerCells()},wh.shown=function(t){this.shown=t,this.updateControllerCells()},wh.compileOrder=function(t){this.compileOrder=t,this.updateControllerCells()},wh.showOrder=function(t){this.showOrder=t,this.updateControllerCells()},wh.setRelativeDimensionsUsingBase=function(t){this.setRelativeDimensionsUsingBase=!!t,this.dirtyDimensions=!0},wh.stashX=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]),this.stashCoordinates[0]=t},wh.stashY=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]),this.stashCoordinates[1]=t},wh.stashWidth=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}this.stashDimensions[0]=t},wh.stashHeight=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}this.stashDimensions[1]=t},Dh.stashX=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]);const e=this.stashCoordinates;e[0]=Ws(e[0],t)},Dh.stashY=function(t){this.stashCoordinates||(this.stashCoordinates=[0,0]);const e=this.stashCoordinates;e[1]=Ws(e[1],t)},Dh.stashWidth=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}const e=this.stashDimensions;e[0]=Ws(e[0],t)},Dh.stashHeight=function(t){if(!this.stashDimensions){const t=this.currentDimensions;this.stashDimensions=[t[0],t[1]]}const e=this.stashDimensions;e[1]=Ws(e[1],t)},wh.clearAlpha=function(t){t.toFixed&&(t>1?t=1:t<0&&(t=0),this.clearAlpha=t)},Dh.clearAlpha=function(t){t.toFixed&&((t+=this.clearAlpha)>1?t=1:t<0&&(t=0),this.clearAlpha=t)},wh.smoothFont=function(t){const{element:e}=this;if(e){const{style:i}=e;i&&(t?(i[Xs]=Ut,i[Ii]=Ut,i[Fn]=Ut):(i[Xs]=Yi,i[Ii]=ii,i[Fn]=Mi))}},wh.checkForEntityHover=function(t){A[this.name].set({checkForEntityHover:t})},wh.onEntityHover=function(t){A[this.name].set({onEntityHover:t})},wh.onEntityNoHover=function(t){A[this.name].set({onEntityNoHover:t})},Oh.group=function(){return A[this.name]},Ph.checkSource=function(t,e){this.currentDimensions[0]===t&&this.currentDimensions[1]===e||this.notifySubscribers()},Ph.getData=function(t,e){return this.checkSource(this.sourceNaturalDimensions[0],this.sourceNaturalDimensions[1]),this.buildStyle(e)},Ph.updateArtefacts=function(t=tr){const e=this.groupBuckets;let i,n,s,r,o,a;for(s=0,r=e.length;s<r;s++)for(n=e[s].artefactCalculateBuckets,o=0,a=n.length;o<a;o++)i=n[o],t.dirtyScale&&(i.dirtyScale=!0),t.dirtyDimensions&&(i.dirtyDimensions=!0),t.dirtyLock&&(i.dirtyLock=!0),t.dirtyStart&&(i.dirtyStart=!0),t.dirtyOffset&&(i.dirtyOffset=!0),t.dirtyHandle&&(i.dirtyHandle=!0),t.dirtyRotation&&(i.dirtyRotation=!0),t.dirtyPathObject&&(i.dirtyPathObject=!0)},Ph.cleanDimensionsAdditionalActions=function(){const t=this.element;if(t){const{mimic:e,useMimicDimensions:i,isBase:n}=this;if(!n&&e&&i){const[e,i]=this.currentDimensions;t.width=e,t.height=i,this.setEngineFromState(this.engine),this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0})}else{const{cleared:e,dirtyDimensionsOverride:i}=this,s=this.getController();if(s&&(e||i)){this.dirtyDimensionsOverride=!1;const{currentDimensions:e,dimensions:i,setRelativeDimensionsUsingBase:r}=this;let o=s.currentDimensions;const[a,l]=o;if(n&&(s.baseMatchesCanvasDimensions||s.isComponent))i[0]=a,i[1]=l,e[0]=a,e[1]=l;else{let t;!n&&r&&(o=s.base.currentDimensions);for(let n=0;n<2;n++)t=i[n],t.substring?(t=parseFloat(t),dt(t)&&t>=1?e[n]=ct(o[n]*(t/100)):e[n]=1):dt(t)&&t>=1?e[n]=ct(t):e[n]=1}const[c,h]=e;t.width=c,t.height=h,this.setEngineFromState(this.engine),n&&s&&s.updateBaseHere(),this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0})}}}},Ph.notifySubscriber=function(t){t.sourceNaturalDimensions||(t.sourceNaturalDimensions=[]),t.sourceNaturalWidth=this.currentDimensions[0],t.sourceNaturalHeight=this.currentDimensions[1],t.sourceLoaded=!0,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0},Ph.subscribeAction=function(t={}){this.subscribers.push(t),t.asset=this,t.source=this.element,this.notifySubscriber(t)},Ph.installElement=function(t,e=Bn){return this.element=t,this.engine=this.element.getContext(Ht,{willReadFrequently:this.willReadFrequently,colorSpace:e}),this.state=Aa({engine:this.engine}),this},Ph.updateControllerCells=function(){const t=this.getController();t&&(t.dirtyCells=!0)},Ph.getController=function(){const{controller:t,currentHost:e}=this;return t||(e?e.getHost():null)},Ph.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=l[this.host]||o[this.host];return t&&(this.currentHost=t),!!t&&this.currentHost}return!1},Ph.updateBaseHere=function(t,e){if(this.isBase){this.here||(this.here={});const i=this.here,n=this.currentDimensions;let s=t.active;const r=t.localListener?t.originalWidth:t.w,o=t.localListener?t.originalHeight:t.h;if(n[0]!==r||n[1]!==o){this.basePaste||(this.basePaste=[]);const a=this.basePaste[0],l=n[0],c=n[1],h=r,u=o,d=t.x,f=t.y,p=l/h||1,g=c/u||1;let m,y;switch(i.w=l,i.h=c,e){case Ch:case Ah:a?(m=(h-l/g)/2,i.x=vt((d-m)*g),i.y=vt(f*g)):(y=(u-c/p)/2,i.x=vt(d*p),i.y=vt((f-y)*p));break;case Ve:i.x=vt(d*p),i.y=vt(f*g);break;default:m=(h-l)/2,y=(u-c)/2,i.x=vt(d-m),i.y=vt(f-y)}(i.x<0||i.x>l)&&(s=!1),(i.y<0||i.y>c)&&(s=!1),i.active=s}else i.x=t.x,i.y=t.y,i.w=r,i.h=o,i.active=s;t.baseActive=s}},Ph.clear=function(){const{element:t,engine:e,backgroundColor:i,clearAlpha:n}=this;this.prepareStamp();const s=ct(t.width),r=ct(t.height);if(i)e.save(),e.fillStyle=i,e.globalCompositeOperation=En,e.globalAlpha=1,e.fillRect(0,0,s,r),e.restore();else if(n){e.save();const i=Va(s,r),{engine:o,element:a}=i;o.drawImage(t,0,0,s,r,0,0,s,r),e.clearRect(0,0,s,r),e.globalAlpha=n,e.drawImage(a,0,0,s,r,0,0,s,r),e.restore(),Wa(i)}else e.clearRect(0,0,s,r)},Ph.compile=function(){this.sortGroups(),this.cleared||this.prepareStamp(),!this.dirtyFilters&&this.currentFilters||this.cleanFilters();const t=this.groupBuckets,e=t.length;for(let i,n=0;n<e;n++)i=t[n],i&&i.stamp&&i.stamp();!this.noFilters&&this.filters&&this.filters.length&&this.applyFilters(),this.stashOutputAction()},Ph.setImageSmoothing=function(t){t.imageSmoothingEnabled=!0,t.imageSmoothingQuality=oi},Ph.show=function(){const t=this.getHost(),e=!(!t||!t.engine)&&t.engine;if(t&&e){let i=0,n=0;if(t.type===Wn?(i=t.domElement.width,n=t.domElement.height):t.type===Un&&(i=t.element.width,n=t.element.height),!i||!n)return!1;const{currentScale:s,composite:r,alpha:o,controller:a,element:l,isBase:c,currentStampHandlePosition:h,currentStampPosition:u}=this,d=l.width,f=l.height;if(!d||!f)return!1;let p;e.save(),e.filter=this.filter;const g=Lo()?1:Io();if(c){this.basePaste||(this.basePaste=[]),p=this.basePaste,this.cleared||this.compiled||this.prepareStamp(),e.globalCompositeOperation=En,e.globalAlpha=1,e.clearRect(0,0,i,n),e.globalCompositeOperation=r,e.globalAlpha=o,this.setImageSmoothing(e);let t,s;switch(a?a.fit:Yi){case Ch:t=i/(d||1),s=n/(f||1),t>s?(p[0]=ct((i-d*s)/2),p[1]=0,p[2]=ct(d*s),p[3]=ct(f*s)):(p[0]=0,p[1]=ct((n-f*t)/2),p[2]=ct(d*t),p[3]=ct(f*t));break;case Ah:t=i/(d||1),s=n/(f||1),t<s?(p[0]=ct((i-d*s)/2),p[1]=0,p[2]=ct(d*s),p[3]=ct(f*s)):(p[0]=0,p[1]=ct((n-f*t)/2),p[2]=ct(d*t),p[3]=ct(f*t));break;case Ve:p[0]=0,p[1]=0,p[2]=ct(i),p[3]=ct(n);break;default:p[0]=ct((i-d*g)/2),p[1]=ct((n-f*g)/2),p[2]=d*g,p[3]=f*g}e.clearRect(0,0,i,n),e.drawImage(l,0,0,d,f,...p)}else s>0&&(this.paste||(this.paste=[]),p=this.paste,this.noDeltaUpdates||this.setDelta(this.delta),this.cleared||this.compiled||this.prepareStamp(),e.globalCompositeOperation=r,e.globalAlpha=o,this.setImageSmoothing(e),p[0]=ct(-h[0]*s),p[1]=ct(-h[1]*s),p[2]=ct(d*s),p[3]=ct(f*s),this.rotateDestination(e,...u),e.drawImage(l,0,0,d,f,...p));e.restore()}},Ph.applyFilters=function(){const t=this.engine,e=t.getImageData(0,0,this.currentDimensions[0],this.currentDimensions[1]);this.preprocessFilters(this.currentFilters);const i=hc.action({identifier:this.filterIdentifier,image:e,filters:this.currentFilters});i&&t.putImageData(i,0,0)},Ph.stashOutputAction=function(){if(this.stashOutput){this.stashOutput=!1;const{currentDimensions:t,stashCoordinates:e,stashDimensions:i,engine:n}=this,[s,r]=t;let o=e?e[0]:0,a=e?e[1]:0,l=i?i[0]:s,c=i?i[1]:r;if((l.substring||c.substring||o.substring||a.substring||o||a||l!==s||c!==r)&&(l.substring&&(l=parseFloat(l)/100*s),(!dt(l)||l<=0)&&(l=1),l>s&&(l=s),c.substring&&(c=parseFloat(c)/100*r),(!dt(c)||c<=0)&&(c=1),c>r&&(c=r),o.substring&&(o=parseFloat(o)/100*s),(!dt(o)||o<0)&&(o=0),o+l>s&&(o=s-l),a.substring&&(a=parseFloat(a)/100*r),(!dt(a)||a<0)&&(a=0),a+c>r&&(a=r-c)),n.save(),n.setTransform(1,0,0,1,0,0),this.stashedImageData=n.getImageData(o,a,l,c),n.restore(),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-image`;this.stashOutputAsAsset=!1;const e=Va(),i=e.element;if(i.width=l,i.height=c,e.engine.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=i.toDataURL();else{const e=this.getController();if(e){const n=this,s=document.createElement(hi);s.id=t,s.alt=`A cached image of the ${this.name} Cell`,s.onload=function(){e.canvasHold.appendChild(s),n.stashedImage=s,Cc(`#${t}`)},s.src=i.toDataURL()}}Wa(e)}}},Ph.prepareStamp=function(){(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&(this.cleanDimensions(),this.dirtyAssetSubscribers=!0),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(wi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.dirtyAssetSubscribers&&(this.dirtyAssetSubscribers=!1,this.notifySubscribers()),this.prepareStampTabsHelper()},Ph.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,n=this.currentDimensions,s=-e[0]*i,r=-e[1]*i,o=n[0]*i,a=n[1]*i;t.rect(s,r,o,a)}},Ph.updateHere=function(){const t=this.currentHost;if(t){this.here||(this.here={});const e=this.here,[i,n]=this.currentDimensions;e.w=i,e.h=n,e.x=-1e4,e.y=-1e4,e.active=!1;const s=t.here;if(s&&s.active){const{x:t,y:i}=s;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const n=Va(),r=n.engine,[o,a]=this.currentStampPosition;n.rotateDestination(r,o,a,this);const l=r.isPointInPath(this.pathObject,t,i);if(Wa(n),e.active=l,l){const[n,s]=this.currentStampHandlePosition,{flipUpend:r,flipReverse:l,scale:c}=this;let h=this.roll;if(c){let u=(t-o)/c,d=(i-a)/c;if(l&&(u=-u),r&&(d=-d),h){(l&&!r||!l&&r)&&(h=-h);const t=_a(u,d);t.rotate(-h),[u,d]=t,Ka(t)}u+=n,d+=s,e.x=u,e.y=d}}}}},Ph.splitShift=function(t){if(t&&t.px){const{px:e,vertical:i=!1,cycle:n=!1}=t,[s,r]=this.currentDimensions;let o=0,a=null;if(e.toFixed?o=vt(e):e.substring&&(o=vt(i?parseFloat(e)/100*r:parseFloat(e)/100*s)),o){const t=this.engine;i?o<0?(n&&(a=t.getImageData(0,0,s,-o)),t.putImageData(t.getImageData(0,-o,s,r+o),0,0),n&&t.putImageData(a,0,r+o)):(n&&(a=t.getImageData(0,r-o,s,o)),t.putImageData(t.getImageData(0,0,s,r-o),0,o),n&&t.putImageData(a,0,0)):o<0?(n&&(a=t.getImageData(0,0,-o,r)),t.putImageData(t.getImageData(-o,0,s+o,r),0,0),n&&t.putImageData(a,s+o,0)):(n&&(a=t.getImageData(s-o,0,o,r)),t.putImageData(t.getImageData(0,0,s-o,r),o,0),n&&t.putImageData(a,0,0))}}},Ph.getCellData=function(t=!1){const[e,i]=this.currentDimensions,n=ct(e/2),s=ct(i/2),r=this.engine.getImageData(0,0,e,i),o=r.data,a=[],l=_a();for(let r=0;r<i;r++)for(let i=0;i<e;i++){const c=4*(r*e+i);l.setFromArray([n,s]).subtract([r,i]),a.push({indexR:c,indexG:c+1,indexB:c+2,indexA:c+3,red:o[c+0],green:o[c+1],blue:o[c+2],alpha:t?255:o[c+3],row:r,col:i,distance:l.getMagnitude()})}return Ka(l),{iData:r,pixelState:a}},Ph.paintCellData=function(t=tr){const{iData:e,pixelState:i}=t,{width:n,height:s,data:r}=e,[o,a]=this.currentDimensions;n&&s&&r&&i&&o===n&&a===s&&(i.forEach((t=>{const{indexR:e,indexG:i,indexB:n,indexA:s}=t;let{red:o,green:a,blue:l,alpha:c}=t;o<0?o=0:o>255&&(o=255),a<0?a=0:a>255&&(a=255),l<0?l=0:l>255&&(l=255),c<0?c=0:c>255&&(c=255),t.red=o,t.green=a,t.blue=l,t.alpha=c,r[e]=o,r[i]=a,r[n]=l,r[s]=c})),this.engine.putImageData(e,0,0))};J.Cell=Cell;const Fh=t=>{const{canvasSupportsP3Color:e,displaySupportsP3Color:i}=wo;return t&&e&&i?Ie:Bn},Vector=function(t,e,i){return this.x=0,this.y=0,this.z=0,pr(t)&&this.set(t,e,i),this},Rh=Vector.prototype=Sr();Rh.type=gs,Rh.getXYCoordinate=function(){return[this.x,this.y]},Rh.getXYZCoordinate=function(){return[this.x,this.y,this.z]},Rh.setX=function(t){if(!pr(t))throw new Error(`${this.name} Vector error - setX() arguments error: ${t}`);return this.x=t,this},Rh.setY=function(t){if(!pr(t))throw new Error(`${this.name} Vector error - setY() arguments error: ${t}`);return this.y=t,this},Rh.setZ=function(t){if(!pr(t))throw new Error(`${this.name} Vector error - setZ() arguments error: ${t}`);return this.z=t,this},Rh.setXY=function(t,e){if(!gr(t,e))throw new Error(`${this.name} Vector error - setXY() arguments error: ${t}, ${e}`);return this.x=t,this.y=e,this},Rh.set=function(t,e,i){return lr(t)?this.setFromVector(t):ut(t)?this.setFromArray(t):gr(t,e)?this.setFromArray([t,e,i]):this},Rh.setFromArray=function(t){if(!ut(t))throw new Error(`${this.name} Vector error - setFromArray() arguments error: ${t}`);const[e,i,n]=t;return ar(e)&&(this.x=e),ar(i)&&(this.y=i),ar(n)&&(this.z=n),this},Rh.setFromVector=function(t){if(!lr(t))throw new Error(`${this.name} Vector error - setFromVector() arguments error: ${JSON.stringify(t)}`);const{x:e,y:i,z:n}=t;return ar(e)&&(this.x=e),ar(i)&&(this.y=i),ar(n)&&(this.z=n),this},Rh.zero=function(){return this.x=0,this.y=0,this.z=0,this},Rh.vectorAdd=function(t=tr){if(ut(t))return this.vectorAddArray(t);const{x:e,y:i,z:n}=t;return ar(e)&&(this.x+=e),ar(i)&&(this.y+=i),ar(n)&&(this.z+=n),this},Rh.vectorAddArray=function(t=[]){const[e,i,n]=t;return ar(e)&&(this.x+=e),ar(i)&&(this.y+=i),ar(n)&&(this.z+=n),this},Rh.vectorSubtract=function(t=tr){if(ut(t))return this.vectorSubtractArray(t);const{x:e,y:i,z:n}=t;return ar(e)&&(this.x-=e),ar(i)&&(this.y-=i),ar(n)&&(this.z-=n),this},Rh.vectorSubtractArray=function(t){const[e,i,n]=t;return ar(e)&&(this.x-=e),ar(i)&&(this.y-=i),ar(n)&&(this.z-=n),this},Rh.scalarMultiply=function(t){return ar(t)||(t=1),this.x*=t,this.y*=t,this.z*=t,this},Rh.vectorMultiply=function(t=tr){if(ut(t))return this.vectorMultiplyArray(t);const{x:e,y:i,z:n}=t;return ar(e)&&(this.x*=e),ar(i)&&(this.y*=i),ar(n)&&(this.z*=n),this},Rh.vectorMultiplyArray=function(t){const[e,i,n]=t;return ar(e)&&(this.x*=e),ar(i)&&(this.y*=i),ar(n)&&(this.z*=n),this},Rh.scalarDivide=function(t){if(!ar(t))throw new Error(`${this.name} Vector error - scalarDivide() argument not a number: ${t}`);if(!t)throw new Error(`${this.name} Vector error - scalarDivide() division by zero: ${t}`);return this.x/=t,this.y/=t,this.z/=t,this},Rh.getMagnitude=function(){return Ot(this.x*this.x+this.y*this.y+this.z*this.z)},Rh.rotate=function(t){ar(t)||(t=0);let e=nt(this.y,this.x);e+=.01745329251*t;const i=this.getMagnitude();return this.x=i*ot(e),this.y=i*xt(e),this},Rh.reverse=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},Rh.normalize=function(){const t=this.getMagnitude();return t>0&&(this.x/=t,this.y/=t,this.z/=t),this};const Th=[],Hh=function(t,e,i){Th.length||Th.push(new Vector);const n=Th.shift();return n.set(t,e,i),n},Eh=function(...t){t.forEach((t=>{t&&t.type===gs&&Th.push(t.zero())}))},Ih=function(t,e,i){return new Vector(t,e,i)};J.Vector=Vector;const Bh=Math.acos,Quaternion=function(t=tr){return this.n=t.n||1,this.v=Ih(),this.set(t),this},Lh=Quaternion.prototype=Sr();Lh.type=ls,Lh.set=function(t=tr){if(cr(t))return this.setFromQuaternion(t);if(yr(t.pitch,t.yaw,t.roll))return this.setFromEuler(t);const e=this.v,i=!(!pr(t.vector)&&!pr(t.v))&&(t.vector||t.v),n=!(!pr(t.scalar)&&!pr(t.n))&&(t.scalar||t.n||0),s=i?i.x||0:t.x||!1,r=i?i.y||0:t.y||!1,o=i?i.z||0:t.z||!1;return this.n=ar(n)?n:this.n,e.x=ar(s)?s:e.x,e.y=ar(r)?r:e.y,e.z=ar(o)?o:e.z,this},Lh.setFromQuaternion=function(t){if(!cr(t))throw new Error(`${this.name} Quaternion error - setFromQuaternion() bad argument: ${t}`);const e=this.v,i=t.v;return this.n=t.n,e.x=i.x,e.y=i.y,e.z=i.z,this},Lh.setFromEuler=function(t=tr){const e=this.v,i=(t.pitch||t.x||0)*Ct,n=(t.yaw||t.y||0)*Ct,s=(t.roll||t.z||0)*Ct,r=ot(i/2),o=ot(n/2),a=ot(s/2),l=xt(i/2),c=xt(n/2),h=xt(s/2);return e.x=l*o*a+r*c*h,e.y=r*c*a+l*o*h,e.z=r*o*h-l*c*a,this.n=r*o*a-l*c*h,this},Lh.zero=function(){const t=this.v;return this.n=1,t.x=0,t.y=0,t.z=0,this},Lh.getMagnitude=function(){const t=this.v;return Ot(this.n*this.n+t.x*t.x+t.y*t.y+t.z*t.z)},Lh.normalize=function(){const t=this.getMagnitude(),e=this.v;if(!t)throw new Error(`${this.name} Quaternion error - normalize() division by zero: ${t}`);return this.n=Ks(this.n/t),e.x=Ks(e.x/t),e.y=Ks(e.y/t),e.z=Ks(e.z/t),this},Lh.quaternionMultiply=function(t){if(!cr(t))throw new Error(`${this.name} Quaternion error - quaternionMultiply() bad argument: ${t}`);const e=this.v,i=t.v,n=this.n,s=e.x,r=e.y,o=e.z,a=t.n,l=i.x,c=i.y,h=i.z;return this.n=n*a-s*l-r*c-o*h,e.x=n*l+s*a+r*h-o*c,e.y=n*c+r*a+o*l-s*h,e.z=n*h+o*a+s*c-r*l,this},Lh.getAngle=function(t){let e;return t=!!pr(t)&&t,e=2*Bh(this.n),t&&(e*=1/Ct),Ks(e)},Lh.quaternionRotate=function(t){if(!cr(t))throw new Error(`${this.name} Quaternion error - quaternionRotate() bad argument: ${t}`);const e=Mh(t),i=Mh(this);return this.setFromQuaternion(e.quaternionMultiply(i)),Xh(e,i),this};const $h=[],Mh=function(t){$h.length||$h.push(Yh());const e=$h.shift();return e.set(t),e},Xh=function(...t){t.forEach((t=>{t&&t.type===ls&&$h.push(t.zero())}))},Yh=function(t){return new Quaternion(t)};J.Quaternion=Quaternion;const Gh=/[\s\uFEFF\xA0]+/g,jh=["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR","CANVAS"],zh="tabindex";function Nh(t=tr){Lc(t),Gc(t),jc(t),zc(t),Nc(t),Uc(t),qc(t),hh(t);const e={domElement:zs,pitch:0,yaw:0,offsetZ:0,css:null,classes:zs,position:Et,smoothFont:!0,checkForResize:!1,trackHere:zs,activePadding:5,includeInTabNavigation:!1,moreContrastAction:null,otherContrastAction:null,reduceMotionAction:null,noPreferenceMotionAction:null,colorSchemeLightAction:null,colorSchemeDarkAction:null,reduceTransparencyAction:null,noPreferenceTransparencyAction:null,reduceDataAction:null,noPreferenceDataAction:null};t.defs=hr(t.defs,e),t.packetExclusions=dr(t.packetExclusions,["domElement","pathCorners","rotation"]),t.packetFunctions=dr(t.packetFunctions,["onEnter","onLeave","onDown","onUp"]),t.processDOMPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},t.processFactoryPacketOut=function(t,e,i){let n=!0;return i.includes(t)||e!==this.defs[t]||(n=!1),n},t.finalizePacketOut=function(t,e){if(rr(this.domElement)){const e=this.domElement,i=e.cloneNode(!0);i.querySelectorAll(Ae).forEach((t=>i.removeChild(t))),t.outerHTML=i.outerHTML,t.host=e.parentElement.id}return t=this.handlePacketAnchor(t,e)},t.postCloneAction=function(t){return this.onEnter&&(t.onEnter=this.onEnter),this.onLeave&&(t.onLeave=this.onLeave),this.onDown&&(t.onDown=this.onDown),this.onUp&&(t.onUp=this.onUp),t};const i=t.setters,n=t.deltaSetters;i.trackHere=function(t){var e;pr(t)&&(t?(dr(Oo,this.name),"local"===t&&(lr(e=this)&&(e.localMouseListener&&e.localMouseListener(),e.here||(e.here={}),e.here.originalWidth=e.currentDimensions[0],e.here.originalHeight=e.currentDimensions[1],e.localMouseListener=ho(Ei,(function(t){e.here&&(e.here.x=vt(parseFloat(t.offsetX)),e.here.y=vt(parseFloat(t.offsetY)))}),e.domElement)))):(fr(Oo,this.name),function(t){lr(t)&&(t.localMouseListener&&t.localMouseListener(),t.localMouseListener=!1)}(this)),this.trackHere=t)},i.position=function(t){this.position=t,this.dirtyPosition=!0},i.smoothFont=function(t){this.smoothFont=t,this.dirtySmoothFont=!0},i.visibility=function(t){this.visibility=t,this.dirtyVisibility=!0},i.offsetZ=function(t){this.offsetZ=t,this.dirtyOffsetZ=!0},n.offsetZ=function(t){this.offsetZ+=t,this.dirtyOffsetZ=!0},i.roll=function(t){this.roll=_s(t),this.dirtyRotation=!0},n.roll=function(t){this.roll=_s(this.roll+t),this.dirtyRotation=!0},i.pitch=function(t){this.pitch=_s(t),this.dirtyRotation=!0},n.pitch=function(t){this.pitch=_s(this.pitch+t),this.dirtyRotation=!0},i.yaw=function(t){this.yaw=_s(t),this.dirtyRotation=!0},n.yaw=function(t){this.yaw=_s(this.yaw+t),this.dirtyRotation=!0},i.css=function(t){this.css=this.css?hr(this.css,t):t,this.dirtyCss=!0},i.classes=function(t){this.classes=t,this.dirtyClasses=!0},i.domAttributes=function(t){this.updateDomAttributes(t)},i.includeInTabNavigation=function(t){const e=this.domElement;e&&(this.includeInTabNavigation=t,t?e.setAttribute(zh,0):e.setAttribute(zh,-1))},t.updateDomAttributes=function(t,e){const i=this.domElement;return i&&(t.substring&&pr(e)?pr(e)&&e?i.setAttribute(t,e):i.removeAttribute(t):lr(t)&&lt(t).forEach((([t,e])=>{pr(e)&&e?i.setAttribute(t,e):i.removeAttribute(t)}))),this},t.initializeDomLayout=function(t){this.modifyConstructorInputForAnchorButton(t);const e=t.domElement;if(e){const i=e.style;if(i.boxSizing=re,t.setInitialDimensions){const n=e.getBoundingClientRect();this.currentDimensions[0]=n.width,this.currentDimensions[1]=n.height,t.width=n.width,t.height=n.height,e.className&&(t.classes=e.className);let s=!1;if(t&&t.host&&(s=t.host,s.substring&&o[s]&&(s=o[s])),s&&s.domElement){const e=s.domElement.getBoundingClientRect();e&&(t.startX=n.left-e.left,t.startY=n.top-e.top)}if(this.type===fs){const e=parseFloat(i.perspective),{perspective:n,perspectiveX:s,perspectiveY:r,perspectiveZ:o}=t;gr(n,o)||(t.perspectiveZ=dt(e)?e:0);const a=i.perspectiveOrigin;if(a.length){const[e,i]=a.split(In);gr(n,s)||(t.perspectiveX=e),gr(n,r)||(t.perspectiveY=i)}}}}},t.addClasses=function(t){if(t.substring){const e=`${this.classes}  ${t}`.trim().replace(Gh,In);e!==this.classes&&(this.classes=e,this.dirtyClasses=!0)}return this},t.removeClasses=function(t){if(t.substring){const e=t.split();let i,n=this.classes;e.forEach((t=>{i=new RegExp(" ?"+t+" ?"),n=n.replace(i,In),n=n.trim(),n=n.replace(Gh,In)})),n!==this.classes&&(this.classes=n,this.dirtyClasses=!0)}return this},t.addPathCorners=function(){const t=this.domElement;if(t&&!this.noUserInteraction&&!jh.includes(t.tagName)){const e=function(){const t=document.createElement(Be),e=t.style;return e.width=0,e.height=0,e.position=Et,e.margin=0,e.border=0,e.padding=0,t.setAttribute("data-scrawl-corner-div","sc"),t.setAttribute(zt,Ds),t},i=this.pathCorners,n=e(),s=e(),r=e(),o=e();n.style.top=Wi,n.style.left=Wi,s.style.top=Wi,s.style.left=Ui,r.style.top=Ui,r.style.left=Ui,o.style.top=Ui,o.style.left=Wi,t.appendChild(n),t.appendChild(s),t.appendChild(r),t.appendChild(o),i.push(n),i.push(s),i.push(r),i.push(o),this.currentCornersData||(this.currentCornersData=[])}return this},t.checkCornerPositions=function(t){const e=this.pathCorners;if(4===e.length){const i=this.getHere(),n=wo.scrollX-(i.offsetX||0),s=wo.scrollY-(i.offsetY||0),r=[];let o,a;const l=function(t){a=t[0],a?(r.push(vt(a.left+n)),r.push(vt(a.top+s))):r.push(0,0)};switch(t){case"topLeft":return o=e[0].getClientRects(),l(o),r;case"topRight":return o=e[1].getClientRects(),l(o),r;case"bottomRight":return o=e[2].getClientRects(),l(o),r;case"bottomLeft":return o=e[3].getClientRects(),l(o),r;default:return e.forEach((t=>{rr(t)&&(o=t.getClientRects(),l(o))})),r}}},t.getCornerCoordinate=function(t){return Ce.includes(t)?this.checkCornerPositions(t):[].concat(this.currentStampPosition)},t.cleanPathObject=function(){if(this.dirtyPathObject=!1,this.domElement&&!this.noUserInteraction)if(this.pathCorners.length||this.addPathCorners(),this.pathCorners.length){this.currentCornersData||(this.currentCornersData=[]);const t=this.currentCornersData;t.length=0,t.push(...this.checkCornerPositions());const e=this.pathObject=new Path2D;e.moveTo(t[0],t[1]),e.lineTo(t[2],t[3]),e.lineTo(t[4],t[5]),e.lineTo(t[6],t[7]),e.closePath()}else{const t=this.pathObject=new Path2D;t.moveTo(0,0),t.lineTo(10,0),t.lineTo(0,10),t.lineTo(-10,0),t.closePath()}},t.checkHit=function(t=[]){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const e=ut(t)?t:[t],i=Va(),n=i.engine;let s,r;return e.some((t=>{if(ut(t))s=t[0],r=t[1];else{if(!gr(t,t.x,t.y))return!1;s=t.x,r=t.y}return!(!dt(s)||!dt(r))&&n.isPointInPath(this.pathObject,s,r)}),this)?(Wa(i),{x:s,y:r,artefact:this}):(Wa(i),!1)},t.cleanRotation=function(){this.dirtyRotation=!1,this.rotation&&cr(this.rotation)||(this.rotation=Yh()),this.currentRotation&&cr(this.rotation)||(this.currentRotation=Yh());const t=this.rotation;t.setFromEuler({pitch:this.pitch||0,yaw:this.yaw||0,roll:this.roll||0}),1!==t.getMagnitude()&&t.normalize();const e=Mh(),i=this.path,n=this.mimic,s=this.pivot,r=this.lockTo;i&&r.includes(Ni)?e.set(t):n&&this.useMimicRotation&&r.includes(Ai)?pr(n.currentRotation)?(e.set(n.currentRotation),this.addOwnRotationToMimic&&e.quaternionRotate(t)):this.dirtyMimicRotation=!0:(e.set(t),s&&this.addPivotRotation&&r.includes(Ki)&&(pr(s.currentRotation)?e.quaternionRotate(s.currentRotation):this.dirtyPivotRotation=!0)),this.currentRotation.set(e),Xh(e),this.dirtyPositionSubscribers=!0,this.mimicked&&this.mimicked.length&&(this.dirtyMimicRotation=!0)},t.cleanOffsetZ=function(){this.dirtyOffsetZ=!1},t.cleanContent=function(){this.dirtyContent=!1,this.domElement&&(this.dirtyDimensions=!0)},t.cleanDisplayShape=qs,t.cleanDisplayArea=qs,t.prepareStamp=function(){(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle||this.dirtyRotation)&&(this.dirtyPathObject=!0),this.dirtyContent&&this.cleanContent(),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyDisplayArea&&this.cleanDisplayArea(),this.dirtyDisplayShape&&this.cleanDisplayShape(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyOffsetZ&&this.cleanOffsetZ(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.pivoted.length&&(this.dirtyStampPositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.prepareStampTabsHelper()},t.stamp=function(){if(!this.domElement)return!1;const[t,e]=this.currentStampPosition,[i,n]=this.currentStampHandlePosition,s=this.currentScale,r=this.currentRotation,o=`${i}px ${n}px 0`;let a=`translate(${t-i}px,${e-n}px)`;if(this.yaw||this.pitch||this.roll||this.pivot&&this.addPivotRotation||this.mimic&&this.useMimicRotation||this.path&&this.addPathRotation){const t=r.v;a+=` rotate3d(${t.x},${t.y},${t.z},${r.getAngle(!1)}rad)`}this.offsetZ&&(a+=` translateZ(${this.offsetZ}px)`),1!==s&&(a+=` scale(${s},${s})`),a!==this.currentTransformString&&(this.currentTransformString=a,this.dirtyTransform=!0),o!==this.currentTransformOriginString&&(this.currentTransformOriginString=o,this.dirtyTransformOrigin=!0),(this.dirtyTransform||this.dirtyPerspective||this.dirtyPosition||this.dirtyDomDimensions||this.dirtyTransformOrigin||this.dirtyVisibility||this.dirtySmoothFont||this.dirtyCss||this.dirtyClasses||this.domShowRequired)&&(this.domShowRequired=!1,function(t=zs){t&&t.substring&&dr(ra,t)}(this.name),((t=!0)=>{oa=t})(!0),xr(!0)),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),(this.dirtyMimicRotation||this.dirtyPivotRotation)&&(this.dirtyMimicRotation=!1,this.dirtyPivotRotation=!1,this.dirtyRotation=!0),this.dirtyMimicScale&&(this.dirtyMimicScale=!1,this.dirtyScale=!0)},t.initializeAccessibility=function(){this.reduceMotionAction=qs,this.noPreferenceMotionAction=qs,this.colorSchemeLightAction=qs,this.colorSchemeDarkAction=qs,this.reduceTransparencyAction=qs,this.noPreferenceTransparencyAction=qs,this.reduceDataAction=qs,this.noPreferenceDataAction=qs,this.moreContrastAction=qs,this.otherContrastAction=qs},i.moreContrastAction=function(t){or(t)&&(this.moreContrastAction=t)},t.setMoreContrastAction=function(t){or(t)&&(this.moreContrastAction=t)},i.otherContrastAction=function(t){or(t)&&(this.otherContrastAction=t)},t.setOtherContrastAction=function(t){or(t)&&(this.otherContrastAction=t)},t.contrastActions=function(){const t=this.here;if(pr(t)){const e=t.prefersContrast;pr(e)&&(e?this.moreContrastAction():this.otherContrastAction())}},i.reduceMotionAction=function(t){or(t)&&(this.reduceMotionAction=t)},t.setReduceMotionAction=function(t){or(t)&&(this.reduceMotionAction=t)},i.noPreferenceMotionAction=function(t){or(t)&&(this.noPreferenceMotionAction=t)},t.setNoPreferenceMotionAction=function(t){or(t)&&(this.noPreferenceMotionAction=t)},t.reducedMotionActions=function(){const t=this.here;if(pr(t)){const e=t.prefersReducedMotion;pr(e)&&(e?this.reduceMotionAction():this.noPreferenceMotionAction())}},i.colorSchemeLightAction=function(t){or(t)&&(this.colorSchemeLightAction=t)},t.setColorSchemeLightAction=function(t){or(t)&&(this.colorSchemeLightAction=t)},i.colorSchemeDarkAction=function(t){or(t)&&(this.colorSchemeDarkAction=t)},t.setColorSchemeDarkAction=function(t){or(t)&&(this.colorSchemeDarkAction=t)},t.colorSchemeActions=function(){const t=this.here;if(pr(t)){const e=t.prefersDarkColorScheme;pr(e)&&(e?this.colorSchemeDarkAction():this.colorSchemeLightAction())}},i.reduceTransparencyAction=function(t){or(t)&&(this.reduceTransparencyAction=t)},t.setReduceTransparencyAction=function(t){or(t)&&(this.reduceTransparencyAction=t)},i.noPreferenceTransparencyAction=function(t){or(t)&&(this.noPreferenceTransparencyAction=t)},t.setNoPreferenceTransparencyAction=function(t){or(t)&&(this.noPreferenceTransparencyAction=t)},t.reducedTransparencyActions=function(){const t=this.here;if(pr(t)){const e=t.prefersReduceTransparency;pr(e)&&(e?this.reduceTransparencyAction():this.noPreferenceTransparencyAction())}},i.reduceDataAction=function(t){or(t)&&(this.reduceDataAction=t)},t.setReduceDataAction=function(t){or(t)&&(this.reduceDataAction=t)},i.noPreferenceDataAction=function(t){or(t)&&(this.noPreferenceDataAction=t)},t.setNoPreferenceDataAction=function(t){or(t)&&(this.noPreferenceDataAction=t)},t.reducedDataActions=function(){const t=this.here;if(pr(t)){const e=t.prefersReduceData;pr(e)&&(e?this.reduceDataAction():this.noPreferenceDataAction())}},t.checkAccessibilityValues=function(){this.contrastActions(),this.reducedMotionActions(),this.colorSchemeActions(),this.reducedTransparencyActions(),this.reducedDataActions()},t.apply=function(){ea(),this.prepareStamp(),this.stamp(),aa(this.name),this.dirtyPathObject=!0,this.cleanPathObject()}}const Vh="banner",Wh="landscape",Uh="larger",Zh="largest",_h="portrait",Kh="regular",qh="skyscraper",Qh="smaller",Jh="smallest";function tu(t=tr){t.defs=hr(t.defs,{breakToBanner:3,breakToLandscape:1.5,breakToPortrait:.65,breakToSkyscraper:.35,actionBannerShape:null,actionLandscapeShape:null,actionRectangleShape:null,actionPortraitShape:null,actionSkyscraperShape:null,breakToSmallest:2e4,breakToSmaller:8e4,breakToLarger:18e4,breakToLargest:32e4,actionSmallestArea:null,actionSmallerArea:null,actionRegularArea:null,actionLargerArea:null,actionLargestArea:null}),t.packetFunctions=dr(t.packetFunctions,["actionBannerShape","actionLandscapeShape","actionRectangleShape","actionPortraitShape","actionSkyscraperShape","actionSmallestArea","actionSmallerArea","actionRegularArea","actionLargerArea","actionLargestArea"]);const e=t.getters,i=t.setters;e.displayShape=function(){return this.currentDisplayShape},e.displayShapeBreakpoints=function(){return{breakToBanner:this.breakToBanner,breakToLandscape:this.breakToLandscape,breakToPortrait:this.breakToPortrait,breakToSkyscraper:this.breakToSkyscraper,breakToSmallest:this.breakToSmallest,breakToSmaller:this.breakToSmaller,breakToLarger:this.breakToLarger,breakToLargest:this.breakToLargest}},i.displayShapeBreakpoints=function(t=tr){for(const[e,i]of lt(t))if(ar(i))switch(e){case"breakToBanner":this.breakToBanner=i;break;case"breakToLandscape":this.breakToLandscape=i;break;case"breakToPortrait":this.breakToPortrait=i;break;case"breakToSkyscraper":this.breakToSkyscraper=i;break;case"breakToSmallest":this.breakToSmallest=i;break;case"breakToSmaller":this.breakToSmaller=i;break;case"breakToLarger":this.breakToLarger=i;break;case"breakToLargest":this.breakToLargest=i}this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},t.setDisplayShapeBreakpoints=i.displayShapeBreakpoints,i.breakToBanner=function(t){ar(t)&&(this.breakToBanner=t),this.dirtyDisplayShape=!0},i.breakToLandscape=function(t){ar(t)&&(this.breakToLandscape=t),this.dirtyDisplayShape=!0},i.breakToPortrait=function(t){ar(t)&&(this.breakToPortrait=t),this.dirtyDisplayShape=!0},i.breakToSkyscraper=function(t){ar(t)&&(this.breakToSkyscraper=t),this.dirtyDisplayShape=!0},i.breakToSmallest=function(t){ar(t)&&(this.breakToSmallest=t),this.dirtyDisplayArea=!0},i.breakToSmaller=function(t){ar(t)&&(this.breakToSmaller=t),this.dirtyDisplayArea=!0},i.breakToLarger=function(t){ar(t)&&(this.breakToLarger=t),this.dirtyDisplayArea=!0},i.breakToLargest=function(t){ar(t)&&(this.breakToLargest=t),this.dirtyDisplayArea=!0},i.actionBannerShape=function(t){or(t)&&(this.actionBannerShape=t),this.dirtyDisplayShape=!0},t.setActionBannerShape=i.actionBannerShape,i.actionLandscapeShape=function(t){or(t)&&(this.actionLandscapeShape=t),this.dirtyDisplayShape=!0},t.setActionLandscapeShape=i.actionLandscapeShape,i.actionRectangleShape=function(t){or(t)&&(this.actionRectangleShape=t),this.dirtyDisplayShape=!0},t.setActionRectangleShape=i.actionRectangleShape,i.actionPortraitShape=function(t){or(t)&&(this.actionPortraitShape=t),this.dirtyDisplayShape=!0},t.setActionPortraitShape=i.actionPortraitShape,i.actionSkyscraperShape=function(t){or(t)&&(this.actionSkyscraperShape=t),this.dirtyDisplayShape=!0},t.setActionSkyscraperShape=i.actionSkyscraperShape,i.actionSmallestArea=function(t){or(t)&&(this.actionSmallestArea=t),this.dirtyDisplayArea=!0},t.setActionSmallestArea=i.actionSmallestArea,i.actionSmallerArea=function(t){or(t)&&(this.actionSmallerArea=t),this.dirtyDisplayArea=!0},t.setActionSmallerArea=i.actionSmallerArea,i.actionRegularArea=function(t){or(t)&&(this.actionRegularArea=t),this.dirtyDisplayArea=!0},t.setActionRegularArea=i.actionRegularArea,i.actionLargerArea=function(t){or(t)&&(this.actionLargerArea=t),this.dirtyDisplayArea=!0},t.setActionLargerArea=i.actionLargerArea,i.actionLargestArea=function(t){or(t)&&(this.actionLargestArea=t),this.dirtyDisplayArea=!0},t.setActionLargestArea=i.actionLargestArea,t.initializeDisplayShapeActions=function(){this.actionBannerShape=qs,this.actionLandscapeShape=qs,this.actionRectangleShape=qs,this.actionPortraitShape=qs,this.actionSkyscraperShape=qs,this.currentDisplayShape=zs,this.dirtyDisplayShape=!0,this.actionSmallestArea=qs,this.actionSmallerArea=qs,this.actionRegularArea=qs,this.actionLargerArea=qs,this.actionLargestArea=qs,this.currentDisplayArea=zs,this.dirtyDisplayArea=!0},t.cleanDisplayShape=function(){this.dirtyDisplayShape=!1;const[t,e]=this.currentDimensions;if(t>0&&e>0){const i=t/e,n=this.currentDisplayShape,s=this.breakToBanner,r=this.breakToLandscape,o=this.breakToPortrait,a=this.breakToSkyscraper;return i>s?n!==Vh&&(this.currentDisplayShape=Vh,this.actionBannerShape(),!0):i>r?n!==Wh&&(this.currentDisplayShape=Wh,this.actionLandscapeShape(),!0):i<a?n!==qh&&(this.currentDisplayShape=qh,this.actionSkyscraperShape(),!0):i<o?n!==_h&&(this.currentDisplayShape=_h,this.actionPortraitShape(),!0):n!==pn&&(this.currentDisplayShape=pn,this.actionRectangleShape(),!0)}return this.dirtyDisplayShape=!0,!1},t.cleanDisplayArea=function(){this.dirtyDisplayArea=!1;const[t,e]=this.currentDimensions;if(t>0&&e>0){const i=t*e,n=this.currentDisplayArea,s=this.breakToLargest,r=this.breakToLarger,o=this.breakToSmaller,a=this.breakToSmallest;return i>s?n!==Zh&&(this.currentDisplayArea=Zh,this.actionLargestArea(),!0):i>r?n!==Uh&&(this.currentDisplayArea=Uh,this.actionLargerArea(),!0):i<a?n!==Jh&&(this.currentDisplayArea=Jh,this.actionSmallestArea(),!0):i<o?n!==Qh&&(this.currentDisplayArea=Qh,this.actionSmallerArea(),!0):n!==Kh&&(this.currentDisplayArea=Kh,this.actionRegularArea(),!0)}return this.dirtyDisplayArea=!0,!1},t.updateDisplayShape=function(){this.currentDisplayShape=zs,this.dirtyDisplayShape=!0},t.updateDisplayArea=function(){this.currentDisplayArea=zs,this.dirtyDisplayArea=!0},t.updateDisplay=function(){this.updateDisplayShape(),this.updateDisplayArea()}}const eu="aria-busy",iu=["assertive","polite","off"],nu=["fill","contain","cover"],Canvas=function(t=tr){this.makeName(t.name),this.register(),this.initializePositions(),this.dimensions[0]=300,this.dimensions[1]=150,this.pathCorners=[],this.css={},this.here={},this.perspective={x:Zi,y:Zi,z:0},this.dirtyPerspective=!0,this.initializeDomLayout(t),this.set(this.defs),t.label||(t.label=`${this.name} canvas element`),this.initializeDisplayShapeActions(),this.initializeAccessibility(),this.currentActiveEntityNames=null,this.dirtyCss=!0,this.localMouseListener=null,this.mimic=null,this.pivot=null,this.set(t);const e=this.domElement;if(e){const i=e.dataset;this.useDisplayP3WhereAvailable=i.canvasColorSpace===Ie||t.canvasColorSpace===Ie,this.canvasColorSpace=Fh(this.useDisplayP3WhereAvailable),this.engine=this.domElement.getContext(Ht,{colorSpace:this.canvasColorSpace}),this.state=Aa({engine:this.engine}),this.cells=[],this.cellBatchesClear=[],this.cellBatchesCompile=[],this.cellBatchesShow=[];let n=e.width,s=e.height;if(i.isResponsive){e.style.width=Ui,e.style.height=Ui;let t=!0;i.baseWidth&&i.baseHeight&&(t=!1,n=parseFloat(i.baseWidth),s=parseFloat(i.baseHeight)),this.set({checkForResize:!0,baseMatchesCanvasDimensions:t,ignoreCanvasCssDimensions:!0,fit:i.fit||this.fit})}this.cleanDimensions();const r={name:`${this.name}_base`,element:!1,width:n,height:s,cleared:!0,compiled:!0,shown:!1,isBase:!0,host:this.name,controller:this,order:10,canvasColorSpace:this.canvasColorSpace};i.baseClearAlpha&&(r.clearAlpha=parseFloat(i.baseClearAlpha)),i.baseBackgroundColor&&(r.backgroundColor=i.baseBackgroundColor),this.base=this.buildCell(r),ua(this.name),e.getAttribute("role")&&(this.role=e.getAttribute("role")),e.getAttribute("title")&&(this.title=e.getAttribute("title")),i.label&&(this.label=i.label),i.description&&(this.description=i.description);const o=document.createElement("nav");o.id=`${this.name}-navigation`,o.setAttribute(Nt,sn),o.setAttribute(eu,"false"),this.navigation=o,e.appendChild(o),this.dirtyNavigationTabOrder=!0;const a=document.createElement(Be);a.id=`${this.name}-text-hold`,a.setAttribute(Nt,sn),a.setAttribute(eu,"false"),this.textHold=a,e.appendChild(a),this.dirtyTextTabOrder=!0;const l=document.createElement("div");l.id=`${this.name}-canvas-hold`,l.style.display=Yi,l.setAttribute(zt,Ds),this.canvasHold=l,e.appendChild(l);const c=document.createElement(Be);c.id=`${this.name}-fontSizeCalculator`,c.setAttribute(zt,Ds),this.fontSizeCalculator=c,this.fontSizeCalculatorValues=rt(c),l.appendChild(c);const h=document.createElement(Be);h.id=`${this.name}-styles`,h.setAttribute(zt,Ds),this.labelStylesCalculator=h,this.labelStylesCalculatorValues=rt(h),l.appendChild(h);const u=document.createElement(Be);u.id=`${this.name}-ARIA-label`,u.setAttribute(Nt,sn),this.ariaLabelElement=u,e.appendChild(u),e.setAttribute("aria-labelledby",u.id);const d=document.createElement(Be);d.id=`${this.name}-ARIA-description`,d.setAttribute(Nt,sn),this.ariaDescriptionElement=d,e.appendChild(d),e.setAttribute("aria-describedby",d.id),this.includeInTabNavigation=!1,this.cleanAria(),this.computedStyles=rt(e)}return this.dirtyCells=!0,this.apply(),this.dirtyDomDimensions=!0,t.setAsCurrentCanvas&&this.setAsCurrentCanvas(),this},su=Canvas.prototype=Sr();su.type=Wn,su.lib=ae,su.isArtefact=!0,su.isAsset=!1,Co(su),Nh(su),tu(su);const ru={position:Sn,trackHere:zn,fit:Yi,isComponent:!1,baseMatchesCanvasDimensions:!1,renderOnResize:!0,ignoreCanvasCssDimensions:!1,title:zs,label:zs,description:zs,role:hi,navigationAriaLive:sn,textAriaLive:sn,canvasColorSpace:Bn};su.defs=hr(su.defs,ru),su.stringifyFunction=qs,su.processPacketOut=qs,su.finalizePacketOut=qs,su.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},su.clone=Js,su.factoryKill=function(){const t=this.name,e=this.host;if(da(t),fr(Oo,t),e&&e!==xn){const i=this.currentHost?this.currentHost:o[e];if(i){i.removeGroups(t);const e=A[i.name];e&&e.removeArtefacts(t)}}A[t]&&A[t].kill(),this.base.kill(),this.domElement.remove()};const ou=su.getters,au=su.setters,lu=su.deltaSetters;au.fit=function(t){this.fit=nu.includes(t)?t:Yi},au.title=function(t){this.title=t,this.dirtyAria=!0},au.label=function(t){this.label=t,this.dirtyAria=!0},au.description=function(t){this.description=t,this.dirtyAria=!0},au.role=function(t){this.role=t,this.dirtyAria=!0},au.navigationAriaLive=function(t){t.substring&&iu.includes(t)&&(this.navigationAriaLive=t,this.dirtyAria=!0)},au.textAriaLive=function(t){t.substring&&iu.includes(t)&&(this.textAriaLive=t,this.dirtyAria=!0)},ou.backgroundColor=function(){return this.base.backgroundColor},au.backgroundColor=function(t){this.base&&this.base.set({backgroundColor:t})},ou.alpha=function(){return this.base.alpha},au.alpha=function(t){this.base&&this.base.set({alpha:t})},lu.alpha=function(t){this.base&&this.base.deltaSet({alpha:t})},ou.composite=function(){return this.base.composite},au.composite=function(t){this.base&&this.base.set({composite:t})},au.checkForEntityHover=function(t){this.base.set({checkForEntityHover:t})},au.onEntityHover=function(t){this.base.set({onEntityHover:t})},au.onEntityNoHover=function(t){this.base.set({onEntityNoHover:t})},ou.baseGroup=function(){return A[this.base.name]},ou.baseName=function(){return this.base.name},su.setAsCurrentCanvas=function(){return this.base&&pu(this),this},su.setBase=function(t){return this.base&&(this.base.set(t),this.setBaseHelper()),this},su.deltaSetBase=function(t){return this.base&&(this.base.deltaSet(t),this.setBaseHelper()),this},su.getBase=function(){return this.base},su.getBaseHere=function(){return this.base.here},su.updateBaseHere=function(){this.base&&this.base.updateBaseHere(this.here,this.fit)},su.setBaseHelper=function(){const t={},e=this.base;e.dirtyScale&&(t.dirtyScale=!0),e.dirtyDimensions&&(t.dirtyDimensions=!0),e.dirtyLock&&(t.dirtyLock=!0),e.dirtyStart&&(t.dirtyStart=!0),e.dirtyOffset&&(t.dirtyOffset=!0),e.dirtyHandle&&(t.dirtyHandle=!0),e.dirtyRotation&&(t.dirtyRotation=!0),this.cleanCells(),e.prepareStamp(),this.updateCells(t)},su.updateCells=function(t=tr){const e=this.cells;let i;for(let n=0,s=e.length;n<s;n++)i=d[e[n]],i&&(t.dirtyScale&&(i.dirtyScale=!0),t.dirtyDimensions&&(i.dirtyDimensions=!0),t.dirtyLock&&(i.dirtyLock=!0),t.dirtyStart&&(i.dirtyStart=!0),t.dirtyOffset&&(i.dirtyOffset=!0),t.dirtyHandle&&(i.dirtyHandle=!0),t.dirtyRotation&&(i.dirtyRotation=!0))},su.buildCell=function(t=tr){t.host||null||(t.host=this.base.name);const e=function(t){return!!t&&new Cell(t)}(t);return this.addCell(e),this.cleanCells(),e},su.cleanDimensionsAdditionalActions=function(){this.cells&&this.updateCells({dirtyDimensions:!0}),this.dirtyDomDimensions=!0,this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},su.addCell=function(t){if(t=t.substring?t:t.name||null){const e=d[t];e&&(this.base&&(e.host=this.base.name,e.currentHost=null),e.prepareStamp(),dr(this.cells,t),this.dirtyCells=!0)}return this},su.removeCell=function(t){return(t=t.substring?t:t.name||null)&&(fr(this.cells,t),this.dirtyCells=!0),this},su.killCell=function(t){const e=t.substring?d[t]:t;return e&&e.kill(),this.dirtyCells=!0,this},su.clear=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesClear;for(let e=0,i=t.length;e<i;e++)t[e].clear()},su.compile=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesCompile;for(let e=0,i=t.length;e<i;e++)t[e].compile();this.prepareStamp(),this.stamp()},su.show=function(){this.dirtyCells&&this.cleanCells(),this.base&&this.base.dirtyDimensions&&this.base.cleanDimensions();const t=this.cellBatchesShow;for(let e=0,i=t.length;e<i;e++)t[e].show();this.base.show(),aa(),this.dirtyAria&&this.cleanAria(),this.dirtyNavigationTabOrder&&this.reorderNavElements(),this.dirtyTextTabOrder&&this.reorderTextElements()},su.reorderNavElements=function(){this.dirtyNavigationTabOrder=!1;const t=[],e=this.navigation;for(e.setAttribute(eu,"true");e.firstChild;)t.push(e.removeChild(e.firstChild));t.sort(((t,e)=>{const i=parseInt(t.getAttribute(xe),10),n=parseInt(e.getAttribute(xe),10);return i<n?-1:i>n?1:0})),t.forEach((t=>e.appendChild(t))),e.setAttribute(eu,"false")},su.reorderTextElements=function(){this.dirtyTextTabOrder=!1;const t=[],e=this.textHold;for(e.setAttribute(eu,"true");e.firstChild;)t.push(e.removeChild(e.firstChild));t.sort(((t,e)=>{const i=parseInt(t.getAttribute(xe),10),n=parseInt(e.getAttribute(xe),10);return i<n?-1:i>n?1:0})),t.forEach((t=>e.appendChild(t))),e.setAttribute(eu,"false")},su.render=function(){this.clear(),this.compile(),this.show()},su.cleanCells=function(){this.dirtyCells=!1;const t=Jr(),e=Jr(),i=Jr(),{cells:n,cellBatchesClear:s,cellBatchesCompile:r,cellBatchesShow:o}=this;let a,l,c,h,u;for(h=0,u=n.length;h<u;h++)a=d[n[h]],a&&!a.isBase&&(a.cleared&&t.push(a),a.compiled&&(l=a.compileOrder,e[l]||(e[l]=Jr()),e[l].push(a)),a.shown&&(l=a.showOrder,i[l]||(i[l]=Jr()),i[l].push(a)));for(s.length=0,s.push(...t,this.base),to(t),r.length=0,h=0,u=e.length;h<u;h++)c=e[h],c&&(r.push(...c),to(c));for(r.push(this.base),to(e),o.length=0,h=0,u=i.length;h<u;h++)c=i[h],c&&(o.push(...c),to(c));o.push(this.base),to(i)},su.cascadeEventAction=function(t,e={}){this.currentActiveEntityNames||(this.currentActiveEntityNames=[]);const i=this.currentActiveEntityNames,n=Jr(),s=Jr(),r=Jr(),a=Jr(),l=Jr(),c=Jr(),h=Jr();let u,f,p,g,m,y;const b=this.cells;for(u=0,f=b.length;u<f;u++)p=d[b[u]],p&&(p.shown||p.isBase||p.includeInCascadeEventActions)&&s.push(...p.getEntityHits());for(u=0,f=s.length;u<f;u++)g=s[u],m=g.name,r.includes(m)||(r.push(m),i.includes(m)?(c.push(g),h.push(m)):(a.push(g),l.push(m)));n.push(...a,...c);const S=function(t){if(i.length){for(u=0,f=l.length;u<f;u++)fr(i,l[u]);for(u=0,f=h.length;u<f;u++)fr(i,h[u]);for(u=0,f=i.length;u<f;u++)y=o[i[u]],y&&y.onLeave(t)}},k=n.length,C=a.length;switch(t){case Le:for(u=0;u<k;u++)n[u].onDown(e);break;case Es:for(u=0;u<k;u++)n[u].onUp(e);break;case je:for(u=0;u<C;u++)a[u].onEnter(e);break;case fi:S(e);break;case Ei:for(S(e),u=0;u<C;u++)a[u].onEnter(e);break;case"otherInteraction":for(u=0;u<k;u++)n[u].onOtherInteraction(e)}return i.length=0,i.push(...l,...h),to(n,s,r,a,l,c,h),[...i]},su.getEntityHits=function(){return this.cascadeEventAction()},su.checkHover=function(){this.cascadeEventAction()},su.cleanAria=function(){this.dirtyAria=!1,this.domElement.setAttribute("title",this.title),this.domElement.setAttribute(Pn,this.role),this.ariaLabelElement.textContent=this.label,this.ariaDescriptionElement.textContent=this.description,this.navigation.setAttribute(Nt,this.navigationAriaLive),this.textHold.setAttribute(Nt,this.textAriaLive)};const cu=function(t){return!!t&&new Canvas(t)};J.Canvas=Canvas;const hu=function(t){let e=t.getAttribute(Pe),i=t.id||t.getAttribute(Li),n=Et;return e&&e!==xn||(t.setAttribute(Pe,xn),e=xn,n=t.style.position),i||(i=er(),t.id=i),cu({name:i,domElement:t,group:e,host:e,position:n,setInitialDimensions:!0})},uu=function(t){const e=document.querySelector(`#${t}`),i=h[t];if(i){if(null!=e.dataset.scrawlGroup)return pu(i),i;M(t)}if(e){const t=hu(e);return pu(t),t}};let du=null,fu=null;const pu=function(t){let e=!1;if(t)if(t.substring){const i=h[t];i&&(fu=i,e=!0)}else t.type===Wn&&(fu=t,e=!0);if(e&&fu.base){const t=A[fu.base.name];t&&(du=t)}},gu=function(t=tr){const e=document.createElement(ae),i=t.name?t.name:er(),n=t.width||300,s=t.height||150;let r,a=xn,l=Sn,c=t.host;c.substring&&(r=o[c],!r&&c?(c=document.querySelector(c),c&&(a=c.id)):c=r),c?c.type===fs?(a=c.name,l=Et,c=c.domElement):rr(c)||(c=document.body):c=document.body,e.id=i,e.setAttribute(Pe,a),e.width=n,e.height=s,e.style.position=l,c.appendChild(e);const h=cu({name:i,domElement:e,group:a,host:a,position:l,setInitialDimensions:!1,setAsCurrentCanvas:!pr(t.setAsCurrentCanvas)||t.setAsCurrentCanvas,trackHere:pr(t.trackHere)?t.trackHere:zn});return delete t.group,delete t.host,delete t.name,delete t.element,delete t.position,delete t.setInitialDimensions,delete t.setAsCurrentCanvas,delete t.trackHere,h.set(t),h},Element=function(t=tr){const e=t.domElement;this.makeName(t.name),this.register(),e&&(t.text?e.textContent=t.text:t.content&&(e.innerHTML=t.content)),this.initializePositions(),this.dimensions[0]=this.dimensions[1]=100,this.pathCorners=[],this.css={},this.here={},this.initializeDomLayout(t),this.set(this.defs),this.initializeAccessibility(),this.mimic=null,this.pivot=null,this.dirtyContent=!0,this.dirtyCss=!0,this.localMouseListener=null,this.canvas=null,this.elementComputedStyles=null,this.set(t);const i=this.domElement;return i&&(i.id=this.name),this.apply(),this},mu=Element.prototype=Sr();mu.type="Element",mu.lib=Me,mu.isArtefact=!0,mu.isAsset=!1,Co(mu),Nh(mu),mu.factoryKill=function(){fr(Oo,this.name),this.domElement.remove()};const yu=mu.setters;yu.text=function(t){const e=this.domElement;if(rr(e)){const i=e.querySelectorAll(Ae);e.textContent=t,i.forEach((t=>e.appendChild(t))),this.dirtyContent=!0}},yu.content=function(t){const e=this.domElement;if(rr(e)){const i=e.querySelectorAll(Ae);e.innerHTML=t,i.forEach((t=>e.appendChild(t))),this.dirtyContent=!0}},mu.cleanDimensionsAdditionalActions=function(){this.dirtyDomDimensions=!0},mu.addCanvas=function(t=tr){if(this.canvas)return this.canvas;{const e=document.createElement(ae),i=this.domElement;e.id=`${this.name}-canvas`;const n=i.getBoundingClientRect();i.parentNode.insertBefore(e,this.domElement);const s=cu({name:`${this.name}-canvas`,domElement:e,position:Et,width:n.width,height:n.height,mimic:this.name,lockTo:Ai,useMimicDimensions:!0,useMimicScale:!0,useMimicStart:!0,useMimicHandle:!0,useMimicOffset:!0,useMimicRotation:!0,addOwnDimensionsToMimic:!1,addOwnScaleToMimic:!1,addOwnStartToMimic:!1,addOwnHandleToMimic:!1,addOwnOffsetToMimic:!1,addOwnRotationToMimic:!1});return s.set(t),this.canvas=s,s}};const bu=function(t){return!!t&&new Element(t)};J.Element=Element;const Su="data-scrawl-stack",Stack=function(t=tr){this.makeName(t.name),this.register(),this.initializePositions(),this.initializeCascade(),this.dimensions[0]=300,this.dimensions[1]=150,this.pathCorners=[],this.css={},this.here={},this.perspective={x:Zi,y:Zi,z:0},this.dirtyPerspective=!0,this.initializeDomLayout(t);const e=Tc({name:this.name,host:this.name});this.addGroups(e.name),this.set(this.defs),this.initializeDisplayShapeActions(),this.initializeAccessibility(),this.dirtyDomDimensions=!0,this.dirtyPath=!0,this.rotation=null,this.currentCornersData=null,this.currentTransformString="",this.dirtyTransform=!0,this.currentTransformOriginString="",this.dirtyTransformOrigin=!0,this.domShowRequired=!0,this.dirtyCss=!0,this.localMouseListener=null,this.set(t);const i=this.domElement;if(i){i.dataset.isResponsive&&(this.isResponsive=!0),i.getAttribute(Pe)===xn&&ua(this.name)}return this},ku=Stack.prototype=Sr();ku.type=fs,ku.lib="stack",ku.isArtefact=!0,ku.isAsset=!1,Co(ku),uh(ku),Nh(ku),tu(ku);const Cu={position:Sn,perspective:null,trackHere:zn,isResponsive:!1,containElementsInHeight:!1};ku.defs=hr(ku.defs,Cu),ku.stringifyFunction=qs,ku.processPacketOut=qs,ku.finalizePacketOut=qs,ku.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},ku.clone=Js,ku.factoryKill=function(){const t=this.name;da(t),fr(Oo,t),A[t]&&A[t].kill(),Dt(o).forEach((e=>{e.host===t&&e.kill()})),this.domElement.remove()};const Au=ku.getters,vu=ku.setters,Pu=ku.deltaSetters;Au.perspectiveX=function(){return this.perspective.x},Au.perspectiveY=function(){return this.perspective.y},Au.perspectiveZ=function(){return this.perspective.z},vu.perspectiveX=function(t){this.perspective.x=t,this.dirtyPerspective=!0},vu.perspectiveY=function(t){this.perspective.y=t,this.dirtyPerspective=!0},vu.perspectiveZ=function(t){this.perspective.z=t,this.dirtyPerspective=!0},vu.perspective=function(t=tr){this.perspective.x=pr(t.x)?t.x:this.perspective.x,this.perspective.y=pr(t.y)?t.y:this.perspective.y,this.perspective.z=pr(t.z)?t.z:this.perspective.z,this.dirtyPerspective=!0},Pu.perspectiveX=function(t){this.perspective.x=Ws(this.perspective.x,t),this.dirtyPerspective=!0},Pu.perspectiveY=function(t){this.perspective.y=Ws(this.perspective.y,t),this.dirtyPerspective=!0},Au.group=function(){return A[this.name]},ku.updateArtefacts=function(t=tr){this.groupBuckets.forEach((e=>{e.artefactCalculateBuckets.forEach((e=>{t.dirtyScale&&(e.dirtyScale=!0),t.dirtyDimensions&&(e.dirtyDimensions=!0),t.dirtyLock&&(e.dirtyLock=!0),t.dirtyStart&&(e.dirtyStart=!0),t.dirtyOffset&&(e.dirtyOffset=!0),t.dirtyHandle&&(e.dirtyHandle=!0),t.dirtyRotation&&(e.dirtyRotation=!0),t.dirtyPathObject&&(e.dirtyPathObject=!0)}))}))},ku.cleanDimensionsAdditionalActions=function(){this.groupBuckets&&this.updateArtefacts({dirtyDimensions:!0,dirtyPath:!0,dirtyStart:!0,dirtyHandle:!0}),this.dirtyDomDimensions=!0,this.dirtyPath=!0,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyDisplayShape=!0,this.dirtyDisplayArea=!0},ku.cleanPerspective=function(){this.dirtyPerspective=!1;const t=this.perspective;this.domPerspectiveString=`perspective-origin: ${t.x} ${t.y}; perspective: ${t.z}px;`,this.domShowRequired=!0,this.groupBuckets&&this.updateArtefacts({dirtyHandle:!0,dirtyPathObject:!0})},ku.checkResponsive=function(){this.isResponsive&&this.trackHere&&(this.currentVportWidth||(this.currentVportWidth=wo.w),this.currentVportHeight||(this.currentVportHeight=wo.h),this.dirtyHeight&&this.containElementsInHeight&&(this.dirtyHeight=!1),this.currentVportWidth!==wo.w&&(this.currentVportWidth=wo.w,this.containElementsInHeight&&(this.dirtyHeight=!0)),this.currentVportHeight!==wo.h&&(this.currentVportHeight=wo.h))},ku.clear=function(){this.checkResponsive()},ku.compile=function(){this.sortGroups(),this.prepareStamp(),this.stamp(),this.groupBuckets.forEach((t=>t.stamp()))},ku.show=function(){aa()},ku.render=function(){this.compile(),this.show()},ku.addExistingDomElements=function(t){if(pr(t)){let e,i,n,s;const r=t.substring?document.querySelectorAll(t):[].concat(t);for(n=0,s=r.length;n<s;n++)e=r[n],rr(e)&&(i=bu({name:e.id||e.name,domElement:e,group:this.name,host:this.name,position:Et,setInitialDimensions:!0}),i&&i.domElement&&this.domElement.appendChild(i.domElement))}return this},ku.addNewElement=function(t){if(t&&t.tag){t.domElement=document.createElement(t.tag),t.domElement.setAttribute(Pe,this.name),pr(t.group)||(t.group=this.name),t.host=this.name,t.position||(t.position=Et),t.dimensions&&ut(t.dimensions)&&(t.width=t.dimensions[0]||100,t.height=t.dimensions[1]||100),pr(t.width)||(t.width=100),pr(t.height)||(t.height=100);const e=bu(t);return e&&e.domElement&&(pr(t.boxSizing)||(e.domElement.style.boxSizing=re),this.domElement.appendChild(e.domElement)),e}return!1};const xu=function(t){return!!t&&new Stack(t)};J.Stack=Stack;const Ou=function(t){let e=t.getAttribute(Pe),i=t.id||t.getAttribute(Li),n=Et;e||(t.setAttribute(Pe,xn),e=xn,n=Sn),i||(i=er(),t.id=i);const s=xu({name:i,domElement:t,group:e,host:e,position:n,setInitialDimensions:!0});return wu(t,i),s},wu=function(t,e){const i=t.getBoundingClientRect();let n,s,r,o,a=0;Array.from(t.children).forEach((t=>{null!=t.getAttribute(Su)||sr(t)||"SCRIPT"==t.tagName?t.setAttribute(Pe,e):(n=t.getBoundingClientRect(),s=rt(t),r=parseFloat(s.marginTop)+parseFloat(s.borderTopWidth)+parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)+parseFloat(s.borderBottomWidth)+parseFloat(s.marginBottom),a=a||n.top-i.top,o={name:t.id||t.getAttribute(Li),domElement:t,group:e,host:e,position:Et,width:n.width,height:n.height,startX:n.left-i.left,startY:a,classes:t.className?t.className:zs},a+=r+n.height,bu(o))}))},Du=function(t=tr){let e,i,n,s,r,a=Et;e=t.element&&t.element.substring?document.querySelector(t.element):rr(t.element)?t.element:document.createElement(Be),t.host&&t.host.substring?(i=document.querySelector(t.host),i||(i=document.body)):i=rr(t.host)?t.host:pr(e.parentElement)?e.parentElement:document.body,pr(t.width)&&(e.style.width=t.width.toFixed?`${t.width}px`:t.width),pr(t.height)&&(e.style.height=t.height.toFixed?`${t.height}px`:t.height),r=t.name||e.id||e.getAttribute(Li)||zs,r||(r=er()),e.id=r,e.setAttribute(Su,Su),i&&null!=i.getAttribute(Su)?(n=o[i.id],s=n?n.name:xn):s=xn,e.setAttribute(Pe,s),s===xn&&(a=Sn),e.parentElement&&i.id===e.parentElement.id||i.appendChild(e);const l=xu({name:r,domElement:e,group:s,host:s,position:a,setInitialDimensions:!0});return wu(e,r),Array.from(e.childNodes).forEach((t=>{var e;t.id&&(e=t.id,ca.includes(e))&&da(t.id)})),delete t.name,delete t.element,delete t.host,delete t.width,delete t.height,l.set(t),l},Fu=function(t){const e=document.querySelector(`#${t}`),i=T[t];if(i){if(null!=e.dataset.scrawlGroup)return i;M(t)}if(e){return Ou(e)}},Ru=function(){!function(t="[data-scrawl-stack]"){document.querySelectorAll(t).forEach((t=>Ou(t)))}(),function(t="[data-scrawl-canvas]"){let e;document.querySelectorAll(t).forEach(((t,i)=>{e=hu(t),i||pu(e)}))}(),ao(),ea(),jo(),xr(!0),Qo()},Tu=function(t){return t.length?t:fa()},Hu=function(t,e){let i,n,s;for(i=0,n=t.length;i<n;i++)s=o[t[i]],s&&s[e]&&s[e]()},Eu=function(...t){const e=Tu(t);Hu(e,de)},Iu=function(...t){const e=Tu(t);Hu(e,"compile")},Bu=function(...t){const e=Tu(t);Hu(e,"show")},Lu=function(...t){const e=Tu(t);Hu(e,"render")},RenderAnimation=function(t=tr){let e;if(this.noTarget=null!=t.noTarget&&t.noTarget,t.target||t.noTarget){if(ut(t.target)){const e=[];return t.target.forEach((i=>{const n=it({},t);n.name=`${n.name}_${i.name}`,n.target=i,e.push(new RenderAnimation(n))})),e}e=t.target&&t.target.substring?o[t.target]:t.target}else e={clear:Eu,compile:Iu,show:Bu,checkAccessibilityValues:qs};this.makeName(t.name),this.order=pr(t.order)?t.order:this.defs.order,this.onRun=t.onRun||qs,this.onHalt=t.onHalt||qs,this.onKill=t.onKill||qs,this.maxFrameRate=t.maxFrameRate||60,this.lastRun=0,this.chokedAnimation=!0,this.target=e,this.commence=t.commence||qs,this.afterClear=t.afterClear||qs,this.afterCompile=t.afterCompile||qs,this.afterShow=t.afterShow||qs,this.afterCreated=t.afterCreated||qs,this.error=t.error||qs,this.readyToInitialize=!0,this.fn=function(){this.noTarget?(this.commence(),this.afterClear(),this.afterCompile(),this.afterShow(),this.readyToInitialize&&(this.afterCreated(this),this.readyToInitialize=!1)):this.isRunning()&&(this.commence(),this.target.clear(),this.afterClear(),this.target.compile(),this.afterCompile(),this.target.show(),this.afterShow(),this.readyToInitialize&&(this.target.checkAccessibilityValues(),this.afterCreated(this),this.readyToInitialize=!1))},this.register();const i=t.observer||!1;return this.observer=null,i&&setTimeout((()=>{nr(i)?this.observer=co(this,this.target):this.observer=co(this,this.target,i)}),0),t.delay||this.run(),this},$u=RenderAnimation.prototype=Sr();$u.type=us,$u.lib=Xt,$u.isArtefact=!1,$u.isAsset=!1,Co($u);$u.defs=hr($u.defs,{order:1,maxFrameRate:60,onRun:null,onHalt:null,onKill:null,commence:null,afterClear:null,afterCompile:null,afterShow:null,afterCreated:null,error:null,target:null}),$u.stringifyFunction=qs,$u.processPacketOut=qs,$u.finalizePacketOut=qs,$u.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},$u.clone=Js,$u.kill=function(){return this.onKill(),so(this.name),this.deregister(),!0},$u.run=function(){return this.onRun(),no(this.name),this.target&&this.target.checkAccessibilityValues(),setTimeout((()=>Zr()),20),this},$u.start=function(){return this.readyToInitialize=!0,this.run()},$u.isRunning=function(){return ro(this.name)},$u.halt=function(){return this.onHalt(),so(this.name),this},$u.updateOnce=function(){return this.isRunning()||(this.run(),setTimeout((()=>this.halt()),0)),this},$u.updateHook=function(t="",e){switch(t){case"commence":this.commence=e||qs;break;case"afterClear":this.afterClear=e||qs;break;case"afterCompile":this.afterCompile=e||qs;break;case"afterShow":this.afterShow=e||qs;break;case"afterCreated":this.afterCreated=e||qs;break;case"error":this.error=e||qs}};const Mu=function(t){return!!t&&new RenderAnimation(t)};J.RenderAnimation=RenderAnimation;const Xu=["width","height","zIndex","borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],Yu=["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],UnstackedElement=function(t){const e=t.id||t.name;return this.makeName(e),this.register(),t.setAttribute("data-scrawl-name",this.name),this.domElement=t,this.elementComputedStyles=rt(t),this.hostStyles={},this.canvasStartX=0,this.canvasStartY=0,this.canvasWidth=0,this.canvasHeight=0,this.canvasZIndex=0,this},Gu=UnstackedElement.prototype=Sr();Gu.type="UnstackedElement",Gu.lib="unstackedelement",Gu.isArtefact=!1,Gu.isAsset=!1,Co(Gu);Gu.defs=hr(Gu.defs,{canvasOnTop:!1}),Gu.demolish=function(){return!0},Gu.addCanvas=function(t=tr){if(!this.canvas){const e=document.createElement(ae),i=this.domElement,n=i.style;"static"===n.position&&(n.position=Sn),e.id=`${this.name}-canvas`,i.prepend(e);const s=cu({name:`${this.name}-canvas`,domElement:e,position:Et});return this.canvas=s,s.set(t),this.updateCanvas(),s}},Gu.checkElementStyleValues=function(){const t={},e=this.domElement,i=this.canvas;if(e&&i&&i.domElement){const n=this.hostStyles,s=this.elementComputedStyles,r=i.domElement;let{x:o,y:a,width:l,height:c}=e.getBoundingClientRect(),{x:h,y:u}=r.getBoundingClientRect(),{width:d,height:f}=s;const p=s.zIndex;let g,m,y,b,S;o=ct(o),a=ct(a),h=ct(h),u=ct(u),l=ct(l),c=ct(c),d=ct(parseFloat(d)),f=ct(parseFloat(f)),Xu.forEach((e=>{switch(e){case Gs:g=pt(d,l),this.canvasWidth!==g&&(this.canvasWidth=g,this.dirtyDimensions=!0);break;case ri:m=pt(f,c),this.canvasHeight!==m&&(this.canvasHeight=m,this.dirtyDimensions=!0);break;case"zIndex":y=p===Ut?0:parseInt(p,10),y=this.canvasOnTop?y+1:y-1,this.canvasZIndex!==y&&(this.canvasZIndex=y,this.dirtyZIndex=!0);break;default:b=n[e],S=s[e],pr(b)&&b===S||(n[e]=S,t[e]=S)}}));const k=o-h,C=a-u;(k||C)&&(this.canvasStartX+=k,this.canvasStartY+=C,this.dirtyStart=!0)}return t},Gu.updateCanvas=function(){if(this.canvas&&this.canvas.domElement){const t=this.canvas,e=t.domElement.style,i=this.checkElementStyleValues();for(const[t,n]of lt(i))Yu.includes(t)&&(e[t]=n);if(this.dirtyStart&&(this.dirtyStart=!1,t.set({startX:this.canvasStartX,startY:this.canvasStartY})),this.dirtyDimensions){this.dirtyDimensions=!1;const e=this.canvasWidth,i=this.canvasHeight;t.set({width:e,height:i}),t.dirtyDimensions=!0,t.base.set({width:e,height:i}),t.base.dirtyDimensions=!0,t.cleanDimensions(),t.base.cleanDimensions()}this.dirtyZIndex&&(this.dirtyZIndex=!1,e.zIndex=this.canvasZIndex)}};J.UnstackedElement=UnstackedElement;const ju=["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"],zu=function(t){const e=!!rr(t.domElement)&&t.domElement,i=lr(t.animationHooks)?t.animationHooks:{},n=lr(t.canvasSpecs)?t.canvasSpecs:{},s=lr(t.observerSpecs)?t.observerSpecs:{},r=!nr(t.includeCanvas)||t.includeCanvas;return e&&e.id&&o[e.id]?Nu(e,n,i,s):Vu(e,n,i,s,r)},Nu=function(t,e,i,n){const s=o[t.id];if(!s)return!1;e.baseMatchesCanvasDimensions=!0,e.ignoreCanvasCssDimensions=!0,e.checkForResize=!0;const r=s.addCanvas(e);s.elementComputedStyles=rt(t),i.name=`${s.name}-animation`,i.target=r;const a=Mu(i),l=co(a,s,n);return{element:s,canvas:r,animation:a,demolish:()=>{l(),a.kill(),r.demolish(),s.demolish(!0)}}},Vu=function(t,e,i,n,s){if(!t||ju.includes(t.tagName))return{};const r=t.id;let o;var a;r&&$[r]?o=$[r]:o=!!(a=t)&&new UnstackedElement(a),e.baseMatchesCanvasDimensions=!0,e.checkForResize=!0;const l=!!s&&o.addCanvas(e);i.name=`${o.name}-animation`,l?(i.afterClear||(i.afterClear=()=>o.updateCanvas()),i.target=l):i.noTarget=!0;const c=Mu(i),h=co(c,o,n);return{element:o,canvas:l,animation:c,demolish:()=>{h(),c.kill(),l&&l.demolish(),o.demolish(!0)}}},Wu=["artefact","group","animation","animationtickers","world","tween","styles","filter"],Uu="unnamed",Zu=t=>{if(t&&t.substring){let e;return!!Wu.some((i=>(e=tt[i][t],e)))&&e}return!1};function _u(t=tr){const e={order:1,ticker:zs,targets:null,time:0,action:null,reverseOnCycleEnd:!1,reversed:!1};t.defs=hr(t.defs,e),t.kill=function(){const t=this.ticker;if(t===`${this.name}_ticker`){const e=s[t];e&&e.kill()}else t&&this.removeFromTicker(t);return this.deregister(),!0};const i=t.getters,n=t.setters;i.targets=function(){return[].concat(this.targets)},n.targets=function(t=[]){this.setTargets(t)},n.action=function(t){this.action=t,typeof this.action!==Qe&&(this.action=qs)},t.calculateEffectiveTime=function(t){const[e,i]=Zs(mr(t,this.time));if(this.effectiveTime=0,e===Vi&&i<=100){if(this.ticker){const t=s[this.ticker];t&&(this.effectiveTime=t.effectiveDuration*(i/100))}}else this.effectiveTime=i;return this},t.addToTicker=function(t){if(pr(t)){const e=this.ticker,i=s[t];e&&e!==t&&this.removeFromTicker(e),pr(i)&&(this.ticker=t,i.subscribe(this.name),this.calculateEffectiveTime())}return this},t.removeFromTicker=function(t){if(t=pr(t)?t:this.ticker){const e=s[t];pr(e)&&(this.ticker=zs,e.unsubscribe(this.name))}return this},t.setTargets=function(t){t=[].concat(t);const e=Jr();return t.forEach((t=>{if(or(t))or(t.set)&&e.push(t);else if(lr(t)&&pr(t.name))e.push(t);else{const i=Zu(t);i&&e.push(i)}})),this.targets||(this.targets=[]),this.targets.length=0,this.targets.push(...e),to(e),this},t.addToTargets=function(t){let e;return(t=[].concat(t)).forEach((t=>{typeof t===Qe?typeof t.set===Qe&&this.targets.push(t):(e=Zu(t),e&&this.targets.push(e))}),this),this},t.removeFromTargets=function(t){t=[].concat(t);const e=Jr(),i=[].concat(this.targets);i.forEach((t=>{const i=t.type||Hs,n=t.name||Uu;i!==Hs&&n!==Uu&&e.push(`${i}_${n}`)})),t.forEach((t=>{let n;if(n=typeof t===Qe?t:Zu(t),n){const t=n.type||Hs,s=n.name||Uu;if(t!==Hs&&s!==Uu){const n=`${t}_${s}`,r=e.indexOf(n);r>=0&&(i[r]=!1)}}})),this.targets||(this.targets=[]);const n=this.targets;return n.length=0,i.forEach((t=>{t&&n.push(t)}),this),to(e),this},t.checkForTarget=function(t){return!!t.substring&&this.targets.some((e=>e.name===t))},t.run=qs,t.isRunning=qs,t.halt=qs,t.reverse=qs,t.resume=qs,t.seekTo=qs,t.seekFor=qs}const Action=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.action=qs,this.revert=qs,this.triggered=null,this.set(t),this.calculateEffectiveTime(),pr(t.ticker)&&this.addToTicker(t.ticker),this},Ku=Action.prototype=Sr();Ku.type="Action",Ku.lib=Fs,Ku.isArtefact=!1,Ku.isAsset=!1,Co(Ku),_u(Ku);Ku.defs=hr(Ku.defs,{revert:null}),Ku.packetExclusions=dr(Ku.packetExclusions,["targets"]),Ku.packetFunctions=dr(Ku.packetFunctions,["revert","action"]),Ku.finalizePacketOut=function(t){return ut(this.targets)&&(t.targets=this.targets.map((t=>t.name))),t};const qu=Ku.setters;qu.revert=function(t){this.revert=t,typeof this.revert!==Qe&&(this.revert=qs)},qu.triggered=function(t){this.triggered!==t&&(t?this.action():this.revert(),this.triggered=t)},Ku.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==Li&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Ts&&(this[a]=l));const c=!!pr(t.ticker)&&this.ticker;c?(this.ticker=c,this.addToTicker(t.ticker)):pr(t.time)&&this.calculateEffectiveTime()}return this},Ku.getEndTime=function(){return this.effectiveTime},Ku.update=function(t){const{tick:e,reverseTick:i,willLoop:n}=t,{reversed:s,effectiveTime:r,triggered:o}=this;return s?i>=r?o||(this.action(),this.triggered=!0):o&&(this.revert(),this.triggered=!1):e>=r?o||(this.action(),this.triggered=!0):o&&(this.revert(),this.triggered=!1),n&&(this.triggered=!this.triggered),!0};const Qu=function(t){return!!t&&new Action(t)};J.Action=Action;function Ju(t=tr){Lc(t),Gc(t),jc(t),zc(t),Nc(t),Uc(t),qc(t),hh(t),Oc(t);const e={method:Ve,pathObject:null,winding:"nonzero",flipReverse:!1,flipUpend:!1,scaleOutline:!0,scaleShadow:!1,lockFillStyleToEntity:!1,lockStrokeStyleToEntity:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,onOtherInteraction:null};t.defs=hr(t.defs,e),t.packetExclusions=dr(t.packetExclusions,["state"]),t.packetFunctions=dr(t.packetFunctions,["onEnter","onLeave","onDown","onUp","onOtherInteraction"]),t.processEntityPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},t.processFactoryPacketOut=function(t,e,i){let n=!0;return i.indexOf(t)||e!==this.defs[t]||(n=!1),n},t.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=hr(t,i),t=this.handlePacketAnchor(t,e)},t.postCloneAction=function(t,e){return this.onEnter&&(t.onEnter=this.onEnter),this.onLeave&&(t.onLeave=this.onLeave),this.onDown&&(t.onDown=this.onDown),this.onUp&&(t.onUp=this.onUp),this.onOtherInteraction&&(t.onOtherInteraction=this.onOtherInteraction),e.sharedState&&(t.state=this.state),e.anchor&&(e.anchor.host=t,pr(e.anchor.focusAction)||(e.anchor.focusAction=this.anchor.focusAction),pr(e.anchor.blurAction)||(e.anchor.blurAction=this.anchor.blurAction),t.buildAnchor(e.anchor),e.anchor.clickAction||(t.anchor.clickAction=this.anchor.clickAction)),t};const i=t.getters,n=t.setters;i.group=function(){return this.group?this.group.name:zs},n.lockStylesToEntity=function(t){this.lockFillStyleToEntity=t,this.lockStrokeStyleToEntity=t},t.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return null!=n?(i=this[t],typeof i!==Ts?i:n):(n=e.defs[t],null!=n?(i=e[t],typeof i!==Ts?i:n):null)}},t.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.state,o=r?r.setters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Xn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=u)))}return this},t.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.state,o=r?r.deltaSetters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Xn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=Ws(r[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=Ws(this[h],u))))}return this},t.entityInit=function(t=tr){this.modifyConstructorInputForAnchorButton(t),this.makeName(t.name),this.register(),this.initializePositions(),this.state=Aa(tr),this.filters=[],this.currentFilters=[],this.dirtyFilters=!1,this.dirtyFiltersCache=!1,this.dirtyImageSubscribers=!1,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.set(this.defs),t.group||(t.group=du),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.onOtherInteraction=qs,this.set(t),this.midInitActions(t),this.purge&&this.purgeArtefact(this.purge)},t.midInitActions=qs,t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1,this.dirtyDimensions=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},t.cleanPathObject=qs,t.stamp=function(t=!1,e,i){const n=!(this.noFilters||!this.filters||!this.filters.length);return t?(e&&ei.includes(e.type)&&(this.currentHost=e),i&&this.set(i),this.prepareStamp(),n?this.filteredStamp(n):this.regularStamp()):this.visibility?this.checkHitIgnoreTransparency||this.stashOutput||n?this.filteredStamp(n):this.regularStamp():void 0},t.regularStamp=function(){const t=this.currentHost;if(t){const e=t.engine,[i,n]=this.currentStampPosition;t.rotateDestination(e,i,n,this),this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},t.filteredStamp=function(t=!1){const{dirtyFilters:e,currentHost:i,state:n}=this;!e&&this.currentFilters||this.cleanFilters();const{element:s,engine:r,currentDimensions:o}=i,a=o?o[0]:s.width,l=o?o[1]:s.height;if(a&&l){const e=Va(a,l),{element:o,engine:c}=e;this.currentHost=e;const h=this.noCanvasEngineUpdates;this.noCanvasEngineUpdates=!1;const u=n?n.globalCompositeOperation:En;if(n.globalCompositeOperation=En,this.regularStamp(),n.globalCompositeOperation=u,t){const t=this.currentFilters;this.isStencil&&(c.save(),c.globalCompositeOperation=Tn,c.globalAlpha=1,c.resetTransform(),c.drawImage(s,0,0),c.restore(),this.dirtyFilterIdentifier=!0),c.resetTransform();const e=c.getImageData(0,0,a,l);this.preprocessFilters(t);const i=hc.action({identifier:this.filterIdentifier,image:e,filters:t});i&&(c.globalCompositeOperation=En,c.globalAlpha=1,c.resetTransform(),c.putImageData(i,0,0),this.checkHitIgnoreTransparency&&(this.stashedImageData=i))}if(r.save(),r.globalAlpha=n&&n.globalAlpha?n.globalAlpha:1,r.globalCompositeOperation=n&&n.globalCompositeOperation?n.globalCompositeOperation:En,r.resetTransform(),r.drawImage(o,0,0),this.stashOutput){this.stashOutput=!1;const[t,e,i,n]=this.getCellCoverage(c.getImageData(0,0,o.width,o.height));if(this.stashedImageData=c.getImageData(t,e,i,n),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-image`;if(this.stashOutputAsAsset=!1,o.width=i,o.height=n,c.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=o.toDataURL();else{const e=this.group.currentHost.getController();if(e){const i=this,n=document.createElement(hi);n.id=t,n.alt=`A cached image of the ${this.name} ${this.type} entity`,n.onload=function(){e.canvasHold.appendChild(n),i.stashedImage=n,Cc(`#${t}`)},n.src=o.toDataURL()}}}}r.restore(),this.currentHost=i,this.noCanvasEngineUpdates=h,Wa(e)}},t.getCellCoverage=function(t){const{width:e,height:i,data:n}=t;let s,r,o,a,l=0,c=0,h=e,u=i,d=3;for(o=0,a=e*i;o<a;o++)n[d]&&(r=ct(o/e),s=o-r*e,h>s&&(h=s),l<s&&(l=s),u>r&&(u=r),c<r&&(c=r)),d+=4;return h<l&&u<c?[h,u,l-h,c-u]:[0,0,e,i]},t.simpleStamp=function(t,e){t&&ei.includes(t.type)&&(this.currentHost=t,e&&this.set(e),this.prepareStamp(),this.regularStamp())},t.draw=function(t){t.stroke(this.pathObject)},t.fill=function(t){t.fill(this.pathObject,this.winding)},t.drawAndFill=function(t){const e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(e),t.fill(e,this.winding)},t.fillAndDraw=function(t){const e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e)},t.drawThenFill=function(t){const e=this.pathObject;t.stroke(e),t.fill(e,this.winding)},t.fillThenDraw=function(t){const e=this.pathObject;t.fill(e,this.winding),t.stroke(e)},t.clip=function(t){t.clip(this.pathObject,this.winding)},t.clear=function(t){const e=t.globalCompositeOperation;t.globalCompositeOperation=Fe,t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e},t.none=function(){}}const Block=function(t=tr){return this.entityInit(t),t.dimensions||(t.width||(this.currentDimensions[0]=this.dimensions[0]=10),t.height||(this.currentDimensions[1]=this.dimensions[1]=10)),this},td=Block.prototype=Sr();td.type="Block",td.lib=ze,td.isArtefact=!0,td.isAsset=!1,Co(td),Ju(td),td.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,n=this.currentDimensions,s=-e[0]*i,r=-e[1]*i,o=n[0]*i,a=n[1]*i;t.rect(s,r,o,a)}};const ed=function(t){return!!t&&new Block(t)};J.Block=Block;const id="getBezierXY",nd="getQuadraticXY",sd=[],rd={x:0,y:0},od=function(t,e,i){t.x=e,t.y=i},ad=function(t,e){let i=nt(t.y,t.x);i+=.01745329251*e;const n=Ot(t.x*t.x+t.y*t.y);t.x=n*ot(i),t.y=n*xt(i)},ld=function(t,e,i){let n,s,r=[],o=[],a=0;const l=[],c=[];if(t===mi){const[t,e,l,c]=i;n=l-t,s=c-e,a=Ot(n*n+s*s),r=r.concat([t,l]),o=o.concat([e,c])}else if(t===Kt||t===an){const h=t===Kt?id:nd;let u,d,f,p,g,m,y=!1,b=.25,S=0;for(;!y;){for(r.length=0,o.length=0,S=0,l.length=0,c.length=0,m=cd[h](0,...i),u=m.x,d=m.y,r.push(u),o.push(d),g=b;g<=1;g+=b)m=cd[h](g,...i),({x:f,y:p}=m),r.push(f),o.push(p),n=f-u,s=p-d,S+=Ot(n*n+s*s),u=f,d=p,l.push(S),c.push(g);S<a+e&&(y=!0),a=S,b/=2,b<.004&&(y=!0)}}return{length:a,xPoints:r,yPoints:o,positions:c,progression:l}},cd={[id]:function(t,e,i,n,s,r,o,a,l){const c=1-t;return{x:kt(c,3)*e+3*t*kt(c,2)*n+3*t*t*c*r+t*t*t*a,y:kt(c,3)*i+3*t*kt(c,2)*s+3*t*t*c*o+t*t*t*l}},[nd]:function(t,e,i,n,s,r,o){const a=1-t;return{x:a*a*e+2*a*t*n+t*t*r,y:a*a*i+2*a*t*s+t*t*o}}};function hd(t=tr){Ju(t);const e={species:zs,useAsPath:!1,precision:10,pathDefinition:zs,showBoundingBox:!1,boundingBoxColor:"rgb(0 0 0 / 0.5)",minimumBoundingBoxDimensions:20};t.defs=hr(t.defs,e),t.packetExclusions=dr(t.packetExclusions,["dimensions","pathed"]),t.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=hr(t,i),t=this.handlePacketAnchor(t,e)};const i=t.setters,n=t.deltaSetters;i.species=function(t){pr(t)&&(this.species=t,this.updateDirty())},i.precision=function(t){pr(t)&&t.toFixed&&(this.precision=t,this.updateDirty())},i.width=qs,i.height=qs,i.dimensions=qs,n.width=qs,n.height=qs,n.dimensions=qs,i.pathDefinition=function(t){t.substring&&(this.pathDefinition=t),this.pathCalculatedOnce=!1,this.dirtyPathObject=!0},t.updateDirty=function(){this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},t.shapeInit=function(t){this.units=[],this.unitLengths=[],this.unitPartials=[],this.pathed=[],this.localBox=[],this.localPath=null,this.length=0,this.unitProgression=[],this.unitPositions=[],this.entityInit(t)},t.positionPointOnPath=function(t){const e=Hh(t);e.vectorSubtract(this.currentStampHandlePosition),this.flipReverse&&(e.x=-e.x),this.flipUpend&&(e.y=-e.y),e.rotate(this.roll),e.vectorAdd(this.currentStampPosition);const i={x:e.x,y:e.y};return Eh(e),i},t.getBezierXY=function(t,e,i,n,s,r,o,a,l){const c=1-t;return{x:kt(c,3)*e+3*t*kt(c,2)*n+3*t*t*c*r+t*t*t*a,y:kt(c,3)*i+3*t*kt(c,2)*s+3*t*t*c*o+t*t*t*l}},t.getQuadraticXY=function(t,e,i,n,s,r,o){const a=1-t;return{x:a*a*e+2*a*t*n+t*t*r,y:a*a*i+2*a*t*s+t*t*o}},t.getLinearXY=function(t,e,i,n,s){return{x:e+(n-e)*t,y:i+(s-i)*t}},t.getBezierAngle=function(t,e,i,n,s,r,o,a,l){const c=1-t,h=kt(c,2)*(n-e)+2*t*c*(r-n)+t*t*(a-r),u=kt(c,2)*(s-i)+2*t*c*(o-s)+t*t*(l-o);return(-nt(h,u)+St)/Ct},t.getQuadraticAngle=function(t,e,i,n,s,r,o){const a=1-t;return(-nt(2*a*(n-e)+2*t*(r-n),2*a*(s-i)+2*t*(o-s))+St)/Ct},t.getLinearAngle=function(t,e,i,n,s){return(-nt(n-e,s-i)+St)/Ct},t.getConstantPosition=function(t){if(!dt(t))return 0;if(t>=1)return.9999;const{unitPositions:e,unitProgression:i,length:n}=this;if(e&&e.length){const s=e.length;let r,o=0,a=0,l=0;for(let c=0;c<s;c++)r=i[c]/n,t>r&&(a=e[c],l=r,o++);const c=o?t-l:t,h=o?(i[o]-i[o-1])/n:i[o]/n;return a+=c*((o?e[o]-e[o-1]:e[o])/h),a}return t},t.buildPathPositionObject=function(t,e){if(t){const[i,...n]=t;let s,r;switch(i){case mi:s=this.positionPointOnPath(this.getLinearXY(e,...n)),r=this.getLinearAngle(e,...n);break;case an:s=this.positionPointOnPath(this.getQuadraticXY(e,...n)),r=this.getQuadraticAngle(e,...n);break;case Kt:s=this.positionPointOnPath(this.getBezierXY(e,...n)),r=this.getBezierAngle(e,...n)}let o=0;return this.flipReverse&&o++,this.flipUpend&&o++,1===o&&(r=-r),r+=this.roll,s.angle=r,s}return!1},t.getPathPositionData=function(t,e=!1){if(this.useAsPath&&pr(t)&&t.toFixed){const i=this.unitPartials;let n,s,r,o,a,l,c=0,h=t%1;for(0===t?h=0:1===t&&(h=.9999),e&&(h=this.getConstantPosition(h)),r=0,o=i.length;r<o;r++)if(l=this.units[r][0],l!==Ei&&l!==ge&&l!==Hs){if(n=i[r],h<=n){a=this.units[r],s=(h-c)/(n-c);break}c=n}return this.buildPathPositionObject(a,s)}return!1},t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyHandle)&&(this.dirtyPathObject=!0,(this.dirtyScale||this.dirtySpecies)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},t.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0},t.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.dirtyDimensions&&(this.cleanSpecies(),this.pathCalculatedOnce=!1),this.calculateLocalPath(this.pathDefinition),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyHandle&&this.cleanHandle(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions();const t=this.currentStampHandlePosition;this.pathObject=new Path2D(`m${-t[0]},${-t[1]}${this.localPath}`)}},t.calculateLocalPath=function(t,e){let i;if(this.pathCalculatedOnce||(i=((t,e,i,n,s,r)=>{const o=Jr(),a=Jr(),l=Jr(),c=Jr(),h=r.units,u=r.unitLengths,d=r.unitPartials,f=r.unitProgression,p=r.unitPositions,g=t.match(/([A-Za-z][0-9. ,-]*)/g),m=/(-?[0-9.]+\b)/g;let y,b,S,k,C,A=zs,v=zs,P=0,x=0,O=0,w=0,D=0,F=0,R=0;const T=t=>{a.push({c:A.toLowerCase(),p:t||null,x:w,y:D,cx:x,cy:O,rx:F,ry:R}),n||(l.push(x),c.push(O)),w=x,D=O};for(y=0,b=g.length;y<b;y++)if(A=g[y][0],o.length=0,C=g[y].match(m),C&&o.push(...C),o.length){for(S=0,k=o.length;S<k;S++)o[S]=parseFloat(o[S]);switch(0===y?"M"===A&&(w=o[0]*e-i.x,D=o[1]*e-i.y,A="m"):(w=x,D=O),A){case"H":for(S=0,k=o.length;S<k;S++)o[S]=o[S]*e-w,x+=o[S],F=R=0,T(o.slice(S,S+1));break;case"V":for(S=0,k=o.length;S<k;S++)o[S]=o[S]*e-D,O+=o[S],F=R=0,T(o.slice(S,S+1));break;case"M":for(S=0,k=o.length;S<k;S+=2)o[S]=o[S]*e-w,o[S+1]=o[S+1]*e-D,x+=o[S],O+=o[S+1],F=R=0,T(o.slice(S,S+2));break;case"L":case"T":for(S=0,k=o.length;S<k;S+=2)o[S]=o[S]*e-w,o[S+1]=o[S+1]*e-D,x+=o[S],O+=o[S+1],"T"===A?(F=o[S]+w,R=o[S+1]+D):F=R=0,T(o.slice(S,S+2));break;case"Q":case"S":for(S=0,k=o.length;S<k;S+=4)o[S]=o[S]*e-w,o[S+1]=o[S+1]*e-D,o[S+2]=o[S+2]*e-w,o[S+3]=o[S+3]*e-D,x+=o[S+2],O+=o[S+3],F=o[S]+w,R=o[S+1]+D,T(o.slice(S,S+4));break;case"C":for(S=0,k=o.length;S<k;S+=6)o[S]=o[S]*e-w,o[S+1]=o[S+1]*e-D,o[S+2]=o[S+2]*e-w,o[S+3]=o[S+3]*e-D,o[S+4]=o[S+4]*e-w,o[S+5]=o[S+5]*e-D,x+=o[S+4],O+=o[S+5],F=o[S+2]+w,R=o[S+3]+D,T(o.slice(S,S+6));break;case"A":for(S=0,k=o.length;S<k;S+=7)o[S+5]=o[S+5]*e-w,o[S+6]=o[S+6]*e-D,x+=o[S+5],O+=o[S+6],F=R=0,T(o.slice(S,S+7));break;case"h":for(S=0,k=o.length;S<k;S++)o[S]*=e,x+=o[S],F=R=0,T(o.slice(S,S+1));break;case"v":for(S=0,k=o.length;S<k;S++)o[S]*=e,O+=o[S],F=R=0,T(o.slice(S,S+1));break;case"m":case"l":case"t":for(S=0,k=o.length;S<k;S+=2)o[S]*=e,o[S+1]*=e,x+=o[S],O+=o[S+1],"t"===A?(F=o[S]+w,R=o[S+1]+D):F=R=0,T(o.slice(S,S+2));break;case"q":case"s":for(S=0,k=o.length;S<k;S+=4)o[S]*=e,o[S+1]*=e,o[S+2]*=e,o[S+3]*=e,x+=o[S+2],O+=o[S+3],F=o[S]+w,R=o[S+1]+D,T(o.slice(S,S+4));break;case"c":for(S=0,k=o.length;S<k;S+=6)o[S]*=e,o[S+1]*=e,o[S+2]*=e,o[S+3]*=e,o[S+4]*=e,o[S+5]*=e,x+=o[S+4],O+=o[S+5],F=o[S+2]+w,R=o[S+3]+D,T(o.slice(S,S+6));break;case"a":for(S=0,k=o.length;S<k;S+=7)o[S]*=e,o[S+1]*=e,o[S+5]*=e,o[S+6]*=e,x+=o[S+5],O+=o[S+6],F=R=0,T(o.slice(S,S+7))}}else F=R=0,T();for(y=0,b=a.length;y<b;y++){const t=a[y];v+=t.p?`${t.c}${t.p.join()}`:`${t.c}`}if(r.localPath=v,n){const t=rd;let e,i,n,r,o,g,m,S;for(y=0,b=a.length;y<b;y++)if(e=a[y],i=y>0&&a[y-1],({c:n,p:r,x:o,y:g,cx:m,cy:S}=e),r)switch(n){case"h":h[y]=[mi,o,g,r[0]+o,g];break;case"v":h[y]=[mi,o,g,o,r[0]+g];break;case"m":h[y]=[Ei,o,g];break;case"l":h[y]=[mi,o,g,r[0]+o,r[1]+g];break;case"t":i&&(i.rx||i.ry)?(od(t,i.rx-m,i.ry-S),ad(t,180),h[y]=[an,o,g,t.x+m,t.y+S,r[0]+o,r[1]+g]):h[y]=[an,o,g,o,g,r[0]+o,r[1]+g];break;case"q":h[y]=[an,o,g,r[0]+o,r[1]+g,r[2]+o,r[3]+g];break;case"s":i&&(i.rx||i.ry)?(od(t,i.rx-m,i.ry-S),ad(t,180),h[y]=[Kt,o,g,t.x+m,t.y+S,r[0]+o,r[1]+g,r[2]+o,r[3]+g]):h[y]=[Kt,o,g,o,g,r[0]+o,r[1]+g,r[2]+o,r[3]+g];break;case"c":h[y]=[Kt,o,g,r[0]+o,r[1]+g,r[2]+o,r[3]+g,r[4]+o,r[5]+g];break;case"a":h[y]=[mi,o,g,r[5]+o,r[6]+g];break;case"z":dt(o)||(o=0),dt(g)||(g=0),h[y]=[ge,o,g];break;default:dt(o)||(o=0),dt(g)||(g=0),h[y]=[Hs,o,g]}else h[y]=[`no-points-${n}`,o,g];for(y=0,b=h.length;y<b;y++){const[t,...e]=h[y];let i;switch(t){case mi:case an:case Kt:i=ld(t,s,e),u[y]=i.length,l.push(...i.xPoints),c.push(...i.yPoints),f.push(i.progression),p.push(i.positions);break;default:u[y]=0}}P=u.reduce(((t,e)=>t+e),0);let k=0;for(y=0,b=u.length;y<b;y++)k+=u[y]/P,d[y]=k}return r.length=P,r.maxX=pt(...l),r.maxY=pt(...c),r.minX=gt(...l),r.minY=gt(...c),r.xRange.push(...l),r.yRange.push(...c),to(o,a,l,c),r})(t,this.currentScale,this.currentStart,this.useAsPath,this.precision,(sd.length||sd.push({localPath:null,length:0,maxX:0,maxY:0,minX:0,minY:0,unitLengths:[],unitPartials:[],units:[],unitPositions:[],unitProgression:[],xRange:[],yRange:[]}),sd.shift())),this.pathCalculatedOnce=!0),i){this.localPath=i.localPath,this.length=i.length;const t=i.maxX,s=i.maxY,r=i.minX,o=i.minY,a=this.dimensions,l=this.currentDimensions,c=this.localBox;if(a[0]=t-r,a[1]=s-o,a[0]===l[0]&&a[1]===l[1]||(l[0]=a[0],l[1]=a[1],this.dirtyHandle=!0),c.length=0,c.push(r,o,a[0],a[1]),this.useAsPath){const{units:t,unitLengths:e,unitPartials:n,unitProgression:s,unitPositions:r}=i,o=Jr(),a=Jr();let l,c,h,u,d,f,p,g,m,y,b=0;for(d=0,f=e.length;d<f;d++)if(b+=e[d],h=s[d],h)for(c=n[d],l=n[d+1]-c,u=r[d],p=0,g=h.length;p<g;p++)m=b+h[p],o.push(m),y=c+u[p]*l,a.push(y);this.units.length=0,this.units.push(...t),this.unitLengths.length=0,this.unitLengths.push(...e),this.unitPartials.length=0,this.unitPartials.push(...n),this.unitProgression||(this.unitProgression=[]),this.unitProgression.length=0,this.unitProgression.push(...o),this.unitPositions||(this.unitPositions=[]),this.unitPositions.length=0,this.unitPositions.push(...a),to(o,a)}(n=i).localPath=null,n.length=0,n.units.length=0,n.maxX=0,n.maxY=0,n.minX=0,n.minY=0,n.unitLengths.length=0,n.unitPartials.length=0,n.unitPositions.length=0,n.unitProgression.length=0,n.xRange.length=0,n.yRange.length=0,sd.push(n),e||this.calculateLocalPathAdditionalActions()}var n},t.calculateLocalPathAdditionalActions=qs,t.updatePathSubscribers=function(){let t;this.pathed.forEach((e=>{t=o[e],t&&(t.currentPathData=!1,t.dirtyStart=!0,t.addPathHandle&&(t.dirtyHandle=!0),t.addPathOffset&&(t.dirtyOffset=!0),t.addPathRotation&&(t.dirtyRotation=!0),t.type===os?t.dirtyPins=!0:t.type!==es&&t.type!==as&&t.type!==Vn||t.dirtyPins.push(this.name))}),this)},t.draw=function(t){t.stroke(this.pathObject),this.showBoundingBox&&this.drawBoundingBox(t)},t.fill=function(t){t.fill(this.pathObject,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.drawAndFill=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.fillAndDraw=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e),this.showBoundingBox&&this.drawBoundingBox(t)},t.drawThenFill=function(t){const e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.showBoundingBox&&this.drawBoundingBox(t)},t.fillThenDraw=function(t){const e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.showBoundingBox&&this.drawBoundingBox(t)},t.clear=function(t){const e=t.globalCompositeOperation;t.globalCompositeOperation=Fe,t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e,this.showBoundingBox&&this.drawBoundingBox(t)},t.drawBoundingBox=function(t){t.save(),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation=En,t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.strokeRect(...this.getBoundingBox()),t.restore()},t.getBoundingBox=function(){const t=this.minimumBoundingBoxDimensions;let[e,i,n,s]=this.localBox;const[r,o]=this.currentStampHandlePosition,[a,l]=this.currentStampPosition;return n<t&&(n=t),s<t&&(s=t),[ct(e-r),ct(i-o),st(n),st(s),a,l]}}const ud=t=>t.substring?t.charAt(0).toUpperCase()+t.slice(1):zs;function dd(t=tr){const e={end:null,endPivot:zs,endPivotCorner:zs,endPivotIndex:-1,addEndPivotHandle:!1,addEndPivotOffset:!1,endPath:zs,endPathPosition:0,addEndPathHandle:!1,addEndPathOffset:!0,endParticle:zs,endLockTo:zs,useStartAsControlPoint:!1};t.defs=hr(t.defs,e),t.packetExclusions=dr(t.packetExclusions,["controlledLineOffset"]),t.packetCoordinates=dr(t.packetCoordinates,["end"]),t.packetObjects=dr(t.packetObjects,["endPivot","endPath"]),t.factoryKill=function(){Dt(o).forEach((t=>{t.name!==this.name&&(t.startControlPivot&&t.startControlPivot.name===this.name&&t.set({startControlPivot:!1}),t.controlPivot&&t.controlPivot.name===this.name&&t.set({controlPivot:!1}),t.endControlPivot&&t.endControlPivot.name===this.name&&t.set({endControlPivot:!1}),t.endPivot&&t.endPivot.name===this.name&&t.set({endPivot:!1}),t.startControlPath&&t.startControlPath.name===this.name&&t.set({startControlPath:!1}),t.controlPath&&t.controlPath.name===this.name&&t.set({controlPath:!1}),t.endControlPath&&t.endControlPath.name===this.name&&t.set({endControlPath:!1}),t.endPath&&t.endPath.name===this.name&&t.set({endPath:!1}))}))};const i=t.getters,n=t.setters,s=t.deltaSetters;n.useStartAsControlPoint=function(t){if(this.useStartAsControlPoint=t,!t){const t=this.controlledLineOffset;t[0]=0,t[1]=0}this.updateDirty()},n.endPivot=function(t){this.setControlHelper(t,"endPivot",Ye),this.updateDirty(),this.dirtyEnd=!0},n.endParticle=function(t){this.setControlHelper(t,"endParticle",Ye),this.updateDirty(),this.dirtyEnd=!0},n.endPath=function(t){this.setControlHelper(t,"endPath",Ye),this.updateDirty(),this.dirtyEnd=!0},n.endPathPosition=function(t){this.endPathPosition=t,this.dirtyEnd=!0,this.currentEndPathData=!1,this.dirtyFilterIdentifier=!0},s.endPathPosition=function(t){this.endPathPosition+=t,this.dirtyEnd=!0,this.currentEndPathData=!1,this.dirtyFilterIdentifier=!0},i.endPositionX=function(){return this.currentEnd[0]},i.endPositionY=function(){return this.currentEnd[1]},i.endPosition=function(){return[].concat(this.currentEnd)},n.endX=function(t){null!=t&&(this.end[0]=t,this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1)},n.endY=function(t){null!=t&&(this.end[1]=t,this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1)},n.end=function(t,e){this.setCoordinateHelper(Ye,t,e),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.endX=function(t){const e=this.end;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.endY=function(t){const e=this.end;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},s.end=function(t,e){this.setDeltaCoordinateHelper(Ye,t,e),this.updateDirty(),this.dirtyEnd=!0,this.currentEndPathData=!1},n.endLockTo=function(t){this.endLockTo=t,this.updateDirty(),this.dirtyEndLock=!0,this.currentEndPathData=!1},t.curveInit=function(){this.end=qa(),this.currentEnd=qa(),this.endLockTo=ke,this.dirtyEnd=!0,this.dirtyPins=[],this.controlledLineOffset=qa()},t.setControlHelper=function(t,e,i){if(nr(t)&&!t)this[e]=null,i===$n?this.dirtyStartControlLock=!0:i===Se?this.dirtyControlLock=!0:i===Ge?this.dirtyEndControlLock=!0:this.dirtyEndLock=!0;else if(t){const n=this[e];let s=t.substring?o[t]:t;e.includes("Pivot")?s&&s.isArtefact&&(n&&n.isArtefact&&fr(n.pivoted,this.name),dr(s.pivoted,this.name),this[e]=s):e.includes("Path")?s&&s.isArtefact&&(n&&n.isArtefact&&fr(n.pathed,this.name),dr(s.pathed,this.name),this[e]=s):e.includes(ss)&&(s=t.substring?P[t]:t,s||(this.updateDirty(),i===$n?this.dirtyStartControl=!0:i===Se?this.dirtyControl=!0:i===Ge?this.dirtyEndControl=!0:this.dirtyEnd=!0,this[e]=t))}},t.buildPathPositionObject=function(t,e){if(t){const[i,...n]=t;let s,r;switch(i){case mi:s=this.positionPointOnPath(this.getLinearXY(e,...n)),r=this.getLinearAngle(e,...n);break;case an:s=this.positionPointOnPath(this.getQuadraticXY(e,...n)),r=this.getQuadraticAngle(e,...n);break;case Kt:s=this.positionPointOnPath(this.getBezierXY(e,...n)),r=this.getBezierAngle(e,...n)}let o=0;this.flipReverse&&o++,this.flipUpend&&o++,1===o&&(r=-r),r+=this.roll;const a=this.controlledLineOffset;return s.x+=a[0],s.y+=a[1],s.angle=r,s}return!1},t.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),this.dirtyPins.length&&this.preparePinsForStamp(),this.dirtyLock&&this.cleanLock(),this.dirtyStartControlLock&&this.cleanControlLock($n),this.dirtyEndControlLock&&this.cleanControlLock(Ge),this.dirtyControlLock&&this.cleanControlLock(Se),this.dirtyEndLock&&this.cleanControlLock(Ye),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyStartControl||this.dirtyEndControl||this.dirtyControl||this.dirtyEnd||this.dirtyHandle)&&(this.dirtyPathObject=!0,this.useStartAsControlPoint&&this.dirtyStart&&(this.dirtySpecies=!0,this.pathCalculatedOnce=!1),(this.dirtyScale||this.dirtySpecies||this.dirtyStartControl||this.dirtyEndControl||this.dirtyControl||this.dirtyEnd)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.useStartAsControlPoint&&(this.dirtySpecies=!0,this.dirtyPathObject=!0,this.pathCalculatedOnce=!1)),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),(this.dirtyStartControl||this.startControlLockTo===zi)&&this.cleanControl($n),(this.dirtyEndControl||this.endControlLockTo===zi)&&this.cleanControl(Ge),(this.dirtyControl||this.controlLockTo===zi)&&this.cleanControl(Se),(this.dirtyEnd||this.endLockTo===zi)&&this.cleanControl(Ye),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&(this.updatePositionSubscribers(),this.updateControlPathSubscribers()),this.prepareStampTabsHelper()},t.cleanControlLock=function(t){const e=ud(t);this[`dirty${e}Lock`]=!1,this[`dirty${e}`]=!0},t.cleanControl=function(t){const e=ud(t);this[`dirty${e}`]=!1;let i,n,s=this[`${t}Pivot`],r=this[`${t}Path`],a=this[`${t}Particle`];s&&s.substring&&(i=o[s],i&&(s=i)),r&&r.substring&&(i=o[r],i&&(r=i)),a&&a.substring&&(i=P[a],i&&(a=i));let l,c,h,u,d,f,p,g=this[`${t}LockTo`];const m=this[t],y=this[`current${e}`];switch((g!==Ki||s&&!s.substring)&&(g!==Ni||r&&!r.substring)&&(g!==zi||a&&!a.substring)||(g=ke),g){case Ki:if(this.pivotCorner&&s.getCornerCoordinate)[l,c]=s.getCornerCoordinate(this[`${t}PivotCorner`]);else if(s.type===Kn)if(this[`${t}PivotIndex`]<0)s.layoutTemplate?[l,c]=s.layoutTemplate.currentStampPosition:this[`dirty${e}`]=!0;else{const i=s.getUnitStartAt(this[`${t}PivotIndex`]);i?[l,c]=i:this[`dirty${e}`]=!0}else[l,c]=s.currentStampPosition;this.addPivotOffset||([h,u]=s.currentOffset,l-=h,c-=u);break;case Ni:n=this.getControlPathData(r,t,e),l=n.x,c=n.y,this.addPathOffset||(l-=r.currentOffset[0],c-=r.currentOffset[1]);break;case zi:l=a.position.x,c=a.position.y,this.pathCalculatedOnce=!1;break;case wi:d=this.getHere(),l=d.x||0,c=d.y||0;break;default:l=c=0,f=this.getHost(),f&&(p=f.currentDimensions,p&&(this.cleanPosition(y,m,p),[l,c]=y))}y[0]=l,y[1]=c,this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyPositionSubscribers=!0},t.getControlPathData=function(t,e,i){const n=this[`current${i}PathData`];if(n)return n;let s=this[`${e}PathPosition`];const r=s,o=t.getPathPositionData(s);if(s<0&&(s+=1),s>1&&(s%=1),s=parseFloat(s.toFixed(6)),s!==r&&(this[`${e}PathPosition`]=s),o)return this[`current${i}PathData`]=o,o;{const t=this.getHost();if(t){const n=t.currentDimensions;if(n){const t=this[`current${i}`];return this.cleanPosition(t,this[e],n),{x:t[0],y:t[1]}}}return{x:0,y:0}}},t.updateControlPathSubscribers=function(){let t;[].concat(this.endSubscriber,this.endControlSubscriber,this.controlSubscriber,this.startControlSubscriber).forEach((e=>{t=o[e],t&&(t.type!==es&&t.type!==as&&t.type!==Vn||(t.type===as?(t.dirtyControl=!0,t.currentControlPathData=!1):t.type===Vn&&(t.dirtyStartControl=!0,t.dirtyEndControl=!0,t.currentStartControlPathData=!1,t.currentEndControlPathData=!1),t.currentEndPathData=!1,t.dirtyEnd=!0),t.currentPathData=!1,t.dirtyStart=!0)}))}}const Bezier=function(t=tr){return this.startControl=qa(),this.endControl=qa(),this.currentStartControl=qa(),this.currentEndControl=qa(),this.startControlLockTo=ke,this.endControlLockTo=ke,this.curveInit(t),this.shapeInit(t),this.dirtyStartControl=!0,this.dirtyEndControl=!0,this},fd=Bezier.prototype=Sr();fd.type=Vn,fd.lib=ze,fd.isArtefact=!0,fd.isAsset=!1,Co(fd),hd(fd),dd(fd);const pd={startControl:null,startControlPivot:zs,startControlPivotIndex:-1,startControlPivotCorner:zs,addStartControlPivotHandle:!1,addStartControlPivotOffset:!1,startControlPath:zs,startControlPathPosition:0,addStartControlPathHandle:!1,addStartControlPathOffset:!0,startControlParticle:zs,endControl:null,endControlPivot:zs,endControlPivotIndex:-1,endControlPivotCorner:zs,addEndControlPivotHandle:!1,addEndControlPivotOffset:!1,endControlPath:zs,endControlPathPosition:0,addEndControlPathHandle:!1,addEndControlPathOffset:!0,endControlParticle:zs,startControlLockTo:zs,endControlLockTo:zs};fd.defs=hr(fd.defs,pd),fd.packetCoordinates=dr(fd.packetCoordinates,["startControl","endControl"]),fd.packetObjects=dr(fd.packetObjects,["startControlPivot","startControlParticle","startControlPath","endControlPivot","endControlParticle","endControlPath"]);const gd=fd.getters,md=fd.setters,yd=fd.deltaSetters;md.endControlPivot=function(t){this.setControlHelper(t,"endControlPivot",Ge),this.updateDirty(),this.dirtyEndControl=!0},md.endControlParticle=function(t){this.setControlHelper(t,"endControlParticle",Ge),this.updateDirty(),this.dirtyEndControl=!0},md.endControlPath=function(t){this.setControlHelper(t,"endControlPath",Ge),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},md.endControlPathPosition=function(t){this.endControlPathPosition=t,this.dirtyEndControl=!0,this.currentEndControlPathData=!1,this.dirtyFilterIdentifier=!0},yd.endControlPathPosition=function(t){this.endControlPathPosition+=t,this.dirtyEndControl=!0,this.currentEndControlPathData=!1,this.dirtyFilterIdentifier=!0},md.startControlPivot=function(t){this.setControlHelper(t,"startControlPivot",$n),this.updateDirty(),this.dirtyStartControl=!0},md.startControlParticle=function(t){this.setControlHelper(t,"startControlParticle",$n),this.updateDirty(),this.dirtyStartControl=!0},md.startControlPath=function(t){this.setControlHelper(t,"startControlPath",$n),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},md.startControlPathPosition=function(t){this.startControlPathPosition=t,this.dirtyStartControl=!0,this.currentStartControlPathData=!1,this.dirtyFilterIdentifier=!0},yd.startControlPathPosition=function(t){this.startControlPathPosition+=t,this.dirtyStartControl=!0,this.currentStartControlPathData=!1,this.dirtyFilterIdentifier=!0},gd.startControlPositionX=function(){return this.currentStartControl[0]},gd.startControlPositionY=function(){return this.currentStartControl[1]},gd.startControlPosition=function(){return[].concat(this.currentStartControl)},md.startControlX=function(t){null!=t&&(this.startControl[0]=t,this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1)},md.startControlY=function(t){null!=t&&(this.startControl[1]=t,this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1)},md.startControl=function(t,e){this.setCoordinateHelper($n,t,e),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},yd.startControlX=function(t){const e=this.startControl;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},yd.startControlY=function(t){const e=this.startControl;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},yd.startControl=function(t,e){this.setDeltaCoordinateHelper($n,t,e),this.updateDirty(),this.dirtyStartControl=!0,this.currentStartControlPathData=!1},gd.endControlPositionX=function(){return this.currentEndControl[0]},gd.endControlPositionY=function(){return this.currentEndControl[1]},gd.endControlPosition=function(){return[].concat(this.currentEndControl)},md.endControlX=function(t){null!=t&&(this.endControl[0]=t,this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1)},md.endControlY=function(t){null!=t&&(this.endControl[1]=t,this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1)},md.endControl=function(t,e){this.setCoordinateHelper(Ge,t,e),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},yd.endControlX=function(t){const e=this.endControl;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},yd.endControlY=function(t){const e=this.endControl;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},yd.endControl=function(t,e){this.setDeltaCoordinateHelper(Ge,t,e),this.updateDirty(),this.dirtyEndControl=!0,this.currentEndControlPathData=!1},md.startControlLockTo=function(t){this.startControlLockTo=t,this.updateDirty(),this.dirtyStartControlLock=!0},md.endControlLockTo=function(t){this.endControlLockTo=t,this.updateDirty(),this.dirtyEndControlLock=!0,this.currentEndControlPathData=!1},fd.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeBezierPath()},fd.makeBezierPath=function(){const[t,e]=this.currentStampPosition,[i,n]=this.currentStartControl,[s,r]=this.currentEndControl,[o,a]=this.currentEnd;return`m0,0c${(i-t).toFixed(2)},${(n-e).toFixed(2)} ${(s-t).toFixed(2)},${(r-e).toFixed(2)} ${(o-t).toFixed(2)},${(a-e).toFixed(2)}`},fd.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyStartControl=!0,this.dirtyEndControl=!0,this.dirtyEnd=!0,this.dirtyFilterIdentifier=!0},fd.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath,n=this.startControlPivot,s=this.startControlPath,r=this.endControlPivot,o=this.endControlPath;for(let a,l=0,c=t.length;l<c;l++)a=t[l],(n&&n.name===a||s&&s.name===a)&&(this.dirtyStartControl=!0,this.startControlLockTo.includes(Ni)&&(this.currentStartControlPathData=!1)),(r&&r.name===a||o&&o.name===a)&&(this.dirtyEndControl=!0,this.endControlLockTo.includes(Ni)&&(this.currentEndControlPathData=!1)),(e&&e.name===a||i&&i.name===a)&&(this.dirtyEnd=!0,this.endLockTo.includes(Ni)&&(this.currentEndPathData=!1));t.length=0};const bd=function(t=tr){return!!t&&(t.species=Kt,new Bezier(t))};J.Bezier=Bezier;const Sd=["line","quadratic","bezier"],Cog=function(t=tr){return this.shapeInit(t),this},kd=Cog.prototype=Sr();kd.type="Cog",kd.lib=ze,kd.isArtefact=!0,kd.isAsset=!1,Co(kd),hd(kd);const Cd={outerRadius:0,innerRadius:0,outerControlsDistance:0,innerControlsDistance:0,outerControlsOffset:0,innerControlsOffset:0,points:0,twist:0,curve:Kt};kd.defs=hr(kd.defs,Cd);const Ad=kd.setters,vd=kd.deltaSetters;Ad.outerRadius=function(t){this.outerRadius=t,this.updateDirty()},vd.outerRadius=function(t){this.outerRadius+=t,this.updateDirty()},Ad.innerRadius=function(t){this.innerRadius=t,this.updateDirty()},vd.innerRadius=function(t){this.innerRadius+=t,this.updateDirty()},Ad.outerControlsDistance=function(t){this.outerControlsDistance=t,this.updateDirty()},vd.outerControlsDistance=function(t){this.outerControlsDistance+=t,this.updateDirty()},Ad.innerControlsDistance=function(t){this.innerControlsDistance=t,this.updateDirty()},vd.innerControlsDistance=function(t){this.innerControlsDistance+=t,this.updateDirty()},Ad.outerControlsOffset=function(t){this.outerControlsOffset=t,this.updateDirty()},vd.outerControlsOffset=function(t){this.outerControlsOffset+=t,this.updateDirty()},Ad.innerControlsOffset=function(t){this.innerControlsOffset=t,this.updateDirty()},vd.innerControlsOffset=function(t){this.innerControlsOffset+=t,this.updateDirty()},Ad.points=function(t){this.points=t,this.updateDirty()},vd.points=function(t){this.points+=t,this.updateDirty()},Ad.twist=function(t){this.twist=t,this.updateDirty()},vd.twist=function(t){this.twist+=t,this.updateDirty()},Ad.curve=function(t){t&&Sd.includes(t)?this.curve=t:this.curve=Kt,this.updateDirty()},kd.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeCogPath()},kd.makeCogPath=function(){const{points:t,twist:e,curve:i}=this;let{outerRadius:n,innerRadius:s,outerControlsDistance:r,innerControlsDistance:o,outerControlsOffset:a,innerControlsOffset:l}=this;const c=360/t;let h,u,d,f,p,g=zs;if(n.substring||s.substring||r.substring||o.substring||a.substring||l.substring){const t=this.getHost();if(t){const[e]=t.currentDimensions;n=n.substring?parseFloat(n)/100*e:n,s=s.substring?parseFloat(s)/100*e:s,r=r.substring?parseFloat(r)/100*e:r,o=o.substring?parseFloat(o)/100*e:o,a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*e:l}}const m=Hh({x:0,y:-n}),y=Hh({x:0,y:-s}),b=Hh({x:r+a,y:-n}),S=Hh({x:-o+l,y:-s}),k=Hh({x:o+l,y:-s}),C=Hh({x:-r+a,y:-n});if(S.rotate(-c/2),S.rotate(e),y.rotate(-c/2),y.rotate(e),k.rotate(-c/2),k.rotate(e),h=m.x,u=m.y,i===Kt)for(p=0;p<t;p++)d=parseFloat((b.x-h).toFixed(1)),f=parseFloat((b.y-u).toFixed(1)),g+=`${d},${f} `,S.rotate(c),y.rotate(c),k.rotate(c),d=parseFloat((S.x-h).toFixed(1)),f=parseFloat((S.y-u).toFixed(1)),g+=`${d},${f} `,d=parseFloat((y.x-h).toFixed(1)),h+=d,f=parseFloat((y.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((k.x-h).toFixed(1)),f=parseFloat((k.y-u).toFixed(1)),g+=`${d},${f} `,C.rotate(c),m.rotate(c),b.rotate(c),d=parseFloat((C.x-h).toFixed(1)),f=parseFloat((C.y-u).toFixed(1)),g+=`${d},${f} `,d=parseFloat((m.x-h).toFixed(1)),h+=d,f=parseFloat((m.y-u).toFixed(1)),u+=f,g+=`${d},${f} `;else if(i===an)for(p=0;p<t;p++)d=parseFloat((b.x-h).toFixed(1)),f=parseFloat((b.y-u).toFixed(1)),g+=`${d},${f} `,y.rotate(c),k.rotate(c),d=parseFloat((y.x-h).toFixed(1)),h+=d,f=parseFloat((y.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((k.x-h).toFixed(1)),f=parseFloat((k.y-u).toFixed(1)),g+=`${d},${f} `,m.rotate(c),b.rotate(c),d=parseFloat((m.x-h).toFixed(1)),h+=d,f=parseFloat((m.y-u).toFixed(1)),u+=f,g+=`${d},${f} `;else for(p=0;p<t;p++)d=parseFloat((b.x-h).toFixed(1)),h+=d,f=parseFloat((b.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,S.rotate(c),y.rotate(c),k.rotate(c),d=parseFloat((S.x-h).toFixed(1)),h+=d,f=parseFloat((S.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((y.x-h).toFixed(1)),h+=d,f=parseFloat((y.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((k.x-h).toFixed(1)),h+=d,f=parseFloat((k.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,C.rotate(c),m.rotate(c),b.rotate(c),d=parseFloat((C.x-h).toFixed(1)),h+=d,f=parseFloat((C.y-u).toFixed(1)),u+=f,g+=`${d},${f} `,d=parseFloat((m.x-h).toFixed(1)),h+=d,f=parseFloat((m.y-u).toFixed(1)),u+=f,g+=`${d},${f} `;return Eh(m,b,C,y,k,S),i===Kt?`${js}c${g}z`:i===an?`${js}q${g}z`:`${js}l${g}z`},kd.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(js,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Pd=function(t){return!!t&&(t.species="cog",new Cog(t))};J.Cog=Cog;const Palette=function(t=tr){return this.makeName(t.name),this.register(),this.factory=Yl({name:`${this.name}-color-factory`}),this.set(this.defs),this.colors=t.colors||{"0 ":[0,0,0,1],"999 ":[255,255,255,1]},this.stops=Array(1e3).fill(Jt),this.easingFunction=Qs,this.set(t),this.dirtyPalette=!0,this},xd=Palette.prototype=Sr();xd.type=ns,xd.lib="palette",xd.isArtefact=!1,xd.isAsset=!1,Co(xd);const Od={colors:null,stops:null,cyclic:!1,easing:mi,easingFunction:null,precision:25};xd.defs=hr(xd.defs,Od),xd.packetFunctions=dr(xd.packetFunctions,["easingFunction"]),xd.packetExclusions=dr(xd.packetExclusions,["stops"]),xd.kill=function(){return this.factory&&this.factory.kill&&this.factory.kill(),this.deregister(),this};const wd=xd.getters,Dd=xd.setters;wd.colors=function(){const t=this.factory,e=[];if(t){const i=t.colorSpace;for(const[n,s]of lt(this.colors))e.push([parseInt(n,10),t.buildColorString(...s,i)])}else e.push([0,qt],[999,Ys]);return e},Dd.colors=function(t){if(ut(t)){const e=this.factory,i={},n=e.colorSpace.toLowerCase();t.forEach((t=>{const[s,r]=t;s.toFixed&&r.substring&&(e.convert(r),i[`${s} `]=[...e[n]])})),this.colors=i,this.dirtyPalette=!0}},Dd.easing=function(t){this.setEasingHelper(t)},Dd.easingFunction=Dd.easing,xd.setEasing=function(t){return this.setEasingHelper(t),this},xd.setEasingFunction=xd.setEasing,xd.setEasingHelper=function(t){or(t)?(this.easing=Qe,this.easingFunction=t):t.substring&&br[t]?(this.easing=t,this.easingFunction=Qs):(this.easing=mi,this.easingFunction=Qs),this.dirtyPaletteData=!0},wd.colorSpace=function(){return this.getColorSpace()},Dd.colorSpace=function(t){if(t.substring){const e=t.toUpperCase(),i=t.toLowerCase();if(ui.includes(e)){const t=it({},this.colors),n=this.factory.colorSpace;this.factory.set({colorSpace:e});for(const[e,s]of lt(t)){const t=this.factory.buildColorString(...s,n);this.factory.setColor(t),this.colors[e].length=0,this.colors[e].push(...this.factory[i])}this.dirtyPalette=!0}}},wd.returnColorAs=function(){return this.getReturnColorAs()},Dd.returnColorAs=function(t){this.factory.set({returnColorAs:t}),this.dirtyPalette=!0},Dd.precision=function(t){t=parseInt(t,10),(!dt(t)||t<0)&&(t=0),t>50&&(t=50),this.precision=t,this.dirtyPaletteData=!0},Dd.stops=qs,xd.getColorSpace=function(){return this.factory?this.factory.colorSpace:An},xd.getReturnColorAs=function(){return this.factory?this.factory.returnColorAs:An},xd.recalculateStopColors=function(){if(this.dirtyPalette){this.dirtyPalette=!1,this.dirtyPaletteData=!0;const{colors:t,stops:e,factory:i}=this;e.fill(Jt);const{colorSpace:n}=i,s=ft(t).map((t=>parseInt(t,10))).sort(((t,e)=>t-e));let r,o,a,l,c,h,u,d=s[0];const[f,p,g,m]=t[`${d} `];for(e[d]=i.returnColorFromValues(f,p,g,m),c=0,h=s.length-1;c<h;c++)for(d=s[c],r=s[c+1],o=t[`${d} `],a=t[`${r} `],i.setMinimumColor(i.buildColorString(...o,n)),i.setMaximumColor(i.buildColorString(...a,n)),l=r-d,u=d+1;u<=r;u++)e[u]=i.getRangeColor((u-d)/l,!0)}},xd.updateColor=function(t,e){const i=this.factory,n=i.colorSpace.toLowerCase();gr(t,e)&&(t=t.substring?parseInt(t,10):ct(t))>=0&&t<1e3&&(i.convert(e),t+=In,this.colors[t]=[...i[n]],this.dirtyPalette=!0)},xd.removeColor=function(t){pr(t)&&(t=t.substring?parseInt(t,10):ct(t))>=0&&t<1e3&&(t+=In,delete this.colors[t],this.dirtyPalette=!0)},xd.getStopData=function(t,e,i,n){if(!t)return Jt;const s=`${this.name}-data`,{stops:r}=this;if(this.dirtyPaletteData||!Ta()){this.dirtyPaletteData=!1,gr(e,i)||(e=0,i=999);const{easing:t,easingFunction:o,precision:a}=this,l=ft(this.colors).map((t=>parseInt(t,10))).sort(((t,e)=>t-e));let c,h,u,d,f,p,g=o;t!==Qe&&br[t]&&(g=br[t]);const m=this.getColorSpace(),y=!(!a||t===mi&&m===An),b=[];if(e<i){if(b.push(0,r[e]),c=i-e,y)for(u=e+1;u<i;u+=a)h=(u-e)/c,n&&(h>1?h-=1:h<0&&(h+=1)),h=g(h),h>0&&h<1&&b.push(h,r[u]);else for(u=0,d=l.length;u<d;u++)f=l[u],f>e&&f<i&&(h=(f-e)/c,n&&(h>1?h-=1:h<0&&(h+=1)),h>0&&h<1&&b.push(h,r[f]));b.push(1,r[i])}else if(n){if(b.push(0,r[e]),p=999-e,c=p+i,y)for(u=0;u<c;u+=a)f=u+e,f>999&&(f-=1e3),h=g(u/c),h>0&&h<1&&b.push(h,r[f]);else for(u=0,d=l.length;u<d;u++){if(f=l[u],999===f)h=(f-e-.01)/c;else if(f>e)h=(f-e)/c;else if(0===f)h=(f+p+.01)/c;else{if(!(f<i))continue;h=(f+p)/c}h>1?h-=1:h<0&&(h+=1),h>0&&h<1&&b.push(h,r[f])}b.push(1,r[i])}else{if(b.push(0,r[e]),c=e-i,y)for(u=i+1;u<e;u+=a)u<e&&u>i&&(h=g(1-(u-i)/c),h>0&&h<1&&b.push(h,r[u]));else for(u=0,d=l.length;u<d;u++)f=l[u],f<e&&f>i&&(h=1-(f-i)/c,h>0&&h<1&&b.push(h,r[f]));b.push(1,r[i])}Ea(s,b)}return e===i?r[e]||Jt:Ha(s)||Jt},xd.addStopsToGradient=function(t,e,i,n){this.recalculateStopColors();const s=this.getStopData(t,e,i,n);if(s.substring)return s;for(let e=0,i=s.length;e<i;e+=2)t.addColorStop(s[e],s[e+1]);return t},xd.updateData=function(){this.dirtyPaletteData=!0};J.Palette=Palette;const Fd=["colors","cyclic","stops"];function Rd(t=tr){t.defs=hr(t.defs,{start:null,end:null,palette:null,paletteStart:0,paletteEnd:999,cyclePalette:!1,animateByDelta:!1}),t.finalizePacketOut=function(t,e){return e.colors?t.colors=e.colors:this.palette?t.colors=this.palette.get("colors"):t.colors=[[0,qt],[999,Ys]],e.easing?t.easing=e.easing:this.palette&&this.palette.easing?t.easing=this.palette.easing:t.easing=mi,pr(e.precision)?t.precision=e.precision:this.palette&&pr(this.palette.precision)?t.precision=this.palette.precision:t.precision=0,e.colorSpace?t.colorSpace=e.colorSpace:this.palette?t.colorSpace=this.palette.getColorSpace():t.colorSpace=An,e.returnColorAs?t.returnColorAs=e.returnColorAs:this.palette?t.returnColorAs=this.palette.getReturnColorAs():t.returnColorAs=An,t},t.kill=function(){const t=this.name;return this.palette&&this.palette.kill&&this.palette.kill(),Dt(m).forEach((e=>{const i=e.state;if(i){const e=i.fillStyle,n=i.strokeStyle;lr(e)&&e.name===t&&(i.fillStyle=i.defs.fillStyle),lr(n)&&n.name===t&&(i.strokeStyle=i.defs.strokeStyle)}})),this.deregister(),this};const e=t.getters,i=t.setters,n=t.deltaSetters;e.startX=function(){return this.currentStart[0]},e.startY=function(){return this.currentStart[1]},i.startX=function(t){null!=t&&(this.start[0]=t,this.dirtyStart=!0)},i.startY=function(t){null!=t&&(this.start[1]=t,this.dirtyStart=!0)},i.start=function(t,e){this.setCoordinateHelper(Ln,t,e),this.dirtyStart=!0},n.startX=function(t){const e=this.start;e[0]=Ws(e[0],t),this.dirtyStart=!0},n.startY=function(t){const e=this.start;e[1]=Ws(e[1],t),this.dirtyStart=!0},n.start=function(t,e){this.setDeltaCoordinateHelper(Ln,t,e),this.dirtyStart=!0},e.endX=function(){return this.currentEnd[0]},e.endY=function(){return this.currentEnd[1]},i.endX=function(t){null!=t&&(this.end[0]=t,this.dirtyEnd=!0)},i.endY=function(t){null!=t&&(this.end[1]=t,this.dirtyEnd=!0)},i.end=function(t,e){this.setCoordinateHelper(Ye,t,e),this.dirtyEnd=!0},n.endX=function(t){const e=this.end;e[0]=Ws(e[0],t),this.dirtyEnd=!0},n.endY=function(t){const e=this.end;e[1]=Ws(e[1],t),this.dirtyEnd=!0},n.end=function(t,e){this.setDeltaCoordinateHelper(Ye,t,e),this.dirtyEnd=!0},i.palette=function(t=tr){t.type===ns&&(t.dirtyPalette=!0,this.palette=t)},i.paletteStart=function(t){t.toFixed&&this.palette&&(this.paletteStart=t,(t<0||t>999)&&(this.paletteStart=t>500?999:0),this.palette.updateData())},n.paletteStart=function(t){let e;t.toFixed&&this.palette&&(e=this.paletteStart+t,(e<0||e>999)&&(e=this.cyclePalette?e>500?e-1e3:e+1e3:t>500?999:0),this.paletteStart=e,this.palette.updateData())},i.paletteEnd=function(t){t.toFixed&&this.palette&&(this.paletteEnd=t,(t<0||t>999)&&(this.paletteEnd=t>500?999:0),this.palette.updateData())},n.paletteEnd=function(t){let e;t.toFixed&&this.palette&&(e=this.paletteEnd+t,(e<0||e>999)&&(e=this.cyclePalette?e>500?e-1e3:e+1e3:t>500?999:0),this.paletteEnd=e,this.palette.updateData())},i.cyclePalette=function(t){this.palette&&(this.cyclePalette=!!t,this.palette.updateData())},i.colors=function(t){ut(t)&&this.palette&&this.palette.set({colors:t})},i.easing=function(t){this.palette&&this.palette.set({easing:t})},i.easingFunction=i.easing,i.colorSpace=function(t){this.palette&&this.palette.set({colorSpace:t})},i.returnColorAs=function(t){this.palette&&this.palette.set({returnColorAs:t})},i.precision=function(t){this.palette&&this.palette.set({precision:t})},i.delta=function(t=tr){t&&(this.delta=ur(this.delta,t))},t.get=function(t){const e=this.getters[t],i=this.palette;if(e)return e.call(this);{let e,n=this.defs[t];return typeof n!==Ts?(e=this[t],typeof e!==Ts?e:n):(n=i.defs[t],typeof n!==Ts?(e=i[t],typeof e!==Ts?e:n):void 0)}},t.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.palette;let o,a,l,c,h,u;for(r&&(o=r.setters||tr,a=r.defs||tr),c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Fd.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=u)));this.dirtyFilterIdentifier=!0}return this},t.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.palette;let o,a,l,c,h,u;for(r&&(o=r.deltaSetters||tr,a=r.defs||tr),c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Fd.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=Ws(this[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=Ws(this[h],u))));this.dirtyFilterIdentifier=!0}return this},t.setCoordinateHelper=function(t,e,i){const n=this[t];ut(e)?(n[0]=e[0],n[1]=e[1]):(n[0]=e,n[1]=i)},t.setDeltaCoordinateHelper=function(t,e,i){const n=this[t],s=n[0],r=n[1];ut(e)?(n[0]=Ws(s,e[0]),n[1]=Ws(r,e[1])):(n[0]=Ws(s,e),n[1]=Ws(r,i))},t.updateByDelta=function(){return this.setDelta(this.delta),this},t.stylesInit=function(t=tr){this.makeName(t.name),this.register(),this.gradientArgs=[],this.start=qa(),this.end=qa(),this.currentStart=qa(),this.currentEnd=qa(),this.palette=function(t){return!!t&&new Palette(t)}({name:`${this.name}_palette`}),this.delta={},this.set(this.defs),this.set(t)},t.getData=function(t,e){return this.cleanStyle(t,e),this.finalizeCoordinates(t),this.buildStyle(e)},t.cleanStyle=function(t=tr,e=tr){let i,n,s,r;t.lockFillStyleToEntity||t.lockStrokeStyleToEntity?(i=t.currentDimensions,r=t.currentScale,n=i[0]*r,s=i[1]*r):(i=e.currentDimensions||[e.element.width,e.element.height],n=i[0],s=i[1]),this.cleanPosition(this.currentStart,this.start,[n,s]),this.cleanPosition(this.currentEnd,this.end,[n,s]),this.cleanRadius(n)},t.cleanPosition=function(t,e,i){let n,s;for(let r=0;r<2;r++)n=e[r],s=i[r],n.toFixed?t[r]=n:n===pi||n===vs?t[r]=0:n===vn||n===oe?t[r]=s:n===le?t[r]=s/2:dt(parseFloat(n))?t[r]=parseFloat(n)/100*s:t[r]=0},t.finalizeCoordinates=function(t=tr){const e=t.currentStampPosition,i=t.currentStampHandlePosition,n=t.currentScale;let s,r;t.lockFillStyleToEntity||t.lockStrokeStyleToEntity?(s=-i[0]*n||0,r=-i[1]*n||0):(s=-e[0]||0,r=-e[1]||0),this.updateGradientArgs(s,r)},t.cleanRadius=qs,t.buildStyle=function(){return Jt},t.addStopsToGradient=function(t,e,i,n){return this.palette?this.palette.addStopsToGradient(t,e,i,n):t},t.updateColor=function(t,e){return this.palette&&(this.dirtyFilterIdentifier=!0,this.palette.updateColor(t,e)),this},t.removeColor=function(t){return this.palette&&(this.dirtyFilterIdentifier=!0,this.palette.removeColor(t)),this}}vo({name:"SC-core-gradient-delta-animation",fn:()=>{L.forEach((t=>{const e=B[t];e&&e.animateByDelta&&e.updateByDelta()}))}});const ConicGradient=function(t=tr){return this.stylesInit(t),this},Td=ConicGradient.prototype=Sr();Td.type="ConicGradient",Td.lib=jn,Td.isArtefact=!1,Td.isAsset=!1,Co(Td),Rd(Td);Td.defs=hr(Td.defs,{angle:0}),Td.packetObjects=dr(Td.packetObjects,["palette"]),Td.buildStyle=function(t){if(t){const e=t.engine;if(e){if(!e.createConicGradient)return Jt;const t=e.createConicGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return Jt},Td.updateGradientArgs=function(t,e){const i=this.gradientArgs,n=this.currentStart,s=this.angle*Ct,r=n[0]+t,o=n[1]+e;i.length=0,i.push(s,r,o)};const Hd=function(t){return!!t&&new ConicGradient(t)};J.ConicGradient=ConicGradient;const Crescent=function(t=tr){return yr(t.dimensions,t.width,t.height,t.radius)||(t.radius=5),this.currentOuterRadius=5,this.currentInnerRadius=5,this.currentDisplacement=0,this.currentDimensions=[],this.outerCircleStart=0,this.outerCircleEnd=0,this.innerCircleStart=0,this.innerCircleEnd=0,this.drawOuterCircle=!1,this.drawDonut=!1,this.pathObjectOuter=null,this.pathObjectInner=null,this.entityInit(t),this},Ed=Crescent.prototype=Sr();Ed.type="Crescent",Ed.lib=ze,Ed.isArtefact=!0,Ed.isAsset=!1,Co(Ed),Ju(Ed);Ed.defs=hr(Ed.defs,{outerRadius:20,innerRadius:10,displacement:0,displayIntersect:!1});const Id=Ed.setters,Bd=Ed.deltaSetters;Id.outerRadius=function(t){null!=t&&(this.outerRadius=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Bd.outerRadius=function(t){null!=t&&(this.outerRadius=Ws(this.outerRadius,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Id.innerRadius=function(t){null!=t&&(this.innerRadius=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Bd.innerRadius=function(t){null!=t&&(this.innerRadius=Ws(this.innerRadius,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},Id.width=Id.outerRadius,Bd.width=Bd.outerRadius,Id.height=Id.innerRadius,Bd.height=Bd.innerRadius,Id.displacement=function(t){if(null!=t&&t.toFixed&&t>=0){let e=t;e<0&&(e=0),this.displacement=e,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0}},Bd.displacement=function(t){if(null!=t&&t.toFixed){let e=Ws(this.displacement,t);e.toFixed&&e<0&&(e=0),this.displacement=e,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0}},Id.displayIntersect=function(t){this.displayIntersect=t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Ed.cleanDimensionsAdditionalActions=function(){const{outerRadius:t,innerRadius:e,displacement:i}=this,n=this.getHost();let s;s=n?n.currentDimensions?n.currentDimensions:[n.w,n.h]:[300,150];const[r,o]=s;this.currentOuterRadius=t.substring?parseFloat(t)/100*r:t,this.currentInnerRadius=e.substring?parseFloat(e)/100*o:e,this.currentDisplacement=i.substring?parseFloat(i)/100*r:i,this.currentDimensions[0]=this.currentDimensions[1]=2*this.currentOuterRadius,this.dirtyPathObject=!0},Ed.calculateInterception=function(){gr(this.currentOuterRadius,this.currentInnerRadius,this.currentDisplacement)||this.cleanDimensionsAdditionalActions();const{currentOuterRadius:t,currentInnerRadius:e,currentDisplacement:i}=this;this.outerCircleStart=0,this.outerCircleEnd=360*Ct,this.innerCircleStart=0,this.innerCircleEnd=360*Ct,this.drawOuterCircle=!1,this.drawDonut=!1;const n=t+e,s=t-e;if(!s&&!i)this.drawOuterCircle=!0;else if(i>=n)this.drawOuterCircle=!0;else if(i<n&&i>s){const n=Va(),{engine:s,element:r}=n,o=_a();let a,l;for(r.width=r.width,s.fillStyle="black",s.save(),s.beginPath(),s.arc(0,0,t,0,2*Math.PI),o.setFromArray([e,0]),a=0;a<360&&(o.rotate(.5),!s.isPointInPath(o[0]+i,o[1]));a+=.5);for(s.restore(),s.save(),s.beginPath(),s.arc(i,0,e,0,2*Math.PI),o.setFromArray([t,0]),l=0;l<360&&(o.rotate(.5),s.isPointInPath(...o));l+=.5);s.restore(),this.outerCircleStart=-l*Ct,this.outerCircleEnd=l*Ct,this.innerCircleStart=a*Ct,this.innerCircleEnd=-a*Ct,Ka(o),Wa(n)}else this.drawDonut=!0},Ed.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){this.calculateInterception();const{currentStampHandlePosition:t,currentScale:e,outerCircleStart:i,outerCircleEnd:n,innerCircleStart:s,innerCircleEnd:r,drawOuterCircle:o,displayIntersect:a}=this;let{currentOuterRadius:l,currentInnerRadius:c,currentDisplacement:h}=this;const u=this.pathObject=new Path2D;l*=e,c*=e,h*=e;const d=l-t[0]*e,f=l-t[1]*e;if(o)u.arc(d,f,l,i,n),u.closePath(),this.pathObjectOuter=!1,this.pathObjectInner=!1;else{const t=this.pathObjectOuter=new Path2D,e=this.pathObjectInner=new Path2D;a?u.arc(d,f,l,i,n):u.arc(d,f,l,i,n,!0),u.arc(d+h,f,c,s,r),u.closePath(),t.arc(d,f,l,i,n,!0),t.closePath(),e.arc(d+h,f,c,s,r),e.closePath()}}},Ed.draw=function(t){this.drawDonut?(t.stroke(this.pathObjectOuter),t.stroke(this.pathObjectInner)):t.stroke(this.pathObject)},Ed.fill=function(t){t.fill(this.pathObject,this.winding)},Ed.drawAndFill=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.stroke(i),t.stroke(n),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(i),t.stroke(n),t.fill(e,this.winding)}else{const e=this.pathObject;t.stroke(e),t.fill(e,this.winding),this.currentHost.clearShadow(),t.stroke(e),t.fill(e,this.winding)}},Ed.fillAndDraw=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.fill(e,this.winding),t.stroke(i),t.stroke(n),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(i),t.stroke(n)}else{const e=this.pathObject;t.fill(e,this.winding),t.stroke(e),this.currentHost.clearShadow(),t.fill(e,this.winding),t.stroke(e)}},Ed.drawThenFill=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.stroke(i),t.stroke(n),t.fill(e,this.winding)}else{const e=this.pathObject;t.stroke(e),t.fill(e,this.winding)}},Ed.fillThenDraw=function(t){if(this.drawDonut){const e=this.pathObject,i=this.pathObjectOuter,n=this.pathObjectInner;t.fill(e,this.winding),t.stroke(i),t.stroke(n)}else{const e=this.pathObject;t.fill(e,this.winding),t.stroke(e)}},Ed.clip=function(t){t.clip(this.pathObject,this.winding)},Ed.clear=function(t){const e=t.globalCompositeOperation;t.globalCompositeOperation=Fe,t.fill(this.pathObject,this.winding),t.globalCompositeOperation=e};const Ld=function(t){return!!t&&new Crescent(t)};J.Crescent=Crescent;const $d="ParticleHistory",ParticleHistory=function(){const t=Array(4).fill(0);return Pt(t,ParticleHistory.prototype),t},Md=ParticleHistory.prototype=at(Array.prototype);Md.constructor=ParticleHistory,Md.type=$d;const Xd=[],Yd=function(...t){t.forEach((t=>{t&&t.type===$d&&(t.fill(0),Xd.push(t),Xd.length>100&&(Xd.length=0))}))};J.ParticleHistory=ParticleHistory;const Particle=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.initializePositions(),this.hasLifetime=!1,this.distanceLimit=0,this.killBeyondCanvas=!1,this.isBeingDragged=!1,this.dragOffset=null,this.set(t),this},Gd=Particle.prototype=Sr();Gd.type=ss,Gd.lib=zi,Gd.isArtefact=!1,Gd.isAsset=!1,Co(Gd);const jd={position:null,velocity:null,load:null,history:null,historyLength:1,engine:Ne,forces:null,mass:1,fill:qt,stroke:qt};Gd.defs=hr(Gd.defs,jd),Gd.packetExclusionsByRegex=dr(Gd.packetExclusionsByRegex,["^(local|dirty|current)"]),Gd.packetObjects=dr(Gd.packetObjects,["position","velocity","acceleration"]),Gd.factoryKill=function(){this.history.forEach((t=>Yd(t)));const t=[];let e;D.forEach((i=>{e=w[i],(e.particleFrom&&e.particleFrom.name===this.name||e.particleTo&&e.particleTo.name===this.name)&&t.push(e)})),t.forEach((t=>t.kill()))};const zd=Gd.getters,Nd=Gd.setters,Vd=Gd.deltaSetters;zd.positionX=function(){return this.position.x},zd.positionY=function(){return this.position.y},zd.positionZ=function(){return this.position.z},zd.position=function(){const t=this.position;return[t.x,t.y,t.z]},Nd.positionX=function(t){this.position.x=t},Nd.positionY=function(t){this.position.y=t},Nd.positionZ=function(t){this.position.z=t},Nd.position=function(t){this.position.set(t)},Vd.positionX=function(t){this.position.x+=t},Vd.positionY=function(t){this.position.y+=t},Vd.positionZ=function(t){this.position.z+=t},Vd.position=qs,zd.velocityX=function(){return this.velocity.x},zd.velocityY=function(){return this.velocity.y},zd.velocityZ=function(){return this.velocity.z},zd.velocity=function(){const t=this.velocity;return[t.x,t.y,t.z]},Nd.velocityX=function(t){this.velocity.x=t},Nd.velocityY=function(t){this.velocity.y=t},Nd.velocityZ=function(t){this.velocity.z=t},Nd.velocity=function(t,e,i){this.velocity.set(t,e,i)},Vd.velocityX=function(t){this.velocity.x+=t},Vd.velocityY=function(t){this.velocity.y+=t},Vd.velocityZ=function(t){this.velocity.z+=t},Vd.velocity=qs,Nd.forces=function(t){t&&(ut(t)?(this.forces.length=0,this.forces=this.forces.concat(t)):this.forces.push(t))},Nd.load=qs,Nd.history=qs,Vd.load=qs,Gd.initializePositions=function(){this.initialPosition=Ih(),this.position=Ih(),this.velocity=Ih(),this.load=Ih(),this.forces=[],this.history=[],this.isRunning=!1},Gd.applyForces=function(t,e){let i;this.load.zero(),this.isBeingDragged||this.forces.forEach((n=>{i=x[n],i&&i.action&&i.action(this,t,e)}))},Gd.update=function(t,e){this.isBeingDragged?this.position.setFromVector(this.isBeingDragged).vectorAdd(this.dragOffset):Kd[this.engine].call(this,t*e.tickMultiplier)},Gd.manageHistory=function(t,e){const{history:i,remainingTime:n,position:s,historyLength:r,hasLifetime:o,distanceLimit:a,initialPosition:l,killBeyondCanvas:c}=this;let h=!0,u=0;if(o)if(u=n-t,u<=0){const t=i.pop();Yd(t),h=!1,i.length||(this.isRunning=!1)}else this.remainingTime=u;const d=i[i.length-1];if(d){const[,t,i,n]=d;if(c){const t=e.element.width,s=e.element.height;(i<0||n<0||i>t||n>s)&&(h=!1,this.isRunning=!1)}if(a){const e=Hh(l);e.vectorSubtractArray([i,n,t]),e.getMagnitude()>a&&(h=!1,this.isRunning=!1),Eh(e)}}if(h){const{x:t,y:e,z:n}=s,o=(Xd.length||Xd.push(new ParticleHistory),Xd.shift());if(o[0]=u,o[1]=n,o[2]=t,o[3]=e,i.unshift(o),i.length>r){i.splice(r).forEach((t=>Yd(t)))}}},Gd.run=function(t,e,i){this.hasLifetime=!1,t&&(this.remainingTime=t,this.hasLifetime=!0),this.distanceLimit=0,e&&(this.initialPosition.set(this.position),this.distanceLimit=e),this.killBeyondCanvas=i,this.isRunning=!0};const Wd=function(t){return!!t&&new Particle(t)};J.Particle=Particle;const Ud=[],Zd=function(t){Ud.length||Ud.push(new Particle);const e=Ud.shift();return e.set(t),e},_d=function(t){if(t&&t.type===ss&&(t.history.forEach((t=>Yd(t))),t.history.length=0,t.set(t.defs),Ud.push(t),Ud.length>50)){const t=[...Ud];Ud.length=0,t.forEach((t=>t.kill()))}},Kd={euler:function(t){const{position:e,velocity:i,load:n,mass:s}=this,r=Hh(),o=Hh(i);r.setFromVector(n).scalarDivide(s),o.vectorAdd(r.scalarMultiply(t)),i.setFromVector(o),e.vectorAdd(o.scalarMultiply(t)),Eh(r,o)},"improved-euler":function(t){const{position:e,velocity:i,load:n,mass:s}=this,r=Hh(),o=Hh(),a=Hh(),l=Hh(i);r.setFromVector(n).scalarDivide(s).scalarMultiply(t),o.setFromVector(n).vectorAdd(r).scalarDivide(s).scalarMultiply(t),a.setFromVector(r).vectorAdd(o).scalarDivide(2),l.vectorAdd(a),i.setFromVector(l),e.vectorAdd(l.scalarMultiply(t)),Eh(r,o,a,l)},"runge-kutta":function(t){const{position:e,velocity:i,load:n,mass:s}=this,r=Hh(),o=Hh(),a=Hh(),l=Hh(),c=Hh(),h=Hh(i);r.setFromVector(n).scalarDivide(s).scalarMultiply(t).scalarDivide(2),o.setFromVector(n).vectorAdd(r).scalarDivide(s).scalarMultiply(t).scalarDivide(2),a.setFromVector(n).vectorAdd(o).scalarDivide(s).scalarMultiply(t).scalarDivide(2),l.setFromVector(n).vectorAdd(a).scalarDivide(s).scalarMultiply(t).scalarDivide(2),o.scalarMultiply(2),a.scalarMultiply(2),c.setFromVector(r).vectorAdd(o).vectorAdd(a).vectorAdd(l).scalarDivide(6),h.vectorAdd(c),i.setFromVector(h),e.vectorAdd(h.scalarMultiply(t)),Eh(r,o,a,l,c,h)}},Emitter=function(t=tr){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.fillColorFactory=Yl({name:`${this.name}-fillColorFactory`}),this.strokeColorFactory=Yl({name:`${this.name}-strokeColorFactory`}),this.range=Ih(),this.rangeFrom=Ih(),this.minimumVelocity=Ih(),this.preAction=qs,this.stampAction=qs,this.postAction=qs,this.particleStore=[],this.deadParticles=[],this.liveParticles=[],this.forces=[],this.filters=[],this.currentFilters=[],this.dirtyFilters=!1,this.dirtyFiltersCache=!1,this.dirtyImageSubscribers=!1,this.generatorChoke=0,this.lastUpdated=0,t.group||(t.group=du),this.set(t),this.purge&&this.purgeArtefact(this.purge),this},qd=Emitter.prototype=Sr();qd.type="Emitter",qd.lib=ze,qd.isArtefact=!0,qd.isAsset=!1,Co(qd),Ju(qd);const Qd={world:null,artefact:null,range:null,rangeFrom:null,minimumVelocity:null,generationRate:0,particleCount:0,generateAlongPath:null,generateInArea:null,generateFromExistingParticles:!1,generateFromExistingParticleHistories:!1,limitDirectionToAngleMultiples:0,generationChoke:15,killAfterTime:0,killAfterTimeVariation:0,killRadius:0,killRadiusVariation:0,killBeyondCanvas:!1,historyLength:1,forces:null,mass:1,massVariation:0,engine:Ne,hitRadius:10,showHitRadius:!1,hitRadiusColor:qt,resetAfterBlur:3};qd.defs=hr(qd.defs,Qd),qd.packetExclusions=dr(qd.packetExclusions,["forces","particleStore","deadParticles","liveParticles","fillColorFactory","strokeColorFactory"]),qd.packetObjects=dr(qd.packetObjects,["world","artefact","generateInArea","generateAlongPath"]),qd.packetFunctions=dr(qd.packetFunctions,["preAction","stampAction","postAction"]),qd.finalizePacketOut=function(t,e){const i=e.forces||this.forces||!1;if(i){const e=[];i.forEach((t=>{t.substring?e.push(t):lr(t)&&t.name&&e.push(t.name)})),t.forces=e}const n=[];return this.particleStore.forEach((t=>n.push(t.saveAsPacket()))),t.particleStore=n,t},qd.postCloneAction=function(t){return t},qd.factoryKill=function(t,e){this.isRunning=!1,t&&this.artefact.kill(),e&&this.world.kill(),this.fillColorFactory.kill(),this.strokeColorFactory.kill(),this.deadParticles.forEach((t=>t.kill())),this.liveParticles.forEach((t=>t.kill())),this.particleStore.forEach((t=>t.kill()))};const Jd=qd.setters,tf=qd.deltaSetters;Jd.rangeX=function(t){this.range.x=t},Jd.rangeY=function(t){this.range.y=t},Jd.rangeZ=function(t){this.range.z=t},Jd.range=function(t){this.range.set(t)},Jd.rangeFromX=function(t){this.rangeFrom.x=t},Jd.rangeFromY=function(t){this.rangeFrom.y=t},Jd.rangeFromZ=function(t){this.rangeFrom.z=t},Jd.rangeFrom=function(t){this.rangeFrom.set(t)},Jd.minimumVelocityX=function(t){this.minimumVelocity.x=t},Jd.minimumVelocityY=function(t){this.minimumVelocity.y=t},Jd.minimumVelocityZ=function(t){this.minimumVelocity.z=t},Jd.minimumVelocity=function(t){this.minimumVelocity.set(t)},Jd.preAction=function(t){or(t)&&(this.preAction=t,this.dirtyFilterIdentifier=!0)},Jd.stampAction=function(t){or(t)&&(this.stampAction=t,this.dirtyFilterIdentifier=!0)},Jd.postAction=function(t){or(t)&&(this.postAction=t,this.dirtyFilterIdentifier=!0)},Jd.world=function(t){let e;t.substring?e=F[t]:lr(t)&&t.type===ys&&(e=t),e&&(this.world=e)},Jd.artefact=function(t){let e;t.substring?e=o[t]:lr(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e,this.dirtyFilterIdentifier=!0)},Jd.generateAlongPath=function(t){let e;t.substring?e=o[t]:lr(t)&&t.isArtefact&&(e=t),e&&e.useAsPath?this.generateAlongPath=e:this.generateAlongPath=!1,this.dirtyFilterIdentifier=!0},Jd.generateInArea=function(t){let e;t.substring?e=o[t]:lr(t)&&t.isArtefact&&(e=t),this.generateInArea=e||!1,this.dirtyFilterIdentifier=!0},Jd.fillColor=function(t){this.fillColorFactory.set({color:t}),this.dirtyFilterIdentifier=!0},Jd.fillMinimumColor=function(t){this.fillColorFactory.set({minimumColor:t}),this.dirtyFilterIdentifier=!0},Jd.fillMaximumColor=function(t){this.fillColorFactory.set({maximumColor:t}),this.dirtyFilterIdentifier=!0},Jd.strokeColor=function(t){this.strokeColorFactory.set({color:t}),this.dirtyFilterIdentifier=!0},Jd.strokeMinimumColor=function(t){this.strokeColorFactory.set({minimumColor:t}),this.dirtyFilterIdentifier=!0},Jd.strokeMaximumColor=function(t){this.strokeColorFactory.set({maximumColor:t}),this.dirtyFilterIdentifier=!0},Jd.hitRadius=function(t){t.toFixed&&(this.hitRadius=t,this.width=this.height=2*t)},tf.hitRadius=function(t){t.toFixed&&(this.hitRadius+=t,this.width=this.height=2*this.hitRadius)},Jd.width=function(t){t.toFixed&&(this.hitRadius=t/2,this.width=this.height=t)},tf.width=function(t){t.toFixed&&(this.hitRadius=t/2,this.width=this.height=t)},Jd.height=Jd.width,tf.height=tf.width,qd.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1,this.dirtyDimensions=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions();const t=mt(),{particleStore:e,deadParticles:i,liveParticles:n,particleCount:s,generationRate:r,resetAfterBlur:o}=this;let a=this.generatorChoke;a||(this.generatorChoke=a=t),e.forEach((t=>{t.isRunning?n.push(t):i.push(t)})),e.length=0,i.forEach((t=>_d(t))),i.length=0,e.push(...n),n.length=0;let l=t-a;if(l/1e3>o&&(l=0,this.generatorChoke=t),l>0&&r){let i=ct(r/1e3*l);if(s){const t=s-e.length;t<=0?i=0:t<i&&(i=t)}i&&(this.addParticles(i),this.generatorChoke=t)}this.prepareStampTabsHelper()},qd.addParticles=function(t){const e=function(t,e){return Ks(t+(At()*e*2-e))},i=function(t,e,i){let n=Ks(t+At()*e);for(;et(n)<i;)n=Ks(t+At()*e);return n};let n,s,r,o,a,l;const c=mt(),{historyLength:h,engine:u,forces:d,mass:f,massVariation:p,fillColorFactory:g,strokeColorFactory:m,range:y,rangeFrom:b,minimumVelocity:S,currentStampPosition:k,particleStore:C,killAfterTime:A,killAfterTimeVariation:v,killRadius:P,killRadiusVariation:x,killBeyondCanvas:O,currentRotation:w,generateAlongPath:D,generateInArea:F,generateFromExistingParticles:R,generateFromExistingParticleHistories:T,limitDirectionToAngleMultiples:H,generationChoke:E}=this,{x:I,y:B,z:L}=y,{x:$,y:M,z:X}=b;if(F){const y=this.currentHost;if(y){const b=y.element,{width:k,height:w}=b;F.pathObject&&!F.dirtyPathObject||F.cleanPathObject();const D=Va(),R=D.engine,T=_a(),{pathObject:H,winding:Y,currentStart:G}=F;[r,o]=G;const j=t=>R.isPointInPath(H,...t,Y);D.rotateDestination(R,r,o,F);t:for(n=0;n<t;n++){let t=!1;for(;!t;){if(c+E<mt())break t;T.set(At()*k,At()*w),j(T)&&(t=!0)}s=Zd(),s.set({positionX:T[0],positionY:T[1],positionZ:0,velocityX:i($,I,S.x),velocityY:i(M,B,S.y),velocityZ:i(X,L,S.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(At()),stroke:m.getRangeColor(At())}),a=et(e(A,v)),l=et(e(P,x)),s.run(a,l,O),C.push(s)}Wa(D),Ka(T)}}else if(D){if(D.useAsPath){D.pathObject&&!D.dirtyPathObject||D.cleanPathObject();t:for(n=0;n<t;n++){let t=!1,n=!1;for(;!n;){if(c+E<mt())break t;t=D.getPathPositionData(At(),!0),t&&(n=!0)}s=Zd(),s.set({positionX:t.x,positionY:t.y,positionZ:0,velocityX:i($,I,S.x),velocityY:i(M,B,S.y),velocityZ:i(X,L,S.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(At()),stroke:m.getRangeColor(At())}),a=et(e(A,v)),l=et(e(P,x)),s.run(a,l,O),C.push(s)}}}else if(T){const r=C.length,o=Hh();let c,y,b,D;for(n=0;n<t;n++)r?(y=C[ct(At()*r)],b=y.history,b&&b.length>1?([,,...D]=b[ct(At()*b.length)],D?o.setFromArray(D):o.setFromVector(y.position)):o.setFromVector(y.position)):o.setFromArray(k),s=Zd(),s.set({positionX:Ks(o.x),positionY:Ks(o.y),positionZ:Ks(o.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(At()),stroke:m.getRangeColor(At())}),H?(o.zero(),c=ct(360/H),o.x=i($,I,S.x),o.rotate(ct(At()*c)*H),s.set({velocityX:Ks(o.x),velocityY:Ks(o.y),velocityZ:i(X,L,S.z)})):s.set({velocityX:i($,I,S.x),velocityY:i(M,B,S.y),velocityZ:i(X,L,S.z)}),s.velocity.rotate(w),a=et(e(A,v)),l=et(e(P,x)),s.run(a,l,O),C.push(s);Eh(o)}else if(R){const r=C.length,o=Hh();let c,y;for(n=0;n<t;n++)r?(y=C[ct(At()*r)],o.setFromVector(y.position)):o.setFromArray(k),s=Zd(),s.set({positionX:Ks(o.x),positionY:Ks(o.y),positionZ:Ks(o.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(At()),stroke:m.getRangeColor(At())}),H?(o.zero(),c=ct(360/H),o.x=i($,I,S.x),o.rotate(ct(At()*c)*H),s.set({velocityX:Ks(o.x),velocityY:Ks(o.y),velocityZ:i(X,L,S.z)})):s.set({velocityX:i($,I,S.x),velocityY:i(M,B,S.y),velocityZ:i(X,L,S.z)}),s.velocity.rotate(w),a=et(e(A,v)),l=et(e(P,x)),s.run(a,l,O),C.push(s);Eh(o)}else for([r,o]=k,n=0;n<t;n++)s=Zd(),s.set({positionX:r,positionY:o,positionZ:0,velocityX:i($,I,S.x),velocityY:i(M,B,S.y),velocityZ:i(X,L,S.z),historyLength:h,engine:u,forces:d,mass:e(f,p),fill:g.getRangeColor(At()),stroke:m.getRangeColor(At())}),s.velocity.rotate(w),a=et(e(A,v)),l=et(e(P,x)),s.run(a,l,O),C.push(s)},qd.regularStamp=function(){const{world:t,artefact:e,particleStore:i,preAction:n,stampAction:s,postAction:r,lastUpdated:o,resetAfterBlur:a,showHitRadius:l,hitRadius:c,hitRadiusColor:h,currentStampPosition:u}=this,d=this.currentHost;let f=wt;const p=mt();if(o&&(f=(p-o)/1e3),f>a&&(i.forEach((t=>_d(t))),i.length=0,f=wt),i.forEach((e=>e.applyForces(t,d))),i.forEach((e=>e.update(f,t))),n.call(this,d),i.forEach((t=>{t.manageHistory(f,d),s.call(this,e,t,d)})),r.call(this,d),l){const t=d.engine;t.save(),t.lineWidth=1,t.strokeStyle=h,t.setTransform(1,0,0,1,0,0),t.beginPath(),t.arc(u[0],u[1],c,0,bt),t.stroke(),t.restore()}this.lastUpdated=p},qd.checkHit=function(t=[]){if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=this.currentStampPosition;let n,s,r=!1;return!!e.some((t=>{if(ut(t))n=t[0],s=t[1];else{if(!gr(t,t.x,t.y))return!1;n=t.x,s=t.y}if(!dt(n)||!dt(s))return!1;const e=Hh(i).vectorSubtract(t);return e.getMagnitude()<this.hitRadius&&(r=!0),Eh(e),r}),this)&&this.checkHitReturn(n,s)};const ef=function(t){return!!t&&new Emitter(t)};J.Emitter=Emitter;const nf=["ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded","ultra-expanded"],sf=function(t=tr){return this.isDefaultTextStyle=!!t.isDefaultTextStyle,this.isDefaultTextStyle?(this.set(this.defs),this.set(t),this.letterSpacing=`${this.letterSpaceValue}px`,this.wordSpacing=`${this.wordSpaceValue}px`):this.set(t,!0),this},rf=sf.prototype=Sr();rf.type="TextStyle",Co(rf);const of={direction:bi,fontKerning:Gi,fontStretch:Gi,fontVariantCaps:Gi,textRendering:Ut,fillStyle:qt,lineDash:null,lineDashOffset:0,lineWidth:1,strokeStyle:qt,canvasFont:Oe,fontString:Oe,letterSpaceValue:0,wordSpaceValue:0,fontFamily:"sans-serif",fontSize:"12px",fontStyle:Gi,fontWeight:Gi,includeUnderline:!1,underlineGap:3,underlineOffset:0,underlineStyle:zs,underlineWidth:1,includeOverline:!1,overlineOffset:0,overlineStyle:zs,overlineWidth:1,highlightStyle:zs,includeHighlight:!1,method:Ve};rf.defs=hr(rf.defs,of),rf.processPacketOut=function(t,e,i){let n=!0;if(t===gi)e.length||(n=!!i.includes(gi));else i.includes(t)||e!==this.defs[t]||(n=!1);return n},rf.finalizePacketOut=function(t){const e=t.fillStyle,i=t.strokeStyle;return e&&!e.substring&&(t.fillStyle=e.name),i&&!i.substring&&(t.strokeStyle=i.name),t},rf.set=function(t=tr,e=!1){if(this.isDefaultTextStyle||e){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.setters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!=Li&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!=Ts&&(this[i]=n))}}return this},rf.setDelta=function(t=tr,e=!1){if(this.isDefaultTextStyle||e){let e,i,n,s;const r=ft(t),o=r.length;if(o){const a=this.deltaSetters,l=this.defs;for(e=0;e<o;e++)i=r[e],n=t[i],i&&i!=Li&&null!=n&&(s=a[i],s?s.call(this,n):typeof l[i]!=Ts&&(this[i]=Ws(this[i],n)))}}return this};const af=rf.getters,lf=rf.setters,cf=rf.deltaSetters;lf.fontString=function(t){null!=t&&t.substring&&(this.fontString=t)},lf.fontSize=function(t){null!=t&&t.substring&&(this.fontSize=t.toLowerCase())},lf.fontStyle=function(t){null!=t&&t.substring&&(this.fontStyle=t.toLowerCase())},lf.fontVariantCaps=function(t){null!=t&&t.substring&&(this.fontVariantCaps=t.toLowerCase())},lf.fontStretch=function(t){null!=t&&t.substring&&(this.fontStretch=this.fontStretchHelper(t))},rf.fontStretchHelper=function(t){if(!t.substring)return Gi;if(t=t.toLowerCase(),nf.includes(t))return t;if(t.includes(Vi)){const e=parseFloat(t);if(dt(e)){if(e<=50)return nf[0];if(e<=62.5)return nf[1];if(e<=75)return nf[2];if(e<=87.5)return nf[3];if(e>=200)return nf[7];if(e>=150)return nf[6];if(e>=125)return nf[5];if(e>=112.5)return nf[4]}}return Gi},lf.fontWeight=function(t){this.fontWeight=t.toFixed?`${t}`:t},lf.direction=function(t){null!=t&&t.substring&&(this.direction=t)},lf.fontKerning=function(t){null!=t&&t.substring&&(this.fontKerning=t)},af.letterSpaceValue=function(){return this.letterSpaceValue},af.letterSpacing=function(){return`${this.letterSpaceValue}px`},cf.letterSpacing=function(t){if(null!=t){t===Gi&&(t=0);const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.letterSpaceValue+=e,this.letterSpacing=`${this.letterSpaceValue}px`)}},lf.letterSpacing=function(t){if(null!=t){t===Gi&&(t=0);const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.letterSpaceValue=e,this.letterSpacing=`${e}px`)}},af.wordSpaceValue=function(){return this.wordSpaceValue},af.wordSpacing=function(){return`${this.wordSpaceValue}px`},cf.wordSpacing=function(t){if(null!=t){const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.wordSpaceValue+=e,this.wordSpacing=`${this.wordSpaceValue}px`)}},lf.wordSpacing=function(t){if(null!=t){const e=t.toFixed?t:parseFloat(t);dt(e)&&(this.wordSpaceValue=e,this.wordSpacing=`${e}px`)}},lf.textRendering=function(t){null!=t&&t.substring&&(this.textRendering=t)},af.textAlign=qs,lf.textAlign=qs,af.textBaseline=qs,lf.textBaseline=qs;const hf=function(t){return!!t&&new sf(t)};J.TextStyle=sf;const uf=/[0-9.,]+(%|cap|ch|cm|cqb|cqh|cqi|cqmax|cqmin|cqw|dvb|dvh|dvi|dvmax|dvmin|dvw|em|ex|ic|in|lh|lvb|lvh|lvi|lvmax|lvmin|lvw|mm|pc|pt|px|Q|rcap|rch|rem|rex|ric|rlh|svb|svh|svi|svmax|svmin|svw|vb|vh|vi|vmax|vmin|vw)/i,df=["small-caps","all-small-caps","petite-caps","all-petite-caps","unicase","titling-caps"],ff="italic",pf=["direction","fontKerning","fontSize","fontStretch","fontString","fontStyle","fontVariantCaps","fontWeight","letterSpaceValue","letterSpacing","scale","textRendering","wordSpaceValue","wordSpacing"],gf=["fontString"],mf=["fontString","scale"],yf=["fontFamily","fontSize","fontStretch","fontStyle","fontVariantCaps","fontWeight"],bf=["lineSpacing","textUnitFlow","lineAdjustment","alignment","justifyLine","flipReverse","flipUpend","alignTextUnitsToPath","lockFillStyleToEntity","lockStrokeStyleToEntity"],Sf="oblique",kf=["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"],Cf=["width","height","dimensions","startX","startY","start","position","handleX","handleY","handle","offsetX","offsetY","offset","roll","scale","flipReverse","flipUpend"],Af=["canvasFont","direction","fillStyle","fontFamily","fontKerning","fontSize","fontStretch","fontString","fontStyle","fontVariantCaps","fontWeight","highlightStyle","includeHighlight","includeUnderline","letterSpaceValue","letterSpacing","lineDash","lineDashOffset","lineWidth","overlineOffset","overlineStyle","overlineWidth","strokeStyle","textRendering","underlineGap","underlineOffset","underlineStyle","underlineWidth","wordSpaceValue","wordSpacing","method"],vf=document.createElement(Be);function Pf(t=tr){const e={textIsAccessible:!0,accessibleText:"§",accessibleTextPlaceholder:"§",accessibleTextRole:zs,accessibleTextOrder:0};t.defs=hr(t.defs,e),t.finalizePacketOut=function(t,e){const i=yt(this.defaultTextStyle.saveAsPacket(e))[3],n=yt(this.state.saveAsPacket(e))[3];return t=hr(t,{direction:i.direction,fillStyle:i.fillStyle,fontKerning:i.fontKerning,fontStretch:i.fontStretch,fontString:i.fontString,fontVariantCaps:i.fontVariantCaps,highlightStyle:i.highlightStyle,includeHighlight:i.includeHighlight,includeUnderline:i.includeUnderline,letterSpacing:i.letterSpaceValue,lineDash:i.lineDash,lineDashOffset:i.lineDashOffset,lineWidth:i.lineWidth,method:i.method,overlineOffset:i.overlineOffset,overlineStyle:i.overlineStyle,overlineWidth:i.overlineWidth,strokeStyle:i.strokeStyle,textRendering:i.textRendering,underlineGap:i.underlineGap,underlineOffset:i.underlineOffset,underlineStyle:i.underlineStyle,underlineWidth:i.underlineWidth,wordSpacing:i.wordSpaceValue,filter:n.filter,font:null,globalAlpha:n.globalAlpha,globalCompositeOperation:n.globalCompositeOperation,imageSmoothingEnabled:n.imageSmoothingEnabled,imageSmoothingQuality:n.imageSmoothingQuality,lineCap:wn,lineJoin:wn,miterLimit:10,shadowBlur:n.shadowBlur,shadowColor:n.shadowColor,shadowOffsetX:n.shadowOffsetX,shadowOffsetY:n.shadowOffsetY,textAlign:pi,textBaseline:vs}),this.type===ts&&(t=this.handlePacketAnchor(t,e)),t},t.factoryKill=function(){this.dirtyCache(),this.accessibleTextHold&&this.accessibleTextHold.remove();const t=this.getCanvasTextHold(this.currentHost);t&&(t.dirtyTextTabOrder=!0)},t.get=function(t){const{defs:e,getters:i,state:n,defaultTextStyle:s,layoutTemplate:r}=this,o=s?s.getters:tr,a=s?s.defs:tr,l=n?n.getters:tr,c=n?n.defs:tr;let h;if(r&&Cf.includes(t))return r.get(t);if(Af.includes(t)){if(h=o[t],h)return h.call(s);if(typeof a[t]!=Ts)return s[t]}if(Xn.includes(t)){if(h=l[t],h)return h.call(n);if(typeof c[t]!=Ts)return n[t]}return h=i[t],h?h.call(this):typeof e[t]!=Ts?this[t]:null},t.set=function(t=tr){const e=ft(t),i=e.length;if(i){this.dirtyCache();const{defs:n,setters:s,state:r,defaultTextStyle:o,layoutTemplate:a}=this,l=o?o.setters:tr,c=o?o.defs:tr,h=r?r.setters:tr,u=r?r.defs:tr;let d,f,p,g;for(f=0;f<i;f++)p=e[f],g=t[p],p&&p!==Li&&null!=g&&(a&&Cf.includes(p)?a.set({[p]:g}):Af.includes(p)?(d=l[p],d?d.call(o,g):typeof c[p]!==Ts&&(o[p]=g)):Xn.includes(p)?(d=h[p],d?d.call(r,g):typeof u[p]!==Ts&&(r[p]=g)):(d=s[p],d?d.call(this,g):typeof n[p]!==Ts&&(this[p]=g)),a&&(bf.includes(p)||Af.includes(p))&&(this.dirtyLayout=!0),pf.includes(p)&&(this.dirtyFont=!0),yf.includes(p)&&(this.updateUsingFontParts=!0),mf.includes(p)&&(this.updateUsingFontString=!0),gf.includes(p)&&(this.currentFontIsLoaded=!1))}return this},t.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){this.dirtyCache();const{defs:n,deltaSetters:s,state:r,defaultTextStyle:o,layoutTemplate:a}=this,l=o?o.deltaSetters:tr,c=o?o.defs:tr,h=r?r.deltaSetters:tr,u=r?r.defs:tr;let d,f,p,g;for(f=0;f<i;f++)p=e[f],g=t[p],p&&p!=Li&&null!=g&&(a&&Cf.includes(p)?a.setDelta({[p]:g}):Af.includes(p)?(d=l[p],d?d.call(r,g):typeof c[p]!=Ts&&(o[p]=Ws(o[p],g))):Xn.includes(p)?(d=h[p],d?d.call(r,g):typeof u[p]!=Ts&&(r[p]=Ws(r[p],g))):(d=s[p],d?d.call(this,g):typeof n[p]!=Ts&&(this[p]=Ws(this[p],g))),a&&(bf.includes(p)||Af.includes(p))&&(this.dirtyLayout=!0),pf.includes(p)&&(this.dirtyFont=!0),yf.includes(p)&&(this.updateUsingFontParts=!0),mf.includes(p)&&(this.updateUsingFontString=!0),gf.includes(p)&&(this.currentFontIsLoaded=!1))}return this};const i=t.getters,n=t.setters;i.rawText=function(){return this.rawText},n.text=function(t){this.rawText=t.substring?t:t.toString(),this.text=this.convertTextEntityCharacters(this.rawText.normalize("NFC")),this.dirtyText=!0,this.dirtyFont=!0,this.currentFontIsLoaded=!1},i.accessibleText=function(){return this.getAccessibleText()},n.accessibleText=function(t){null!=t&&t.substring&&(this.accessibleText=t,this.dirtyText=!0)},n.accessibleTextPlaceholder=function(t){null!=t&&t.substring&&(this.accessibleTextPlaceholder=t,this.dirtyText=!0)},n.accessibleTextOrder=function(t){null!=t&&t.toFixed&&(this.accessibleTextOrder=t,this.dirtyText=!0)},n.textIsAccessible=function(t){this.textIsAccessible=!!t,this.dirtyText=!0},t.dirtyCache=qs,t.recalculateFont=function(t=!1){t?this.usingViewportFontSizing&&(this.dirtyFont=!0):this.dirtyFont=!0},t.convertTextEntityCharacters=function(t){return vf.innerHTML=t,vf.textContent},t.updateCanvasFont=function(t,e){const{fontStyle:i,fontVariantCaps:n,fontWeight:s,fontSize:r,fontSizeValue:o,fontFamily:a}=t;let l="";(i==ff||i.includes(Sf))&&(l+=`${i} `),"small-caps"==n&&(l+=`${n} `),null!=s&&s&&s!==Gi&&"400"!==s&&(l+=`${s} `),this.type===ts?l+=`${o*e}px ${a}`:l+=`${parseFloat(r)*e}px ${a}`,t.canvasFont=l},t.updateFontString=function(t){const{fontStretch:e,fontStyle:i,fontVariantCaps:n,fontWeight:s,fontSize:r,fontFamily:o}=t;let a="";null!=e&&e&&e!==Gi&&(a+=`${e} `),null!=i&&i&&i!==Gi&&(a+=`${i} `),null!=n&&n&&n!==Gi&&(a+=`${n} `),null!=s&&s&&s!==Gi&&"400"!==s&&(a+=`${s} `),a+=`${r} ${o}`,t.fontString=a},t.getControllerCell=function(){const t=this.group;if(t){const e=t&&t.getHost?t.getHost():null;if(e)return e.getController()}return null},t.setImageSmoothing=function(t){Io()>=2?t.imageSmoothingEnabled=!1:(t.imageSmoothingEnabled=!0,t.imageSmoothingQuality=oi)},t.getCalculators=function(){let t=null,e=null;const i=this.getControllerCell();return i&&(t=i.fontSizeCalculator,e=i.fontSizeCalculatorValues),[t,e]},t.temperFont=function(){const{group:t,defaultTextStyle:e}=this;if(gr(t,e)){const[t,i]=this.getCalculators();t?this.calculateTextStyleFontStrings(e,t,i):this.dirtyFont=!0}},t.cleanFont=function(){if(this.currentFontIsLoaded)this.dirtyFont=!1,this.temperFont(),this.type!==ts||this.dirtyFont||this.measureFont();else if(null!=this.currentFontIsLoaded){const[t,e]=this.getCalculators(),i=this.defaultTextStyle.fontString;if(t){t.style.font=i;const n=e.fontFamily;C.includes(`100px ${n}`)?(this.currentFontIsLoaded=!0,this.dirtyFont=!1,this.temperFont(),this.type!==ts||this.dirtyFont||this.measureFont()):this.checkFontIsLoaded(i)}}},t.calculateTextStyleFontStrings=function(t,e,i){let n=t.fontSize;const{fontStretch:s,fontStyle:r,fontWeight:o,fontVariantCaps:a,fontString:l}=t,{lineSpacing:c,updateUsingFontParts:h,updateUsingFontString:u}=this,d=this.getScale();e.style.font=l;const f=i.fontFamily;if(this.getFontMetadata(f),u||null==n||!n){this.updateUsingFontString=!1;const s=l.match(uf);s&&s[0]&&(n=s[0]),e.style.fontSize=n,t.fontSize=i.fontSize}h?(this.updateUsingFontParts=!1,e.style.fontStretch=s,e.style.fontStyle=r,e.style.fontVariantCaps=a,e.style.fontWeight=o,e.style.fontSize=n):1!==d&&(e.style.fontSize=n);const p=i.fontWeight,g=t.fontStretchHelper(i.fontStretch);let m=i.fontVariantCaps,y=i.fontStyle;m=df.includes(m)?m:Gi,y=y===ff||y.includes(Sf)?y:Gi;const b=i.fontSize,S=parseFloat(b);if(t.fontSizeValue=S,null!=c&&l.includes("/")){const t=parseFloat(i.lineHeight);this.lineSpacing=dt(t)?t/S:this.defs.lineSpacing,this.dirtyLayout=!0}t.fontStretch=g,t.fontStyle=y,t.fontVariantCaps=m,t.fontWeight=p,t.fontFamily=f,this.updateCanvasFont(t,d),this.updateFontString(t)},t.getScale=function(){const t=this.layoutTemplate;return t?null!=t.currentScale?t.currentScale:1:null!=this.currentScale?this.currentScale:1},t.getStyle=function(t,e,i){if(null==i)return qt;if(t||(t=this.state[e]),null==t)return qt;if(t.substring){let e=null;L.includes(t)?e=B[t]:f.includes(t)&&(e=d[t]),null!=e&&(t=e.getData(this,i))}else t=t.getData(this,i);return t},t.getFontMetadata=function(t){if(t){const e=`100px ${t}`;if(C.includes(e))return k[e];const i=Va(),n=i.engine;n.textAlign=pi,n.textBaseline=vs,n.font=e;const s=n.measureText(In),{actualBoundingBoxAscent:r,actualBoundingBoxDescent:o,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,alphabeticBaseline:c,hangingBaseline:h,ideographicBaseline:u}=s;let d=a+l;dt(d)||(d=st(et(o)+et(r)));const f=dt(a)?a:r;return C.push(e),k[e]={height:d,verticalOffset:f,alphabeticRatio:et((c-f)/d),hangingRatio:et((h-f)/d),ideographicRatio:et((u-f)/d),alphabeticBaseline:-c,hangingBaseline:-h,ideographicBaseline:-u},Wa(i),k[e]}},t.checkFontIsLoaded=function(t){if(null==t)this.currentFontIsLoaded=!1;else if(kf.includes(t))this.currentFontIsLoaded=!0;else if(null!=this.currentFontIsLoaded&&!this.currentFontIsLoaded){this.currentFontIsLoaded=null;document.fonts.load(t).then((()=>this.currentFontIsLoaded=!0)).catch((e=>{this.currentFontIsLoaded=!1,console.log("checkFontIsLoaded error:",t,e)}))}},t.getCanvasTextHold=function(t){return t&&t.type===Un&&t.controller&&t.controller.type&&t.controller.type===Wn&&t.controller.textHold?t.controller:!(!t||t.type!==Un||!t.currentHost)&&this.getCanvasTextHold(t.currentHost)},t.updateAccessibleTextHold=function(){if(this.dirtyText=!1,this.textIsAccessible){if(!this.accessibleTextHold){const t=document.createElement(Be);t.id=`${this.name}-text-hold`,t.setAttribute(Nt,sn),t.setAttribute(xe,this.accessibleTextOrder),this.accessibleTextRole&&t.setAttribute(Pn,this.accessibleTextRole),this.accessibleTextHold=t,this.accessibleTextHoldAttached=!1}if(this.accessibleTextHold.textContent=this.getAccessibleText(),this.currentHost){const t=this.getCanvasTextHold(this.currentHost);t&&t.textHold&&(this.accessibleTextHoldAttached||(t.textHold.appendChild(this.accessibleTextHold),this.accessibleTextHoldAttached=!0),t.dirtyTextTabOrder=!0)}}else if(this.accessibleTextHold){this.accessibleTextHold.remove(),this.accessibleTextHold=null,this.accessibleTextHoldAttached=!1;const t=this.getCanvasTextHold(this.currentHost);t&&(t.dirtyTextTabOrder=!0)}},t.getAccessibleText=function(){const{accessibleText:t,accessibleTextPlaceholder:e,text:i}=this;return t.replace(e,i)}}const xf="draw",Of="drawAndFill",wf="fillAndDraw",Df=/[0-9.,]+(svh|lvh|dvh|vh|svw|lvw|dvw|vw|svmax|lvmax|dvmax|vmax|svmin|lvmin|dvmin|vmin|svb|lvb|dvb|vb|svi|lvi|dvi|vi)/i,Ff="space-around",Rf="space-between",Tf="EnhancedLabelLine",Hf="EnhancedLabelUnit",Ef=/[-]/,If=["column","column-reverse"],Bf=["row-reverse","column-reverse"],Lf=/[\u2060]/,$f=/[\u00ad]/,Mf=/[ \f\n\r\t\v\u2028\u2029\u200b]/,Xf="C",Yf="h",Gf="S",jf=/[\u200b]/,EnhancedLabel=function(t=tr){return this.makeName(t.name),this.register(),this.state=Aa(tr),this.defaultTextStyle=hf({isDefaultTextStyle:!0}),this.cache=null,this.textUnitHitZones=[],this.pivoted=[],this.set(this.defs),t.group||(t.group=du),this.currentFontIsLoaded=!1,this.updateUsingFontParts=!1,this.updateUsingFontString=!1,this.usingViewportFontSizing=!1,this.useMimicDimensions=!0,this.useMimicFlip=!0,this.useMimicHandle=!0,this.useMimicOffset=!0,this.useMimicRotation=!0,this.useMimicScale=!0,this.useMimicStart=!0,this.delta={},this.deltaConstraints={},this.currentStampPosition=qa(),this.textHandle=qa(),this.textOffset=qa(),this.lines=[],this.textUnits=lp(),this.underlinePaths=[],this.overlinePaths=[],this.highlightPaths=[],this.guidelineDash=[],this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyRotation=!0,this.dirtyScale=!0,this.dirtyDimensions=!0,this.currentHost=null,this.dirtyHost=!0,this.currentDimensions=[],this.currentScale=1,this.currentStampHandlePosition=null,this.pathObject=null,this.accessibleTextHold=null,this.accessibleTextHoldAttached=null,this.guidelinesPath=null,this.currentPathData=null,this.filters=[],this.currentFilters=[],this.dirtyFilters=!0,this.dirtyFiltersCache=!0,this.dirtyImageSubscribers=!0,this.stashOutput=!1,this.stashOutputAsAsset=!1,this.stashedImageData=null,this.stashedImage=null,this.set(t),this.dirtyFont=!0,this.currentFontIsLoaded=!1,this},zf=EnhancedLabel.prototype=Sr();zf.type=Kn,zf.lib=ze,zf.isArtefact=!0,zf.isAsset=!1,Co(zf),Gc(zf),Oc(zf),Pf(zf);const Nf={text:zs,lineSpacing:1.5,layoutTemplate:null,useLayoutTemplateAsPath:!1,pathPosition:0,constantSpeedAlongPath:!0,alignment:0,alignTextUnitsToPath:!0,lineAdjustment:0,breakTextOnSpaces:!0,breakWordsOnHyphens:!1,justifyLine:le,textUnitFlow:"row",truncateString:"…",hyphenString:"-",textHandle:null,textOffset:null,showGuidelines:!1,guidelineStyle:"rgb(0 0 0 / 0.5)",guidelineWidth:1,guidelineDash:null,visibility:!0,calculateOrder:0,stampOrder:0,host:null,group:null,method:Ve,lockFillStyleToEntity:!1,lockStrokeStyleToEntity:!1,cacheOutput:!0,checkHitUseTemplate:!0};zf.defs=hr(zf.defs,Nf),zf.packetExclusions=dr(zf.packetExclusions,["pathObject","mimicked","pivoted","state"]),zf.packetExclusionsByRegex=dr(zf.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),zf.packetCoordinates=dr(zf.packetCoordinates,["start","handle","offset"]),zf.packetObjects=dr(zf.packetObjects,["group","layoutTemplate"]),zf.packetFunctions=dr(zf.packetFunctions,["onEnter","onLeave","onDown","onUp"]),zf.processPacketOut=function(t,e,i){return this.processEntityPacketOut(t,e,i)},zf.handlePacketAnchor=function(t){return t},zf.processEntityPacketOut=function(t,e,i){return this.processFactoryPacketOut(t,e,i)},zf.processFactoryPacketOut=function(t,e,i){let n=!0;return i.indexOf(t)||e!==this.defs[t]||(n=!1),n},zf.postCloneAction=function(t){return t},zf.kill=function(t=!1,e=!1){const i=this.name;return Dt(A).forEach((t=>{t.artefacts.includes(i)&&t.removeArtefacts(i)})),this.anchor&&this.demolishAnchor(),this.button&&this.demolishButton(),Dt(o).forEach((t=>{t.name!==i&&(t.pivot&&t.pivot.name===i&&t.set({pivot:!1}),t.mimic&&t.mimic.name===i&&t.set({mimic:!1}),t.path&&t.path.name===i&&t.set({path:!1}),t.generateAlongPath&&t.generateAlongPath.name===i&&t.set({generateAlongPath:!1}),t.generateInArea&&t.generateInArea.name===i&&t.set({generateInArea:!1}),t.artefact&&t.artefact.name===i&&t.set({artefact:!1}),ut(t.pins)&&t.pins.forEach(((e,n)=>{lr(e)&&e.name===i&&t.removePinAt(n)})))})),Dt(E).forEach((t=>{t.checkForTarget(i)&&t.removeFromTargets(this)})),this.factoryKill(t,e),this.deregister(),this};const Vf=zf.getters,Wf=zf.setters,Uf=zf.deltaSetters;Vf.group=function(){return this.group?this.group.name:zs},Wf.group=function(t){let e;t&&(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring?(e=A[t],this.group=e||t):this.group=t),this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},Wf.layoutTemplate=function(t){if(t){const e=this.layoutTemplate,i=t.substring?o[t]:t,n=this.name;i&&i.name&&(e&&e.name!==i.name&&(e.mimicked&&fr(e.mimicked,n),e.pathed&&fr(e.pathed,n)),i.mimicked&&dr(i.mimicked,n),i.pathed&&dr(i.pathed,n),this.layoutTemplate=i,this.dirtyPathObject=!0,this.dirtyLayout=!0)}},Wf.breakTextOnSpaces=function(t){this.breakTextOnSpaces=!!t,this.dirtyText=!0},Wf.breakWordsOnHyphens=function(t){this.breakWordsOnHyphens=!!t,this.dirtyText=!0},Wf.truncateString=function(t){t.substring&&(this.truncateString=this.convertTextEntityCharacters(t),this.dirtyText=!0)},Wf.hyphenString=function(t){t.substring&&(this.hyphenString=this.convertTextEntityCharacters(t),this.dirtyText=!0)},Wf.textHandleX=function(t){this.textHandle[0]=t,this.dirtyLayout=!0},Wf.textHandleY=function(t){this.textHandle[1]=t,this.dirtyLayout=!0},Wf.textHandle=function(t){ut(t)&&t.length>1&&(this.textHandle[0]=t[0],this.textHandle[1]=t[1],this.dirtyLayout=!0)},Wf.guidelineDash=function(t){ut(t)&&(this.guidelineDash=t)},Wf.guidelineStyle=function(t){t?t.substring&&(this.guidelineStyle=t):this.guidelineStyle=this.defs.guidelineStyle},Wf.pathPosition=function(t){t<0&&(t=et(t)),t>1&&(t%=1),this.pathPosition=parseFloat(t.toFixed(6)),this.dirtyTextLayout=!0},Uf.pathPosition=function(t){let e=this.pathPosition+t;e<0&&(e+=1),e>1&&(e%=1),this.pathPosition=parseFloat(e.toFixed(6)),this.dirtyTextLayout=!0},Wf.textUnitFlow=function(t){this.textUnitFlow=t,this.dirtyText=!0},Vf.textUnits=function(){return this.textUnits},Vf.textLines=function(){return this.lines},zf.getTester=function(){const t=this.getControllerCell();return t?t.labelStylesCalculator:null},zf.makeWorkingTextStyle=function(t){const e=at(t);return it(e,t),e.isDefaultTextStyle=!1,e},zf.setEngineFromWorkingTextStyle=function(t,e,i,n){this.updateWorkingTextStyle(t,e),i.set(t),n.setEngine(this)},zf.updateWorkingTextStyle=function(t,e){let i=1;this.layoutTemplate&&(i=this.layoutTemplate.currentScale),t.set(e,!0),this.updateCanvasFont(t,i),this.updateFontString(t)},zf.getTextHandleX=function(t,e,i){return t.toFixed?t:t===Ln?i===bi?0:e:t===le?e/2:t===Ye?i===bi?e:0:t===pi?0:t===vn?e:dt(parseFloat(t))?parseFloat(t)/100*e:0},zf.getTextHandleY=function(t,e,i){const n=this.getFontMetadata(i),{alphabeticRatio:s,hangingRatio:r,height:o,ideographicRatio:a}=n,l=e/100;let c=1;this.layoutTemplate&&(c=this.layoutTemplate.currentScale);const h=o*l;return t.toFixed?t*c:t===vs?0:t===oe?h*c:t===le?h/2*c:t===$t?h*s*c:t===si?h*r*c:t===ci?h*a*c:t===vi?h/2*c:dt(parseFloat(t))?parseFloat(t)/100*h:0},zf.getTextOffset=function(t,e){return t.toFixed?t:dt(parseFloat(t))?parseFloat(t)/100*e:0},zf.dirtyCache=function(){Wa(this.cache),this.cache=null,this.textUnitHitZones.length=0,this.pivoted.length&&this.updatePivotSubscribers()},zf.cleanPathObject=function(){const t=this.layoutTemplate;t&&this.dirtyPathObject&&t.pathObject&&(this.dirtyPathObject=!1,this.pathObject=new Path2D(t.pathObject))},zf.cleanLayout=function(){this.currentFontIsLoaded&&(this.dirtyCache(),this.dirtyLayout=!1,this.useLayoutTemplateAsPath||this.calculateLines(),this.dirtyTextLayout=!0)},zf.calculateLines=function(){const{alignment:t,defaultTextStyle:e,layoutTemplate:i,lineAdjustment:n,lines:s,lineSpacing:r,textUnitFlow:o}=this,{currentDimensions:a,currentScale:l,currentRotation:c,currentStampPosition:h,pathObject:u,winding:d}=i,{fontSizeValue:f}=e,p=(-t-c)*Ct,[g,m]=h,[y,b]=a,S=_a(),k=Va(),C=k.engine;k.rotateDestination(C,g,m,i),C.rotate(p);const A=Jr();let v,P,x,O,w,D;const F=vt(f*r*l),R=vt(g),T=vt(R-y*l*2),H=vt(R+y*l*2),E=vt(m+n*l),I=vt(E-b*l*2),B=vt(E+b*l*2);if(F){for(let t=E;t>I;t-=F){const e=Jr();v=!1,P=!1;for(let i=T;i<H;i++)P=C.isPointInPath(u,i,t,d),P!==v&&(e.push([!1===P?i-1:i,t]),v=P);A.push([t,[...e]]),to(e)}for(let t=E+F;t<B;t+=F){const e=Jr();v=!1,P=!1;for(let i=T;i<H;i++)P=C.isPointInPath(u,i,t,d),P!==v&&(e.push([!1===P?i-1:i,t]),v=P);A.push([t,[...e]]),to(e)}}else{const t=Jr();v=!1,P=!1;for(let e=T;e<H;e++)P=C.isPointInPath(u,e,E,d),P!==v&&(t.push([!1===P?e-1:e,E]),v=P);A.push([E,[...t]]),to(t)}const L=Jr();L.push(...A.filter((t=>t[1].length))),to(A),L.sort(((t,e)=>t[0]>e[0]?1:t[0]<e[0]?-1:0));const $=L.map((t=>t[1]));Bf.includes(o)&&$.reverse(),to(L),$.forEach((e=>{e.forEach((e=>{S.set(e).subtract(h).rotate(t+c).add(h),e[0]=S[0],e[1]=S[1]}))})),rp(...s),s.length=0,$.forEach((t=>{for(let e=0,i=t.length;e<i;e+=2)s.push(sp().set({startAt:t[e],endAt:t[e+1]}))}));let M="";s.forEach((t=>{[x,O]=t.startAt,[w,D]=t.endAt,t.length=ht(x-w,O-D),M+=`M ${x}, ${O} ${w}, ${D} `})),this.guidelinesPath=new Path2D(M),Wa(k),Ka(S)},zf.cleanText=function(){if(this.currentFontIsLoaded){this.dirtyText=!1;const{breakTextOnSpaces:t,breakWordsOnHyphens:e,defaultTextStyle:i,text:n,textUnitFlow:s,textUnits:r}=this,o=[...n],a=i.direction===bi,l=If.includes(s),c=[];let h=!1;ep(...r),r.length=0;let u=0;t?a&&e?(o.forEach((t=>{Mf.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u})),u++,r.push(tp({[_f]:t,[Kf]:Gf,index:u})),c.length=0,u++):Ef.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u})),u++,r.push(tp({[_f]:t,[Kf]:"H",index:u})),c.length=0,u++):$f.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u})),u++,r.push(tp({[_f]:t,[Kf]:Yf,index:u})),c.length=0,u++):c.push(t)})),c.length&&r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u}))):(o.forEach((t=>{Mf.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u})),u++,r.push(tp({[_f]:t,[Kf]:Gf})),c.length=0,u++):c.push(t)})),c.length&&r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u}))):o.forEach(((t,e)=>{c.push(t),l?Mf.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:Gf,index:u})),c.length=0,u++):Lf.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:"B",index:u})),c.length=0,u++):jf.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:"Z",index:u})),c.length=0,u++):(r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u})),c.length=0,u++):(h=Lf.test(t)||Lf.test(o[e+1]),h||(Mf.test(t)?(r.push(tp({[_f]:c.join(zs),[Kf]:Gf,index:u})),c.length=0,u++):(r.push(tp({[_f]:c.join(zs),[Kf]:Xf,index:u})),c.length=0,u++)))})),this.assessTextForStyle(),this.measureTextUnits(),this.dirtyTextLayout=!0}},zf.assessTextForStyle=function(){const t=this.getTester();if(!t)return this.dirtyText=!0,null;const e=t=>{if(3!==t.nodeType)for(const i of t.childNodes)e(i);else{const e=u[i(f)];null!=e&&null==e.style&&(e.style=hf({})),f+=t.textContent.length,l(t,e)}},i=t=>{let e=0;for(let i=0,n=u.length;i<n;i++)if(e+=u[i].chars.length,t<e)return i;return null},n="",s="",r=0,o=0,a=0,l=(t,e)=>{const i=rt(t.parentNode),l={};let c,h;c=d.direction,h=i.getPropertyValue("direction"),c!==h&&(l.direction=h),c=d.fontFamily,h=i.getPropertyValue("font-family"),c!==h&&(l.fontFamily=h),c=d.fontKerning,h=i.getPropertyValue("font-kerning"),c!==h&&(l.fontKerning=h),c=d.fontSize,h=i.getPropertyValue("font-size"),c!==h&&(l.fontSize=h,Df.test(h)&&(this.usingViewportFontSizing=!0)),c=d.fontStretch,h=i.getPropertyValue("font-stretch"),"100%"===h&&(h=Gi),c!==h&&(l.fontStretch=h),c=d.fontStyle,h=i.getPropertyValue("font-style"),c!==h&&(l.fontStyle=h),c=d.fontVariantCaps,h=i.getPropertyValue("font-variant-caps"),c!==h&&(l.fontVariantCaps=h),c=d.fontWeight,h=i.getPropertyValue("font-weight"),c!==h&&(l.fontWeight=h),c=d.get("letterSpacing"),h=i.getPropertyValue("letter-spacing"),h===Gi&&(h=on),c!==h&&(l.letterSpacing=h),c=d.textRendering,h=i.getPropertyValue("text-rendering"),c!==h&&(l.textRendering=h),c=d.get("wordSpacing"),h=i.getPropertyValue("word-spacing"),c!==h&&(l.wordSpacing=h),c=d.fillStyle,h=i.getPropertyValue("--SC-fill-style"),c!==h&&(l.fillStyle=h),c=d.includeHighlight,h=!!i.getPropertyValue("--SC-include-highlight"),c!==h&&(l.includeHighlight=h),c=d.highlightStyle,h=i.getPropertyValue("--SC-highlight-style"),c!==h&&(l.highlightStyle=h),c=d.lineWidth,h=parseFloat(i.getPropertyValue("--SC-stroke-width")),c!==h&&(l.lineWidth=h),c=d.includeOverline,h=!!i.getPropertyValue("--SC-include-overline"),c!==h&&(l.includeOverline=h),c=d.overlineOffset,h=parseFloat(i.getPropertyValue("--SC-overline-offset")),c!==h&&(l.overlineOffset=h),c=d.overlineStyle,h=i.getPropertyValue("--SC-overline-style"),c!==h&&(l.overlineStyle=h),c=d.overlineWidth,h=parseFloat(i.getPropertyValue("--SC-overline-width")),c!==h&&(l.overlineWidth=h),c=d.includeUnderline,h=!!i.getPropertyValue("--SC-include-underline"),c!==h&&(l.includeUnderline=h),c=d.underlineGap,h=parseFloat(i.getPropertyValue("--SC-underline-gap")),c!==h&&(l.underlineGap=h),c=d.underlineOffset,h=parseFloat(i.getPropertyValue("--SC-underline-offset")),c!==h&&(l.underlineOffset=h),c=d.underlineStyle,h=i.getPropertyValue("--SC-underline-style"),c!==h&&(l.underlineStyle=h),c=d.underlineWidth,h=parseFloat(i.getPropertyValue("--SC-underline-width")),c!==h&&(l.underlineWidth=h),c=d.method,h=i.getPropertyValue("--SC-method"),c!==h&&(l.method=h),c=n,h=i.getPropertyValue("--SC-local-handle-x"),c!==h&&(l.localHandleX=h),c=s,h=i.getPropertyValue("--SC-local-handle-y"),c!==h&&(l.localHandleY=h),c=r,h=parseFloat(i.getPropertyValue("--SC-local-offset-x")),c!==h&&(l.localOffsetX=h),c=o,h=parseFloat(i.getPropertyValue("--SC-local-offset-y")),c!==h&&(l.localOffsetY=h),c=a,h=parseFloat(i.getPropertyValue("--SC-local-alignment")),c!==h&&(l.localAlignment=h),e.set(l),e.style.set(l,!0),d.set(l,!0)},{rawText:c,defaultTextStyle:h,textUnits:u}=this,d=this.makeWorkingTextStyle(h);let f=0;this.usingViewportFontSizing=Df.test(d.fontSize),(()=>{t.style.setProperty("direction",h.direction),t.style.setProperty("font-family",h.fontFamily),t.style.setProperty("font-kerning",h.fontKerning),t.style.setProperty("font-size",h.fontSize),t.style.setProperty("font-stretch",h.fontStretch),t.style.setProperty("font-style",h.fontStyle),t.style.setProperty("font-variant-caps",h.fontVariantCaps),t.style.setProperty("font-weight",h.fontWeight),t.style.setProperty("letter-spacing",h.get("letterSpacing")),t.style.setProperty("text-rendering",h.textRendering),t.style.setProperty("word-spacing",h.get("wordSpacing")),t.style.setProperty("--SC-fill-style",h.fillStyle),t.style.setProperty("--SC-highlight-style",h.highlightStyle),t.style.setProperty("--SC-overline-offset",h.overlineOffset),t.style.setProperty("--SC-overline-style",h.overlineStyle),t.style.setProperty("--SC-overline-width",h.overlineWidth),t.style.setProperty("--SC-stroke-width",h.lineWidth),t.style.setProperty("--SC-stroke-style",h.strokeStyle),t.style.setProperty("--SC-underline-gap",h.underlineGap),t.style.setProperty("--SC-underline-offset",h.underlineOffset),t.style.setProperty("--SC-underline-style",h.underlineStyle),t.style.setProperty("--SC-underline-width",h.underlineWidth),t.style.setProperty("--SC-local-handle-x",n),t.style.setProperty("--SC-local-handle-y",s),t.style.setProperty("--SC-local-offset-x",r),t.style.setProperty("--SC-local-offset-y",o),t.style.setProperty("--SC-local-alignment",a),t.style.setProperty("--SC-method",h.method),t.className=this.name,t.innerHTML=c})(),e(t)},zf.measureTextUnits=function(){const{defaultTextStyle:t,hyphenString:e,state:i,textUnitFlow:n,textUnits:s,truncateString:r,breakTextOnSpaces:o}=this,a=Va(),l=a.engine;let c,h,u,d,f,p,g,m,y,b,S;const k=this.makeWorkingTextStyle(t);this.setEngineFromWorkingTextStyle(k,tr,i,a);const C=If.includes(n);s.forEach((t=>{({chars:h,charType:u,style:d}=t),d&&this.setEngineFromWorkingTextStyle(k,d,i,a),c=l.measureText(h),t.len=c.width,u===Gf?t.len+=k.wordSpaceValue:u===Yf?(c=l.measureText(e),t.replaceLen=c.width):(c=l.measureText(r),t.replaceLen=c.width),t.height=C&&!o&&("Z"===u||"B"===u)?0:parseFloat(k.fontSize)})),!this.useLayoutTemplateAsPath&&this.breakTextOnSpaces||(this.setEngineFromWorkingTextStyle(k,t,i,a),s.forEach(((t,e)=>{({chars:h,charType:u,style:d,len:f}=t),d&&this.setEngineFromWorkingTextStyle(k,d,i,a),k.fontKerning!==Yi&&(p=s[e+1],p&&(({style:g,chars:m,charType:y,len:b}=p),u!==Gf&&y!==Gf&&(g&&(g.fontFamily||g.fontSize||g.fontVariantCaps)||(S=f+b,c=l.measureText(`${h}${m}`),p.kernOffset=S-c.width))))}))),Wa(a)},zf.layoutText=function(){if(this.currentFontIsLoaded){const{useLayoutTemplateAsPath:t,lines:e,textUnits:i,layoutTemplate:n}=this;t?n&&n.useAsPath&&(this.dirtyTextLayout=!1,rp(...e),e.length=0,e.push(sp({length:n.length,isPathEntity:!0}))):e.length&&i.length&&(this.dirtyTextLayout=!1,e.forEach((t=>{t.unitData.length=0})),i.forEach((t=>{t.stampFlag=!0,t.lineOffset=0}))),this.assignTextUnitsToLines(),this.positionTextUnits()}},zf.assignTextUnitsToLines=function(){const{breakWordsOnHyphens:t,defaultTextStyle:e,layoutTemplate:i,lines:n,textUnitFlow:s,textUnits:r}=this,o=e.direction===bi,a=If.includes(s),l=i.currentScale,c=r.length;let h,u,d,f,p,g,m,y,b,S,k,C=0;const A=function(t){h-=t,f.push(C),++C};if(n.forEach((e=>{for(({length:y,unitData:f}=e),h=st(y),k=!0,u=C;u<c&&(d=r[u],({len:g,height:m,charType:b}=d),S=a?m*l:g,k&&!a&&d.charType===Gf&&(S=0),S<=h);u++){if(o&&!a&&t)if(d=r[u+1],d&&d.charType===Yf){if(p=r[u+2],!(p&&g+p.len<h)){if(g+d.replaceLen<h){A(S),A(d.replaceLen),f.push(Yf);break}break}A(g)}else A(S);else A(S);k=!1}})),o&&!a&&c!==C){let t,e,i,s;for(t=n.length-1;t>=0;t--){if(({length:y,unitData:f}=n[t]),i=f.reduce(((t,e)=>(r[e]&&r[e].charType===Xf&&t++,t)),0),i){s=[...f];break}f.length=0}if(s&&s.length){for(({length:y,unitData:f}=n[t]),i=f.reduce(((t,e)=>(r[e]&&r[e].len&&(t+=r[e].len),t)),0),u=f.length-1;u>=0;u--)if(d=r[f[u]],d)if(({len:g,replaceLen:e,charType:b}=d),b!==Xf&&b!==Yf)i-=g,s.pop();else{if(i+e<y){s.push("T");break}i-=g,s.pop()}f.length=0,f.push(...s)}}},zf.positionTextUnits=function(){this.useLayoutTemplateAsPath?this.positionTextUnitsAlongPath():this.positionTextUnitsInSpace(),this.positionTextDecoration()},zf.positionTextUnitsAlongPath=function(){const{alignment:t,alignTextUnitsToPath:e,defaultTextStyle:i,layoutTemplate:n,lines:s,pathPosition:r,constantSpeedAlongPath:o,textHandle:a,textOffset:l,textUnitFlow:c,textUnits:h}=this,{length:u,unitData:d}=s[0],f=i.direction,p=f===bi,g=If.includes(c),m=n.currentScale||1,y=Jr(),b=_a(),S=_a();y.push(...d),p||y.reverse();let k,C,A,v,P,x,O,w,D,F,R,T,H,E,I,B,L,$,M,X,Y,G,j,z,N,V,W,U,Z=r,_=u*Z;const K=this.makeWorkingTextStyle(i);this.updateWorkingTextStyle(K,tr),V=K.fontFamily,N=this.getFontMetadata(V),U=N.verticalOffset*(K.fontSizeValue/100)*m,W=N.height*(K.fontSizeValue/100)*m;for(let i=0,s=y.length;i<s;i++)k=y[i],k.toFixed&&(C=h[y[i]],({len:A,height:v,kernOffset:P,localHandle:x,localOffset:O,startData:D,startCorrection:F,boxData:R,localAlignment:T,style:L}=C),L&&(this.updateWorkingTextStyle(K,L),V=K.fontFamily,N=this.getFontMetadata(V),U=N.verticalOffset*(v/100)*m,W=N.height*(v/100)*m),w=v*m,g?(H=x[0]||a[0]||0,Y=this.getTextHandleX(H,A,f),H=x[1]||a[1]||0,G=this.getTextHandleY(H,v,V),H=O[0]||l[0]||0,j=this.getTextOffset(H,A),H=O[1]||l[1]||0,z=this.getTextOffset(H,v),_+=G,_>=u?(_-=u,C.lineStart=!0):C.lineStart=!1,Z=_/u,C.pathData=n.getPathPositionData(Z,o),({x:$,y:M,angle:X}=C.pathData),E=j-Y,I=z-G,D[0]=$,D[1]=M,F[0]=E,F[1]=I+U,B=e?t+X-90:t-90,C.startAlignment=B,C.startRotation=B*Ct,C.localRotation=T*Ct,_+=w-G):(H=x[0]||a[0]||0,Y=this.getTextHandleX(H,A,f),H=x[1]||a[1]||0,G=this.getTextHandleY(H,v,V),H=O[0]||l[0]||0,j=this.getTextOffset(H,A),H=O[1]||l[1]||0,z=this.getTextOffset(H,v),_+=Y,_>=u?(_-=u,C.lineStart=!0):C.lineStart=!1,Z=_/u,C.pathData=n.getPathPositionData(Z,o),({x:$,y:M,angle:X}=C.pathData),E=j-Y,I=z-G,D[0]=$,D[1]=M,F[0]=E,F[1]=I+U,B=e?t+T+X:t+T,C.startAlignment=B,C.startRotation=B*Ct,C.localRotation=T*Ct,_-=Y,_+=A-P),C.set({boxData:null}),S[0]=$+E,S[1]=M+I-U,b.setFromArray(S).subtract(D).rotate(B).add(D),R.tl.push(...b),S[0]+=A,b.setFromArray(S).subtract(D).rotate(B).add(D),R.tr.push(...b),S[1]=M+I+W,b.setFromArray(S).subtract(D).rotate(B).add(D),R.br.push(...b),S[0]-=A,b.setFromArray(S).subtract(D).rotate(B).add(D),R.bl.push(...b));Ka(b,S),to(y)},zf.positionTextUnitsInSpace=function(){const{alignment:t,defaultTextStyle:e,getTextHandleX:i,getTextHandleY:n,getTextOffset:s,justifyLine:r,layoutTemplate:o,lines:a,textHandle:l,textOffset:c,textUnitFlow:h,textUnits:u}=this,d=e.direction,f=d===bi,p=If.includes(h),{currentRotation:g,currentScale:m}=o;let y,b,S,k,C,A,v,P,x,O,w,D,F,R,T,H,E,I,B,L,$,M,X,Y,G,j,z,N,V,W,U,Z,_,K,q;const Q=this.makeWorkingTextStyle(e);this.updateWorkingTextStyle(Q,tr),Z=Q.fontFamily,_=this.getFontMetadata(Z),K=_.verticalOffset*(Q.fontSizeValue/100)*m,q=_.height*(Q.fontSizeValue/100)*m,a.forEach((e=>{if(({length:b,unitData:S,startAt:N}=e),S.length){const e=Jr(),o=Jr(),a=_a(),h=_a();switch(C=S.length-1,k=0,A=0,v=0,e.length=0,o.length=0,[j,z]=N,S.forEach(((t,i)=>{t.toFixed&&(y=u[t],0!==i&&i!==C||y.charType!==Gf||(y.stampFlag=!1),y.stampFlag&&(e.push(k),k+=p?y.height*m:y.len-y.kernOffset,r!==Rf&&r!==Ff||y.charType!==Gf||A++))})),P=b-k,f&&(S.includes(Yf)||S.includes("T"))&&(y=u[S[S.length-2]],P-=null!=y.replaceLen?y.replaceLen:0),r){case Ye:o.push(...e.map((t=>t+P)));break;case le:P/=2,o.push(...e.map((t=>t+P)));break;case Rf:A&&(v=P/A),o.push(...e);break;case Ff:v=P/(A+2),o.push(...e);break;default:o.push(...e)}if(r===Rf)C=0,S.forEach((t=>{if(y=u[t],y&&y.stampFlag&&(C++,y.charType===Gf))for(let t=C,e=o.length;t<e;t++)o[t]+=v}));else if(r===Ff){C=0,S.forEach((t=>{if(y=u[t],y&&y.stampFlag&&(C++,y.charType===Gf))for(let t=C,e=o.length;t<e;t++)o[t]+=v}));const t=[...o];o.length=0,o.push(...t.map((t=>t+v)))}S.forEach((e=>{e.toFixed&&(y=u[e],({boxData:R,height:O,len:x,localAlignment:E,localHandle:T,localOffset:H,startCorrection:F,startData:D,style:w}=y),w&&(this.updateWorkingTextStyle(Q,w),Z=Q.fontFamily,_=this.getFontMetadata(Z),K=_.verticalOffset*(O/100)*m,q=_.height*(O/100)*m),y.stampFlag&&(p?(I=o.shift(),B=T[0]||l[0]||0,M=i.call(this,B,x,d),B=T[1]||l[1]||0,X=n.call(this,B,O,Z),B=H[0]||c[0]||0,Y=s.call(this,B,x),B=H[1]||c[1]||0,G=s.call(this,B,O),U=t+g,a.set(I+X,0).rotate(U),V=j+a[0],W=z+a[1],L=V+Y,$=W+G-X+K,D[0]=V,D[1]=W,F[0]=L-V-M,F[1]=$-W,y.startAlignment=U-90,y.startRotation=(U-90)*Ct,y.localRotation=E*Ct):(I=f?o.shift():b-x-o.shift(),B=T[0]||l[0]||0,M=i.call(this,B,x,d),B=T[1]||l[1]||0,X=n.call(this,B,O,Z),B=H[0]||c[0]||0,Y=s.call(this,B,x),B=H[1]||c[1]||0,G=s.call(this,B,O),U=t+g,a.set(I+M,0).rotate(U),V=j+a[0],W=z+a[1],L=V+Y,$=W+G-X+K,D[0]=V,D[1]=W,F[0]=L-V-M,F[1]=$-W,y.startAlignment=U,y.startRotation=U*Ct,y.localRotation=E*Ct),y.set({boxData:null}),h[0]=L-M,h[1]=$-K,U+=E,p&&(U-=90),a.setFromArray(h).subtract(D).rotate(U).add(D),R.tl.push(...a),h[0]+=x,a.setFromArray(h).subtract(D).rotate(U).add(D),R.tr.push(...a),h[1]=$+q-K,a.setFromArray(h).subtract(D).rotate(U).add(D),R.br.push(...a),h[0]-=x,a.setFromArray(h).subtract(D).rotate(U).add(D),R.bl.push(...a)))})),to(e,o),Ka(a,h)}}))},zf.positionTextDecoration=function(){const t=function(t,e,i,n){if(t.length&&t.length===e.length&&n){const s=Jr(),r=Jr(),o=Jr();let a,l,c,h,u,d,f;for(s.push(...t),r.push(...e),a=0,l=s.length;a<l;a++)c=s[a],h=r[a],o.length=0,u=W.setFromArray(h).subtract(c).getMagnitude(),d=W.scalarMultiply(i).getMagnitude(),o.push(...W.add(c)),f=(d+n*U)/u,W.setFromArray(h).subtract(c).scalarMultiply(f).add(c),c[0]=o[0],c[1]=o[1],h[0]=W[0],h[1]=W[1];t.length=0,t.push(...s),e.length=0,e.push(...r),to(s,r,o)}},e=function(t,e,i,n){const s=t.length,r=e.length;let o,a,l;if(s&&r){for(a=t[0][0]-Z[0],l=t[0][1]-Z[1],v=`m ${a.toFixed(2)}, ${l.toFixed(2)} `,o=1;o<s;o++)a=t[o][0]-t[o-1][0],l=t[o][1]-t[o-1][1],v+=`${a.toFixed(2)}, ${l.toFixed(2)} `;for(a=e[e.length-1][0]-t[t.length-1][0],l=e[e.length-1][1]-t[t.length-1][1],v+=`${a.toFixed(2)}, ${l.toFixed(2)} `,o=r-2;o>=0;o--)a=e[o][0]-e[o+1][0],l=e[o][1]-e[o+1][1],v+=`${a.toFixed(2)}, ${l.toFixed(2)} `;v+="z",n.push([i,new Path2D(v),[...Z]])}},i=function(i=!1){Y.length&&($=O,M=w,X=D,i||(L.underlineStyle&&($=L.underlineStyle),L.underlineOffset&&(M=L.underlineOffset),L.underlineWidth&&(X=L.underlineWidth)),t(Y,G,M,X),e(Y,G,$,f),Y.length=0,G.length=0)},n=function(i=!1){j.length&&($=R,M=T,X=H,i||(L.overlineStyle&&($=L.overlineStyle),L.overlineOffset&&(M=L.overlineOffset),L.overlineWidth&&(X=L.overlineWidth)),t(j,z,M,X),e(j,z,$,h),j.length=0,z.length=0)},s=function(t=!1){N.length&&($=I,t||L.highlightStyle&&($=L.highlightStyle),e(N,V,$,a),N.length=0,V.length=0)},{breakTextOnSpaces:r,defaultTextStyle:o,highlightPaths:a,layoutTemplate:l,lines:c,overlinePaths:h,textUnitFlow:u,textUnits:d,underlinePaths:f,useLayoutTemplateAsPath:p}=this;let g,m,y,b,S,k,C,A,v,P,x,O,w,D,F,R,T,H,E,I,B,L,$,M,X;const Y=Jr(),G=Jr(),j=Jr(),z=Jr(),N=Jr(),V=Jr(),W=_a(),{currentScale:U,currentStampPosition:Z}=l;f.length=0,h.length=0,a.length=0;const _=this.makeWorkingTextStyle(o);this.updateWorkingTextStyle(_,tr),({includeUnderline:x,underlineStyle:O,underlineOffset:w,underlineWidth:D,includeOverline:F,overlineStyle:R,overlineOffset:T,overlineWidth:H,includeHighlight:E,highlightStyle:I}=_),c.forEach((t=>{g=t.unitData,Y.length=0,G.length=0,j.length=0,z.length=0,N.length=0,V.length=0,g.forEach((t=>{t.toFixed&&(m=d[t],({boxData:b,charType:P,lineStart:B,localStyle:L,style:y}=m),L||(L=tr),y&&(this.updateWorkingTextStyle(_,y),({includeUnderline:x,includeOverline:F,includeHighlight:E}=_),x&&({underlineStyle:O,underlineOffset:w,underlineWidth:D}=_),F&&({overlineStyle:R,overlineOffset:T,overlineWidth:H}=_),E&&({highlightStyle:I}=_)),m.stampFlag&&(({tl:S,tr:k,br:C,bl:A}=b),If.includes(u)?P!==Gf&&((L.includeUnderline||x)&&(Y.push([...S],[...k]),G.push([...A],[...C]),i()),(L.includeOverline||F)&&(j.push([...S],[...k]),z.push([...A],[...C]),n()),(L.includeHighlight||E)&&(N.push([...S],[...k]),V.push([...A],[...C]),s())):p?r?P!==Gf&&((L.includeUnderline||x)&&(Y.push([...S],[...k]),G.push([...A],[...C]),i()),(L.includeOverline||F)&&(j.push([...S],[...k]),z.push([...A],[...C]),n()),(L.includeHighlight||E)&&(N.push([...S],[...k]),V.push([...A],[...C]),s())):(B&&(i(),n(),s()),L.includeUnderline?(i(!0),Y.push([...S],[...k]),G.push([...A],[...C]),i()):x?(Y.push([...S],[...k]),G.push([...A],[...C])):i(),L.includeOverline?(n(!0),j.push([...S],[...k]),z.push([...A],[...C]),n()):F?(j.push([...S],[...k]),z.push([...A],[...C])):n(),L.includeHighlight?(s(!0),N.push([...S],[...k]),V.push([...A],[...C]),s()):E?(N.push([...S],[...k]),V.push([...A],[...C])):s()):(L.includeUnderline?(i(!0),Y.push([...S],[...k]),G.push([...A],[...C]),i()):x?(Y.push([...S],[...k]),G.push([...A],[...C])):i(),L.includeOverline?(n(!0),j.push([...S],[...k]),z.push([...A],[...C]),n()):F?(j.push([...S],[...k]),z.push([...A],[...C])):n(),L.includeHighlight?(s(!0),N.push([...S],[...k]),V.push([...A],[...C]),s()):E?(N.push([...S],[...k]),V.push([...A],[...C])):s())))})),Y.length&&i(),j.length&&n(),N.length&&s()})),Ka(W),to(Y,G,j,z,N,V)},zf.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1);const t=this.layoutTemplate;this.currentDimensions=t.currentDimensions,this.currentScale=t.currentScale,this.currentStampHandlePosition=t.currentStampHandlePosition,this.currentStampPosition=t.currentStampPosition,this.dirtyScale&&(this.dirtyCache(),this.dirtyScale=!1,this.dirtyFont=!0,this.dirtyPathObject=!0,this.dirtyLayout=!0),(this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle||this.dirtyRotation||this.dirtyFilters)&&(this.dirtyCache(),this.dirtyDimensions=!1,this.dirtyStart=!1,this.dirtyOffset=!1,this.dirtyHandle=!1,this.dirtyRotation=!1,this.dirtyPathObject=!0,this.dirtyLayout=!0),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyFont&&(this.cleanFont(),this.dirtyFont||(this.dirtyText=!0)),!this.dirtyPathObject&&this.currentFontIsLoaded&&(this.dirtyText&&(this.updateAccessibleTextHold(),this.cleanText()),this.dirtyLayout&&this.cleanLayout(),this.dirtyTextLayout&&this.layoutText())},zf.stamp=function(t=!1,e,i){this.dirtyFont||this.dirtyText||this.dirtyLayout||(t?(e&&ei.includes(e.type)&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp()):this.visibility&&this.regularStamp())},zf.simpleStamp=qs,zf.removeShadowAndAlpha=function(t){t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor="rgb(0 0 0 / 0)",t.globalAlpha=1,t.globalCompositeOperation=En,t.lineJoin=wn,t.lineCap=wn,this.setImageSmoothing(t)},zf.getCellCoverage=function(t){const{width:e,height:i,data:n}=t;let s,r,o,a,l=0,c=0,h=e,u=i,d=3;for(o=0,a=e*i;o<a;o++)n[d]&&(r=ct(o/e),s=o-r*e,h>s&&(h=s),l<s&&(l=s),u>r&&(u=r),c<r&&(c=r)),d+=4;return h<l&&u<c?[h,u,l-h,c-u]:[0,0,e,i]},zf.regularStamp=function(t){const{cache:e,cacheOutput:i,currentHost:n,layoutTemplate:s,state:r}=this,o=t||n;if(o&&s){const{element:t,engine:n}=o;if(i&&e)n.save(),n.shadowOffsetX=r.shadowOffsetX,n.shadowOffsetY=r.shadowOffsetY,n.shadowBlur=r.shadowBlur,n.shadowColor=r.shadowColor,this.setImageSmoothing(n),n.globalAlpha=r.globalAlpha,n.globalCompositeOperation=r.globalCompositeOperation,n.resetTransform(),n.drawImage(e.element,0,0),n.restore();else{const{guidelinesPath:e,showGuidelines:s,useLayoutTemplateAsPath:a}=this,l=a?this.createTextCellsForPath(o):this.createTextCellsForSpace(o);if(l){const{copyCell:c,mainCell:h}=l,u=t.width,d=t.height,f=Va(u,d),p=f.element,g=f.engine;this.removeShadowAndAlpha(g);const m=this.addUnderlinesToCopyCell(o,c),y=this.createOverlineCell(o),b=this.createHighlightCell(o);!a&&s&&e&&this.stampGuidelinesOnCell(f),m&&g.drawImage(c.element,0,0),g.drawImage(h.element,0,0),y&&g.drawImage(y.element,0,0),b&&(g.save(),g.globalCompositeOperation=Re,g.drawImage(b.element,0,0),g.restore());if(!(this.noFilters||!this.filters||!this.filters.length)){!this.dirtyFilters&&this.currentFilters||this.cleanFilters();const e=this.currentFilters;this.isStencil&&(g.save(),g.globalCompositeOperation=Tn,g.globalAlpha=1,g.resetTransform(),g.drawImage(t,0,0),g.restore(),this.dirtyFilterIdentifier=!0),g.resetTransform();const i=g.getImageData(0,0,u,d);this.preprocessFilters(e);const n=hc.action({identifier:this.filterIdentifier,image:i,filters:e});n&&(g.globalCompositeOperation=En,g.globalAlpha=1,g.resetTransform(),g.putImageData(n,0,0))}if(n.save(),n.resetTransform(),n.shadowOffsetX=r.shadowOffsetX,n.shadowOffsetY=r.shadowOffsetY,n.shadowBlur=r.shadowBlur,n.shadowColor=r.shadowColor,n.globalAlpha=r.globalAlpha,n.globalCompositeOperation=r.globalCompositeOperation,n.drawImage(p,0,0),n.restore(),this.stashOutput){this.stashOutput=!1;const[t,e,i,n]=this.getCellCoverage(g.getImageData(0,0,u,d));if(this.stashedImageData=g.getImageData(t,e,i,n),this.stashOutputAsAsset){const t=this.stashOutputAsAsset.substring?this.stashOutputAsAsset:`${this.name}-image`;this.stashOutputAsAsset=!1;const e=Va(i,n);if(this.setImageSmoothing(e.engine),e.engine.putImageData(this.stashedImageData,0,0),this.stashedImage)this.stashedImage.src=e.element.toDataURL();else{const i=this.getControllerCell();if(i){const n=this,s=document.createElement(hi);s.id=t,s.alt=`A cached image of the ${this.name} ${this.type} entity`,s.onload=function(){i.canvasHold.appendChild(s),n.stashedImage=s,Cc(`#${t}`)},s.src=e.element.toDataURL()}}Wa(e)}}i?this.cache=f:Wa(f),Wa(c,h,y,b)}}}},zf.createTextCellsForPath=function(t){const e=t.element,i=e.width,n=e.height,s=Va(i,n),r=Va(i,n);if(s&&r){const t=s.engine,e=r.engine,{state:i,lines:n,textUnits:o,defaultTextStyle:a}=this,l=this.makeWorkingTextStyle(a);this.setEngineFromWorkingTextStyle(l,tr,i,s),this.removeShadowAndAlpha(t),this.setEngineFromWorkingTextStyle(l,tr,i,r),this.removeShadowAndAlpha(e);const c=n[0];if(c){const{unitData:n}=c;let a,h,u,d,f,p,g,m,y,b,S,k,C,A,v,P;n.forEach((n=>{if(a=o[n],a&&(({chars:f,charType:p,localRotation:d,localStyle:v,startCorrection:u,startData:h,startRotation:k,style:g}=a),v||(v=tr),g&&(this.setEngineFromWorkingTextStyle(l,g,i,s),this.removeShadowAndAlpha(t),t.lineWidth=l.underlineGap,this.setEngineFromWorkingTextStyle(l,g,i,r),this.removeShadowAndAlpha(e)),p!==Gf)){switch([m,y]=h,[b,S]=u,C=ot(k),A=xt(k),t.setTransform(C,A,-A,C,m,y),e.setTransform(C,A,-A,C,m,y),t.rotate(d),e.rotate(d),t.strokeText(f,b,S),t.fillText(f,b,S),e.save(),P=v.method||l.method,v.fillStyle&&(e.fillStyle=v.fillStyle),v.strokeStyle&&(e.strokeStyle=v.strokeStyle),P){case xf:e.strokeText(f,b,S);break;case wf:e.fillText(f,b,S),e.strokeText(f,b,S);break;case Of:e.strokeText(f,b,S),e.fillText(f,b,S);break;default:e.fillText(f,b,S)}e.restore()}}))}return{copyCell:s,mainCell:r}}return Wa(s,r),null},zf.createTextCellsForSpace=function(t){const e=t.element,i=e.width,n=e.height,s=Va(i,n),r=Va(i,n);if(s&&r){const t=s.engine,e=r.engine,{state:i,lines:n,textUnits:o,defaultTextStyle:a,hyphenString:l,truncateString:c}=this,h=a.direction===bi,u=this.makeWorkingTextStyle(a);return this.setEngineFromWorkingTextStyle(u,tr,i,s),this.removeShadowAndAlpha(t),this.setEngineFromWorkingTextStyle(u,tr,i,r),this.removeShadowAndAlpha(e),n.forEach((n=>{const{unitData:a}=n;let d,f,p,g,m,y,b,S,k,C,A,v,P,x,O,w,D;a.forEach(((n,F)=>{if(d=o[n],d&&(({startData:f,startCorrection:p,startRotation:C,localRotation:A,chars:g,style:m,localStyle:w}=d),w||(w=tr),m&&(this.setEngineFromWorkingTextStyle(u,m,i,s),this.removeShadowAndAlpha(t),t.lineWidth=u.underlineGap,this.setEngineFromWorkingTextStyle(u,m,i,r),this.removeShadowAndAlpha(e)),h?(x=a[F+1],O=x&&x.substring?x===Yf?`${g}${l}`:`${g}${c}`:g):O=g,O!==In)){switch([y,b]=f,[S,k]=p,S=ct(S),k=ct(k),v=ot(C),P=xt(C),t.setTransform(v,P,-P,v,y,b),e.setTransform(v,P,-P,v,y,b),t.rotate(A),e.rotate(A),t.strokeText(O,S,k),t.fillText(O,S,k),e.save(),D=w.method||u.method,w.fillStyle&&(e.fillStyle=w.fillStyle),w.strokeStyle&&(e.strokeStyle=w.strokeStyle),D){case xf:e.strokeText(O,S,k);break;case wf:e.fillText(O,S,k),e.strokeText(O,S,k);break;case Of:e.strokeText(O,S,k),e.fillText(O,S,k);break;default:e.fillText(O,S,k)}e.restore()}}))})),{copyCell:s,mainCell:r}}return Wa(s,r),null},zf.addUnderlinesToCopyCell=function(t,e){const i=this.underlinePaths;if(i.length){const n=t.element,s=n.width,r=n.height,o=Va(s,r);if(o){const t=o.engine;this.removeShadowAndAlpha(t);const n=e.engine;return i.forEach((e=>{t.resetTransform(),t.translate(...e[2]),t.fillStyle=this.getStyle(e[0],"fillStyle",o),t.fill(e[1])})),n.save(),this.removeShadowAndAlpha(n),n.globalCompositeOperation=Hn,n.resetTransform(),n.drawImage(o.element,0,0),n.restore(),Wa(o),!0}Wa(o)}return!1},zf.createOverlineCell=function(t){const e=this.overlinePaths;if(e.length){const i=t.element,n=i.width,s=i.height,r=Va(n,s);if(r){const t=r.engine;return this.removeShadowAndAlpha(t),e.forEach((e=>{t.resetTransform(),t.translate(...e[2]),t.fillStyle=this.getStyle(e[0],"fillStyle",r),t.fill(e[1])})),r}Wa(r)}return null},zf.createHighlightCell=function(t){const e=this.highlightPaths;if(e.length){const i=t.element,n=i.width,s=i.height,r=Va(n,s);if(r){const t=r.engine;return this.removeShadowAndAlpha(t),e.forEach((e=>{t.resetTransform(),t.translate(...e[2]),t.fillStyle=this.getStyle(e[0],"fillStyle",r),t.fill(e[1])})),r}Wa(r)}return null},zf.stampGuidelinesOnCell=function(t){if(t&&t.engine){const{guidelinesPath:e,guidelineStyle:i,guidelineWidth:n,guidelineDash:s}=this,r=t.engine;r.save(),r.setLineDash(s),r.strokeStyle=i,r.lineWidth=n,this.setImageSmoothing(r),r.stroke(e),r.restore()}},zf.checkHit=function(t=[]){const e=t=>{let e,i;if(ut(t))e=t[0],i=t[1];else{if(!gr(t,t.x,t.y))return[!1];e=t.x,i=t.y}return dt(e)&&dt(i)?[!0,e,i]:[!1]},{checkHitUseTemplate:i,layoutTemplate:n,textUnits:s,textUnitHitZones:r}=this;if(i&&n)return n.checkHit(t);if(!r.length&&s.length){let t,e,i,n;s.forEach((s=>{({tl:t,tr:e,br:i,bl:n}=s.boxData),r.push(new Path2D(`M ${t[0]},${t[1]} ${e[0]},${e[1]} ${i[0]},${i[1]} ${n[0]},${n[1]}Z`))}))}if(r.length){const i=ut(t)?t:[t],n=r.length;let s,o,a,l,c,h,u;const d=Va(),f=d.engine;for(h=0,u=i.length;h<u;h++)if([o,a,l]=e(i[h]),o){for(c=0;c<n;c++)if(f.isPointInPath(r[c],a,l)){s={x:a,y:l,index:c,artefact:this};break}if(s)return Wa(d),s}Wa(d)}return!1},zf.updatePivotSubscribers=function(){let t;this.pivoted.forEach((e=>{t=o[e],t||(t=l[e],t&&t.type===Un||(t=!1)),t&&(t.dirtyStart=!0),t.addPivotRotation&&(t.dirtyRotation=!0)}),this)},zf.getUnitStartAt=function(t){const e=this.textUnits;return t>=0&&t<e.length?[...e[t].startData]:null},zf.getUnitAlignment=function(t){const{textUnits:e,alignment:i}=this;return t>=0&&t<e.length?i+e[t].localAlignment:i};const Zf=function(t){return!!t&&new EnhancedLabel(t)};J.EnhancedLabel=EnhancedLabel;const _f="chars",Kf="charType",qf=["localStyle","localHandleX","localHandleY","localOffsetX","localOffsetY","localAlignment"],UnitObject=function(){return this.startData=qa(),this.startCorrection=qa(),this.boxData={tl:[],tr:[],br:[],bl:[]},this.localHandle=[],this.localOffset=[],this.set(this.defs),this},Qf=UnitObject.prototype=Sr();Qf.type=Hf,Qf.defs={chars:zs,charType:zs,style:null,pathData:null,pathPos:0,stampFlag:!0,startData:null,startCorrection:null,localHandle:null,localOffset:null,boxData:null,localAlignment:0,localRotation:0,startRotation:0,localStyle:null,lineStart:!1,len:0,height:0,kernOffset:0,replaceLen:0,index:0},Qf.defKeys=ft(Qf.defs),Qf.set=function(t=tr){let e,i,n,s,r;for(const[o,a]of lt(t))if(this.defKeys.includes(o)||qf.includes(o))switch(o){case"startData":case"startCorrection":null!=a?this[o].set(a):this[o].zero();break;case"localHandleX":this.localHandle[0]=null!=a?a:null;break;case"localHandleY":this.localHandle[1]=null!=a?a:null;break;case"localHandle":null!=a?(this.localHandle[0]=a[0],this.localHandle[1]=a[1]):(this.localHandle[0]=null,this.localHandle[1]=null);break;case"localOffsetX":this.localOffset[0]=null!=a?a:null;break;case"localOffsetY":this.localOffset[1]=null!=a?a:null;break;case"localOffset":null!=a?(this.localOffset[0]=a[0],this.localOffset[1]=a[1]):(this.localOffset[0]=null,this.localOffset[1]=null);break;case"boxData":e=this.boxData,null!=a?(({tl:i,tr:n,br:s,bl:r}=a),null!=i&&ut(i)&&(e.tl.length=0,e.tl.push(...i)),null!=n&&ut(n)&&(e.tr.length=0,e.tr.push(...n)),null!=s&&ut(s)&&(e.br.length=0,e.br.push(...s)),null!=r&&ut(r)&&(e.bl.length=0,e.bl.push(...r))):(e.tl.length=0,e.tr.length=0,e.br.length=0,e.bl.length=0);break;case"chars":case"charType":case"height":case"index":case"kernOffset":case"len":case"lineStart":case"localAlignment":case"localStyle":case"pathData":case"pathPos":case"replaceLen":case"stampFlag":case"startRotation":case"style":this[o]=null!=a?a:this.defs[o]}return this},Qf.reset=function(){return this.set(this.defs),this},zf.setTextUnit=function(t,e){const i=this.textUnits[t];if(null!==i)for(const[t,n]of lt(e))qf.includes(t)&&i.set({[t]:n});this.dirtyLayout=!0,this.dirtyCache()},zf.setAllTextUnits=function(t){this.textUnits.forEach((e=>{if(null!==e)for(const[i,n]of lt(t))qf.includes(i)&&e.set({[i]:n})})),this.dirtyLayout=!0,this.dirtyCache()},zf.applyTextUnitUpdates=function(){this.dirtyLayout=!0,this.dirtyCache()};const Jf=[],tp=function(t=tr){Jf.length||Jf.push(new UnitObject);const e=Jf.shift();return e.set(t),e},ep=function(...t){t.forEach((t=>{t&&t.type===Hf&&Jf.push(t.reset())}))},LineObject=function(){return this.startAt=qa(),this.endAt=qa(),this.unitData=[],this.set(this.defs),this},ip=LineObject.prototype=Sr();ip.type=Tf,ip.defs={length:0,isPathEntity:!1,startAt:null,endAt:null,unitData:null},ip.defKeys=ft(ip.defs),ip.set=function(t=tr){for(const[e,i]of lt(t))if(this.defKeys.includes(e))switch(e){case"startAt":case"endAt":null!=i?this[e].set(i):this[e].zero();break;case"unitData":this[e].length=0,null!=i&&this[e].push(...i);break;default:this[e]=null!=i?i:this.defs[e]}return this},ip.reset=function(){return this.set(this.defs),this};const np=[],sp=function(t=tr){np.length||np.push(new LineObject);const e=np.shift();return e.set(t),e},rp=function(...t){t.forEach((t=>{t&&t.type===Tf&&np.push(t.reset())}))},op=function(){const t=[];return Pt(t,op.prototype),t},ap=op.prototype=at(Array.prototype);ap.constructor=op,ap.type="EnhancedLabelUnitArray";const lp=()=>new op;ap.findByIndex=function(t){let e;for(let i=0,n=this.length;i<n;i++)if(e=this[i],e.index===t)return e;return null},ap.findFirstWithChar=function(t){let e;for(let i=0,n=this.length;i<n;i++)if(e=this[i],e.chars.includes(t))return e;return null},ap.findAllWithChar=function(t){let e;const i=[];for(let n=0,s=this.length;n<s;n++)e=this[n],e.chars.includes(t)&&i.push(e);return i},ap.findAllDisplayedChars=function(){let t;const e=[];for(let i=0,n=this.length;i<n;i++)t=this[i],t.stampFlag&&t.charType!==Gf&&e.push(t);return e};const Gradient=function(t=tr){return this.stylesInit(t),this},cp=Gradient.prototype=Sr();cp.type="Gradient",cp.lib=jn,cp.isArtefact=!1,cp.isAsset=!1,Co(cp),Rd(cp),cp.packetObjects=dr(cp.packetObjects,["palette"]),cp.buildStyle=function(t){if(t){const e=t.engine;if(e){const t=e.createLinearGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return Jt},cp.updateGradientArgs=function(t,e){const i=this.gradientArgs,n=this.currentStart,s=this.currentEnd,r=n[0]+t,o=n[1]+e,a=s[1]+e;let l=s[0]+t;r===l&&o===a&&l++,i.length=0,i.push(r,o,l,a)};const hp=function(t){return!!t&&new Gradient(t)};J.Gradient=Gradient;const up=["down","round","up"],dp="emboss-work",fp=["random","ordered","bluenoise"],Filter=function(t=tr){return this.makeName(t.name),this.register(),this.actions=[],this.set(t),this},pp=Filter.prototype=Sr();pp.type=qn,pp.lib=We,pp.isArtefact=!1,pp.isAsset=!1,Co(pp);const gp={actions:null,method:zs,lineIn:zs,lineMix:zs,lineOut:zs,opacity:1,alpha:255,angle:0,areaAlphaLevels:null,asset:zs,blend:Gi,blue:0,blueInBlue:0,blueColor:qt,blueInGreen:0,blueInRed:0,channelA:1,channelB:1,channelL:1,channelX:gn,channelY:ni,clamp:0,compose:En,copyHeight:1,copyWidth:1,copyX:0,copyY:0,concurrent:!1,easing:mi,excludeAlpha:!0,excludeBlue:!1,excludeGreen:!1,excludeRed:!1,excludeTransparentPixels:!0,gradient:null,green:0,greenInBlue:0,greenColor:qt,greenInGreen:0,greenInRed:0,gutterHeight:1,gutterWidth:1,height:1,highAlpha:255,highBlue:255,highColor:Ys,highGreen:255,highRed:255,includeAlpha:!1,includeBlue:!0,includeGreen:!0,includeRed:!0,innerRadius:0,keepOnlyChangedAreas:!1,level:0,lowAlpha:0,lowBlue:0,lowColor:qt,lowGreen:0,lowRed:0,minimumColorDistance:1e3,noiseType:un,noWrap:!1,offsetAlphaX:0,offsetAlphaY:0,offsetBlueX:0,offsetBlueY:0,offsetGreenX:0,offsetGreenY:0,offsetRedX:0,offsetRedY:0,offsetX:0,offsetY:0,offsetAlphaMin:0,offsetAlphaMax:0,offsetBlueMin:0,offsetBlueMax:0,offsetGreenMin:0,offsetGreenMax:0,offsetRedMin:0,offsetRedMax:0,offsetMin:0,offsetMax:0,opaqueAt:1,operation:Ci,outerRadius:"30%",palette:Qt,passes:1,points:null,postProcessResults:!0,processHorizontal:!0,processVertical:!0,radius:1,ranges:null,red:0,redInBlue:0,redColor:qt,redInGreen:0,redInRed:0,reference:qt,scaleX:1,scaleY:1,seed:we,smoothing:0,startX:Zi,startY:Zi,step:1,strength:1,staticSwirls:null,tileHeight:1,tileWidth:1,tileRadius:1,tolerance:0,transparentAt:0,transparentEdges:!1,useBluenoise:!1,useLabForPaletteDistance:!1,useMixedChannel:!0,useNaturalGrayscale:!1,weights:null,width:1};pp.defs=hr(pp.defs,gp),pp.kill=function(){const t=this.name;let e;return Dt(m).forEach((i=>{e=i.filters,e&&e.includes(t)&&fr(e,t)})),Dt(A).forEach((i=>{e=i.filters,e&&e.includes(t)&&fr(e,t)})),Dt(d).forEach((i=>{e=i.filters,e&&e.includes(t)&&fr(e,t)})),this.deregister(),this};const mp=pp.setters;pp.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==Li&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Ts&&(this[a]=l))}return this.method&&yp[this.method]&&yp[this.method](this),this.dirtyFilterIdentifier=!0,this},pp.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs;let r,o,a,l;for(o=0;o<i;o++)a=e[o],l=t[a],a&&a!==Li&&null!=l&&(r=n[a],r?r.call(this,l):typeof s[a]!==Ts&&(this[a]=Ws(this[a],l)))}return this.method&&yp[this.method]&&yp[this.method](this),this.dirtyFilterIdentifier=!0,this},mp.actions=function(t){null!=t&&(this.actions=t)};const yp={alphaToChannels:function(t){t.actions=[{action:Lt,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,excludeRed:null==t.excludeRed||t.excludeRed,excludeGreen:null==t.excludeGreen||t.excludeGreen,excludeBlue:null==t.excludeBlue||t.excludeBlue}]},areaAlpha:function(t){t.actions=[{action:Gt,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,gutterWidth:null!=t.gutterWidth?t.gutterWidth:1,gutterHeight:null!=t.gutterHeight?t.gutterHeight:1,areaAlphaLevels:null!=t.areaAlphaLevels?t.areaAlphaLevels:[255,0,0,0]}]},blend:function(t){t.actions=[{action:te,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,lineMix:null!=t.lineMix?t.lineMix:zs,blend:null!=t.blend?t.blend:Gi,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,opacity:null!=t.opacity?t.opacity:1}]},blue:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,excludeRed:!0,excludeGreen:!0}]},blur:function(t){t.actions=[{action:ne,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,excludeTransparentPixels:null!=t.excludeTransparentPixels&&t.excludeTransparentPixels,processHorizontal:null==t.processHorizontal||t.processHorizontal,processVertical:null==t.processVertical||t.processVertical,radius:null!=t.radius?t.radius:1,passes:null!=t.passes?t.passes:1,step:null!=t.step?t.step:1}]},brightness:function(t){const e=null!=t.level?t.level:1;t.actions=[{action:xi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,red:e,green:e,blue:e}]},channelLevels:function(t){t.actions=[{action:yi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,red:null!=t.red?t.red:[0],green:null!=t.green?t.green:[0],blue:null!=t.blue?t.blue:[0],alpha:null!=t.alpha?t.alpha:[255]}]},channels:function(t){t.actions=[{action:xi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,red:null!=t.red?t.red:1,green:null!=t.green?t.green:1,blue:null!=t.blue?t.blue:1,alpha:null!=t.alpha?t.alpha:1}]},channelstep:function(t){let e=null!=t.clamp?t.clamp:Le;up.includes(e)||(e=Le),t.actions=[{action:Gn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,clamp:e,red:null!=t.red?t.red:1,green:null!=t.green?t.green:1,blue:null!=t.blue?t.blue:1}]},channelsToAlpha:function(t){t.actions=[{action:ce,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue}]},chroma:function(t){const e=[],i=[];null!=t.ranges&&t.ranges.forEach((t=>{6===t.length?e.push(t):2===t.length&&(t[0].substring&&t[1].substring&&(i.length=0,t.forEach((t=>{const[e,n,s]=rc.extractRGBfromColor(t);i.push(e,n,s)}))),e.push(i))})),t.actions=[{action:he,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,ranges:e}]},chromakey:function(t){let e=null!=t.red?t.red:0,i=null!=t.green?t.green:255,n=null!=t.blue?t.blue:0;null!=t.reference&&([e,i,n]=rc.extractRGBfromColor(t.reference),t.red=e,t.green=i,t.blue=n,delete t.reference),t.actions=[{action:ye,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,red:e,green:i,blue:n,transparentAt:null!=t.transparentAt?t.transparentAt:0,opaqueAt:null!=t.opaqueAt?t.opaqueAt:1}]},clampChannels:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,n=null!=t.lowBlue?t.lowBlue:0,s=null!=t.highRed?t.highRed:255,r=null!=t.highGreen?t.highGreen:255,o=null!=t.highBlue?t.highBlue:255;null!=t.lowColor&&([e,i,n]=rc.extractRGBfromColor(t.lowColor),t.lowRed=e,t.lowGreen=i,t.lowBlue=n,delete t.lowColor),null!=t.highColor&&([s,r,o]=rc.extractRGBfromColor(t.highColor),t.highRed=s,t.highGreen=r,t.highBlue=o,delete t.highColor),t.actions=[{action:ue,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,lowRed:e,lowGreen:i,lowBlue:n,highRed:s,highGreen:r,highBlue:o}]},compose:function(t){t.actions=[{action:be,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,lineMix:null!=t.lineMix?t.lineMix:zs,compose:null!=t.compose?t.compose:En,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,opacity:null!=t.opacity?t.opacity:1}]},corrode:function(t){t.actions=[{action:ve,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,width:null!=t.width?t.width:3,height:null!=t.height?t.height:3,offsetX:null!=t.offsetX?t.offsetX:1,offsetY:null!=t.offsetY?t.offsetY:1,includeRed:null!=t.includeRed&&t.includeRed,includeGreen:null!=t.includeGreen&&t.includeGreen,includeBlue:null!=t.includeBlue&&t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,operation:null!=t.operation?t.operation:Ci,opacity:null!=t.opacity?t.opacity:1}]},curveWeights:function(t){t.actions=[{action:$s,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,weights:null!=t.weights&&t.weights,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel}]},cyan:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeGreen:!0,includeBlue:!0,excludeRed:!0}]},displace:function(t){t.actions=[{action:Ee,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,lineMix:null!=t.lineMix?t.lineMix:zs,opacity:null!=t.opacity?t.opacity:1,channelX:null!=t.channelX?t.channelX:gn,channelY:null!=t.channelY?t.channelY:ni,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,scaleX:null!=t.scaleX?t.scaleX:1,scaleY:null!=t.scaleY?t.scaleY:1,transparentEdges:null!=t.transparentEdges&&t.transparentEdges}]},edgeDetect:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:!0,includeGreen:!0,includeBlue:!0,includeAlpha:!1,weights:[0,1,0,1,-4,1,0,1,0]}]},emboss:function(t){const e=[];t.useNaturalGrayscale?e.push({action:ii,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:dp}):e.push({action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:dp,includeRed:!0,includeGreen:!0,includeBlue:!0}),t.clamp&&e.push({action:ue,lineIn:dp,lineOut:dp,lowRed:0+t.clamp,lowGreen:0+t.clamp,lowBlue:0+t.clamp,highRed:255-t.clamp,highGreen:255-t.clamp,highBlue:255-t.clamp}),t.smoothing&&e.push({action:Je,lineIn:dp,lineOut:dp,radius:t.smoothing}),e.push({action:Xe,lineIn:dp,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,angle:null!=t.angle?t.angle:0,strength:null!=t.strength?t.strength:1,tolerance:null!=t.tolerance?t.tolerance:0,keepOnlyChangedAreas:null!=t.keepOnlyChangedAreas&&t.keepOnlyChangedAreas,postProcessResults:null==t.postProcessResults||t.postProcessResults}),t.actions=e},flood:function(t){let e=null!=t.red?t.red:0,i=null!=t.green?t.green:0,n=null!=t.blue?t.blue:0,s=null!=t.alpha?t.alpha:255;const r=null!=t.excludeAlpha&&t.excludeAlpha;null!=t.reference&&([e,i,n,s]=rc.extractRGBfromColor(t.reference),s=vt(255*s),t.red=e,t.green=i,t.blue=n,t.alpha=s,delete t.reference),t.actions=[{action:Ue,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,red:e,green:i,blue:n,alpha:s,excludeAlpha:r}]},gaussianBlur:function(t){t.actions=[{action:Je,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,radius:null!=t.radius?t.radius:1}]},glitch:function(t){t.actions=[{action:ti,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel,seed:null!=t.seed?t.seed:we,step:null!=t.step?t.step:1,offsetMin:null!=t.offsetMin?t.offsetMin:0,offsetMax:null!=t.offsetMax?t.offsetMax:0,offsetRedMin:null!=t.offsetRedMin?t.offsetRedMin:0,offsetRedMax:null!=t.offsetRedMax?t.offsetRedMax:0,offsetGreenMin:null!=t.offsetGreenMin?t.offsetGreenMin:0,offsetGreenMax:null!=t.offsetGreenMax?t.offsetGreenMax:0,offsetBlueMin:null!=t.offsetBlueMin?t.offsetBlueMin:0,offsetBlueMax:null!=t.offsetBlueMax?t.offsetBlueMax:0,offsetAlphaMin:null!=t.offsetAlphaMin?t.offsetAlphaMin:0,offsetAlphaMax:null!=t.offsetAlphaMax?t.offsetAlphaMax:0,transparentEdges:null!=t.transparentEdges&&t.transparentEdges,level:null!=t.level?t.level:0}]},gray:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,includeBlue:!0}]},grayscale:function(t){t.actions=[{action:ii,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1}]},green:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,excludeRed:!0,excludeBlue:!0}]},image:function(t){t.actions=[{action:rn,lineOut:null!=t.lineOut?t.lineOut:zs,asset:null!=t.asset?t.asset:zs,width:null!=t.width?t.width:1,height:null!=t.height?t.height:1,copyWidth:null!=t.copyWidth?t.copyWidth:1,copyHeight:null!=t.copyHeight?t.copyHeight:1,copyX:null!=t.copyX?t.copyX:0,copyY:null!=t.copyY?t.copyY:0}]},invert:function(t){t.actions=[{action:di,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,includeBlue:!0}]},magenta:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeBlue:!0,excludeGreen:!0}]},mapToGradient:function(t){t.gradient&&t.gradient.substring&&(t.gradient=B[t.gradient]),t.actions=[{action:Si,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,useNaturalGrayscale:null!=t.useNaturalGrayscale&&t.useNaturalGrayscale,gradient:t.gradient||hp()}]},matrix:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,weights:null!=t.weights?t.weights:[0,0,0,0,1,0,0,0,0]}]},matrix5:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,width:5,height:5,offsetX:2,offsetY:2,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,weights:null!=t.weights?t.weights:[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]}]},modifyOk:function(t){t.actions=[{action:Pi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,channelL:null!=t.channelL?t.channelL:0,channelA:null!=t.channelA?t.channelA:0,channelB:null!=t.channelB?t.channelB:0}]},modulateOk:function(t){t.actions=[{action:Oi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,channelL:null!=t.channelL?t.channelL:1,channelA:null!=t.channelA?t.channelA:1,channelB:null!=t.channelB?t.channelB:1}]},negative:function(t){t.actions=[{action:$i,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1}]},newsprint:function(t){t.actions=[{action:Xi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,width:null!=t.width?t.width:1}]},notblue:function(t){t.actions=[{action:Dn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeBlue:!0,level:0}]},notgreen:function(t){t.actions=[{action:Dn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeGreen:!0,level:0}]},notred:function(t){t.actions=[{action:Dn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,level:0}]},offset:function(t){t.actions=[{action:ji,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,offsetRedX:null!=t.offsetX?t.offsetX:0,offsetRedY:null!=t.offsetY?t.offsetY:0,offsetGreenX:null!=t.offsetX?t.offsetX:0,offsetGreenY:null!=t.offsetY?t.offsetY:0,offsetBlueX:null!=t.offsetX?t.offsetX:0,offsetBlueY:null!=t.offsetY?t.offsetY:0,offsetAlphaX:null!=t.offsetX?t.offsetX:0,offsetAlphaY:null!=t.offsetY?t.offsetY:0}]},offsetChannels:function(t){t.actions=[{action:ji,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,offsetRedX:null!=t.offsetRedX?t.offsetRedX:0,offsetRedY:null!=t.offsetRedY?t.offsetRedY:0,offsetGreenX:null!=t.offsetGreenX?t.offsetGreenX:0,offsetGreenY:null!=t.offsetGreenY?t.offsetGreenY:0,offsetBlueX:null!=t.offsetBlueX?t.offsetBlueX:0,offsetBlueY:null!=t.offsetBlueY?t.offsetBlueY:0,offsetAlphaX:null!=t.offsetAlphaX?t.offsetAlphaX:0,offsetAlphaY:null!=t.offsetAlphaY?t.offsetAlphaY:0}]},pixelate:function(t){t.actions=[{action:qi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha}]},randomNoise:function(t){const e=fp.includes(t.noiseType)?t.noiseType:un;t.actions=[{action:dn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,width:null!=t.width?t.width:1,height:null!=t.height?t.height:1,seed:null!=t.seed?t.seed:we,noiseType:e,level:null!=t.level?t.level:0,noWrap:null!=t.noWrap&&t.noWrap,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null==t.includeAlpha||t.includeAlpha,excludeTransparentPixels:null==t.excludeTransparentPixels||t.excludeTransparentPixels}]},red:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,excludeGreen:!0,excludeBlue:!0}]},reducePalette:function(t){let e=null!=t.palette?t.palette:Qt;t.actions=[],e.substring&&e.includes(jt)&&(e=e.split(jt),e.forEach((t=>t.trim())));let i=t.useBluenoise?ie:t.noiseType||un;fp.includes(i)||(i=un),t.actions.push({action:mn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,seed:null!=t.seed?t.seed:we,minimumColorDistance:null!=t.minimumColorDistance?t.minimumColorDistance:1e3,palette:e,noiseType:i,opacity:null!=t.opacity?t.opacity:1})},rotateHue:function(t){t.actions=[{action:On,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,angle:null!=t.angle?t.angle:0}]},saturation:function(t){const e=null!=t.level?t.level:1;t.actions=[{action:xi,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,red:e,green:e,blue:e,saturation:!0}]},sepia:function(t){t.actions=[{action:As,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,redInRed:.393,redInGreen:.349,redInBlue:.272,greenInRed:.769,greenInGreen:.686,greenInBlue:.534,blueInRed:.189,blueInGreen:.168,blueInBlue:.131}]},sharpen:function(t){t.actions=[{action:ki,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,width:3,height:3,offsetX:1,offsetY:1,includeRed:!0,includeGreen:!0,includeBlue:!0,includeAlpha:!1,weights:[0,-1,0,-1,5,-1,0,-1,0]}]},swirl:function(t){const e=null!=t.startX?t.startX:Zi,i=null!=t.startY?t.startY:Zi,n=null!=t.innerRadius?t.innerRadius:0,s=null!=t.outerRadius?t.outerRadius:"30%",r=null!=t.angle?t.angle:0,o=null!=t.easing?t.easing:mi,a=[...null!=t.staticSwirls?t.staticSwirls:[]];a.push([e,i,n,s,r,o]),t.actions=[{action:Nn,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,swirls:a}]},threshold:function(t){let e=null!=t.lowRed?t.lowRed:0,i=null!=t.lowGreen?t.lowGreen:0,n=null!=t.lowBlue?t.lowBlue:0,s=null!=t.lowAlpha?t.lowAlpha:255,r=null!=t.highRed?t.highRed:255,o=null!=t.highGreen?t.highGreen:255,a=null!=t.highBlue?t.highBlue:255,l=null!=t.highAlpha?t.highAlpha:255;null!=t.lowColor&&([e,i,n,s]=rc.extractRGBfromColor(t.lowColor),s=vt(255*s),t.lowRed=e,t.lowGreen=i,t.lowBlue=n,t.lowAlpha=s,t.low=[e,i,n,s],delete t.lowColor),null!=t.highColor&&([r,o,a,l]=rc.extractRGBfromColor(t.highColor),l=vt(255*l),t.highRed=r,t.highGreen=o,t.highBlue=a,t.highAlpha=l,t.high=[r,o,a,l],delete t.highColor);const c=null!=t.low?t.low:[e,i,n,s],h=null!=t.high?t.high:[r,o,a,l];t.actions=[{action:ks,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,level:null!=t.level?t.level:128,red:null!=t.red?t.red:128,green:null!=t.green?t.green:128,blue:null!=t.blue?t.blue:128,alpha:null!=t.alpha?t.alpha:128,low:c,high:h,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha,useMixedChannel:null==t.useMixedChannel||t.useMixedChannel}]},tiles:function(t){t.actions=[{action:Cs,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,tileWidth:null!=t.tileWidth?t.tileWidth:1,tileHeight:null!=t.tileHeight?t.tileHeight:1,tileRadius:null!=t.tileRadius?t.tileRadius:1,offsetX:null!=t.offsetX?t.offsetX:0,offsetY:null!=t.offsetY?t.offsetY:0,angle:null!=t.angle?t.angle:0,points:null!=t.points?t.points:fn,seed:null!=t.seed?t.seed:we,includeRed:null==t.includeRed||t.includeRed,includeGreen:null==t.includeGreen||t.includeGreen,includeBlue:null==t.includeBlue||t.includeBlue,includeAlpha:null!=t.includeAlpha&&t.includeAlpha}]},tint:function(t){let e=null!=t.redInRed?t.redInRed:1,i=null!=t.redInGreen?t.redInGreen:0,n=null!=t.redInBlue?t.redInBlue:0,s=null!=t.greenInRed?t.greenInRed:0,r=null!=t.greenInGreen?t.greenInGreen:1,o=null!=t.greenInBlue?t.greenInBlue:0,a=null!=t.blueInRed?t.blueInRed:0,l=null!=t.blueInGreen?t.blueInGreen:0,c=null!=t.blueInBlue?t.blueInBlue:1;null!=t.redColor&&([e,s,a]=rc.extractRGBfromColor(t.redColor),e/=255,s/=255,a/=255,t.redInRed=e,t.greenInRed=s,t.blueInRed=a,delete t.redColor),null!=t.greenColor&&([i,r,l]=rc.extractRGBfromColor(t.greenColor),i/=255,r/=255,l/=255,t.redInGreen=i,t.greenInGreen=r,t.blueInGreen=l,delete t.greenColor),null!=t.blueColor&&([n,o,c]=rc.extractRGBfromColor(t.blueColor),n/=255,o/=255,c/=255,t.redInBlue=n,t.greenInBlue=o,t.blueInBlue=c,delete t.blueColor),t.actions=[{action:As,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,redInRed:e,redInGreen:i,redInBlue:n,greenInRed:s,greenInGreen:r,greenInBlue:o,blueInRed:a,blueInGreen:l,blueInBlue:c}]},userDefined:function(t){t.actions=[{action:Bs,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1}]},yellow:function(t){t.actions=[{action:_t,lineIn:null!=t.lineIn?t.lineIn:zs,lineOut:null!=t.lineOut?t.lineOut:zs,opacity:null!=t.opacity?t.opacity:1,includeRed:!0,includeGreen:!0,excludeBlue:!0}]}},bp=function(t){return!!t&&new Filter(t)};J.Filter=Filter;const Force=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.action||(this.action=qs),this},Sp=Force.prototype=Sr();Sp.type="Force",Sp.lib="force",Sp.isArtefact=!1,Sp.isAsset=!1,Co(Sp);Sp.defs=hr(Sp.defs,{action:null}),Sp.packetFunctions=dr(Sp.packetFunctions,["action"]),Sp.kill=function(){return this.deregister(),!0};Sp.setters.action=function(t){or(t)?this.action=t:this.action=qs};const kp=function(t){return!!t&&new Force(t)};J.Force=Force,kp({name:"gravity",action:(t,e)=>{const{mass:i,load:n}=t,s=Hh();s.setFromVector(e.gravity).scalarMultiply(i),n.vectorAdd(s),Eh(s)}});const Cp=Number.isSafeInteger||Number.isInteger,Ap="cellGradient",vp="gridGradient",Pp="gridPicture",xp="tilePicture",Grid=function(t=tr){return this.tileFill=[],this.tileSources=[],this.rowLines=null,this.columnLines=null,this.currentTileWidth=0,this.currentTileHeight=0,this.entityInit(t),t.tileSources||(this.tileSources=[].concat([{type:me,source:qt},{type:me,source:Ys}])),t.tileFill?ut(t.tileFill)&&this.tileFill.length===t.tileFill.length&&(this.tileFill=t.tileFill):(this.tileFill.length=this.columns*this.rows,this.tileFill.fill(0)),this.tilePaths=[],this.tileRealCoordinates=[],this.tileVirtualCoordinates=[],t.dimensions||(t.width||(this.currentDimensions[0]=this.dimensions[0]=20),t.height||(this.currentDimensions[1]=this.dimensions[1]=20)),this},Op=Grid.prototype=Sr();Op.type="Grid",Op.lib=ze,Op.isArtefact=!0,Op.isAsset=!1,Co(Op),Ju(Op);const wp={columns:2,rows:2,columnGutterWidth:1,rowGutterWidth:1,tileSources:null,tileFill:null,gutterColor:"rgb(127 127 127 / 1)"};Op.defs=hr(Op.defs,wp),Op.packetExclusions=dr(Op.packetExclusions,["tileSources"]),Op.finalizePacketOut=function(t,e){const i=t.tileSources=[];this.tileSources.forEach((t=>{i.push({type:t.type,source:lr(t.source)?t.source.name:t.source})})),lr(t.gutterColor)&&(t.gutterColor=t.gutterColor.name);const n=yt(this.state.saveAsPacket(e))[3];return t=hr(t,n),t=this.handlePacketAnchor(t,e)};const Dp=Op.setters,Fp=Op.deltaSetters;Dp.columns=function(t){if(ar(t)&&(Cp(t)||(t=parseInt(t,10)),t!==this.columns)){let e,i,n;const s=this.tileFill,r=this.columns,o=[];for(this.columns=t,e=0,i=this.rows;e<i;e++)for(n=0;n<t;n++)n<r?o.push(s[e*r+n]):o.push(0);this.tileFill=o}this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fp.columns=qs,Dp.rows=function(t){if(ar(t)&&(Cp(t)||(t=parseInt(t,10)),t!==this.rows)){const e=this.rows;this.rows=t,this.tileFill.length=this.columns*t,e<t&&this.tileFill.fill(0,e*this.columns)}this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},Fp.rows=qs,Op.setAllTilesTo=function(t){return ar(t)&&(Cp(t)||(t=parseInt(t,10)),this.tileFill.fill(t),this.dirtyFilterIdentifier=!0),this},Op.setTileFill=function(t){const{columns:e,rows:i}=this;return ut(t)&&t.length===e*i&&(this.tileFill=t,this.dirtyFilterIdentifier=!0),this},Op.setTilesTo=function(t,e){const i=this.tileFill;return pr(t)&&ar(e)&&(Cp(e)||(e=parseInt(e,10)),ar(t)?i[t]=e:ut(t)&&t.forEach((t=>{ar(t)&&(i[t]=e)})),this.dirtyFilterIdentifier=!0),this},Op.setTileSourceTo=function(t,e){return ar(t)&&lr(e)&&e.type&&e.source&&(this.tileSources[t]=e),this},Op.removeTileSource=function(t){return ar(t)&&t&&(this.tileSources[t]=null,this.tileFill=this.tileFill.map((e=>e===t?0:e))),this},Op.getTileSource=function(t,e){if(ar(t))return ar(e)?this.tileFill[t*this.rows+e]:this.tileFill[t]},Op.getTilesUsingSource=function(t){const e=[];return ar(t)&&this.tileFill.forEach(((i,n)=>i===t&&e.push(n))),e},Op.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=new Path2D,i=new Path2D,n=this.currentStampHandlePosition,s=this.currentScale,r=this.currentDimensions,o=-n[0]*s,a=-n[1]*s,l=r[0]*s,c=r[1]*s;t.rect(o,a,l,c);const h=this.columns,u=this.rows,d=l/h,f=c/u,p=this.tilePaths,g=this.tileRealCoordinates,m=this.tileVirtualCoordinates;let y,b,S,k;for(e.moveTo(o,a),e.lineTo(o+l,a),y=1;y<=u;y++){const t=a+y*f;e.moveTo(o,t),e.lineTo(o+l,t)}for(this.rowLines=e,i.moveTo(o,a),i.lineTo(o,a+c),b=1;b<=h;b++)S=o+b*d,i.moveTo(S,a),i.lineTo(S,a+c);for(this.columnLines=i,p.length=0,g.length=0,m.length=0,y=0;y<u;y++)for(b=0;b<h;b++){const t=new Path2D;S=b*d,k=y*f,t.rect(o+S,a+k,d,f),p.push(t),m.push([S,k]),g.push([o+S,a+k])}this.currentTileWidth=d,this.currentTileHeight=f}},Op.performFill=function(t){if(this.scale>0){t.save();const e=Va(),i=e.engine,n=e.element,s=this.tileSources,r=this.tileFill,o=this.tilePaths,a=this.tileRealCoordinates,l=this.tileVirtualCoordinates,c=this.winding,h=this.currentTileWidth,u=this.currentTileHeight,d=this.scale,f=this.currentDimensions;let p;s.forEach(((s,g)=>{if(s&&s.type)switch(s.type){case me:t.fillStyle=s.source;break;case Ap:this.lockFillStyleToEntity=!1,t.fillStyle=s.source.getData(this,this.currentHost);break;case vp:this.lockFillStyleToEntity=!0,t.fillStyle=s.source.getData(this,this.currentHost)}const y=r.map((t=>t===g));if(y.length)switch(s.type){case Pp:p=s.source.substring?m[s.source]:s.source,p.simpleStamp&&(n.width=f[0]*d,n.height=f[1]*d,i.globalCompositeOperation=En,i.fillStyle=qt,y.forEach(((t,e)=>{t&&i.fillRect(l[e][0],l[e][1],h,u)})),i.globalCompositeOperation=Tn,p.simpleStamp(e,{startX:0,startY:0,width:f[0]*d,height:f[1]*d,method:Ve}),t.drawImage(n,~~a[0][0],~~a[0][1]));break;case xp:p=s.source.substring?m[s.source]:s.source,p.simpleStamp&&(n.width=h,n.height=u,i.globalCompositeOperation=En,p.simpleStamp(e,{startX:0,startY:0,width:h,height:u,method:Ve}),y.forEach(((e,i)=>e&&t.drawImage(n,~~a[i][0],~~a[i][1]))));break;default:y.forEach(((e,i)=>e&&t.fill(o[i],c)))}}));const g=this.gutterColor,y=this.rowGutterWidth,b=this.columnGutterWidth;let S;if(pr(g)){switch(g.substring?S={type:me,source:this.gutterColor}:lr(g)?S=g:ar(g)&&lr(s[g])&&(S=s[g]),S.type){case Ap:this.lockFillStyleToEntity=!1,t.strokeStyle=S.source.getData(this,this.currentHost);break;case vp:this.lockFillStyleToEntity=!0,t.strokeStyle=S.source.getData(this,this.currentHost);break;case me:t.strokeStyle=S.source}switch(S.type){case Pp:case xp:if((y||b)&&(p=S.source.substring?m[S.source]:S.source,p.simpleStamp)){const s=this.currentStampHandlePosition,r=this.currentScale,o=s[0]*r,l=s[1]*r;n.width=f[0]*r,n.height=f[1]*r,i.globalCompositeOperation=En,i.strokeStyle=qt,i.translate(o,l),y&&(i.lineWidth=y,i.stroke(this.rowLines)),b&&(i.lineWidth=b,i.stroke(this.columnLines)),i.globalCompositeOperation=Tn,p.simpleStamp(e,{startX:0,startY:0,width:f[0]*r,height:f[1]*r,method:Ve}),t.drawImage(n,~~a[0][0],~~a[0][1]),i.translate(0,0)}break;default:y&&(t.lineWidth=y,t.stroke(this.rowLines)),b&&(t.lineWidth=b,t.stroke(this.columnLines))}}Wa(e),t.restore()}},Op.fill=function(t){this.performFill(t)},Op.drawAndFill=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),this.performFill(t)},Op.fillAndDraw=function(t){const e=this.pathObject;t.stroke(e),this.currentHost.clearShadow(),this.performFill(t),t.stroke(e)},Op.drawThenFill=function(t){const e=this.pathObject;t.stroke(e),this.performFill(t)},Op.fillThenDraw=function(t){const e=this.pathObject;this.performFill(t),t.stroke(e)},Op.checkHit=function(t=[]){if(this.noUserInteraction)return!1;this.pathObject&&!this.dirtyPathObject||this.cleanPathObject();const e=ut(t)?t:[t],i=Va(),n=i.engine,s=this.currentStampPosition,r=s[0],o=s[1],a=new Set,l=this.tilePaths;let c,h,u;const d=t=>{let e,i;if(ut(t))e=t[0],i=t[1];else{if(!gr(t,t.x,t.y))return[!1];e=t.x,i=t.y}return dt(e)&&dt(i)?[!0,e,i]:[!1]};return i.rotateDestination(n,r,o,this),e.some((t=>([c,h,u]=d(t),!!c&&n.isPointInPath(this.pathObject,h,u,this.winding))),this)?(e.forEach((t=>{[c,h,u]=d(t),c&&l.some(((t,e)=>!!n.isPointInPath(t,h,u,this.winding)&&(a.add(e),!0)))})),Wa(i),{x:h,y:u,tiles:[...a],artefact:this}):(Wa(i),!1)};const Rp=function(t){return!!t&&new Grid(t)};J.Grid=Grid;const Label=function(t=tr){return this.entityInit(t),this},Tp=Label.prototype=Sr();Tp.type=ts,Tp.lib=ze,Tp.isArtefact=!0,Tp.isAsset=!1,Co(Tp),Ju(Tp),Pf(Tp);const Hp={text:zs,showBoundingBox:!1,boundingBoxStyle:qt,boundingBoxLineWidth:1,boundingBoxLineDash:null,boundingBoxLineDashOffset:0};Tp.defs=hr(Tp.defs,Hp);const Ep=Tp.getters,Ip=Tp.setters,Bp=Tp.deltaSetters;Ep.width=function(){return this.currentDimensions[0]},Ip.width=qs,Bp.width=qs,Ep.height=function(){return this.currentDimensions[1]},Ip.height=qs,Bp.height=qs,Ep.dimensions=function(){return[...this.currentDimensions]},Ip.dimensions=qs,Bp.dimensions=qs,Tp.entityInit=function(t=tr){this.modifyConstructorInputForAnchorButton(t),this.makeName(t.name),this.register(),this.initializePositions(),this.state=Aa(tr),this.defaultTextStyle=hf({name:`${this.name}_default-textstyle`,isDefaultTextStyle:!0}),this.filters=[],this.currentFilters=[],this.dirtyFilters=!1,this.dirtyFiltersCache=!1,this.dirtyImageSubscribers=!1,this.accessibleTextHold=null,this.accessibleTextHoldAttached=null,this.set(this.defs),t.group||(t.group=du),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.currentFontIsLoaded=!1,this.updateUsingFontParts=!1,this.updateUsingFontString=!1,this.usingViewportFontSizing=!0,this.letterSpaceValue=0,this.wordSpaceValue=0,this.alphabeticBaseline=0,this.hangingBaseline=0,this.ideographicBaseline=0,this.fontVerticalOffset=0,this.delta={},this.set(t),this.midInitActions(t),this.purge&&this.purgeArtefact(this.purge),this.dirtyFont=!0,this.currentFontIsLoaded=!1},Tp.measureFont=function(){const{defaultTextStyle:t,currentScale:e,dimensions:i}=this,{fontFamily:n,fontSizeValue:s,letterSpaceValue:r,wordSpaceValue:o}=t;t.letterSpacing=r*e+"px",t.wordSpacing=o*e+"px";const a=Va(),l=a.engine;l.font=t.canvasFont,l.fontKerning=t.fontKerning,l.fontStretch=t.fontStretch,l.fontVariantCaps=t.fontVariantCaps,l.textRendering=t.textRendering,l.letterSpacing=t.letterSpacing,l.wordSpacing=t.wordSpacing,l.direction=t.direction,l.textAlign=pi,l.textBaseline=vs;const c=l.measureText(this.text);Wa(a);const{actualBoundingBoxLeft:h,actualBoundingBoxRight:u}=c,d=this.getFontMetadata(n),f=s/100;i&&(i[0]=st(et(h)+et(u)),i[1]=d.height*f*e);const p=d.verticalOffset*f;this.alphabeticBaseline=(d.alphabeticBaseline*f+p)*e,this.hangingBaseline=(d.hangingBaseline*f+p)*e,this.ideographicBaseline=(d.ideographicBaseline*f+p)*e,this.fontVerticalOffset=p,this.dirtyPathObject=!0,this.dirtyDimensions=!0},Tp.cleanPathObject=function(){this.dirtyPathObject=!1;const t=this.pathObject=new Path2D,e=this.currentHandle,i=this.currentDimensions,[n,s]=e,[r,o]=i;t.rect(-n,-s,r,o)},Tp.cleanDimensions=function(){this.dirtyDimensions=!1;const t=this.dimensions,e=this.currentDimensions,[i,n]=e;e[0]=t[0],e[1]=t[1],this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,i===e[0]&&n===e[1]||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0),this.dirtyFilterIdentifier=!0},Tp.cleanHandle=function(){this.dirtyHandle=!1;const{handle:t,currentHandle:e,currentDimensions:i,mimicked:n,defaultTextStyle:s,alphabeticBaseline:r,hangingBaseline:o,ideographicBaseline:a}=this,[l,c]=t,[h,u]=i,d=s.direction||bi;l.toFixed?e[0]=l:l===pi?e[0]=0:l===vn?e[0]=h:l===le?e[0]=h/2:l===Ln?e[0]=d===bi?0:h:l===Ye?e[0]=d===bi?h:0:dt(parseFloat(l))?e[0]=parseFloat(l)/100*h:e[0]=0,c.toFixed?e[1]=c:c===vs?e[1]=0:c===oe?e[1]=u:c===le||c===vi?e[1]=u/2:c===si?e[1]=dt(o)?o:0:c===$t?e[1]=dt(r)?r:0:c===ci?e[1]=dt(a)?a:0:dt(parseFloat(c))?e[1]=parseFloat(c)/100*u:e[1]=0,this.dirtyFilterIdentifier=!0,this.dirtyStampHandlePositions=!0,n&&n.length&&(this.dirtyMimicHandle=!0)},Tp.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyText&&this.updateAccessibleTextHold(),this.dirtyFont&&this.cleanFont(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},Tp.regularStamp=function(){const t=this.currentHost,e=this.defaultTextStyle;if(t&&e){const i=t.engine,[n,s]=this.currentStampPosition;t.rotateDestination(i,n,s,this),this.noCanvasEngineUpdates||(this.state.set(this.defaultTextStyle),t.setEngine(this)),this.setImageSmoothing(t.engine),this[e.method](t)}},Tp.stampPositioningHelper=function(){const{currentHandle:t,currentScale:e,text:i,fontVerticalOffset:n}=this,s=-t[0],r=-t[1]+n*e;return[i,ct(s),ct(r)]},Tp.underlineEngine=function(t,e){const{currentDimensions:i,currentScale:n,currentStampPosition:s,defaultTextStyle:r,fontVerticalOffset:o}=this,{underlineGap:a,underlineOffset:l,underlineStyle:c,underlineWidth:h}=r,[,u,d]=e,[f,p]=i,g=d+l*p-o*n,m=h*n,{element:y,engine:b}=t,S=Va(y.width,y.height),{element:k,engine:C}=S;S.rotateDestination(C,...s,this),C.fillStyle=qt,C.strokeStyle=qt,C.font=r.canvasFont,C.fontKerning=r.fontKerning,C.fontStretch=r.fontStretch,C.fontVariantCaps=r.fontVariant,C.textRendering=r.textRendering,C.letterSpacing=r.letterSpacing,C.lineCap=wn,C.lineJoin=wn,C.wordSpacing=r.wordSpacing,C.direction=r.direction,C.textAlign=pi,C.textBaseline=vs,C.lineWidth=2*a*n,this.setImageSmoothing(C);const A=this.getStyle(c,"fillStyle",S);C.strokeText(...e),C.fillText(...e),C.globalCompositeOperation="source-out",C.fillStyle=A,C.fillRect(u,g,f,m),b.save(),b.resetTransform(),this.setImageSmoothing(b),b.drawImage(k,0,0),b.restore(),Wa(S)},Tp.drawBoundingBox=function(t){if(this.pathObject){const e=this.getStyle(this.boundingBoxStyle,"fillStyle",t),i=t.engine;i.save(),i.strokeStyle=e,i.lineWidth=this.boundingBoxLineWidth,i.setLineDash(this.boundingBoxLineDash||[]),i.lineDashOffset=this.boundingBoxLineDashOffset||0,i.globalCompositeOperation=En,i.globalAlpha=1,i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,this.setImageSmoothing(i),i.stroke(this.pathObject),i.restore()}},Tp.draw=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.strokeText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.fill=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.fillText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.drawAndFill=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.strokeText(...i),e.fillText(...i),this.currentHost.clearShadow(),e.strokeText(...i),e.fillText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.fillAndDraw=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.fillText(...i),e.strokeText(...i),this.currentHost.clearShadow(),e.fillText(...i),e.strokeText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.drawThenFill=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.strokeText(...i),e.fillText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.fillThenDraw=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=this.stampPositioningHelper();this.defaultTextStyle&&this.defaultTextStyle.includeUnderline&&this.underlineEngine(t,i),e.fillText(...i),e.strokeText(...i),this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.clip=function(t){t.engine.clip(this.pathObject,this.winding)},Tp.clear=function(t){if(this.currentFontIsLoaded){const e=t.engine,i=e.globalCompositeOperation,n=this.stampPositioningHelper();e.globalCompositeOperation=Fe,e.fillText(...n),e.globalCompositeOperation=i,this.showBoundingBox&&this.drawBoundingBox(t)}},Tp.none=qs;const Lp=function(t){return!!t&&new Label(t)};J.Label=Label;const Line=function(t=tr){return this.curveInit(t),this.shapeInit(t),this},$p=Line.prototype=Sr();$p.type=es,$p.lib=ze,$p.isArtefact=!0,$p.isAsset=!1,Co($p),hd($p),dd($p),$p.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeLinePath()},$p.makeLinePath=function(){let t=js;const{currentStampPosition:e,currentEnd:i}=this;if(e&&i){const[e,i]=this.currentStampPosition,[n,s]=this.currentEnd;t=`m0,0l${(n-e).toFixed(2)},${(s-i).toFixed(2)}`}return t},$p.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyEnd=!0},$p.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath;let n,s,r;for(n=0,s=t.length;n<s;n++)r=t[n],(e&&e.name===r||i&&i.name===r)&&(this.dirtyEnd=!0,this.endLockTo.includes(Ni)&&(this.currentEndPathData=!1));t.length=0};const Mp=function(t){return!!t&&(t.species="line",new Line(t))};J.Line=Line;const LineSpiral=function(t=tr){return this.shapeInit(t),this},Xp=LineSpiral.prototype=Sr();Xp.type="LineSpiral",Xp.lib=ze,Xp.isArtefact=!0,Xp.isAsset=!1,Co(Xp),hd(Xp);Xp.defs=hr(Xp.defs,{startRadius:0,radiusIncrement:.1,radiusIncrementAdjust:1,startAngle:0,angleIncrement:5,angleIncrementAdjust:1,stepLimit:100});const Yp=Xp.setters,Gp=Xp.deltaSetters;Yp.startRadius=function(t){this.startRadius=t,this.updateDirty()},Gp.startRadius=function(t){this.startRadius+=t,this.updateDirty()},Yp.radiusIncrement=function(t){this.radiusIncrement=t,this.updateDirty()},Gp.radiusIncrement=function(t){this.radiusIncrement+=t,this.updateDirty()},Yp.radiusIncrementAdjust=function(t){this.radiusIncrementAdjust=t,this.updateDirty()},Gp.radiusIncrementAdjust=function(t){this.radiusIncrementAdjust+=t,this.updateDirty()},Yp.startAngle=function(t){this.startAngle=t,this.updateDirty()},Gp.startAngle=function(t){this.startAngle+=t,this.updateDirty()},Yp.angleIncrement=function(t){this.angleIncrement=t,this.updateDirty()},Gp.angleIncrement=function(t){this.angleIncrement+=t,this.updateDirty()},Yp.angleIncrementAdjust=function(t){this.angleIncrementAdjust=t,this.updateDirty()},Gp.angleIncrementAdjust=function(t){this.angleIncrementAdjust+=t,this.updateDirty()},Yp.stepLimit=function(t){this.stepLimit=t,this.updateDirty()},Gp.stepLimit=function(t){this.stepLimit+=t,this.updateDirty()},Xp.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeLineSpiralPath()},Xp.makeLineSpiralPath=function(){let t=`${js} m`;const{startRadius:e,radiusIncrement:i,radiusIncrementAdjust:n,startAngle:s,angleIncrement:r,angleIncrementAdjust:o,stepLimit:a}=this,l=_a();let c=s,h=r,u=e,d=i,f=0;for(l.setFromArray([0,u]).rotate(c),t+=`${l[0].toFixed(1)},${l[1].toFixed(1)}l`;f<a;)f++,h*=o,c+=h,d*=n,u+=d,l.setFromArray([0,u]).rotate(c),t+=`${l[0].toFixed(1)},${l[1].toFixed(1)} `;return Ka(l),t},Xp.calculateLocalPathAdditionalActions=function(){const[t,e]=this.localBox,i=this.scale;this.pathDefinition=this.pathDefinition.replace(`${js} `,`m${-t/i},${-e/i}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const jp=function(t){return!!t&&(t.species="linespiral",new LineSpiral(t))};J.LineSpiral=LineSpiral;const Loom=function(t=tr){return this.makeName(t.name),this.register(),this.state=Aa(tr),this.modifyConstructorInputForAnchorButton(t),this.set(this.defs),t.group||(t.group=du),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.delta={},this.boundingBox=[],this.currentHost=null,this.currentPathData=null,this.dirtyDimensions=!0,this.dirtyHost=!0,this.dirtyInput=!0,this.dirtyOutput=!0,this.dirtyTargetImage=!0,this.fromPathSteps=1,this.output=null,this.pathTests=null,this.sourceDimension=0,this.sourceImageData=null,this.toPathSteps=1,this.watchFromPath=!0,this.set(t),this.fromPathData=[],this.toPathData=[],this.watchFromPath=null,this.watchIndex=-1,this.engineInstructions=[],this.engineDeltaLengths=[],this},zp=Loom.prototype=Sr();zp.type="Loom",zp.lib=ze,zp.isArtefact=!0,zp.isAsset=!1,Co(zp),Gc(zp),Uc(zp),qc(zp),hh(zp);const Np={fromPath:null,toPath:null,fromPathStart:0,fromPathEnd:1,toPathStart:0,toPathEnd:1,synchronizePathCursors:!0,loopPathCursors:!0,constantSpeedAlongPath:!0,isHorizontalCopy:!0,showBoundingBox:!1,boundingBoxColor:qt,source:null,sourceIsVideoOrSprite:!1,interferenceLoops:2,interferenceFactor:1.03,sourceExpansionFactor:1,visibility:!0,calculateOrder:0,stampOrder:0,host:null,group:null,anchor:null,noCanvasEngineUpdates:!1,noDeltaUpdates:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,noUserInteraction:!1,method:Ve};zp.defs=hr(zp.defs,Np),zp.packetExclusions=dr(zp.packetExclusions,["pathObject","state"]),zp.packetExclusionsByRegex=dr(zp.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),zp.packetObjects=dr(zp.packetObjects,["group","fromPath","toPath","source"]),zp.packetFunctions=dr(zp.packetFunctions,["onEnter","onLeave","onDown","onUp"]),zp.processPacketOut=function(t,e,i){let n=!0;return i.includes(t)||e!==this.defs[t]||(n=!1),n},zp.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=hr(t,i),t=this.handlePacketAnchor(t,e)},zp.handlePacketAnchor=function(t,e){if(this.anchor){const i=yt(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},zp.clone=Js;const Vp=zp.getters,Wp=zp.setters,Up=zp.deltaSetters;zp.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return null!=n?(i=this[t],typeof i!==Ts?i:n):(n=e.defs[t],null!=n?(i=e[t],typeof i!==Ts?i:n):null)}},zp.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.state,o=r?r.setters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Xn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=u)))}return this},zp.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.state,o=r?r.deltaSetters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Xn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=Ws(r[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=Ws(this[h],u))))}return this},Wp.host=function(t){if(t){const e=o[t];e&&e.here?this.host=e.name:this.host=t}else this.host=zs},Vp.group=function(){return this.group?this.group.name:zs},Wp.group=function(t){let e;t&&(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring?(e=A[t],this.group=e||t):this.group=t),this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},zp.getHere=function(){return wo},Wp.delta=function(t){t&&(this.delta=ur(this.delta,t))},Wp.fromPath=function(t){if(t){const e=this.fromPath,i=t.substring?o[t]:t,n=this.name;i&&i.name&&i.useAsPath&&(e&&e.name!==i.name&&fr(e.pathed,n),dr(i.pathed,n),this.fromPath=i,this.dirtyStart=!0)}},Wp.toPath=function(t){if(t){const e=this.toPath,i=t.substring?o[t]:t,n=this.name;i&&i.name&&i.useAsPath&&(e&&e.name!==i.name&&fr(e.pathed,n),dr(i.pathed,n),this.toPath=i,this.dirtyStart=!0)}},Wp.source=function(t){if((t=t.substring?o[t]:t)&&t.type===rs){const e=this.source;e&&e.type===rs&&e.imageUnsubscribe(this.name),this.source=t,t.imageSubscribe(this.name),this.dirtyInput=!0}},Wp.isHorizontalCopy=function(t){this.isHorizontalCopy=!!t,this.dirtyPathData=!0},Wp.synchronizePathCursors=function(t){this.synchronizePathCursors=!!t,t&&(this.toPathStart=this.fromPathStart,this.toPathEnd=this.fromPathEnd),this.dirtyPathData=!0},Wp.loopPathCursors=function(t){if(this.loopPathCursors=!!t,t){let t=this.fromPathStart;(t<0||t>1)&&(this.fromPathStart=t-ct(t)),t=this.fromPathEnd,(t<0||t>1)&&(this.fromPathEnd=t-ct(t)),t=this.toPathStart,(t<0||t>1)&&(this.toPathStart=t-ct(t)),t=this.toPathEnd,(t<0||t>1)&&(this.toPathEnd=t-ct(t))}this.dirtyOutput=!0},Wp.fromPathStart=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.fromPathStart=t,this.synchronizePathCursors&&(this.toPathStart=t),this.dirtyPathData=!0},Up.fromPathStart=function(t){let e=this.fromPathStart+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.fromPathStart=e,this.synchronizePathCursors&&(this.toPathStart=e),this.dirtyPathData=!0},Wp.fromPathEnd=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.fromPathEnd=t,this.synchronizePathCursors&&(this.toPathEnd=t),this.dirtyPathData=!0},Up.fromPathEnd=function(t){let e=this.fromPathEnd+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.fromPathEnd=e,this.synchronizePathCursors&&(this.toPathEnd=e),this.dirtyPathData=!0},Wp.toPathStart=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.toPathStart=t,this.synchronizePathCursors&&(this.fromPathStart=t),this.dirtyPathData=!0},Up.toPathStart=function(t){let e=this.toPathStart+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.toPathStart=e,this.synchronizePathCursors&&(this.fromPathStart=e),this.dirtyPathData=!0},Wp.toPathEnd=function(t){this.loopPathCursors&&(t<0||t>1)&&(t-=ct(t)),this.toPathEnd=t,this.synchronizePathCursors&&(this.fromPathEnd=t),this.dirtyPathData=!0},Up.toPathEnd=function(t){let e=this.toPathEnd+=t;this.loopPathCursors&&(e<0||e>1)&&(e-=ct(e)),this.toPathEnd=e,this.synchronizePathCursors&&(this.fromPathEnd=e),this.dirtyPathData=!0},zp.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=o[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return wo},zp.midInitActions=qs,zp.update=function(){this.dirtyInput=!0,this.dirtyOutput=!0},zp.prepareStamp=function(){const t=this.fromPath,e=this.toPath,[i,n]=this.getBoundingBox();if(!this.dirtyPathData){const{x:i,y:n}=t.getPathPositionData(0),{x:s,y:r}=t.getPathPositionData(1),{x:o,y:a}=e.getPathPositionData(0),{x:l,y:c}=e.getPathPositionData(1),h=[i,n,s,r,o,a,l,c];this.pathTests&&!this.pathTests.some(((t,e)=>t!==h[e]))||(this.pathTests=h,this.dirtyPathData=!0)}if(this.dirtyPathData||!this.fromPathData.length){this.dirtyPathData=!1,this.watchIndex=-1,this.engineInstructions.length=0,this.engineDeltaLengths.length=0;const s=this.fromPathData;s.length=0;const r=this.toPathData;if(r.length=0,t&&e){const o=st(t.length),a=st(e.length),l=this.setSourceDimension(pt(o,a)*this.sourceExpansionFactor),c=this.fromPathStart,h=this.fromPathEnd,u=this.toPathStart,d=this.toPathEnd,f=this.constantSpeedAlongPath;let p,g;p=c<h?h-c:h+(1-c),p<.005&&(p=.005),g=u<d?d-u:d+(1-u),g<.005&&(g=.005);const m=st(gt(p,g)),y=1/(l*(1/m));let b,S,k;for(k=0;k<=1;k+=y)({x:b,y:S}=t.getPathPositionData(k,f)),s.push([b-i,S-n]),({x:b,y:S}=e.getPathPositionData(k,f)),r.push([b-i,S-n]);this.fromPathSteps=p/m,this.toPathSteps=g/m,this.watchFromPath=1===this.fromPathSteps,this.dirtyOutput=!0}else this.dirtyPathData=!0}this.prepareStampTabsHelper()},zp.setSourceDimension=function(t){if(t)this.sourceDimension!==t&&(this.sourceDimension=t,this.dirtyInput=!0);else{const t=this.fromPath,e=this.toPath;if(t&&e){const i=st(t.length),n=st(e.length),s=pt(i,n);this.sourceDimension!==s&&(this.sourceDimension=s)}else this.sourceDimension=0}return this.sourceDimension},zp.simpleStamp=function(t,e){t&&ei.includes(t.type)&&(this.currentHost=t,e&&(this.set(e),this.prepareStamp()),this.regularStamp())},zp.stamp=function(t=!1,e,i){if(t)return e&&ei.includes(e.type)&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp();this.visibility&&((this.sourceIsVideoOrSprite||this.dirtyInput)&&this.cleanInput(),this.dirtyOutput&&(this.output=this.cleanOutput()),this.regularStamp())},zp.cleanInput=function(){this.dirtyInput=!1;const t=this.sourceDimension;if(!t)return this.dirtyInput=!0,!1;const e=Va(),i=e.engine,n=e.element;n.width=t,n.height=t,i.setTransform(1,0,0,1,0,0),this.source.stamp(!0,e,{startX:0,startY:0,handleX:0,handleY:0,offsetX:0,offsetY:0,roll:0,scale:1,width:t,height:t,method:Ve}),this.sourceImageData=i.getImageData(0,0,t,t),Wa(e)},zp.cleanOutput=function(){this.dirtyOutput=!1;const t=this.sourceDimension,e=this.sourceImageData;if(t&&e){const i=this.fromPathData,n=this.toPathData,s=i.length,r=this.fromPathStart,o=this.fromPathSteps||1,a=this.toPathStart,l=this.toPathSteps||1,c=St-1.5708,h=this.isHorizontalCopy,u=this.loopPathCursors,d=this.watchFromPath,f=this.engineInstructions,p=this.engineDeltaLengths;let g,m,y,b,S,k,C,A,v,P,x,O,w,D=r*s,F=a*s,R=this.watchIndex,[,,T,H]=this.getBoundingBox();if(T&&H){T=~~T,H=~~H;const r=Va(),a=r.engine,E=r.element;E.width=t,E.height=t,a.setTransform(1,0,0,1,0,0),a.putImageData(e,0,0);const I=Va(),B=I.engine,L=I.element;if(L.width=T,L.height=H,B.globalAlpha=this.state.globalAlpha,B.setTransform(1,0,0,1,0,0),!f.length){for(x=0;x<t;x++)R<0&&(d&&D<1||!d&&F<1)&&(R=x),D<s&&F<s&&D>=0&&F>=0?([g,m]=i[ct(D)],[y,b]=n[ct(F)],S=y-g,k=b-m,C=ht(S,k),h?(A=-nt(S,k)+St,v=ot(A),P=xt(A),f.push([v,P,-P,v,g,m]),p.push(C)):(A=-nt(S,k)+c,v=ot(A),P=xt(A),f.push([v,P,-P,v,g,m,C]),p.push(C))):(f.push(!1),p.push(!1)),D+=o,F+=l,u&&(D>=s&&(D-=s),F>=s&&(F-=s));R<0&&(R=0),this.watchIndex=R}if(h)for(x=0;x<t;x++)w=f[R],w&&(B.setTransform(...w),B.drawImage(E,0,~~R,~~t,1,0,0,~~p[R],1)),R++,R>=t&&(R=0);else for(x=0;x<t;x++)w=f[R],w&&(B.setTransform(...w),B.drawImage(E,~~R,0,1,~~t,0,0,1,~~p[R])),R++,R>=t&&(R=0);const $=this.interferenceFactor,M=this.interferenceLoops,X=1+~~(T*$),Y=1+~~(H*$);for(E.width=X,E.height=Y,B.setTransform(1,0,0,1,0,0),a.setTransform(1,0,0,1,0,0),O=0;O<M;O++)a.drawImage(L,0,0,T,H,0,0,X,Y),B.drawImage(E,0,0,X,Y,0,0,T,H);const G=B.getImageData(0,0,T,H);return Wa(r,I),this.dirtyTargetImage=!0,G}this.dirtyOutput=!0}return!1},zp.regularStamp=function(){const t=this.currentHost;if(t){const e=t.engine;this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},zp.getBoundingBox=function(){const t=this.fromPath,e=this.toPath;if(t&&e){if(this.dirtyStart)if(this.boundingBox.length=0,t.getBoundingBox&&e.getBoundingBox){this.dirtyStart=!1;let[i,n,s,r,o,a]=t.getBoundingBox(),[l,c,h,u,d,f]=e.getBoundingBox();dt(i)&&dt(n)&&dt(s)&&dt(r)&&dt(o)&&dt(a)&&dt(l)&&dt(c)&&dt(h)&&dt(u)&&dt(d)&&dt(f)||(this.dirtyStart=!0),i===l&&n===c&&s===h&&r===u&&o===d&&a===f&&(this.dirtyStart=!0),i+=o,n+=a,l+=d,c+=f;const p=gt(i,l),g=pt(i+s,l+h),m=gt(n,c),y=pt(n+r,c+u);this.boundingBox.push(p,m,g-p,y-m),this.dirtyPathData=!0}else this.boundingBox.push(0,0,0,0)}else this.boundingBox.length||this.boundingBox.push(0,0,0,0);return this.boundingBox},zp.fill=function(t){this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},zp.draw=function(t){this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},zp.drawAndFill=function(t){this.doStroke(t),this.currentHost.clearShadow(),this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},zp.fillAndDraw=function(t){this.doFill(t),this.currentHost.clearShadow(),this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},zp.drawThenFill=function(t){this.doStroke(t),this.doFill(t),this.showBoundingBox&&this.drawBoundingBox(t)},zp.fillThenDraw=function(t){this.doFill(t),this.doStroke(t),this.showBoundingBox&&this.drawBoundingBox(t)},zp.clear=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element,n=t.globalCompositeOperation;if(e&&i){const i=Va(),s=i.engine,r=i.element;let[o,a,l,c]=this.getBoundingBox();o=~~o,a=~~a,l=~~l,c=~~c,r.width=l,r.height=c,s.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation=Fe,t.drawImage(r,0,0,l,c,o,a,l,c),t.globalCompositeOperation=n,Wa(i),this.showBoundingBox&&this.drawBoundingBox(t)}},zp.none=qs,zp.clip=qs,zp.doStroke=function(t){const e=this.fromPath,i=this.toPath;if(e&&e.getBoundingBox&&i&&i.getBoundingBox){const n=this.currentHost;if(n){const s=e.currentStampPosition,r=e.getPathPositionData(1),o=i.currentStampPosition,a=i.getPathPositionData(1);n.rotateDestination(t,s[0],s[1],e),t.stroke(e.pathObject),n.rotateDestination(t,o[0],o[1],e),t.stroke(i.pathObject),t.setTransform(1,0,0,1,0,0),t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(a.x,a.y),t.moveTo(...o),t.lineTo(...s),t.closePath(),t.stroke()}}},zp.doFill=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element;if(e&&i){const i=Va(),n=i.engine,s=i.element;let[r,o,a,l]=this.getBoundingBox();r=~~r,o=~~o,a=~~a,l=~~l,s.width=a,s.height=l,n.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.drawImage(s,0,0,a,l,r,o,a,l),Wa(i)}},zp.drawBoundingBox=function(t){this.dirtyStart&&this.getBoundingBox(),t.save();const e=t.getTransform();t.setTransform(1,0,0,1,0,0),t.strokeStyle=this.boundingBoxColor,t.lineWidth=1,t.globalCompositeOperation=En,t.globalAlpha=1,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.strokeRect(...this.boundingBox),t.restore(),t.setTransform(e)},zp.checkHit=function(t=[]){if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=!(!this.output||!this.output.data)&&this.output.data;let n,s,r,o,a;if(i){const[t,l,c,h]=this.getBoundingBox();if(e.some((e=>{if(ut(e))n=e[0],s=e[1];else{if(!gr(e,e.x,e.y))return!1;n=e.x,s=e.y}return!(!dt(n)||!dt(s))&&(r=n-t,o=s-l,!(r<0||r>c||o<0||o>h)&&(a=4*(o*c+r)+3,!!i&&i[a]>0))}),this))return{x:n,y:s,artefact:this}}return!1};const Zp=function(t){return!!t&&new Loom(t)};J.Loom=Loom;const Mesh=function(t=tr){return this.makeName(t.name),this.register(),this.modifyConstructorInputForAnchorButton(t),this.set(this.defs),this.state=Aa(),t.group||(t.group=du),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.delta={},this.currentHost=null,this.dirtyHost=!0,this.badNet=!0,this.dirtyParticles=!0,this.particlePositions=null,this.sourceImageData=null,this.sourceDimension=0,this.rows=null,this.columns=null,this.struts=null,this.boundingBox=null,this.pathObject=null,this.dirtyOutput=!0,this.dirtyTargetImage=!0,this.output=null,this.set(t),this.fromPathData=[],this.toPathData=[],this.watchFromPath=null,this.watchIndex=-1,this.engineInstructions=[],this.engineDeltaLengths=[],this},_p=Mesh.prototype=Sr();_p.type="Mesh",_p.lib=ze,_p.isArtefact=!0,_p.isAsset=!1,Co(_p),Gc(_p),Uc(_p),qc(_p),hh(_p);const Kp={net:null,isHorizontalCopy:!0,source:null,sourceIsVideoOrSprite:!1,interferenceLoops:2,interferenceFactor:1.03,visibility:!0,calculateOrder:0,stampOrder:0,delta:null,host:null,group:null,anchor:null,noCanvasEngineUpdates:!1,noDeltaUpdates:!1,onEnter:null,onLeave:null,onDown:null,onUp:null,noUserInteraction:!1,method:Ve};_p.defs=hr(_p.defs,Kp),_p.packetExclusions=dr(_p.packetExclusions,["pathObject","state"]),_p.packetExclusionsByRegex=dr(_p.packetExclusionsByRegex,["^(local|dirty|current)","Subscriber$"]),_p.packetObjects=dr(_p.packetObjects,["group","net","source"]),_p.packetFunctions=dr(_p.packetFunctions,["onEnter","onLeave","onDown","onUp"]),_p.processPacketOut=function(t,e,i){let n=!0;return!i.includes(t)<0&&e===this.defs[t]&&(n=!1),n},_p.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=hr(t,i),t=this.handlePacketAnchor(t,e)},_p.handlePacketAnchor=function(t,e){if(this.anchor){const i=yt(this.anchor.saveAsPacket(e))[3];t.anchor=i}return t},_p.clone=Js;const qp=_p.getters,Qp=_p.setters;_p.get=function(t){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return typeof n!==Ts?(i=this[t],typeof i!==Ts?i:n):(n=e.defs[t],typeof n!==Ts?(i=e[t],typeof i!==Ts?i:n):null)}},_p.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.state,o=r?r.setters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!==Li&&null!=u&&(Xn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!==Ts&&(r[h]=u)):(l=n[h],l?l.call(this,u):typeof s[h]!==Ts&&(this[h]=u,this.dirtyFilterIdentifier=!0)))}return this},_p.setDelta=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.deltaSetters,s=this.defs,r=this.state,o=r?r.deltaSetters:tr,a=r?r.defs:tr;let l,c,h,u;for(c=0;c<i;c++)h=e[c],u=t[h],h&&h!=Li&&null!=u&&(Xn.includes(h)?(l=o[h],l?l.call(r,u):typeof a[h]!=Ts&&(r[h]=Ws(r[h],u))):(l=n[h],l?l.call(this,u):typeof s[h]!=Ts&&(this[h]=Ws(this[h],u),this.dirtyFilterIdentifier=!0)))}return this},Qp.host=function(t){if(t){const e=o[t];e&&e.here?this.host=e.name:this.host=t}else this.host=zs;this.dirtyFilterIdentifier=!0},qp.group=function(){return this.group?this.group.name:zs},Qp.group=function(t){let e;t&&(this.group&&this.group.type===Qn&&this.group.removeArtefacts(this.name),t.substring?(e=A[t],this.group=e||t):this.group=t),this.group&&this.group.type===Qn&&this.group.addArtefacts(this.name)},_p.getHere=function(){return wo},Qp.net=function(t){t&&((t=t.substring?o[t]:t)&&"Net"===t.type&&(this.net=t,this.dirtyStart=!0),this.dirtyFilterIdentifier=!0)},Qp.source=function(t){if((t=t.substring?o[t]:t)&&t.type===rs){const e=this.source;e&&e.type===rs&&e.imageUnsubscribe(this.name),this.source=t,t.imageSubscribe(this.name),this.dirtyInput=!0,this.dirtyFilterIdentifier=!0}},Qp.isHorizontalCopy=function(t){this.isHorizontalCopy=!!t,this.dirtyPathData=!0,this.dirtyFilterIdentifier=!0},_p.getHost=function(){if(this.currentHost)return this.currentHost;if(this.host){const t=o[this.host];if(t)return this.currentHost=t,this.dirtyHost=!0,this.currentHost}return wo},_p.midInitActions=qs,_p.prepareStamp=function(){this.badNet=!0,this.dirtyParticles=!1,this.particlePositions||(this.particlePositions=[]);const{net:t,particlePositions:e}=this;if(t&&t.particleStore&&t.particleStore.length>3){const{rows:i,columns:n,particleStore:s}=t;if(i&&n){this.badNet=!1,this.rows=i,this.columns=n;const t=[];s.forEach((e=>{const i=e.position,{x:n,y:s}=i;t.push([n,s])}));const r=t.join(jt);e.join(jt)!==r&&(this.particlePositions=t,this.dirtyInput=!0),this.sourceIsVideoOrSprite&&(this.dirtyInput=!0)}}this.prepareStampTabsHelper()},_p.setSourceDimension=function(){if(!this.badNet){const{columns:t,rows:e,particlePositions:i}=this,n=Jr(),s=Jr(),r=Jr(),o=Jr(),a=Jr(),l=Jr(),c=Jr(),h=Jr(),u=Jr();let d,f,p,g,m,y,b,S,k,C,A,v,P,x,O,w,D,F;for(p=0;p<e;p++){for(g=0,P=s[p]=Jr(),y=h[p]=[],d=0,f=t-1;d<f;d++)m=p*t+d,[b,k]=i[m],[S,C]=i[m+1],y.push([b,k,S,C]),0===d?l.push([b,k]):d===f-1?c.push([S,C]):0===p?(a.push([b,k]),d===f-2&&a.push([S,C])):p===e-1&&(u.push([b,k]),d===f-2&&u.push([S,C])),r.push(b,S),o.push(k,C),A=S-b,v=C-k,x=Ot(A*A+v*v),g+=x,P.push(x);n.push(g)}this.sourceDimension=pt(...n);const R=this.currentHost||this.getHost();if(R){const t=pt(...R.currentDimensions);this.sourceDimension>t&&(this.sourceDimension=t)}for(O=0,w=s.length;O<w;O++)for(x=n[O],P=s[O],y=h[O],D=0,F=P.length;D<F;D++)x&&(P[D]=P[D]/x),y[D].push(P[D]);this.struts||(this.struts=[]),this.struts.length=0,this.struts.push(...h);const T=gt(...r),H=gt(...o),E=pt(...r),I=pt(...o);this.boundingBox=[T,H,E-T,I-H],l.reverse(),u.reverse();let B=`M${a[0][0]},${a[0][1]}L`;for(O=1,w=a.length;O<w;O++)[d,p]=a[O],B+=`${d},${p} `;for(O=0,w=c.length;O<w;O++)[d,p]=c[O],B+=`${d},${p} `;for(O=0,w=u.length;O<w;O++)[d,p]=u[O],B+=`${d},${p} `;for(O=0,w=l.length;O<w;O++)[d,p]=l[O],B+=`${d},${p} `;B+="z",this.pathObject=new Path2D(B),to(...s,s),to(n,r,o,a,l,c,u,h)}},_p.simpleStamp=function(t,e){t&&t.type===Un&&(this.currentHost=t,e&&(this.set(e),this.prepareStamp()),this.regularStamp())},_p.stamp=function(t=!1,e,i){t?(e&&e.type===Un&&(this.currentHost=e),i&&(this.set(i),this.prepareStamp()),this.regularStamp()):this.visibility&&(this.dirtyInput&&(this.sourceImageData=this.cleanInput(),this.sourceImageData?this.output=this.cleanOutput():this.dirtyInput=!0),this.output&&this.regularStamp())},_p.cleanInput=function(){this.dirtyInput=!1,this.setSourceDimension();const t=this.sourceDimension;if(!t)return this.dirtyInput=!0,!1;const e=Va(),i=e.engine,n=e.element;n.width=t,n.height=t,i.setTransform(1,0,0,1,0,0),this.source.stamp(!0,e,{startX:0,startY:0,handleX:0,handleY:0,offsetX:0,offsetY:0,roll:0,scale:1,width:t,height:t,method:Ve});const s=i.getImageData(0,0,t,t);return Wa(e),s},_p.cleanOutput=function(){this.dirtyOutput=!1;const{sourceImageData:t,columns:e,rows:i,struts:n,boundingBox:s}=this,r=st(this.sourceDimension);if(t&&i-1>0){let[o,a,l,c]=s;l=~~(o+l),c=~~(a+c);const h=Va(),u=h.engine,d=h.element;d.width=r,d.height=r,u.setTransform(1,0,0,1,0,0),u.putImageData(t,0,0);const f=Va(),p=f.engine,g=f.element;g.width=l,g.height=c,p.globalAlpha=this.state.globalAlpha,p.setTransform(1,0,0,1,0,0);const m=parseFloat((r/(i-1)).toFixed(4)),y=parseFloat((r/(e-1)).toFixed(4));let b,S,k,C,A,v,P,x,O,w,D,F,R,T,H,E,I,B,L,$,M,X,Y;for(M=0,X=i-1;M<X;M++)for(b=n[M],S=n[M+1],L=0,$=e-1;L<$;L++){let[t,e,i,n,s]=b[L],[o,a,l,c,h]=S[L];for(s*=r,h*=r,k=pt(s,h,y),C=y/k,A=(i-t)/k,v=(n-e)/k,P=(l-o)/k,x=(c-a)/k,Y=0;Y<k;Y++){O=t+A*Y,w=e+v*Y,D=o+P*Y,F=a+x*Y,T=M*m,R=L*y+C*Y,H=O-D,E=w-F,I=Ot(H*H+E*E),B=nt(E,H)+St,p.setTransform(1,0,0,1,O,w),p.rotate(B);const i=T+m>r?r-T:m;p.drawImage(d,~~R,~~T,1,~~i,0,0,1,~~I)}}const G=this.interferenceFactor,j=this.interferenceLoops,z=1+~~(l*G),N=1+~~(c*G);d.width=z,d.height=N,p.setTransform(1,0,0,1,0,0),u.setTransform(1,0,0,1,0,0);for(let t=0;t<j;t++)u.drawImage(g,0,0,l,c,0,0,z,N),p.drawImage(d,0,0,z,N,0,0,l,c);const V=p.getImageData(0,0,l,c);return Wa(h,f),this.dirtyTargetImage=!0,V}return!1},_p.regularStamp=function(){const t=this.currentHost;if(t){const e=t.engine;this.noCanvasEngineUpdates||t.setEngine(this),this[this.method](e)}},_p.fill=function(t){this.doFill(t)},_p.draw=function(t){this.doStroke(t)},_p.drawAndFill=function(t){this.doStroke(t),this.currentHost.clearShadow(),this.doFill(t)},_p.fillAndDraw=function(t){this.doFill(t),this.currentHost.clearShadow(),this.doStroke(t)},_p.drawThenFill=function(t){this.doStroke(t),this.doFill(t)},_p.fillThenDraw=function(t){this.doFill(t),this.doStroke(t)},_p.clear=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element,n=t.globalCompositeOperation;if(e&&i){const s=Va(),r=s.engine,o=s.element,a=i.width,l=i.height;o.width=a,o.height=l,r.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.globalCompositeOperation=Fe,t.drawImage(o,0,0),t.globalCompositeOperation=n,Wa(s)}},_p.none=qs,_p.clip=qs,_p.doStroke=function(t){t.setTransform(1,0,0,1,0,0),t.stroke(this.pathObject)},_p.doFill=function(t){const e=this.output,i=!!this.currentHost&&this.currentHost.element;if(e&&i){const n=Va(),s=n.engine,r=n.element,o=i.width,a=i.height;r.width=o,r.height=a,s.putImageData(e,0,0),t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0),Wa(n)}},_p.checkHit=function(t=[]){if(this.noUserInteraction)return!1;if(!this.pathObject)return!1;const e=ut(t)?t:[t];let i,n;const s=Va();if(e.some((t=>{if(ut(t))i=t[0],n=t[1];else{if(!gr(t,t.x,t.y))return!1;i=t.x,n=t.y}return!(!dt(i)||!dt(n))&&s.engine.isPointInPath(this.pathObject,i,n,this.winding)}),this)){const t={x:i,y:n,artefact:this};return Wa(s),t}return Wa(s),!1};const Jp=function(t){return!!t&&new Mesh(t)};J.Mesh=Mesh;const Spring=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.set(t),this.action||(this.action=qs),this},tg=Spring.prototype=Sr();tg.type="Spring",tg.lib="spring",tg.isArtefact=!1,tg.isAsset=!1,Co(tg);tg.defs=hr(tg.defs,{particleFrom:null,particleFromIsStatic:!1,particleTo:null,particleToIsStatic:!1,springConstant:50,damperConstant:10,restLength:1}),tg.packetObjects=dr(tg.packetObjects,["particleFrom","particleTo"]),tg.kill=function(){return this.deregister(),!0};const eg=tg.setters;eg.particleFrom=function(t){t.substring&&(t=P[t]),t&&t.type===ss&&(this.particleFrom=t)},eg.particleTo=function(t){t.substring&&(t=P[t]),t&&t.type===ss&&(this.particleTo=t)},tg.applySpring=function(){const{particleFrom:t,particleTo:e,particleFromIsStatic:i,particleToIsStatic:n,springConstant:s,damperConstant:r,restLength:o}=this;if(t&&e){const{position:a,velocity:l,load:c}=t,{position:h,velocity:u,load:d}=e,f=Hh(u).vectorSubtract(l),p=Hh(h).vectorSubtract(a),g=Hh(p).normalize(),m=Hh(g);g.scalarMultiply(s*(p.getMagnitude()-o)),f.vectorMultiply(m).scalarMultiply(r).vectorMultiply(m);const y=Hh(g).vectorAdd(f);i||c.vectorAdd(y),n||d.vectorSubtract(y),Eh(f,p,g,m,y)}};const ig=function(t){return!!t&&new Spring(t)};J.Spring=Spring;const ng="fillStyle",sg="hub-spoke",rg="strokeStyle",og="strong-net",ag="strong-shape",lg="weak-net",cg="weak-shape",hg=["Bezier","Line","Oval","Polygon","Polyline","Quadratic","Rectangle","Shape","Spiral","Star","Tetragon"],Net=function(t=tr){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.generate=qs,this.postGenerate=qs,this.stampAction=qs,this.particleStore=[],this.springs=[],this.lastUpdated=0,this.lastHitParticle=null,t.group||(t.group=du),this.set(t),this.purge&&this.purgeArtefact(this.purge),this},ug=Net.prototype=Sr();ug.type="Net",ug.lib=ze,ug.isArtefact=!0,ug.isAsset=!1,Co(ug),Ju(ug);const dg={world:null,artefact:null,historyLength:1,forces:null,mass:1,engine:Ne,springConstant:50,damperConstant:10,restLength:1,showSprings:!1,showSpringsColor:qt,rows:0,columns:0,rowDistance:0,columnDistance:0,shapeTemplate:null,precision:20,joinTemplateEnds:!1,particlesAreDraggable:!1,hitRadius:10,showHitRadius:!1,hitRadiusColor:qt,resetAfterBlur:3};ug.defs=hr(ug.defs,dg),ug.packetExclusions=dr(ug.packetExclusions,["forces","springs","particleStore"]),ug.packetObjects=dr(ug.packetObjects,["world","artefact","shapeTemplate"]),ug.packetFunctions=dr(ug.packetFunctions,["generate","postGenerate","stampAction"]),ug.finalizePacketOut=function(t,e){const i=e.forces||this.forces||!1;if(i){const e=[];i.forEach((t=>{t.substring?e.push(t):lr(t)&&t.name&&e.push(t.name)})),t.forces=e}const n=[];return this.particleStore.forEach((t=>n.push(t.saveAsPacket()))),t.particleStore=n,t},ug.postCloneAction=function(t){return t},ug.factoryKill=function(t,e){this.isRunning=!1,t&&(this.artefact.kill(),this.shapeTemplate&&this.shapeTemplate.kill()),e&&this.world.kill(),this.purgeParticlesFromLibrary()},ug.purgeParticlesFromLibrary=function(){const{particleStore:t,springs:e}=this;let i;a.forEach((t=>{i=o[t],i&&(i.particle&&!i.particle.substring&&i.particle.name&&(i.particle=i.particle.name),i.type===os&&i.useParticlesAsPins&&i.pins.forEach(((t,e)=>{lr(t)&&t.type===ss&&(i.pins[e]=t.name,i.dirtyPins=!0)})))})),t.forEach((t=>t.kill())),t.length=0,e.forEach((t=>t.kill())),e.length=0};const fg=ug.setters;fg.generate=function(t){or(t)?this.generate=t:t.substring&&gg[t]&&(this.generate=gg[t])},fg.postGenerate=function(t){or(t)&&(this.postGenerate=t)},fg.stampAction=function(t){or(t)&&(this.stampAction=t)},fg.world=function(t){let e;t.substring?e=F[t]:lr(t)&&t.type===ys&&(e=t),e&&(this.world=e)},fg.artefact=function(t){let e;t.substring?e=o[t]:lr(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e),this.dirtyFilterIdentifier=!0},fg.shapeTemplate=function(t){let e;t.substring?e=m[t]:lr(t)&&t.isArtefact&&pr(t.species)&&(e=t),e&&(this.shapeTemplate=e),this.dirtyFilterIdentifier=!0},ug.regularStamp=function(){const{world:t,artefact:e,particleStore:i,springs:n,generate:s,postGenerate:r,stampAction:o,lastUpdated:a,resetAfterBlur:l,showSprings:c,showSpringsColor:h,showHitRadius:u,hitRadius:d,hitRadiusColor:f}=this;let p,g,m=1,y=En;this.state&&(m=this.state.globalAlpha,y=this.state.globalCompositeOperation);const b=this.currentHost;let S=wt;const k=mt();if(a&&(S=(k-a)/1e3),S>l&&(this.purgeParticlesFromLibrary(),S=wt),i.length||(s.call(this,b),r.call(this)),i.forEach((e=>e.applyForces(t,b))),n.forEach((t=>t.applySpring())),i.forEach((e=>e.update(S,t))),c){const t=b.engine;t.save(),t.globalAlpha=m,t.globalCompositeOperation=y,t.strokeStyle=h,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=Jt,t.lineWidth=1,t.setTransform(1,0,0,1,0,0),t.beginPath(),n.forEach((e=>{({particleFrom:p,particleTo:g}=e),t.moveTo(p.position.x,p.position.y),t.lineTo(g.position.x,g.position.y)})),t.stroke(),t.restore()}if(i.forEach((t=>{t.manageHistory(S,b),o.call(this,e,t,b)})),u){const t=b.engine;t.save(),t.globalAlpha=m,t.globalCompositeOperation=y,t.lineWidth=1,t.strokeStyle=f,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=Jt,t.setTransform(1,0,0,1,0,0),t.beginPath(),i.forEach((e=>{t.moveTo(e.position.x,e.position.y),t.arc(e.position.x,e.position.y,d,0,bt)})),t.stroke(),t.restore()}this.lastUpdated=k},ug.restart=function(){return this.purgeParticlesFromLibrary(),this.lastUpdated=mt(),this},ug.checkHit=function(t=[]){if(this.lastHitParticle=null,!this.particlesAreDraggable)return!1;if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=this.particleStore;let n,s,r,o,a,l=!1;if(e.some((t=>{if(ut(t))n=t[0],s=t[1];else{if(!gr(t,t.x,t.y))return!1;n=t.x,s=t.y}if(!dt(n)||!dt(s))return!1;const e=Hh();for(r=0,o=i.length;r<o;r++)if(a=i[r],e.set(a.position).vectorSubtract(t),e.getMagnitude()<this.hitRadius){l=a;break}return Eh(e),l}),this)){const t=this.checkHitReturn(n,s,l);return this.lastHitParticle=l,t}return!1},ug.checkHitReturn=function(t,e,i){return{x:t,y:e,artefact:this,particle:i}},ug.pickupArtefact=function(t){const e=this.lastHitParticle;return gr(t,e)&&(e.isBeingDragged=t,e.dragOffset=Hh(e.position).vectorSubtract(t)),this},ug.dropArtefact=function(){return this.lastHitParticle.isBeingDragged=null,Eh(this.lastHitParticle.dragOffset),this.lastHitParticle.dragOffset=null,this.lastHitParticle=null,this};const pg=function(t,e,i){const{springs:n,springConstant:s,damperConstant:r,restLength:o}=this,a=Hh(t.position).vectorSubtract(e.position),l=a.getMagnitude(),c=ig({name:i,particleFrom:t,particleTo:e,springConstant:s,damperConstant:r,restLength:l*o});n.push(c),Eh(a)},gg={[lg]:function(t){const{particleStore:e,artefact:i,historyLength:n,engine:s,forces:r,mass:o,rows:a,columns:l,rowDistance:c,columnDistance:h,name:u}=this;if(t&&a>0&&l>0){const[d,f]=this.currentStampPosition,[,p]=t.currentDimensions,g=c.substring?parseFloat(c)/100*p:c,m=h.substring?parseFloat(h)/100*p:h;let y,b,S,k,C,A,v;for(k=0;k<a;k++)for(b=g*k+f,C=0;C<l;C++)y=m*C+d,S=Wd({name:`${u}-${k}-${C}`,positionX:y,positionY:b,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:n,engine:s,forces:r,mass:o,fill:i.get(ng),stroke:i.get(rg)}),S.run(0,0,!1),e.push(S);for(k=0;k<a;k++)for(C=0;C<l-1;C++)A=P[`${u}-${k}-${C}`],v=P[`${u}-${k}-${C+1}`],pg.call(this,A,v,`${u}-${k}-${C}~${u}-${k}-${C+1}`);for(k=0;k<l;k++)for(C=0;C<a-1;C++)A=P[`${u}-${C}-${k}`],v=P[`${u}-${C+1}-${k}`],pg.call(this,A,v,`${u}-${C}-${k}~${u}-${C+1}-${k}`)}},[og]:function(t){const{particleStore:e,artefact:i,historyLength:n,engine:s,forces:r,mass:o,rows:a,columns:l,rowDistance:c,columnDistance:h,name:u}=this;if(t&&a>0&&l>0){const[d,f]=this.currentStampPosition,[,p]=t.currentDimensions,g=c.substring?parseFloat(c)/100*p:c,m=h.substring?parseFloat(h)/100*p:h;let y,b,S,k,C,A,v;for(k=0;k<a;k++)for(b=g*k+f,C=0;C<l;C++)y=m*C+d,S=Wd({name:`${u}-${k}-${C}`,positionX:y,positionY:b,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:n,engine:s,forces:r,mass:o,fill:i.get(ng),stroke:i.get(rg)}),S.run(0,0,!1),e.push(S);for(k=0;k<a;k++)for(C=0;C<l-1;C++)A=P[`${u}-${k}-${C}`],v=P[`${u}-${k}-${C+1}`],pg.call(this,A,v,`${u}-${k}-${C}~${u}-${k}-${C+1}`);for(k=0;k<l;k++)for(C=0;C<a-1;C++)A=P[`${u}-${C}-${k}`],v=P[`${u}-${C+1}-${k}`],pg.call(this,A,v,`${u}-${C}-${k}~${u}-${C+1}-${k}`);for(k=0;k<l-1;k++)for(C=0;C<a-1;C++)A=P[`${u}-${C}-${k}`],v=P[`${u}-${C+1}-${k+1}`],pg.call(this,A,v,`${u}-${C}-${k}~${u}-${C+1}-${k+1}`);for(k=0;k<l-1;k++)for(C=a-1;C>0;C--)A=P[`${u}-${C}-${k}`],v=P[`${u}-${C-1}-${k+1}`],pg.call(this,A,v,`${u}-${C}-${k}~${u}-${C-1}-${k+1}`)}},[cg]:function(){const{particleStore:t,artefact:e,historyLength:i,engine:n,forces:s,mass:r,name:o,shapeTemplate:a,precision:l,joinTemplateEnds:c}=this;let h,u,d,f;if(a&&l){for(h=0;h<l;h++){const c=a.getPathPositionData(h/l);u=Wd({name:`${o}-${h}`,positionX:c.x,positionY:c.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:i,engine:n,forces:s,mass:r,fill:e.get(ng),stroke:e.get(rg)}),u.run(0,0,!1),t.push(u)}for(h=0;h<l-1;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+1}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+1}`);for(c&&(d=P[`${o}-${l-1}`],f=P[`${o}-0`],pg.call(this,d,f,`${o}-${l-1}~${o}-0`)),h=0;h<l-2;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+2}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+2}`);for(c&&(d=P[`${o}-${l-2}`],f=P[`${o}-0`],pg.call(this,d,f,`${o}-${l-2}~${o}-0`),d=P[`${o}-${l-1}`],f=P[`${o}-1`],pg.call(this,d,f,`${o}-${l-1}~${o}-1`)),h=0;h<l-3;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+3}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+3}`);c&&(d=P[`${o}-${l-3}`],f=P[`${o}-0`],pg.call(this,d,f,`${o}-${l-3}~${o}-0`),d=P[`${o}-${l-2}`],f=P[`${o}-1`],pg.call(this,d,f,`${o}-${l-2}~${o}-1`),d=P[`${o}-${l-1}`],f=P[`${o}-2`],pg.call(this,d,f,`${o}-${l-1}~${o}-2`))}},[ag]:function(){const{particleStore:t,artefact:e,historyLength:i,engine:n,forces:s,mass:r,name:o,shapeTemplate:a,precision:l,joinTemplateEnds:c}=this;let h,u,d,f;if(a&&l){for(h=0;h<l;h++){const c=a.getPathPositionData(h/l);u=Wd({name:`${o}-${h}`,positionX:c.x,positionY:c.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:i,engine:n,forces:s,mass:r,fill:e.get(ng),stroke:e.get(rg)}),u.run(0,0,!1),t.push(u)}for(h=0;h<l-1;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+1}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+1}`);for(c&&(d=P[`${o}-${l-1}`],f=P[`${o}-0`],pg.call(this,d,f,`${o}-${l-1}~${o}-0`)),h=0;h<l-2;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+2}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+2}`);for(c&&(d=P[`${o}-${l-2}`],f=P[`${o}-0`],pg.call(this,d,f,`${o}-${l-2}~${o}-0`),d=P[`${o}-${l-1}`],f=P[`${o}-1`],pg.call(this,d,f,`${o}-${l-1}~${o}-1`)),h=0;h<l-3;h++)d=P[`${o}-${h}`],f=P[`${o}-${h+3}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+3}`);c&&(d=P[`${o}-${l-3}`],f=P[`${o}-0`],pg.call(this,d,f,`${o}-${l-3}~${o}-0`),d=P[`${o}-${l-2}`],f=P[`${o}-1`],pg.call(this,d,f,`${o}-${l-2}~${o}-1`),d=P[`${o}-${l-1}`],f=P[`${o}-2`],pg.call(this,d,f,`${o}-${l-1}~${o}-2`));const p=ct(l/2);for(h=0;h<l-p;h++)d=P[`${o}-${h}`],h+p<l-1&&(f=P[`${o}-${h+p}`],pg.call(this,d,f,`${o}-${h}~${o}-${h+p}`))}},[sg]:function(){const{shapeTemplate:t,precision:e}=this;if(t&&t.type&&e){const{particleStore:i,artefact:n,historyLength:s,engine:r,forces:o,mass:a,name:l,joinTemplateEnds:c}=this;let h,u,d,f;if(hg.includes(t.type)){for(h=0;h<e;h++){const c=t.getPathPositionData(h/e);u=Wd({name:`${l}-${h}`,positionX:c.x,positionY:c.y,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:r,forces:o,mass:a,fill:n.get(ng),stroke:n.get(rg)}),u.run(0,0,!1),i.push(u)}for(h=0;h<e-1;h++)d=P[`${l}-${h}`],f=P[`${l}-${h+1}`],pg.call(this,d,f,`${l}-${h}-${h+1}`);for(c&&(d=P[`${l}-${e-1}`],f=P[`${l}-0`],pg.call(this,d,f,`${l}-${e-1}-0`)),h=0;h<e-2;h++)d=P[`${l}-${h}`],f=P[`${l}-${h+2}`],pg.call(this,d,f,`${l}-${h}~${l}-${h+2}`);c&&(d=P[`${l}-${e-2}`],f=P[`${l}-0`],pg.call(this,d,f,`${l}-${e-2}~${l}-0`),d=P[`${l}-${e-1}`],f=P[`${l}-1`],pg.call(this,d,f,`${l}-${e-1}~${l}-1`))}const[p,g]=t.get("position"),m=Wd({name:`${l}-hub`,positionX:p,positionY:g,positionZ:0,velocityX:0,velocityY:0,velocityZ:0,historyLength:s,engine:r,forces:o,mass:a,fill:n.get(ng),stroke:n.get(rg)});m.run(0,0,!1),i.forEach(((t,e)=>pg.call(this,t,m,`${l}-${e}-hub`))),i.push(m)}}},mg=function(t){return!!t&&new Net(t)};function yg(t=tr){t.defs=hr(t.defs,{choke:15});const e=t.setters,i=t.deltaSetters;e.paletteStart=function(t){this.gradient&&this.gradient.set({paletteStart:t})},i.paletteStart=function(t){this.gradient&&this.gradient.setDelta({paletteStart:t})},e.paletteEnd=function(t){this.gradient&&this.gradient.set({paletteEnd:t})},i.paletteEnd=function(t){this.gradient&&this.gradient.setDelta({paletteEnd:t})},e.colors=function(t){this.gradient&&this.gradient.set({colors:t})},e.precision=function(t){this.gradient&&this.gradient.set({precision:t})},e.easing=function(t){this.gradient&&this.gradient.set({easing:t})},e.easingFunction=e.easing,e.colorSpace=function(t){this.gradient&&this.gradient.set({colorSpace:t})},e.returnColorAs=function(t){this.gradient&&this.gradient.set({returnColorAs:t})},e.cyclePalette=function(t){this.gradient&&this.gradient.set({cyclePalette:t})},e.delta=function(t=tr){this.gradient&&this.gradient.set({delta:t})},t.installElement=function(t){const e=document.createElement(ae);e.id=t,this.element=e,this.engine=this.element.getContext(Ht,{willReadFrequently:!0});const i=document.createElement(ae);return i.id=`${t}-color`,i.width=256,i.height=1,this.colorElement=i,this.colorEngine=this.colorElement.getContext(Ht,{willReadFrequently:!0}),this.gradient=hp({name:`${t}-gradient`,endX:Ui,delta:{paletteStart:0,paletteEnd:0},cyclePalette:!1}),this.gradientLastUpdated=0,this},t.checkSource=function(){this.notifySubscribers()},t.getData=function(t,e){return this.notifySubscribers(),this.buildStyle(e)},t.update=function(){this.dirtyOutput=!0},t.notifySubscribers=function(){this.dirtyOutput&&this.cleanOutput(),this.subscribers.forEach((t=>this.notifySubscriber(t)),this)},t.notifySubscriber=function(t){t.sourceNaturalWidth=this.width,t.sourceNaturalHeight=this.height,t.sourceLoaded=!0,t.source=this.element,t.dirtyImage=!0,t.dirtyCopyStart=!0,t.dirtyCopyDimensions=!0,t.dirtyImageSubscribers=!0},t.paintCanvas=function(){if(this.checkOutputValuesExist()&&this.dirtyOutput){this.dirtyOutput=!1;const{element:t,engine:e,width:i,height:n,colorEngine:s,gradient:r,choke:o,gradientLastUpdated:a}=this;t.width=i,t.height=n;const l=e.getImageData(0,0,i,n),c=l.data,h=i*n;let u,d,f;const p=mt();a+o<p&&(r.updateByDelta(),this.gradientLastUpdated=p);const g=s.createLinearGradient(0,0,255,0);r.addStopsToGradient(g,r.paletteStart,r.paletteEnd,r.cyclePalette),s.fillStyle=g,s.fillRect(0,0,256,1);const m=s.getImageData(0,0,256,1).data;for(u=0;u<h;u++)d=4*ct(255*this.getOutputValue(u,i)),f=4*u,c[f]=m[d],c[++f]=m[++d],c[++f]=m[++d],c[++f]=m[++d];e.putImageData(l,0,0)}}}J.Net=Net;const bg=["stripes","smoothed-stripes","worley-euclidean","worley-manhattan"],Sg="euclidian-distance",kg="improved-perlin",Cg="manhattan-distance",Ag="perlin",vg="simplex",Pg="smoothed-stripes",xg="stripes",Og="worley-euclidean",wg="worley-manhattan",Dg=["X","Y","Z","XminusY","XminusZ","YminusX","YminusZ","ZminusX","ZminusY","XaddY","XaddZ","YaddZ","XaddYminusZ","XaddZminusY","YaddZminusX","XmultiplyY","XmultiplyZ","YmultiplyZ","XmultiplyYaddZ","XmultiplyZaddY","YmultiplyZaddX","XmultiplyYminusZ","XmultiplyZminusY","YmultiplyZminusX","sum"],NoiseAsset=function(t=tr){return this.makeName(t.name),this.register(),this.installElement(this.name),this.perm=[],this.permMod8=[],this.values=[],this.grad=[],this.subscribers=[],this.set(this.defs),this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this.dirtyOutput=!0,this},Fg=NoiseAsset.prototype=Sr();Fg.type="NoiseAsset",Fg.lib=Vt,Fg.isArtefact=!1,Fg.isAsset=!0,Co(Fg),uc(Fg),yg(Fg),kh(Fg);const Rg={width:300,height:150,noiseEngine:vg,seed:we,size:256,scale:50,octaves:1,octaveFunction:Yi,persistence:.5,lacunarity:2,smoothing:"quintic",sumFunction:Yi,sineFrequencyCoeff:1,sumAmplitude:5,worleyOutput:"X",worleyDepth:0};Fg.defs=hr(Fg.defs,Rg),delete Fg.defs.source,delete Fg.defs.sourceLoaded,Fg.stringifyFunction=qs,Fg.processPacketOut=qs,Fg.finalizePacketOut=qs,Fg.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Fg.clone=Js;const Tg=Fg.setters;Tg.source=qs,Tg.subscribers=qs,Tg.octaveFunction=function(t){this.octaveFunction=null!=this.octaveFunctions[t]?this.octaveFunctions[t]:Qs,this.dirtyNoise=!0,this.dirtyOutput=!0},Tg.sumFunction=function(t){this.sumFunction=null!=this.sumFunctions[t]?this.sumFunctions[t]:Qs,this.dirtyNoise=!0,this.dirtyOutput=!0},Tg.smoothing=function(t){this.smoothing=null!=br[t]?br[t]:Qs,this.dirtyNoise=!0,this.dirtyOutput=!0},Tg.noiseEngine=function(t){this.noiseEngine=null!=this.noiseEngines[t]?this.noiseEngines[t]:this.noiseEngines[vg],this.dirtyNoise=!0,this.dirtyOutput=!0},Tg.octaves=function(t){t.toFixed&&(this.octaves=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.seed=function(t){t.substring&&(this.seed=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.scale=function(t){t.toFixed&&(this.scale=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.size=function(t){t.toFixed&&(this.size=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.persistence=function(t){t.toFixed&&(this.persistence=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.lacunarity=function(t){t.toFixed&&(this.lacunarity=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.sineFrequencyCoeff=function(t){t.toFixed&&(this.sineFrequencyCoeff=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.modularAmplitude=function(t){t.toFixed&&(this.sumAmplitude=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.sumAmplitude=function(t){t.toFixed&&(this.sumAmplitude=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.width=function(t){t.toFixed&&(this.width=t,this.sourceNaturalWidth=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.height=function(t){t.toFixed&&(this.height=t,this.sourceNaturalHeight=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.worleyDepth=function(t){t.toFixed&&(this.worleyDepth=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.worleyOutput=function(t){t.substring&&Dg.includes(t)&&(this.worleyOutput=t,this.dirtyNoise=!0,this.dirtyOutput=!0)},Tg.colors=function(t){this.gradient&&this.gradient.set({colors:t}),this.dirtyOutput=!0},Fg.cleanOutput=function(){this.dirtyNoise&&this.cleanNoise(),this.dirtyOutput&&this.paintCanvas()},Fg.cleanNoise=function(){if(this.dirtyNoise){this.dirtyNoise=!1;const{noiseEngine:t,seed:e,width:i,height:n,octaves:s,lacunarity:r,persistence:o,scale:a,octaveFunction:l,sumFunction:c}=this;if(t&&t.init){this.rndEngine=xa(e),this.generatePermutationTable(),t.init.call(this);const h=Jr();let u,d,f,p,g,m,y,b;for(d=0;d<n;d++)for(h[d]=[],u=0;u<i;u++)h[d][u]=[];const S=kt(i,-a/100);let k=-1e3,C=1e3;const A=t.name;if(bg.includes(A))for(d=0;d<n;d++)for(u=0;u<i;u++)p=u*S,g=d*S,m=t.getNoiseValue.call(this,p,g),h[d][u]=m,C=gt(C,m),k=pt(k,m);else for(d=0;d<n;d++)for(u=0;u<i;u++){for(p=u*S,g=d*S,m=0,y=1,b=1,f=0;f<s;f++){let e=t.getNoiseValue.call(this,p*b,g*b);e=l(e,p,g,f+1),e*=y,m+=e,b*=r,y*=o}h[d][u]=m,C=gt(C,m),k=pt(k,m)}const v=k-C;for(d=0;d<n;d++)for(u=0;u<i;u++){p=u*S,g=d*S;const t=(h[d][u]-C)/v;h[d][u]=c.call(this,t,u*S,d*S)}this.noiseValues||(this.noiseValues=[]),this.noiseValues.length=0,this.noiseValues.push(...h),to(h)}else this.dirtyNoise=!0}},Fg.checkOutputValuesExist=function(){return null!=this.noiseValues},Fg.getOutputValue=function(t,e){const i=ct(t/e),n=t-i*e;return this.noiseValues[i][n]};const Hg=.5*(Ot(3)-1),Eg=(3-Ot(3))/6,Ig=(3-Ot(3))/6*2,Bg=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];Fg.noiseEngines={[Ag]:{name:Ag,init:function(){const{grad:t,size:e,rndEngine:i}=this;let n;t.length=0;for(let s=0;s<e;s++)t[s]=[2*i.random()-1,2*i.random()-1],n=Ot(t[s][0]*t[s][0]+t[s][1]*t[s][1]),t[s][0]/=n,t[s][1]/=n},getNoiseValue:function(t,e){const{size:i,perm:n,grad:s,smoothing:r}=this;let o,a;const l=ct(t)%i,c=(l+1)%i,h=t-ct(t),u=h-1,d=ct(e)%i,f=(d+1)%i,p=e-ct(e),g=p-1,m=n[l],y=n[c],b=n[m+d],S=n[y+d],k=n[m+f],C=n[y+f],A=r(h),v=r(p);o=h*s[b][0]+p*s[b][1],a=u*s[S][0]+p*s[S][1];const P=ir(A,o,a);o=h*s[k][0]+g*s[k][1],a=u*s[C][0]+g*s[C][1];const x=ir(A,o,a);return.5*(1+ir(v,P,x))}},[kg]:{name:kg,init:qs,getNoiseValue:function(t,e){const{size:i,perm:n,permMod8:s,smoothing:r}=this;let o,a;const l=ct(t)%i,c=(l+1)%i,h=t-ct(t),u=h-1,d=ct(e)%i,f=(d+1)%i,p=e-ct(e),g=p-1,m=n[l],y=n[c],b=s[m+d],S=s[y+d],k=s[m+f],C=s[y+f],A=r(h),v=r(p);o=h*Bg[b][0]+p*Bg[b][1],a=u*Bg[S][0]+p*Bg[S][1];const P=ir(A,o,a);o=h*Bg[k][0]+g*Bg[k][1],a=u*Bg[C][0]+g*Bg[C][1];const x=ir(A,o,a);return.5*(1+ir(v,P,x))}},[vg]:{name:vg,init:qs,getNoiseValue:function(t,e){const i=function(t,e,i){const n=.5-t*t-e*e;if(n<0)return 0;const[s,r]=Bg[i];return n*n*(s*t+r*e)},{size:n,perm:s,permMod8:r}=this,o=(t+e)*Hg,a=ct(t+o),l=ct(e+o),c=(a+l)*Eg,h=t-(a-c),u=e-(l-c),d=a%n,f=l%n;let p=r[d+s[f]],g=i(h,u,p);p=r[d+1+s[f+1]],g+=i(h-1+Ig,u-1+Ig,p);let m=0,y=1;return h>u&&(m=1,y=0),p=r[d+m+s[f+y]],g+=i(h-m+Eg,u-y+Eg,p),.5+35*g}},[Ls]:{name:Ls,init:function(){const{values:t,size:e,rndEngine:i}=this;t.length=0;for(let n=0;n<e;n++)t[n]=t[n+e]=i.random()},getNoiseValue:function(t,e){const{values:i,size:n,perm:s,smoothing:r}=this,o=ct(t)%n,a=ct(e)%n,l=(o+1)%n,c=(a+1)%n,h=t-ct(t),u=e-ct(e),d=r(h),f=r(u),p=s[o],g=s[l],m=s[p+a],y=s[g+a],b=s[p+c],S=s[g+c],k=ir(d,i[m],i[y]),C=ir(d,i[b],i[S]);return ir(f,k,C)}},[xg]:{name:xg,init:qs,getNoiseValue:function(t,e){return t/5+e/5}},[Pg]:{name:Pg,init:qs,getNoiseValue:function(t,e){const{smoothing:i}=this;return i(t)/5+i(e)/5}},[Og]:{name:Og,init:function(){this.worleySeed=ct(1e6*this.rndEngine.random())},getNoiseValue:function(t,e){const{worleyDepth:i,worleyDistanceFunctions:n,worleyOutputFunctions:s,worleyOutput:r}=this,o=n[Sg],a=s[r];return this.worleyNoise({x:t,y:e,z:i},o,a)}},[wg]:{name:wg,init:function(){this.worleySeed=ct(1e6*this.rndEngine.random())},getNoiseValue:function(t,e){const{worleyDepth:i,worleyDistanceFunctions:n,worleyOutputFunctions:s,worleyOutput:r}=this,o=n[Cg],a=s[r];return this.worleyNoise({x:t,y:e,z:i},o,a)}}},Fg.generatePermutationTable=function(){const{perm:t,permMod8:e,rndEngine:i,size:n}=this;let s,r,o;for(t.length=0,e.length=0,s=0;s<n;s++)t[s]=s;for(;--s;)r=ct(i.random()*n),o=t[s],t[s]=t[r],t[r]=o;for(s=0;s<n;s++)t[s+n]=t[s],e[s]=e[s+n]=t[s]%8},Fg.octaveFunctions={none:Qs,absolute:function(t){return et(2*t-1)}},Fg.sumFunctions={none:Qs,"sine-x":function(t,e){return.5+xt(e*this.sineFrequencyCoeff+t)/2},"sine-y":function(t,e,i){return.5+xt(i*this.sineFrequencyCoeff+t)/2},sine:function(t,e,i){return.5+xt(e*this.sineFrequencyCoeff+t)/4+xt(i*this.sineFrequencyCoeff+t)/4},modular:function(t){const e=t*this.sumAmplitude;return e-ct(e)},random:function(t){const e=this.sumAmplitude;let i=t+(At()/e-.5/e);return i>1?i=1:i<0&&(i=0),i}},Fg.wXorshift=function(t){let e=t^t>>12;return e^=e<<25,e^=e>>27,2*e},Fg.wHash=function(t,e,i){return 16777619*(16777619*(16777619*(2166136261^t)^e)^i)&4294967295},Fg.worleyDistanceFunctions={[Sg]:function(t,e){return function(t,e){return[t.x-e.x,t.y-e.y,t.z-e.z]}(t,e).reduce(((t,e)=>t+e*e),0)},[Cg]:function(t,e){return function(t,e){return[t.x-e.x,t.y-e.y,t.z-e.z]}(t,e).reduce(((t,e)=>t+et(e)),0)}},Fg.wProbLookup=function(t){return(t&=4294967295)<393325350?1:t<1022645910?2:t<1861739990?3:t<2700834071?4:t<3372109335?5:t<3819626178?6:t<4075350088?7:t<4203212043?8:9},Fg.wInsert=function(t,e){let i;for(let n=t.length-1;n>=0&&!(e>t[n]);n--)i=t[n],t[n]=e,n+1<t.length&&(t[n+1]=i)},Fg.worleyOutputFunctions={X:function(t){return t[0]},Y:function(t){return t[1]},Z:function(t){return t[2]},XminusY:function(t){return t[0]-t[1]},XminusZ:function(t){return t[0]-t[2]},YminusX:function(t){return t[1]-t[0]},YminusZ:function(t){return t[1]-t[2]},ZminusX:function(t){return t[2]-t[0]},ZminusY:function(t){return t[2]-t[1]},XaddY:function(t){return t[0]+t[1]},XaddZ:function(t){return t[0]+t[2]},YaddZ:function(t){return t[1]+t[2]},XaddYminusZ:function(t){return t[0]+t[1]-t[2]},XaddZminusY:function(t){return t[0]+t[2]-t[1]},YaddZminusX:function(t){return t[1]+t[2]-t[0]},XmultiplyY:function(t){return t[0]*t[1]},XmultiplyZ:function(t){return t[0]*t[2]},YmultiplyZ:function(t){return t[1]*t[2]},XmultiplyYaddZ:function(t){return t[0]*t[1]+t[2]},XmultiplyZaddY:function(t){return t[0]*t[2]+t[1]},YmultiplyZaddX:function(t){return t[1]*t[2]+t[0]},XmultiplyYminusZ:function(t){return t[0]*t[1]-t[2]},XmultiplyZminusY:function(t){return t[0]*t[2]-t[1]},YmultiplyZminusX:function(t){return t[1]*t[2]-t[0]},sum:function(t){return t[0]+t[1]+t[2]}},Fg.worleyNoise=function(t,e,i){let n,s,r={x:0,y:0,z:0};const o={x:0,y:0,z:0};let a,l,c;const h=[9999999,9999999,9999999];let{x:u,y:d,z:f}=t;u=ct(u),d=ct(d),f=ct(f);for(let i=-1;i<2;++i)for(let p=-1;p<2;++p)for(let g=-1;g<2;++g){a=u+i,l=d+p,c=f+g,n=this.wXorshift(this.wHash(a+this.worleySeed&4294967295,4294967295&l,4294967295&c)),s=this.wProbLookup(n);for(let i=0;i<s;++i)n=this.wXorshift(n),o.X=n/4294967296,n=this.wXorshift(n),o.Y=n/4294967296,n=this.wXorshift(n),o.Z=n/4294967296,r={x:o.X+a,y:o.Y+l,z:o.Z+c},this.wInsert(h,e(t,r))}return i(h.map((t=>t<0?0:t>1?1:t)))};const Lg=function(t){return!!t&&new NoiseAsset(t)},$g=function(t){return!!t&&new NoiseAsset(t)};J.NoiseAsset=NoiseAsset;const Oval=function(t=tr){return this.shapeInit(t),this},Mg=Oval.prototype=Sr();Mg.type="Oval",Mg.lib=ze,Mg.isArtefact=!0,Mg.isAsset=!1,Co(Mg),hd(Mg);Mg.defs=hr(Mg.defs,{radiusX:5,radiusY:5,intersectX:.5,intersectY:.5,offshootA:.55,offshootB:0});const Xg=Mg.setters,Yg=Mg.deltaSetters;Xg.radius=function(t){this.setRectHelper(t,cn)},Xg.radiusX=function(t){this.setRectHelper(t,ln)},Xg.radiusY=function(t){this.setRectHelper(t,hn)},Yg.radius=function(t){this.deltaRectHelper(t,cn)},Yg.radiusX=function(t){this.deltaRectHelper(t,ln)},Yg.radiusY=function(t){this.deltaRectHelper(t,hn)},Xg.offshootA=function(t){t.toFixed&&(this.offshootA=t,this.updateDirty())},Xg.offshootB=function(t){t.toFixed&&(this.offshootB=t,this.updateDirty())},Yg.offshootA=function(t){t.toFixed&&(this.offshootA+=t,this.updateDirty())},Yg.offshootB=function(t){t.toFixed&&(this.offshootB+=t,this.updateDirty())},Xg.intersectX=function(t){t.toFixed&&(this.intersectX=t,this.updateDirty())},Xg.intersectY=function(t){t.toFixed&&(this.intersectY=t,this.updateDirty())},Yg.intersectX=function(t){t.toFixed&&(this.intersectX+=t,this.updateDirty())},Yg.intersectY=function(t){t.toFixed&&(this.intersectY+=t,this.updateDirty())},Mg.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},Mg.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=Ws(this[e],t)}),this)},Mg.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeOvalPath()},Mg.makeOvalPath=function(){const t=parseFloat(this.offshootA.toFixed(6)),e=parseFloat(this.offshootB.toFixed(6)),i=this.radiusX,n=this.radiusY;let s,r;if(i.substring||n.substring){const t=this.getHost();if(t){const[e,o]=t.currentDimensions;s=2*(i.substring?parseFloat(i)/100*e:i),r=2*(n.substring?parseFloat(n)/100*o:n)}}else s=2*i,r=2*n;const o=parseFloat((s*this.intersectX).toFixed(2)),a=parseFloat((s-o).toFixed(2)),l=parseFloat((r*this.intersectY).toFixed(2)),c=parseFloat((r-l).toFixed(2));let h=js;return h+=`c${a*t},${l*e} ${a-a*e},${l-l*t}, ${a},${l} `,h+=`${-a*e},${c*t} ${a*t-a},${c-c*e} ${-a},${c} `,h+=`${-o*t},${-c*e} ${o*e-o},${c*t-c} ${-o},${-c} `,h+=`${o*e},${-l*t} ${o-o*t},${l*e-l} ${o},${-l}z`,h},Mg.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(js,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Gg=function(t){return!!t&&(t.species="oval",new Oval(t))};J.Oval=Oval;const jg="VIDEO",zg=["video_audioTracks","video_autoPlay","video_buffered","video_controller","video_controls","video_controlsList","video_crossOrigin","video_currentSrc","video_currentTime","video_defaultMuted","video_defaultPlaybackRate","video_disableRemotePlayback","video_duration","video_ended","video_error","video_loop","video_mediaGroup","video_mediaKeys","video_muted","video_networkState","video_paused","video_playbackRate","video_readyState","video_seekable","video_seeking","video_sinkId","video_src","video_srcObject","video_textTracks","video_videoTracks","video_volume"],Ng=["video_autoPlay","video_controller","video_controls","video_crossOrigin","video_currentTime","video_defaultMuted","video_defaultPlaybackRate","video_disableRemotePlayback","video_loop","video_mediaGroup","video_muted","video_playbackRate","video_src","video_srcObject","video_volume"],VideoAsset=function(t=tr){return this.assetConstructor(t)},Vg=VideoAsset.prototype=Sr();Vg.type=ms,Vg.lib=Vt,Vg.isArtefact=!1,Vg.isAsset=!0,Co(Vg),uc(Vg),Vg.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},Vg.stringifyFunction=qs,Vg.processPacketOut=qs,Vg.finalizePacketOut=qs,Vg.clone=Js;Vg.setters.source=function(t){t&&(t.tagName.toUpperCase()===jg&&(this.source=t,this.sourceNaturalWidth=t.videoWidth||0,this.sourceNaturalHeight=t.videoHeight||0,this.sourceLoaded=t.readyState>2),this.sourceLoaded&&this.notifySubscribers())},Vg.checkSource=function(t,e){const i=this.source;i&&i.readyState>2?(this.sourceLoaded=!0,this.sourceNaturalWidth===i.videoWidth&&this.sourceNaturalHeight===i.videoHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.videoWidth,this.sourceNaturalHeight=i.videoHeight,this.notifySubscribers())):this.sourceLoaded=!1},Vg.addTextTrack=function(t,e,i){const n=this.source;n&&n.addTextTrack&&n.addTextTrack(t,e,i)},Vg.captureStream=function(){const t=this.source;return!(!t||!t.captureStream)&&t.captureStream()},Vg.canPlayType=function(t){const e=this.source;return e?e.canPlayType(t):"maybe"},Vg.fastSeek=function(t){const e=this.source;e&&e.fastSeek&&e.fastSeek(t)},Vg.load=function(){const t=this.source;t&&t.load()},Vg.pause=function(){const t=this.source;t&&t.pause()},Vg.play=function(){const t=this.source;return t?t.play().catch((t=>console.log(t.code,t.name,t.message))):Promise.reject("Source not defined")},Vg.setMediaKeys=function(t){const e=this.source;return e?e.setMediaKeys?e.setMediaKeys(t):Promise.reject("setMediaKeys not supported"):Promise.reject("Source not defined")},Vg.setSinkId=function(){const t=this.source;return t?t.setSinkId?t.setSinkId():Promise.reject("setSinkId not supported"):Promise.reject("Source not defined")};const Wg=function(t){document.querySelectorAll(t).forEach((t=>{let e;if(t.tagName.toUpperCase()===jg){if(t.id||t.name)e=t.id||t.name;else{const i=Wt.exec(t.src);e=i&&i[1]?i[1]:zs}const i=Kg({name:e,source:t});t.readyState<=2&&(t.oncanplay=()=>{i.set({source:t})})}}))},Ug=function(t=tr){const e={};e.audio=!pr(t.audio)||t.audio,e.video={};const i=e.video.width={};t.minWidth&&(i.min=t.minWidth),t.maxWidth&&(i.max=t.maxWidth),i.ideal=t.width?t.width:1280;const n=e.video.height={};t.minHeight&&(n.min=t.minHeight),t.maxHeight&&(n.max=t.maxHeight),n.ideal=t.height?t.height:720,t.facing&&(e.video.facingMode=t.facing);const s=t.name||er(),r=document.createElement(Ms),o=Kg({name:s,source:r});return new Promise(((t,i)=>{navigator&&navigator.mediaDevices?navigator.mediaDevices.getUserMedia(e).then((e=>{const i=e.getVideoTracks();let n;ut(i)&&i[0]&&(n=i[0].getConstraints()),r.id=o.name,n&&(r.width=n.width,r.height=n.height),r.srcObject=e,r.onloadedmetadata=function(){r.play()},t(o)})).catch((e=>{console.log(e),t(o)})):i("Navigator.mediaDevices object not found")}))},Zg=function(t=tr){const e={video:{displaySurface:"browser"},audio:{suppressLocalAudioPlayback:!1},preferCurrentTab:!1,selfBrowserSurface:"exclude",systemAudio:"include",surfaceSwitching:"include",monitorTypeSurfaces:"include"},i=t.name||er(),n=document.createElement(Ms),s=Kg({name:i,source:n});return new Promise(((i,r)=>{navigator&&navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia({...e,...t}).then((t=>{const e=t.getVideoTracks();let r;ut(e)&&e[0]&&(r=e[0].getConstraints()),n.id=s.name,r&&(n.width=r.width,n.height=r.height),n.srcObject=t,n.onloadedmetadata=function(){n.play()},i(s)})).catch((t=>{console.log(t.message),i(s)})):r("Navigator.mediaDevices object not found")}))},_g=function(...t){let e=zs;if(t.length){let i,n,s,r,o,a,l=!1;const c=t[0];if(c.substring){const e=Wt.exec(c);i=e&&e[1]?e[1]:zs,o=[...t],n=zs,s=!1,r=null,a=Ut,l=!0}else c&&c.src&&(i=c.name||zs,o=[...c.src],n=c.className||zs,s=c.visibility||!1,r=document.querySelector(r),a=c.preload||Ut,l=!0);const h=Kg({name:i});if(l){const t=document.createElement(Ms);t.name=i,t.className=n,t.style.display=s?ee:Yi,t.crossOrigin=Yt,t.preload=a,o.forEach((e=>{const i=document.createElement(Rn);i.src=e,t.appendChild(i)})),t.onload=()=>{h.set({source:t}),r&&r.appendChild(t)},h.set({source:t}),e=i}}return e},Kg=function(t){return!!t&&new VideoAsset(t)};J.VideoAsset=VideoAsset;const SpriteAsset=function(t=tr){return this.sourceHold=null,this.manifest=null,this.assetConstructor(t),this},qg=SpriteAsset.prototype=Sr();qg.type=ds,qg.lib=Vt,qg.isArtefact=!1,qg.isAsset=!0,Co(qg),uc(qg);qg.defs=hr(qg.defs,{manifest:null}),qg.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},qg.stringifyFunction=qs,qg.processPacketOut=qs,qg.finalizePacketOut=qs,qg.clone=Js;qg.setters.source=function(t=[]){if(t&&t[0]){this.sourceHold||(this.sourceHold={});const e=this.sourceHold;t.forEach((t=>{const i=t.id||t.name;i&&(e[i]=t)})),this.source=t[0],this.sourceNaturalWidth=t[0].naturalWidth,this.sourceNaturalHeight=t[0].naturalHeight,this.sourceLoaded=t[0].complete}},qg.checkSource=qs;const Qg=function(...t){const e=/\.(jpeg|jpg|png|gif|webp|svg|JPEG|JPG|PNG|GIF|WEBP|SVG)/,i=[];return t.forEach((t=>{let n,s,r,o,a,l=!1,c=!1;if(t.substring){const i=Wt.exec(t);n=i&&i[1]?i[1]:zs,s=[t],r=zs,o=!1,a=t.replace(e,".json"),c=!0}else lr(t)&&t.imageSrc&&t.manifestSrc?(n=t.name||zs,s=ut(t.imageSrc)?t.imageSrc:[t.imageSrc],a=t.manifestSrc,r=t.className||zs,o=t.visibility||!1,l=document.querySelector(t.parent),c=!0):i.push(!1);if(c){const t=Jg({name:n});lr(a)?t.manifest=a:fetch(a).then((t=>{if(200!=t.status)throw new Error("Failed to load manifest");return t.json()})).then((e=>t.manifest=e)).catch((t=>console.log(t.message)));const c=[];s.forEach((t=>{const i=document.createElement(hi);let s,a;e.test(t)&&(a=Wt.exec(t),s=a&&a[1]?a[1]:zs),i.name=s||n,i.className=r,i.crossorigin=Yt,i.style.display=o?ee:Yi,l&&l.appendChild(i),i.src=t,c.push(i)})),t.set({source:c}),i.push(n)}else i.push(!1)})),i},Jg=function(t){return!!t&&new SpriteAsset(t)};J.SpriteAsset=SpriteAsset;function tm(t=tr){const e={asset:null,removeAssetOnKill:!1,spriteIsRunning:!1,spriteLastFrameChange:0,spriteCurrentFrame:0,spriteTrack:"default",spriteForward:!0,spriteFrameDuration:100,spriteWillLoop:!0};t.defs=hr(t.defs,e);const i=t.getters,n=t.setters;i.sourceDimensions=function(){return[this.sourceNaturalWidth,this.sourceNaturalHeight]},n.asset=function(t){const e=this.asset,i=t&&t.name?t.name:t;e&&!e.substring&&e.unsubscribe(this),this.asset=i,this.dirtyAsset=!0},n.imageSource=function(t){const e=kc(t);if(e){const t=l[e[0]];if(t){const e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},n.videoSource=function(t){const e=_g(t);if(e){const t=l[e];if(t){const e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},n.spriteSource=function(t){const e=Qg(t);if(e){const t=l[e];if(t){const e=this.asset;e&&e.unsubscribe&&e.unsubscribe(this),t.subscribe(this)}}},t.cleanAsset=function(){const t=this.asset;if(t&&t.substring){const e=l[t];e&&(this.dirtyAsset=!1,e.subscribe(this))}},t.videoAction=function(t,...e){const i=this.asset;if(i&&i.type===ms)return i[t](...e)},t.videoPromiseAction=function(t,...e){const i=this.asset;return i&&i.type===ms?i[t](...e):Promise.reject("Asset not a video")},t.videoAddTextTrack=function(t,e,i){return this.videoAction("addTextTrack",t,e,i)},t.videoCaptureStream=function(){return this.videoAction("captureStream")},t.videoCanPlayType=function(t){return this.videoAction("canPlayType",t)},t.videoFastSeek=function(t){return this.videoAction("fastSeek",t)},t.videoLoad=function(){return this.videoAction("load")},t.videoPause=function(){return this.videoAction("pause")},t.videoPlay=function(){return this.videoPromiseAction("play")},t.videoSetMediaKeys=function(t){return this.videoPromiseAction("setMediaKeys",t)},t.videoSetSinkId=function(){return this.videoPromiseAction("setSinkId")},t.checkSpriteFrame=function(){const t=this.asset;if(t&&t.type===ds&&t.manifest){const e=this.copyArray;if(this.spriteIsRunning){const i=this.spriteLastFrameChange,n=this.spriteFrameDuration,s=mt();if(s>i+n){const i=t.manifest;if(i){const n=i[this.spriteTrack],r=n.length,o=this.spriteWillLoop;let a=this.spriteCurrentFrame;a=this.spriteForward?a+1:a-1,a<0&&(a=o?r-1:0),a>=r&&(a=o?0:r-1);const[l,c,h,u,d]=n[a];e.length=0,e.push(c,h,u,d),this.dirtyCopyStart=!1,this.dirtyCopyDimensions=!1;if(l!==(this.source.id||this.source.name)){const e=t.sourceHold[l];e&&(this.source=e)}this.spriteCurrentFrame=a,this.spriteLastFrameChange=s}}}else{const[,i,n,s,r]=t.manifest[this.spriteTrack][this.spriteCurrentFrame],[o,a,l,c]=e;o===i&&a===n&&l===s&&c===r||(e.length=0,e.push(i,n,s,r),this.dirtyCopyStart=!1,this.dirtyCopyDimensions=!1)}}},t.playSprite=function(t,e,i,n,s){pr(t)&&(this.spriteFrameDuration=t),pr(e)&&(this.spriteWillLoop=e),pr(i)&&(this.spriteTrack=i),pr(n)&&(this.spriteForward=n),pr(s)&&(this.spriteCurrentFrame=s),this.spriteLastFrameChange=mt(),this.spriteIsRunning=!0},t.haltSprite=function(t,e,i,n,s){pr(t)&&(this.spriteFrameDuration=t),pr(e)&&(this.spriteWillLoop=e),pr(i)&&(this.spriteTrack=i),pr(n)&&(this.spriteForward=n),pr(s)&&(this.spriteCurrentFrame=s),this.spriteIsRunning=!1}}const Pattern=function(t=tr){return this.makeName(t.name),this.register(),this.set(this.defs),this.source=null,this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.sourceLoaded=!1,this.dirtyImage=!0,this.dirtyCopyStart=!0,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.patternMatrix=null,this.set(t),this},em=Pattern.prototype=Sr();em.type="Pattern",em.lib=jn,em.isArtefact=!1,em.isAsset=!1,Co(em),kh(em),tm(em),em.packetObjects=dr(em.packetObjects,["asset"]),em.finalizePacketOut=function(t,e){if(ut(e.patternMatrix))t.patternMatrix=e.patternMatrix;else{const e=this.patternMatrix;e&&(t.patternMatrix=[e.a,e.b,e.c,e.d,e.e,e.f])}return t},em.kill=function(){const{name:t,asset:e,removeAssetOnKill:i}=this;let n,s,r,o;return lr(e)&&e.unsubscribe(this),Dt(m).forEach((e=>{n=e.state,s=n.defs,n&&(r=n.fillStyle,o=n.strokeStyle,lr(r)&&r.name===t&&(n.fillStyle=s.fillStyle),lr(o)&&o.name===t&&(n.strokeStyle=s.strokeStyle))})),i&&(i.substring?e.kill(!0):e.kill()),this.deregister(),this},em.get=function(t){const e=this.source;if(0!==t.indexOf(Tt)&&0!==t.indexOf(Rt)||!e){const e=this.getters[t];if(e)return e.call(this);{const e=this.defs[t];if(typeof e!==Ts){const i=this[t];return typeof i!==Ts?i:e}return}}return zg.includes(t)||bc.includes(t)?e[t.substring(6)]:void 0},em.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.source,r=this.defs;let o,a,l,c;for(a=0;a<i;a++)l=e[a],c=t[l],0!==l.indexOf(Tt)&&0!==l.indexOf(Rt)||!s?l&&l!==Li&&null!=c&&(o=n[l],o?o.call(this,c):typeof r[l]!==Ts&&(this[l]=c)):(Ng.includes(l)||Sc.includes(l))&&(s[l.substring(6)]=c);this.dirtyFilterIdentifier=!0}return this},em.getData=function(t,e){return this.dirtyAsset&&this.cleanAsset(),this.asset.checkSource(this.sourceNaturalWidth,this.sourceNaturalHeight),this.buildStyle(e)};const im=function(t){return!!t&&new Pattern(t)};J.Pattern=Pattern;const nm="copyDimensions",sm="copyStart",Picture=function(t=tr){return this.copyStart=qa(),this.currentCopyStart=qa(),this.copyDimensions=qa(),this.currentCopyDimensions=qa(),this.copyArray=[],this.pasteArray=[],this.dirtyPaste=!0,this.source=null,this.sourceNaturalWidth=0,this.sourceNaturalHeight=0,this.sourceNaturalDimensions=[],this.sourceLoaded=!1,this.entityInit(t),t.copyStart||(t.copyStartX||(this.copyStart[0]=0),t.copyStartY||(this.copyStart[1]=0)),t.copyDimensions||(t.copyWidth||(this.copyDimensions[0]=1),t.copyHeight||(this.copyDimensions[1]=1)),this.imageSubscribers=[],this.dirtyCopyStart=!0,this.dirtyCopyDimensions=!0,this.dirtyImage=!0,this},rm=Picture.prototype=Sr();rm.type=rs,rm.lib=ze,rm.isArtefact=!0,rm.isAsset=!1,Co(rm),Ju(rm),tm(rm);rm.defs=hr(rm.defs,{copyStart:null,copyDimensions:null,checkHitIgnoreTransparency:!1}),rm.packetCoordinates=dr(rm.packetCoordinates,["copyStart","copyDimensions"]),rm.packetObjects=dr(rm.packetObjects,["asset"]),rm.factoryKill=function(){const{asset:t,removeAssetOnKill:e}=this;lr(t)&&(t.unsubscribe(this),e&&t.kill(!0))};const om=rm.getters,am=rm.setters,lm=rm.deltaSetters;om.copyStart=function(){return[].concat(this.currentCopyStart)},om.copyStartX=function(){return this.currentCopyStart[0]},om.copyStartY=function(){return this.currentCopyStart[1]},am.copyStartX=function(t){null!=t&&(this.copyStart[0]=t,this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},am.copyStartY=function(t){null!=t&&(this.copyStart[1]=t,this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},am.copyStart=function(t,e){this.setCoordinateHelper(sm,t,e),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},lm.copyStartX=function(t){const e=this.copyStart;e[0]=Ws(e[0],t),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},lm.copyStartY=function(t){const e=this.copyStart;e[1]=Ws(e[1],t),this.dirtyCopyStart=!0,this.dirtyFilterIdentifier=!0},lm.copyStart=function(t,e){this.setDeltaCoordinateHelper(sm,t,e),this.dirtyCopyStart=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},om.copyWidth=function(){return this.currentCopyDimensions[0]},om.copyHeight=function(){return this.currentCopyDimensions[1]},om.copyDimensions=function(){return[].concat(this.currentCopyDimensions)},am.copyWidth=function(t){null!=t&&(this.copyDimensions[0]=t,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},am.copyHeight=function(t){null!=t&&(this.copyDimensions[1]=t,this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0)},am.copyDimensions=function(t,e){this.setCoordinateHelper(nm,t,e),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},lm.copyWidth=function(t){const e=this.copyDimensions;e[0]=Ws(e[0],t),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},lm.copyHeight=function(t){const e=this.copyDimensions;e[1]=Ws(e[1],t),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},lm.copyDimensions=function(t,e){this.setDeltaCoordinateHelper(nm,t,e),this.dirtyCopyDimensions=!0,this.dirtyImageSubscribers=!0,this.dirtyFilterIdentifier=!0},rm.get=function(t){const e=this.source;if(0!==t.indexOf(Tt)&&0!==t.indexOf(Rt)||!e){const e=this.getters[t];if(e)return e.call(this);{const e=this.state;let i,n=this.defs[t];return typeof n!==Ts?(i=this[t],typeof i!==Ts?i:n):(n=e.defs[t],typeof n!==Ts?(i=e[t],typeof i!==Ts?i:n):void 0)}}return zg.includes(t)||bc.includes(t)?e[t.substring(6)]:void 0},rm.set=function(t=tr){const e=ft(t),i=e.length;if(i){const n=this.setters,s=this.defs,r=this.source,o=this.state,a=o?o.setters:tr,l=o?o.defs:tr;let c,h,u,d;for(h=0;h<i;h++)u=e[h],d=t[u],0!==u.indexOf(Tt)&&0!==u.indexOf(Rt)||!r?u&&u!==Li&&null!=d&&(Xn.includes(u)?(c=a[u],c?c.call(o,d):typeof l[u]!==Ts&&(o[u]=d)):(c=n[u],c?c.call(this,d):typeof s[u]!==Ts&&(this[u]=d))):(Ng.includes(u)||Sc.includes(u))&&(r[u.substring(6)]=d)}return this},rm.updateImageSubscribers=function(){this.dirtyImageSubscribers=!1,this.imageSubscribers.length&&this.imageSubscribers.forEach((t=>{const e=o[t];e&&(e.dirtyInput=!0)}))},rm.imageSubscribe=function(t){t&&t.substring&&dr(this.imageSubscribers,t)},rm.imageUnsubscribe=function(t){t&&t.substring&&fr(this.imageSubscribers,t)},rm.cleanImage=function(){const t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(gr(t,e)&&t>0&&e>0){this.dirtyImage=!1;const i=this.currentCopyStart,n=i[0],s=i[1],r=this.currentCopyDimensions,o=r[0],a=r[1];n+o>t&&(i[0]=t-o),s+a>e&&(i[1]=e-a);const l=this.copyArray;l.length=0,l.push(~~i[0],~~i[1],~~o,~~a)}},rm.cleanCopyStart=function(){const t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(gr(t,e)&&t>0&&e>0){this.dirtyCopyStart=!1,this.cleanPosition(this.currentCopyStart,this.copyStart,[t,e]);const i=this.currentCopyStart,n=i[0],s=i[1];(n<0||n>t)&&(i[0]=n<0?0:t-1),(s<0||s>e)&&(i[1]=s<0?0:e-1),this.dirtyImage=!0}},rm.cleanCopyDimensions=function(){const t=this.sourceNaturalWidth,e=this.sourceNaturalHeight;if(gr(t,e)&&t>0&&e>0){this.dirtyCopyDimensions=!1;const i=this.copyDimensions,n=this.currentCopyDimensions,s=i[0],r=i[1];s.substring?n[0]=parseFloat(s)/100*t:n[0]=s,r.substring?n[1]=parseFloat(r)/100*e:n[1]=r;const o=n[0],a=n[1];(o<=0||o>t)&&(n[0]=o<=0?1:t),(a<=0||a>e)&&(n[1]=a<=0?1:e),this.dirtyImage=!0}},rm.prepareStamp=function(){this.dirtyAsset&&this.cleanAsset(),this.asset&&(this.asset.type===ds?this.checkSpriteFrame(this):this.asset.checkSource?this.asset.checkSource(this.sourceNaturalWidth,this.sourceNaturalHeight):this.dirtyAsset=!0),(this.dirtyDimensions||this.dirtyHandle||this.dirtyScale)&&(this.dirtyPaste=!0),(this.dirtyScale||this.dirtyDimensions||this.dirtyStart||this.dirtyOffset||this.dirtyHandle)&&(this.dirtyPathObject=!0),this.dirtyScale&&this.cleanScale(),this.dirtyDimensions&&this.cleanDimensions(),this.dirtyLock&&this.cleanLock(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyHandle&&this.cleanHandle(),this.dirtyRotation&&this.cleanRotation(),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtyStampHandlePositions&&this.cleanStampHandlePositions(),this.dirtyCopyStart&&this.cleanCopyStart(),this.dirtyCopyDimensions&&this.cleanCopyDimensions(),this.dirtyImage&&this.cleanImage(),this.dirtyPaste&&this.preparePasteObject(),this.dirtyPathObject&&this.cleanPathObject(),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.dirtyImageSubscribers&&this.updateImageSubscribers(),this.prepareStampTabsHelper()},rm.preparePasteObject=function(){this.dirtyPaste=!1;const t=this.currentStampHandlePosition,e=this.currentDimensions,i=this.currentScale,n=-t[0]*i,s=-t[1]*i,r=e[0]*i,o=e[1]*i,a=this.pasteArray;a.length=0,a.push(~~n,~~s,~~r,~~o),this.dirtyPathObject=!0},rm.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject)if(this.pasteArray&&4===this.pasteArray.length||this.preparePasteObject(),4!==this.pasteArray.length)this.dirtyPathObject=!0;else{(this.pathObject=new Path2D).rect(...this.pasteArray)}},rm.draw=function(t){t.stroke(this.pathObject)},rm.fill=function(t){const[e,i,n,s]=this.copyArray;this.source&&n&&s&&t.drawImage(this.source,e,i,n,s,...this.pasteArray)},rm.drawAndFill=function(t){const[e,i,n,s]=this.copyArray,[r,o,a,l]=this.pasteArray;this.source&&n&&s&&(t.stroke(this.pathObject),t.drawImage(this.source,e,i,n,s,r,o,a,l),this.currentHost.clearShadow(),t.stroke(this.pathObject),t.drawImage(this.source,e,i,n,s,r,o,a,l))},rm.fillAndDraw=function(t){const[e,i,n,s]=this.copyArray,[r,o,a,l]=this.pasteArray;this.source&&n&&s&&(t.drawImage(this.source,e,i,n,s,r,o,a,l),t.stroke(this.pathObject),this.currentHost.clearShadow(),t.drawImage(this.source,e,i,n,s,r,o,a,l),t.stroke(this.pathObject)),t.stroke(this.pathObject)},rm.drawThenFill=function(t){const[e,i,n,s]=this.copyArray;this.source&&n&&s&&(t.stroke(this.pathObject),t.drawImage(this.source,e,i,n,s,...this.pasteArray))},rm.fillThenDraw=function(t){const[e,i,n,s]=this.copyArray;this.source&&n&&s&&(t.drawImage(this.source,e,i,n,s,...this.pasteArray),t.stroke(this.pathObject))},rm.checkHitReturn=function(t,e){if(this.checkHitIgnoreTransparency){const i=this.stashedImageData;if(i){const n=4*(e*i.width+t)+3;if(i.data[n])return{x:t,y:e,artefact:this}}return!1}return{x:t,y:e,artefact:this}};const cm=function(t){return!!t&&new Picture(t)};J.Picture=Picture;const Polygon=function(t=tr){return this.shapeInit(t),this},hm=Polygon.prototype=Sr();hm.type="Polygon",hm.lib=ze,hm.isArtefact=!0,hm.isAsset=!1,Co(hm),hd(hm);hm.defs=hr(hm.defs,{sides:0,sideLength:0,radius:0});const um=hm.setters,dm=hm.deltaSetters;um.sides=function(t){this.sides=t,this.updateDirty()},dm.sides=function(t){this.sides+=t,this.updateDirty()},um.sideLength=function(t){this.sideLength=t,this.updateDirty()},dm.sideLength=function(t){this.sideLength+=t,this.updateDirty()},um.radius=function(t){this.radius=t,this.updateDirty()},dm.radius=function(t){this.radius+=t,this.updateDirty()},hm.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makePolygonPath()},hm.makePolygonPath=function(){const t=this.sideLength||this.radius,e=this.sides,i=360/e,n=Jr();let s=0,r=zs;const o=Hh({x:0,y:-t});for(let t=0;t<e;t++)o.rotate(i),s+=o.y,n.push(s),r+=`${o.x.toFixed(1)},${o.y.toFixed(1)} `;Eh(o);const a=gt(...n),l=pt(...n);return r=`m0,${((et(a)+et(l)-t)/2).toFixed(1)}l${r}z`,to(n),r};const fm=function(t){return!!t&&(t.species="polygon",new Polygon(t))};J.Polygon=Polygon;const Polyline=function(t=tr){return this.pins=[],this.currentPins=[],this.controlledLineOffset=qa(),this.shapeInit(t),this},pm=Polyline.prototype=Sr();pm.type=os,pm.lib=ze,pm.isArtefact=!0,pm.isAsset=!1,Co(pm),hd(pm);pm.defs=hr(pm.defs,{pins:null,tension:0,closed:!1,mapToPins:!1,useParticlesAsPins:!1}),pm.packetExclusions=dr(pm.packetExclusions,["controlledLineOffset"]),pm.finalizePacketOut=function(t,e){const i=yt(this.state.saveAsPacket(e))[3];return t=hr(t,i),t=this.handlePacketAnchor(t,e),ft(t).forEach((e=>{if("pins"===e){const e=[];t.pins.forEach((t=>{lr(t)?e.push(t.name):ut(t)?e.push([].concat(t)):e.push(t)})),t.pins=e}})),t};const gm=pm.getters,mm=pm.setters,ym=pm.deltaSetters;gm.pins=function(t){return pr(t)?this.getPinAt(t):this.currentPins.concat()},mm.pins=function(t){if(pr(t)){const e=this.pins;if(ut(t))e.forEach(((t,e)=>this.removePinAt(e))),e.length=0,e.push(...t),this.updateDirty();else if(lr(t)&&pr(t.index)){const i=e[t.index];ut(i)&&(pr(t.x)&&(i[0]=t.x),pr(t.y)&&(i[1]=t.y),this.updateDirty())}}},ym.pins=function(t){if(pr(t)){const e=this.pins;if(lr(t)&&pr(t.index)){const i=e[t.index];ut(i)&&(pr(t.x)&&(i[0]=Ws(i[0],t.x)),pr(t.y)&&(i[1]=Ws(i[1],t.y)),this.updateDirty())}}},mm.tension=function(t){t.toFixed&&(this.tension=t,this.updateDirty())},ym.tension=function(t){t.toFixed&&(this.tension+=t,this.updateDirty())},mm.closed=function(t){this.closed=t,this.updateDirty()},mm.mapToPins=function(t){this.mapToPins=t,this.updateDirty()},mm.flipUpend=function(t){this.flipUpend=t,this.updateDirty()},mm.flipReverse=function(t){this.flipReverse=t,this.updateDirty()},mm.useAsPath=function(t){this.useAsPath=t,this.updateDirty()},mm.pivot=function(t){if(nr(t)&&!t)this.pivot=null,this.lockTo[0]===Ki&&(this.lockTo[0]=Ln),this.lockTo[1]===Ki&&(this.lockTo[1]=Ln),this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0;else{const e=this.pivot,i=t.substring?o[t]:t,n=this.name;i&&i.name&&(e&&e.name!==i.name&&fr(e.pivoted,n),dr(i.pivoted,n),this.pivot=i,this.dirtyStampPositions=!0,this.dirtyStampHandlePositions=!0)}this.updateDirty()},pm.updateDirty=function(){this.dirtySpecies=!0,this.dirtyPathObject=!0,this.dirtyPins=!0},pm.getPinAt=function(t){const e=ct(t);if(this.useAsPath){const t=this.getPathPositionData(this.unitPartials[e]);return[t.x,t.y]}{const t=this.currentPins,i=t[e],[n,s]=this.localBox,[r,o]=i,[a]=t[0],[l,c]=this.localOffset,[h,u]=this.currentStampPosition;let d,f;return this.mapToPins?(d=r-a+n,f=o-a+s):(d=r-l,f=o-c),[h+d,u+f]}},pm.updatePinAt=function(t,e){if(gr(t,e)){e=ct(e);const i=this.pins;if(e<i.length&&e>=0){const n=i[e];lr(n)&&n.pivoted&&fr(n.pivoted,this.name),i[e]=t,this.updateDirty()}}},pm.removePinAt=function(t){t=ct(t);const e=this.pins;if(t<e.length&&t>=0){const i=e[t];lr(i)&&i.pivoted&&fr(i.pivoted,this.name),e[t]=null,this.updateDirty()}},pm.prepareStamp=function(){this.dirtyHost&&(this.dirtyHost=!1),this.useParticlesAsPins&&(this.dirtyPins=!0),(this.dirtyPins||this.dirtyLock)&&(this.dirtySpecies=!0),(this.dirtyScale||this.dirtySpecies||this.dirtyDimensions||this.dirtyStart||this.dirtyHandle)&&(this.dirtyPathObject=!0,(this.dirtyScale||this.dirtySpecies)&&(this.pathCalculatedOnce=!1)),(this.isBeingDragged||this.lockTo.includes(wi)||this.lockTo.includes(zi))&&(this.dirtyStampPositions=!0),this.dirtyScale&&this.cleanScale(),this.dirtyStart&&this.cleanStart(),this.dirtyOffset&&this.cleanOffset(),this.dirtyRotation&&this.cleanRotation(),this.dirtyStampPositions&&this.cleanStampPositions(),this.dirtySpecies&&this.cleanSpecies(),this.dirtyPathObject&&(this.cleanPathObject(),this.updatePathSubscribers()),this.dirtyPositionSubscribers&&this.updatePositionSubscribers(),this.prepareStampTabsHelper()},pm.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makePolylinePath()},pm.getPathParts=function(t,e,i,n,s,r,o){const a=Ot(kt(i-t,2)+kt(n-e,2)),l=Ot(kt(s-i,2)+kt(r-n,2)),c=o*a/(a+l),h=o*l/(a+l);return[i-c*(s-t),n-c*(r-e),i,n,i+h*(s-t),n+h*(r-e)]},pm.buildLine=function(t,e,i){let n=`${js}l`;for(let s=2;s<i.length;s+=6)n+=`${Ks(i[s]-t)},${Ks(i[s+1]-e)} `,t=i[s],e=i[s+1];return n},pm.buildCurve=function(t,e,i){let n=`${js}c`,s=0;for(let r=0;r<i.length;r+=2)n+=`${Ks(i[r]-t)},${Ks(i[r+1]-e)} `,s++,s>2&&(t=i[r],e=i[r+1],s=0);return n},pm.cleanCoordinate=function(t,e){return t.toFixed?t:t===pi||t===vs?0:t===vn||t===oe?e:t===le?e/2:parseFloat(t)/100*e},pm.cleanPinsArray=function(){this.dirtyPins=!1;const t=this.pins,e=this.currentPins;if(e.length=0,this.useParticlesAsPins)t.forEach(((i,n)=>{let s;i&&i.substring?(s=P[i],s&&(t[n]=s)):s=i;const r=!(!s||!s.position)&&s.position;r&&e.push([r.x,r.y])})),e.length||(this.dirtyPins=!0);else{const i=this.getHost(),n=this.cleanCoordinate;let s,r,a,l=1,c=1;i&&(a=i.currentDimensions,a&&([l,c]=a)),t.forEach(((i,a)=>{let h;if(i&&i.substring?(h=o[i],t[a]=h):h=i,h)if(ut(h))[s,r]=h,e.push([n(s,l),n(r,c)]);else if(lr(h)&&h.currentStart){const t=this.name;h.pivoted.includes(t)||dr(h.pivoted,t),e.push([...h.currentStampPosition])}}))}if(e.length){let t=e[0][0],i=e[0][1];e.forEach((e=>{e[0]<t&&(t=e[0]),e[1]<i&&(i=e[1])})),this.localOffset=[t,i],this.updatePivotSubscribers()}},pm.makePolylinePath=function(){const t=this.getPathParts,e=this.buildLine,i=this.buildCurve,n=this.currentPins,s=this.tension,r=this.closed;if(this.dirtyPins&&this.cleanPinsArray(),n.length){const o=n.length,a=n[0],l=n[o-1],c=Jr();let h,u=js;if(r){const r=Jr();for(r.push(...t(...l,...a,...n[1],s)),h=0;h<o-2;h++)c.push(...t(...n[h],...n[h+1],...n[h+2],s));c.push(...t(...n[o-2],...l,...a,s)),c.unshift(r[4],r[5]),c.push(r[0],r[1],r[2],r[3]),u=s?i(a[0],a[1],c)+"z":e(a[0],a[1],c)+"z",to(r)}else{for(c.push(a[0],a[1]),h=0;h<o-2;h++)c.push(...t(...n[h],...n[h+1],...n[h+2],s));c.push(l[0],l[1],l[0],l[1]),u=s?i(a[0],a[1],c):e(a[0],a[1],c)}return to(c),u}return js},pm.calculateLocalPathAdditionalActions=function(){const[t,e]=this.localBox,i=this.pathDefinition;this.mapToPins?this.set({start:this.currentPins[0]}):this.pathDefinition=i.replace(js,`m${-t},${-e}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)},pm.updatePathSubscribers=function(){this.pathed.forEach((t=>{const e=o[t];e&&(e.dirtyStart=!0)}))};const bm=function(t){return!!t&&(t.species="polyline",new Polyline(t))};J.Polyline=Polyline;const Quadratic=function(t=tr){return this.control=qa(),this.currentControl=qa(),this.controlLockTo="coord",this.curveInit(t),this.shapeInit(t),this.dirtyControl=!0,this},Sm=Quadratic.prototype=Sr();Sm.type=as,Sm.lib=ze,Sm.isArtefact=!0,Sm.isAsset=!1,Co(Sm),hd(Sm),dd(Sm);const km={control:null,controlPivot:zs,controlPivotCorner:zs,controlPivotIndex:-1,addControlPivotHandle:!1,addControlPivotOffset:!1,controlPath:zs,controlPathPosition:0,addControlPathHandle:!1,addControlPathOffset:!0,controlParticle:zs,controlLockTo:zs};Sm.defs=hr(Sm.defs,km),Sm.packetCoordinates=dr(Sm.packetCoordinates,["control"]),Sm.packetObjects=dr(Sm.packetObjects,["controlPivot","controlPath"]);const Cm=Sm.getters,Am=Sm.setters,vm=Sm.deltaSetters;Am.controlPivot=function(t){this.setControlHelper(t,"controlPivot",Se),this.updateDirty(),this.dirtyControl=!0},Am.controlParticle=function(t){this.setControlHelper(t,"controlParticle",Se),this.updateDirty(),this.dirtyControl=!0},Am.controlPath=function(t){this.setControlHelper(t,"controlPath",Se),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Am.controlPathPosition=function(t){this.controlPathPosition=t,this.dirtyControl=!0,this.currentControlPathData=!1,this.dirtyFilterIdentifier=!0},vm.controlPathPosition=function(t){this.controlPathPosition+=t,this.dirtyControl=!0,this.currentControlPathData=!1,this.dirtyFilterIdentifier=!0},Cm.controlPositionX=function(){return this.currentControl[0]},Cm.controlPositionY=function(){return this.currentControl[1]},Cm.controlPosition=function(){return[].concat(this.currentControl)},Am.controlX=function(t){null!=t&&(this.control[0]=t,this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1)},Am.controlY=function(t){null!=t&&(this.control[1]=t,this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1)},Am.control=function(t,e){this.setCoordinateHelper(Se,t,e),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},vm.controlX=function(t){const e=this.control;e[0]=Ws(e[0],t),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},vm.controlY=function(t){const e=this.control;e[1]=Ws(e[1],t),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},vm.control=function(t,e){this.setDeltaCoordinateHelper(Se,t,e),this.updateDirty(),this.dirtyControl=!0,this.currentControlPathData=!1},Am.controlLockTo=function(t){this.controlLockTo=t,this.updateDirty(),this.dirtyControlLock=!0,this.currentControlPathData=!1},Sm.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeQuadraticPath()},Sm.makeQuadraticPath=function(){const[t,e]=this.currentStampPosition,[i,n]=this.currentControl,[s,r]=this.currentEnd;return`${js}q${(i-t).toFixed(2)},${(n-e).toFixed(2)} ${(s-t).toFixed(2)},${(r-e).toFixed(2)}`},Sm.cleanDimensions=function(){this.dirtyDimensions=!1,this.dirtyHandle=!0,this.dirtyOffset=!0,this.dirtyStart=!0,this.dirtyControl=!0,this.dirtyEnd=!0,this.dirtyFilterIdentifier=!0},Sm.preparePinsForStamp=function(){const t=this.dirtyPins,e=this.endPivot,i=this.endPath,n=this.controlPivot,s=this.controlPath;for(let r,o=0,a=t.length;o<a;o++)r=t[o],(n&&n.name===r||s&&s.name===r)&&(this.dirtyControl=!0,this.controlLockTo.includes(Ni)&&(this.currentControlPathData=!1)),(e&&e.name===r||i&&i.name===r)&&(this.dirtyEnd=!0,this.endLockTo.includes(Ni)&&(this.currentEndPathData=!1));t.length=0};const Pm=function(t=tr){return!!t&&(t.species=an,new Quadratic(t))};J.Quadratic=Quadratic;const RadialGradient=function(t=tr){return this.currentStartRadius=0,this.currentEndRadius=0,this.stylesInit(t),this},xm=RadialGradient.prototype=Sr();xm.type="RadialGradient",xm.lib=jn,xm.isArtefact=!1,xm.isAsset=!1,Co(xm),Rd(xm);xm.defs=hr(xm.defs,{startRadius:0,endRadius:0}),xm.packetObjects=dr(xm.packetObjects,["palette"]);const Om=xm.getters,wm=xm.setters,Dm=xm.deltaSetters;Om.startRadius=function(){return this.currentStartRadius},Om.endRadius=function(){return this.currentEndRadius},wm.startRadius=function(t){this.startRadius=t,this.dirtyStyle=!0},wm.endRadius=function(t){this.endRadius=t,this.dirtyStyle=!0},Dm.startRadius=function(t){this.startRadius=Ws(this.startRadius,t),this.dirtyStyle=!0},Dm.endRadius=function(t){this.endRadius=Ws(this.endRadius,t),this.dirtyStyle=!0},xm.cleanRadius=function(t){const e=(t,e)=>{if(ar(t))return t;switch(t){case vs:case pi:return 0;case oe:case vn:return e;case le:return e/2;default:return t=parseFloat(t),ar(t)?t/100*e:0}};this.currentStartRadius=t?e(this.startRadius,t):this.defs.startRadius,this.currentEndRadius=t?e(this.endRadius,t):this.defs.endRadius},xm.buildStyle=function(t){if(t){const e=t.engine;if(e){const t=e.createRadialGradient(...this.gradientArgs);return this.addStopsToGradient(t,this.paletteStart,this.paletteEnd,this.cyclePalette)}}return Jt},xm.updateGradientArgs=function(t,e){const i=this.gradientArgs,n=this.currentStart,s=this.currentEnd,r=this.currentStartRadius;let o=this.currentEndRadius;const a=n[0]+t,l=n[1]+e,c=s[0]+t,h=s[1]+e;a===c&&l===h&&r===o&&o++,i.length=0,i.push(a,l,r,c,h,o)};const Fm=function(t){return!!t&&new RadialGradient(t)};J.RadialGradient=RadialGradient;const RawAsset=function(t=tr){this.makeName(t.name),this.register(),this.subscribers=[],this.set(this.defs),this.updateSource=qs;const e=t.keytypes||{};t.userAttributes&&t.userAttributes.forEach((t=>{this.addAttribute(t),t.type&&(e[t.key]=t.type)})),this.initializeAttributes(e),this.set(t);const i=document.createElement(ae);return i.width=0,i.height=0,this.element=i,this.engine=i.getContext(Ht,{willReadFrequently:!0}),t.subscribe&&this.subscribers.push(t.subscribe),this},Rm=RawAsset.prototype=Sr();Rm.type=cs,Rm.lib=Vt,Rm.isArtefact=!1,Rm.isAsset=!0,Co(Rm),uc(Rm);Rm.defs=hr(Rm.defs,{keytypes:null,data:null,updateSource:null}),Rm.saveAsPacket=function(){return[this.name,this.type,this.lib,{}]},Rm.stringifyFunction=qs,Rm.processPacketOut=qs,Rm.finalizePacketOut=qs,Rm.clone=Js;const Tm=Rm.getters,Hm=Rm.setters,Em=Rm.deltaSetters;Hm.source=qs,Hm.element=qs,Hm.engine=qs,Hm.data=function(t){t&&(this.data=t,this.dirtyData=!0)},Hm.updateSource=function(t){t&&or(t)&&(this.updateSource=t,this.dirtyData=!0)},Rm.checkSource=function(t,e){this.source||(this.source=this.element);const i=this.source;if(i){let n=!1;this.dirtyData&&(this.dirtyData=!1,this.updateSource(this),n=!0),this.sourceLoaded=!0,this.sourceNaturalWidth&&this.sourceNaturalHeight&&this.sourceNaturalWidth===t&&this.sourceNaturalHeight===e||(this.sourceNaturalWidth=i.width,this.sourceNaturalHeight=i.height,n=!0),n&&this.sourceNaturalWidth&&this.sourceNaturalHeight&&this.notifySubscribers()}else this.sourceLoaded=!1},Rm.subscribeAction=function(t={}){this.subscribers.push(t),t.asset=this,t.source=this.element,this.notifySubscriber(t)},Rm.addAttribute=function(t=tr){const{key:e,defaultValue:i,setter:n,deltaSetter:s,getter:r}=t;return e&&e.substring&&(this.defs[e]=pr(i)?i:null,this[e]=pr(i)?i:null,or(n)&&(Hm[e]=n),or(s)&&(Em[e]=s),or(r)&&(Tm[e]=r)),this},Rm.removeAttribute=function(t){return t&&t.substring&&(delete this.defs[t],delete this[t],delete Tm[t],delete Hm[t],delete Em[t]),this},Rm.initializeAttributes=function(t){for(const[e,i]of lt(t))switch(i){case ls:this[e]=Yh();break;case gs:this[e]=Ih();break;case _n:this[e]=qa()}};const Im=function(t){return!!t&&new RawAsset(t)};J.RawAsset=RawAsset;const Bm=["random","entity"],RdAsset=function(t=tr){return this.makeName(t.name),this.register(),this.installElement(this.name),this.subscribers=[],this.set(this.defs),this.currentSource=null,this.initialSettingEntity=null,this.set(t),t.subscribe&&this.subscribers.push(t.subscribe),this.currentGeneration=0,this.dataArrays=[],this.dirtyScene=!0,this.dirtyOutput=!0,this},Lm=RdAsset.prototype=Sr();Lm.type=hs,Lm.lib=Vt,Lm.isArtefact=!1,Lm.isAsset=!0,Co(Lm),uc(Lm),yg(Lm),kh(Lm);const $m={width:300,height:150,diffusionRateA:.2097,diffusionRateB:.105,feedRate:.054,killRate:.062,initialSettingPreference:un,randomEngineSeed:we,initialRandomSeedLevel:.0045,initialSettingEntity:null,drawEvery:10,maxGenerations:4e3};Lm.defs=hr(Lm.defs,$m),delete Lm.defs.source,delete Lm.defs.sourceLoaded,Lm.stringifyFunction=qs,Lm.processPacketOut=qs,Lm.finalizePacketOut=qs,Lm.saveAsPacket=function(){return`[${this.name}, ${this.type}, ${this.lib}, {}]`},Lm.clone=Js;const Mm=Lm.setters,Xm=Lm.getters;Mm.subscribers=qs,Mm.width=function(t){t.toFixed&&(this.width=t,this.sourceNaturalWidth=t,this.dirtyScene=!0)},Mm.height=function(t){t.toFixed&&(this.height=t,this.sourceNaturalHeight=t,this.dirtyScene=!0)},Mm.initialRandomSeedLevel=function(t){t.toFixed&&(this.initialRandomSeedLevel=t,this.dirtyScene=!0)},Mm.diffusionRateA=function(t){t.toFixed&&(this.diffusionRateA=t,this.dirtyScene=!0)},Mm.diffusionRateB=function(t){t.toFixed&&(this.diffusionRateB=t,this.dirtyScene=!0)},Mm.feedRate=function(t){t.toFixed&&(this.feedRate=t,this.dirtyScene=!0)},Mm.killRate=function(t){t.toFixed&&(this.killRate=t,this.dirtyScene=!0)},Mm.drawEvery=function(t){t.toFixed&&(this.drawEvery=t,this.dirtyScene=!0)},Mm.maxGenerations=function(t){t.toFixed&&(this.maxGenerations=t,this.dirtyScene=!0)},Mm.initialSettingPreference=function(t){t.substring&&Bm.includes(t)&&(this.initialSettingPreference=t,this.dirtyScene=!0)},Mm.randomEngineSeed=function(t){t.substring&&(this.randomEngineSeed=t,this.dirtyScene=!0)},Mm.initialSettingEntity=function(t){t&&(t.substring||(t=t.name||zs),t&&(this.initialSettingEntity=t,this.dirtyScene=!0))},Xm.generation=function(){return this.currentGeneration},Mm.preset=function(t){if(t.substring){switch(t){case"negativeBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.098,this.killRate=.0555,this.maxGenerations=4e3,this.initialRandomSeedLevel=.05;break;case"positiveBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.098,this.killRate=.057,this.maxGenerations=4e3,this.initialRandomSeedLevel=.1;break;case"precriticalBubbles":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.082,this.killRate=.059,this.maxGenerations=4e3,this.initialRandomSeedLevel=.08;break;case"wormsAndLoops":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.082,this.killRate=.06,this.maxGenerations=4e3,this.initialRandomSeedLevel=.08;break;case"stableSolitons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.074,this.killRate=.064,this.maxGenerations=4e3,this.initialRandomSeedLevel=.15;break;case"uSkateWorld":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.062,this.killRate=.0609,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"worms":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.058,this.killRate=.065,this.maxGenerations=4e3,this.initialRandomSeedLevel=.1;break;case"wormsJoinIntoMazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.046,this.killRate=.063,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"negatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.046,this.killRate=.0594,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"turingPatterns":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.042,this.killRate=.059,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"chaosToTuringNegatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.039,this.killRate=.058,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"fingerprints":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.037,this.killRate=.06,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"chaosWithNegatons":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.0353,this.killRate=.0566,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"spotsAndWorms":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.034,this.killRate=.0618,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"selfReplicatingSpots":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.03,this.killRate=.063,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"superResonantMazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.03,this.killRate=.0565,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"mazes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.029,this.killRate=.057,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045;break;case"mazesWithSomeChaos":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.026,this.killRate=.055,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"chaos":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.026,this.killRate=.051,this.maxGenerations=0,this.initialRandomSeedLevel=.009;break;case"warringMicrobes":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.022,this.killRate=.059,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"spotsAndLoops":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.018,this.killRate=.051,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"movingSpots":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.014,this.killRate=.054,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;case"waves":this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.014,this.killRate=.045,this.maxGenerations=0,this.initialRandomSeedLevel=.0045;break;default:this.diffusionRateA=.2097,this.diffusionRateB=.105,this.feedRate=.054,this.killRate=.062,this.maxGenerations=4e3,this.initialRandomSeedLevel=.0045}this.dirtyScene=!0}},Lm.update=function(){this.dirtyOutput=!0},Lm.cleanOutput=function(t=0){if(this.dirtyScene&&this.cleanScene(),!this.dirtyScene){const{dataArrays:e,diffusionRateA:i,diffusionRateB:n,feedRate:s,killRate:r,currentSource:o,drawEvery:a,maxGenerations:l,currentGeneration:c}=this;let h,u,d,f,p,g,m,y,b,S;if(!l||c<l)if(o?[u,h,f,d]=e:[h,u,d,f]=e,t<a){for(m=0,y=h.length;m<y;m++)p=h[m],g=d[m],b=p+i*this.calculateLaplacian(m,h)-p*g*g+s*(1-p),S=g+n*this.calculateLaplacian(m,d)+p*g*g-(r+s)*g,u[m]=Us(b,0,1),f[m]=Us(S,0,1);this.currentSource=o?0:1,this.currentGeneration=c+1,this.cleanOutput(t+1)}else this.paintCanvas();else this.dirtyOutput&&this.paintCanvas()}},Lm.cleanScene=function(){const{element:t,width:e,height:i,dataArrays:n,initialRandomSeedLevel:s,initialSettingPreference:r,randomEngineSeed:o,initialSettingEntity:a}=this;if(e&&i&&this.dirtyScene){this.dirtyScene=!1,t.width=e,t.height=i;const l=e*i;n.length=0;for(let t=0;t<4;t++)n.push(new Float64Array(l));this.currentSource=0;const[c,h,u,d]=n;if(c.fill(1),h.fill(1),u.fill(0),d.fill(0),ze===r&&m[a]){const t=m[a],n=Va(),{engine:s,element:r}=n;r.width=e,r.height=i,t.simpleStamp(n,{fillStyle:Ys,strokeStyle:Ys});const o=s.getImageData(0,0,e,i).data;let l=0;for(let t=3,e=o.length;t<e;t+=4)u[l]=o[t]/255,l++;Wa(n)}else{const t=xa(o);for(let e=0;e<l;e++)u[e]=t.random()<s?1:0}this.currentGeneration=0}},Lm.calculateLaplacian=function(t,e){const i=this.width,n=ct(t/i),s=this.checkRow(n-1)*i,r=this.checkRow(n+1)*i,o=n*i,a=t-o,l=this.checkCol(a-1),c=this.checkCol(a+1);let h,u=0;return u+=-1*e[t],h=s+l,u+=.05*e[h],h=s+c,u+=.05*e[h],h=r+l,u+=.05*e[h],h=r+c,u+=.05*e[h],h=s+a,u+=.2*e[h],h=o+c,u+=.2*e[h],h=o+l,u+=.2*e[h],h=r+a,u+=.2*e[h],u},Lm.checkRow=function(t){const e=this.height;return t<0?e-1:t>=e?0:t},Lm.checkCol=function(t){const e=this.width;return t<0?e-1:t>=e?0:t},Lm.checkOutputValuesExist=function(){return!!this.dataArrays.length},Lm.getOutputValue=function(t){let e,i;const{dataArrays:n,currentSource:s}=this;return s?[e,,i]=n:[,e,,i]=n,(e[t]-i[t]+1)/2};const Ym=function(t){return!!t&&new RdAsset(t)};J.RdAsset=RdAsset;const Gm=["radiusTLX","radiusTRX","radiusBRX","radiusBLX","radiusTLY","radiusTRY","radiusBRY","radiusBLY"],jm=["radiusBRX","radiusBRY","radiusBLX","radiusBLY"],zm=["radiusBLX","radiusBLY"],Nm=["radiusBLX"],Vm=["radiusBLY"],Wm=["radiusBRX","radiusBRY"],Um=["radiusBRX"],Zm=["radiusBRY"],_m=["radiusBRX","radiusBLX"],Km=["radiusBRY","radiusBLY"],qm=["radiusTLX","radiusTLY","radiusBLX","radiusBLY"],Qm=["radiusTLX","radiusBLX"],Jm=["radiusTLY","radiusBLY"],ty=["radiusTRX","radiusTRY","radiusBRX","radiusBRY"],ey=["radiusTRX","radiusBRX"],iy=["radiusTRY","radiusBRY"],ny=["radiusTLX","radiusTLY","radiusTRX","radiusTRY"],sy=["radiusTLX","radiusTLY"],ry=["radiusTLX"],oy=["radiusTLY"],ay=["radiusTRX","radiusTRY"],ly=["radiusTRX"],cy=["radiusTRY"],hy=["radiusTLX","radiusTRX"],uy=["radiusTLY","radiusTRY"],dy=["radiusTLX","radiusTRX","radiusBRX","radiusBLX"],fy=["radiusTLY","radiusTRY","radiusBRY","radiusBLY"],Rectangle=function(t=tr){return this.shapeInit(t),this.currentRectangleWidth=1,this.currentRectangleHeight=1,this},py=Rectangle.prototype=Sr();py.type="Rectangle",py.lib=ze,py.isArtefact=!0,py.isAsset=!1,Co(py),hd(py);py.defs=hr(py.defs,{rectangleWidth:10,rectangleHeight:10,radiusTLX:0,radiusTLY:0,radiusTRX:0,radiusTRY:0,radiusBRX:0,radiusBRY:0,radiusBLX:0,radiusBLY:0,offshootA:.55,offshootB:0});const gy=py.setters,my=py.deltaSetters;gy.radius=function(t){this.setRectHelper(t,Gm)},gy.radiusX=function(t){this.setRectHelper(t,dy)},gy.radiusY=function(t){this.setRectHelper(t,fy)},gy.radiusT=function(t){this.setRectHelper(t,ny)},gy.radiusB=function(t){this.setRectHelper(t,jm)},gy.radiusL=function(t){this.setRectHelper(t,qm)},gy.radiusR=function(t){this.setRectHelper(t,ty)},gy.radiusTX=function(t){this.setRectHelper(t,hy)},gy.radiusBX=function(t){this.setRectHelper(t,_m)},gy.radiusLX=function(t){this.setRectHelper(t,Qm)},gy.radiusRX=function(t){this.setRectHelper(t,ey)},gy.radiusTY=function(t){this.setRectHelper(t,uy)},gy.radiusBY=function(t){this.setRectHelper(t,Km)},gy.radiusLY=function(t){this.setRectHelper(t,Jm)},gy.radiusRY=function(t){this.setRectHelper(t,iy)},gy.radiusTL=function(t){this.setRectHelper(t,sy)},gy.radiusTR=function(t){this.setRectHelper(t,ay)},gy.radiusBL=function(t){this.setRectHelper(t,zm)},gy.radiusBR=function(t){this.setRectHelper(t,Wm)},gy.radiusTLX=function(t){this.setRectHelper(t,ry)},gy.radiusTLY=function(t){this.setRectHelper(t,oy)},gy.radiusTRX=function(t){this.setRectHelper(t,ly)},gy.radiusTRY=function(t){this.setRectHelper(t,cy)},gy.radiusBRX=function(t){this.setRectHelper(t,Um)},gy.radiusBRY=function(t){this.setRectHelper(t,Zm)},gy.radiusBLX=function(t){this.setRectHelper(t,Nm)},gy.radiusBLY=function(t){this.setRectHelper(t,Vm)},my.radius=function(t){this.deltaRectHelper(t,Gm)},my.radiusX=function(t){this.deltaRectHelper(t,dy)},my.radiusY=function(t){this.deltaRectHelper(t,fy)},my.radiusT=function(t){this.deltaRectHelper(t,ny)},my.radiusB=function(t){this.deltaRectHelper(t,jm)},my.radiusL=function(t){this.deltaRectHelper(t,qm)},my.radiusR=function(t){this.deltaRectHelper(t,ty)},my.radiusTX=function(t){this.deltaRectHelper(t,hy)},my.radiusBX=function(t){this.deltaRectHelper(t,_m)},my.radiusLX=function(t){this.deltaRectHelper(t,Qm)},my.radiusRX=function(t){this.deltaRectHelper(t,ey)},my.radiusTY=function(t){this.deltaRectHelper(t,uy)},my.radiusBY=function(t){this.deltaRectHelper(t,Km)},my.radiusLY=function(t){this.deltaRectHelper(t,Jm)},my.radiusRY=function(t){this.deltaRectHelper(t,iy)},my.radiusTL=function(t){this.deltaRectHelper(t,sy)},my.radiusTR=function(t){this.deltaRectHelper(t,ay)},my.radiusBL=function(t){this.deltaRectHelper(t,zm)},my.radiusBR=function(t){this.deltaRectHelper(t,Wm)},my.radiusTLX=function(t){this.deltaRectHelper(t,ry)},my.radiusTLY=function(t){this.deltaRectHelper(t,oy)},my.radiusTRX=function(t){this.deltaRectHelper(t,ly)},my.radiusTRY=function(t){this.deltaRectHelper(t,cy)},my.radiusBRX=function(t){this.deltaRectHelper(t,Um)},my.radiusBRY=function(t){this.deltaRectHelper(t,Zm)},my.radiusBLX=function(t){this.deltaRectHelper(t,Nm)},my.radiusBLY=function(t){this.deltaRectHelper(t,Vm)},gy.offshootA=function(t){this.offshootA=t,this.updateDirty()},gy.offshootB=function(t){this.offshootB=t,this.updateDirty()},my.offshootA=function(t){t.toFixed&&(this.offshootA+=t,this.updateDirty())},my.offshootB=function(t){t.toFixed&&(this.offshootB+=t,this.updateDirty())},gy.rectangleWidth=function(t){null!=t&&(this.rectangleWidth=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},gy.rectangleHeight=function(t){null!=t&&(this.rectangleHeight=t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0)},my.rectangleWidth=function(t){this.rectangleWidth=Ws(this.rectangleWidth,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},my.rectangleHeight=function(t){this.rectangleHeight=Ws(this.rectangleHeight,t),this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},py.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},py.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=Ws(this[e],t)}),this)},py.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeRectanglePath()},py.cleanDimensions=function(){this.dirtyDimensions=!1;const t=this.getHost();if(t){const e=t.currentDimensions?t.currentDimensions:[t.w,t.h],i=this.currentRectangleWidth||1,n=this.currentRectangleHeight||1;let s=this.rectangleWidth,r=this.rectangleHeight;s.substring&&(s=parseFloat(s)/100*e[0]),r.substring&&(r=parseFloat(r)/100*e[1]);const o=this.mimic;let a;o&&o.name&&this.useMimicDimensions&&(a=o.currentDimensions),a?(this.currentRectangleWidth=this.addOwnDimensionsToMimic?a[0]+s:a[0],this.currentRectangleHeight=this.addOwnDimensionsToMimic?a[1]+r:a[1]):(this.currentRectangleWidth=s,this.currentRectangleHeight=r),this.currentDimensions[0]=this.currentRectangleWidth,this.currentDimensions[1]=this.currentRectangleHeight,this.dirtyStart=!0,this.dirtyHandle=!0,this.dirtyOffset=!0,i===this.currentRectangleWidth&&n===this.currentRectangleHeight||(this.dirtyPositionSubscribers=!0),this.mimicked&&this.mimicked.length&&(this.dirtyMimicDimensions=!0)}else this.dirtyDimensions=!0},py.makeRectanglePath=function(){this.dirtyDimensions&&this.cleanDimensions();const t=this.currentRectangleWidth,e=this.currentRectangleHeight,i=this.offshootA,n=this.offshootB;let s=this.radiusTLX,r=this.radiusTLY,o=this.radiusTRX,a=this.radiusTRY,l=this.radiusBRX,c=this.radiusBRY,h=this.radiusBLX,u=this.radiusBLY;(s.substring||r.substring||o.substring||a.substring||l.substring||c.substring||h.substring||u.substring)&&(s=s.substring?parseFloat(s)/100*t:s,r=r.substring?parseFloat(r)/100*e:r,o=o.substring?parseFloat(o)/100*t:o,a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*t:l,c=c.substring?parseFloat(c)/100*e:c,h=h.substring?parseFloat(h)/100*t:h,u=u.substring?parseFloat(u)/100*e:u);let d=js;return t-s-o!=0&&(d+="h"+(t-s-o)),o+a!==0&&(d+=`c${o*i},${a*n} ${o-o*n},${a-a*i}, ${o},${a}`),e-a-c!=0&&(d+="v"+(e-a-c)),l+c!==0&&(d+=`c${-l*n},${c*i} ${l*i-l},${c-c*n} ${-l},${c}`),-t+h+l!==0&&(d+=`h${-t+h+l}`),h+u!==0&&(d+=`c${-h*i},${-u*n} ${h*n-h},${u*i-u} ${-h},${-u}`),-e+r+u!==0&&(d+=`v${-e+r+u}`),s+r!==0&&(d+=`c${s*n},${-r*i} ${s-s*i},${r*n-r} ${s},${-r}`),d+="z",d},py.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(js,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const yy=function(t){return!!t&&(t.species=pn,new Rectangle(t))};J.Rectangle=Rectangle;const Shape=function(t=tr){return this.shapeInit(t),this},by=Shape.prototype=Sr();by.type="Shape",by.lib=ze,by.isArtefact=!0,by.isAsset=!1,Co(by),hd(by),by.cleanSpecies=function(){this.dirtySpecies=!1},by.cleanStampHandlePositionsAdditionalActions=function(){const t=this.localBox,e=this.currentStampHandlePosition;e[0]+=t[0],e[1]+=t[1]};const Sy=function(t){return!!t&&new Shape(t)};J.Shape=Shape;const ky=[[.043,0,.082,-.035,.088,-.088],[.007,-.057,-.024,-.121,-.088,-.162],[-.07,-.045,-.169,-.054,-.265,-.015],[-.106,.043,-.194,.138,-.235,.265],[-.044,.139,-.026,.3,.058,.442],[.091,.153,.25,.267,.442,.308],[.206,.044,.431,-.001,.619,-.131],[.2,-.139,.34,-.361,.381,-.619]],Cy=[[0,-.27,-.11,-.52,-.29,-.71],[-.19,-.19,-.44,-.29,-.71,-.29],[-.27,0,-.52,.11,-.71,.29],[-.19,.19,-.29,.44,-.29,.71],[0,.27,.11,.52,.29,.71],[.19,.19,.44,.29,.71,.29],[.27,0,.52,-.11,.71,-.29],[.19,-.19,.29,-.44,.29,-.71]],Spiral=function(t=tr){return this.shapeInit(t),this},Ay=Spiral.prototype=Sr();Ay.type="Spiral",Ay.lib=ze,Ay.isArtefact=!0,Ay.isAsset=!1,Co(Ay),hd(Ay);Ay.defs=hr(Ay.defs,{loops:1,loopIncrement:1,drawFromLoop:0});const vy=Ay.setters,Py=Ay.deltaSetters;vy.loops=function(t){this.loops=t,this.updateDirty()},Py.loops=function(t){this.loops+=t,this.updateDirty()},vy.loopIncrement=function(t){this.loopIncrement=t,this.updateDirty()},Py.loopIncrement=function(t){this.loopIncrement+=t,this.updateDirty()},vy.drawFromLoop=function(t){this.drawFromLoop=ct(t),this.updateDirty()},Py.drawFromLoop=function(t){this.drawFromLoop=ct(this.drawFromLoop+t),this.updateDirty()},Ay.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeSpiralPath()},Ay.makeSpiralPath=function(){const t=ct(this.loops),e=this.loopIncrement,i=ct(this.drawFromLoop),n=Jr();let s,r,o,a,l,c,h,u,d,f,p,g;for(let t=0,i=ky.length;t<i;t++)[s,r,o,a,l,c]=ky[t],n.push([s*e,r*e,o*e,a*e,l*e,c*e]);let m=js;for(let y=0;y<t;y++)for(let t=0,b=n.length;t<b;t++)[s,r,o,a,l,c]=n[t],y>=i&&(m+=`c${s},${r} ${o},${a} ${l},${c}`),[h,u,d,f,p,g]=Cy[t],n[t]=[s+h*e,r+u*e,o+d*e,a+f*e,l+p*e,c+g*e];return to(n),m},Ay.calculateLocalPathAdditionalActions=function(){const[t,e]=this.localBox,i=this.scale;this.pathDefinition=this.pathDefinition.replace(js,`m${-t/i},${-e/i}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const xy=function(t){return!!t&&(t.species="spiral",new Spiral(t))};J.Spiral=Spiral;const Star=function(t=tr){return this.shapeInit(t),this},Oy=Star.prototype=Sr();Oy.type="Star",Oy.lib=ze,Oy.isArtefact=!0,Oy.isAsset=!1,Co(Oy),hd(Oy);Oy.defs=hr(Oy.defs,{radius1:0,radius2:0,points:0,twist:0});const wy=Oy.setters,Dy=Oy.deltaSetters;wy.radius1=function(t){this.radius1=t,this.updateDirty()},Dy.radius1=function(t){this.radius1+=t,this.updateDirty()},wy.radius2=function(t){this.radius2=t,this.updateDirty()},Dy.radius2=function(t){this.radius2+=t,this.updateDirty()},wy.points=function(t){this.points=t,this.updateDirty()},Dy.points=function(t){this.points+=t,this.updateDirty()},wy.twist=function(t){this.twist=t,this.updateDirty()},Dy.twist=function(t){this.twist+=t,this.updateDirty()},Oy.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeStarPath()},Oy.makeStarPath=function(){const t=this.points,e=this.twist,i=360/t;let n,s,r,o,a=this.radius1,l=this.radius2,c=zs;if(a.substring||l.substring){const t=this.getHost();if(t){const e=t.currentDimensions[0];a=a.substring?parseFloat(a)/100*e:a,l=l.substring?parseFloat(l)/100*e:l}}const h=Hh({x:0,y:-a}),u=Hh({x:0,y:-l});n=h.x,s=h.y,u.rotate(-i/2),u.rotate(e);for(let e=0;e<t;e++)u.rotate(i),r=parseFloat((u.x-n).toFixed(1)),n+=r,o=parseFloat((u.y-s).toFixed(1)),s+=o,c+=`${r},${o} `,h.rotate(i),r=parseFloat((h.x-n).toFixed(1)),n+=r,o=parseFloat((h.y-s).toFixed(1)),s+=o,c+=`${r},${o} `;return Eh(h,u),`${js}l${c}z`},Oy.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(js,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Fy=function(t){return!!t&&(t.species="star",new Star(t))};J.Star=Star;const Tetragon=function(t=tr){return this.shapeInit(t),this},Ry=Tetragon.prototype=Sr();Ry.type="Tetragon",Ry.lib=ze,Ry.isArtefact=!0,Ry.isAsset=!1,Co(Ry),hd(Ry);Ry.defs=hr(Ry.defs,{radiusX:5,radiusY:5,intersectX:.5,intersectY:.5});const Ty=Ry.setters,Hy=Ry.deltaSetters;Ty.radius=function(t){this.setRectHelper(t,cn)},Ty.radiusX=function(t){this.setRectHelper(t,ln)},Ty.radiusY=function(t){this.setRectHelper(t,hn)},Hy.radius=function(t){this.deltaRectHelper(t,cn)},Hy.radiusX=function(t){this.deltaRectHelper(t,ln)},Hy.radiusY=function(t){this.deltaRectHelper(t,hn)},Ty.intersectX=function(t){t.toFixed&&(this.intersectX=t,this.updateDirty())},Ty.intersectY=function(t){t.toFixed&&(this.intersectY=t,this.updateDirty())},Hy.intersectX=function(t){t.toFixed&&(this.intersectX+=t,this.updateDirty())},Hy.intersectY=function(t){t.toFixed&&(this.intersectY+=t,this.updateDirty())},Ry.setRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=t}),this)},Ry.deltaRectHelper=function(t,e){this.updateDirty(),e.forEach((e=>{this[e]=Ws(this[e],t)}),this)},Ry.cleanSpecies=function(){this.dirtySpecies=!1,this.pathDefinition=this.makeTetragonPath()},Ry.makeTetragonPath=function(){const t=this.radiusX,e=this.radiusY;let i,n;if(t.substring||e.substring){const s=this.getHost();if(s){const[r,o]=s.currentDimensions;i=2*(t.substring?parseFloat(t)/100*r:t),n=2*(e.substring?parseFloat(e)/100*o:e)}}else i=2*t,n=2*e;const s=parseFloat((i*this.intersectX).toFixed(2)),r=parseFloat((i-s).toFixed(2)),o=parseFloat((n*this.intersectY).toFixed(2)),a=parseFloat((n-o).toFixed(2));let l=js;return l+=`l${r},${o} ${-r},${a} ${-s},${-a} ${s},${-o}z`,l},Ry.calculateLocalPathAdditionalActions=function(){let t=this.scale;t<.001&&(t=.001);const[e,i]=this.localBox;this.pathDefinition=this.pathDefinition.replace(js,`m${-e/t},${-i/t}`),this.pathCalculatedOnce=!1,this.calculateLocalPath(this.pathDefinition,!0)};const Ey=function(t){return!!t&&(t.species="tetragon",new Tetragon(t))};J.Tetragon=Tetragon;const Iy="Ticker",Ticker=function(t=tr){return this.makeName(t.name),this.register(),this.subscribers=[],this.subscriberObjects=[],this.set(this.defs),this.set(t),this.cycleCount=0,this.active=!1,this.effectiveDuration=0,this.startTime=0,this.currentTime=0,this.tick=0,this.lastEvent=0,t.subscribers&&this.subscribe(t.subscribers),this.setEffectiveDuration(),this},By=Ticker.prototype=Sr();By.type=Iy,By.lib="animationtickers",By.isArtefact=!1,By.isAsset=!1,Co(By);By.defs=hr(By.defs,{order:1,duration:0,subscribers:null,killOnComplete:!1,cycles:1,eventChoke:0,observer:null,onRun:null,onHalt:null,onReverse:null,onResume:null,onSeekTo:null,onSeekFor:null,onComplete:null,onReset:null}),By.packetExclusions=dr(By.packetExclusions,["subscribers"]),By.packetFunctions=dr(By.packetFunctions,["onRun","onHalt","onReverse","onResume","onSeekTo","onSeekFor","onComplete","onReset"]),By.kill=function(){return this.active&&this.halt(),fr(My,this.name),Xy=!0,this.deregister(),!0},By.killTweens=function(t=!1){let e,i,n;for(e=0,i=this.subscribers.length;e<i;e++)n=E[this.subscribers[e]],n.completeAction(),n.kill();return t?(this.kill(),!0):this};const Ly=By.getters,$y=By.setters;Ly.subscribers=function(){return[].concat(this.subscribers)},$y.subscribers=function(t){this.subscribers=[],this.subscribe(t)},$y.order=function(t){this.order=t,this.active&&(Xy=!0)},$y.cycles=function(t){this.cycles=t,this.cycles||(this.cycleCount=0)},$y.duration=function(t){let e,i,n;const s=this.subscribers;if(this.duration=t,this.setEffectiveDuration(),pr(s))for(e=0,i=s.length;e<i;e++)n=E[s[e]],n&&(n.calculateEffectiveTime(),n.type===ps&&n.calculateEffectiveDuration())},By.subscribe=function(t){const e=Jr();let i,n,s,r;for(ut(t)?e.push(...t):e.push(t),i=0,n=e.length;i<n;i++)s=e[i],null!=s&&(r=s.substring?s:!(!lr(s)||!s.name)&&s.name,r&&dr(this.subscribers,r));return e.length&&(this.sortSubscribers(),this.recalculateEffectiveDuration()),to(e),this},By.unsubscribe=function(t){const e=Jr();let i,n,s,r;for(ut(t)?e.push(...t):e.push(t),i=0,n=e.length;i<n;i++)s=t[i],r=s.substring?s:!(!lr(s)||!s.name)&&s.name,r&&fr(this.subscribers,r);return e.length&&(this.sortSubscribers(),this.recalculateEffectiveDuration()),to(e),this},By.repopulateSubscriberObjects=function(){const t=this.subscriberObjects,e=this.subscribers;let i;t.length=0,e.forEach((e=>{i=E[e],i&&t.push(i)}))},By.getSubscriberObjects=function(){return this.subscribers.length&&!this.subscriberObjects.length&&this.repopulateSubscriberObjects(),this.subscriberObjects},By.sortSubscribers=function(){const t=this.subscribers,e=t.length;if(e>1){const i=Jr();let n,s,r,o;for(n=0;n<e;n++)r=t[n],o=ct(r.effectiveTime)||0,i[o]||(i[o]=Jr()),i[o].push(r);for(t.length=0,n=0,s=i.length;n<s;n++)r=i[n],r&&(t.push(...r),to(r));to(i)}this.repopulateSubscriberObjects()},By.updateSubscribers=function(t,e){e=!!pr(e)&&e;const i=this.getSubscriberObjects();let n,s;if(e)for(n=i.length-1;n>=0;n--)i[n].set(t);else for(n=0,s=i.length;n<s;n++)i[n].set(t);return this},By.changeSubscriberDirection=function(){return this.getSubscriberObjects().forEach((t=>t.reversed=!t.reversed)),this},By.makeTickerUpdateEvent=function(){return new CustomEvent("tickerupdate",{detail:{name:this.name,type:Iy,tick:this.tick,reverseTick:this.effectiveDuration-this.tick},bubbles:!0,cancelable:!0})},By.recalculateEffectiveDuration=function(){const t=this.getSubscriberObjects();let e,i=0;return this.duration?this.setEffectiveDuration():(t.forEach((t=>{e=t.getEndTime(),e>i&&(i=e)})),this.effectiveDuration=i),this},By.setEffectiveDuration=function(){let t;return this.duration&&(t=Zs(this.duration),t[0]===Vi?(this.duration=0,this.recalculateEffectiveDuration()):this.effectiveDuration=t[1]),this},By.checkObserverRunningState=function(){let t=this.observer;if(t){if(t.substring){const e=i[t];if(!e||e.type!==us)return!0;t=this.observer=e}if(t.type===us)return t.isRunning()}return!0},By.fn=function(t){t=!!pr(t)&&t;const e=Gy(),i=this.startTime,n=this.cycles,s=this.effectiveDuration,r=this.eventChoke;let o,a,l,c,h,u,d,f,p=this.active,g=this.cycleCount;if(p&&i&&(!n||g<n)){if(d=this.currentTime=mt(),f=this.tick=d-i,!n||g+1<n?(f>=s?(f=this.tick=0,this.startTime=this.currentTime,e.tick=s,e.reverseTick=0,e.willLoop=!0,n&&(g++,this.cycleCount=g)):(e.tick=f,e.reverseTick=s-f),e.next=!0):f>=s?(e.tick=s,e.reverseTick=0,p=this.active=!1,n&&(g++,this.cycleCount=g)):(e.tick=f,e.reverseTick=s-f,e.next=!0),l=this.getSubscriberObjects(),t)for(o=l.length-1;o>=0;o--)l[o].update(e);else for(o=0,a=l.length;o<a;o++)l[o].update(e);r&&(c=this.lastEvent+r,h=mt(),c<h&&(u=this.makeTickerUpdateEvent(),window.dispatchEvent(u),this.lastEvent=h)),p||this.halt(),this.killOnComplete&&g>=n&&this.killTweens(!0)}jy(e)},By.run=function(){return this.active||(this.startTime=this.currentTime=mt(),this.cycleCount=0,this.updateSubscribers({reversed:!1}),this.active=!0,dr(My,this.name),Xy=!0,typeof this.onRun===Qe&&this.onRun()),this},By.isRunning=function(){return this.active},By.reset=function(){return this.active&&this.halt(),this.startTime=this.currentTime=mt(),this.cycleCount=0,this.updateSubscribers({reversed:!1}),this.active=!0,this.fn(!0),this.active=!1,typeof this.onReset===Qe&&this.onReset(),this},By.complete=function(){return this.active&&this.halt(),this.startTime=this.currentTime=mt(),this.cycleCount=0,this.updateSubscribers({reversed:!0}),this.active=!0,this.fn(),this.active=!1,typeof this.onComplete===Qe&&this.onComplete(),this},By.reverse=function(t=!1){t=mr(t,!1),this.active&&this.halt();const e=this.currentTime-this.startTime;return this.startTime=this.currentTime-(this.effectiveDuration-e),this.changeSubscriberDirection(),this.active=!0,this.fn(),this.active=!1,typeof this.onReverse===Qe&&this.onReverse(),t&&this.resume(),this},By.halt=function(){return this.active=!1,fr(My,this.name),Xy=!0,typeof this.onHalt===Qe&&this.onHalt(),this},By.resume=function(){let t,e,i;return this.active||(t=mt(),e=this.currentTime,i=this.startTime,this.startTime=t-(e-i),this.currentTime=t,this.active=!0,dr(My,this.name),Xy=!0,typeof this.onResume===Qe&&this.onResume()),this},By.seekTo=function(t,e=!1){let i=!1;return t=mr(t,0),this.active&&this.halt(),this.cycles&&this.cycleCount>=this.cycles&&(this.cycleCount=this.cycles-1),t<this.tick&&(i=!0),this.currentTime=mt(),this.startTime=this.currentTime-t,this.active=!0,this.fn(i),this.active=!1,typeof this.onSeekTo===Qe&&this.onSeekTo(),e&&this.resume(),this},By.seekFor=function(t,e=!1){let i=!1;return t=mr(t,0),this.active&&this.halt(),this.cycles&&this.cycleCount>=this.cycles&&(this.cycleCount=this.cycles-1),this.startTime-=t,t<0&&(i=!0),this.active=!0,this.fn(i),this.active=!1,typeof this.onSeekFor===Qe&&this.onSeekFor(),e&&this.resume(),this};const My=[];let Xy=!0;vo({name:"SC-core-tickers-animation",order:0,fn:function(){let t,e,i,n,r,o;if(Xy){Xy=!1;const s=Jr();for(n=0,r=My.length;n<r;n++)e=My[n],e&&(i=ct(e.order)||0,s[i]||(s[i]=Jr()),s[i].push(e));for(My.length=0,n=0,r=s.length;n<r;n++)t=s[n],t&&(My.push(...t),to(t));to(s)}for(n=0,r=My.length;n<r;n++)o=My[n],e=s[o],e&&e.fn&&e.checkObserverRunningState()&&e.fn()}});const Yy=[],Gy=function(){return Yy.length||Yy.push({tick:0,reverseTick:0,willLoop:!1,next:!1}),Yy.shift()},jy=function(t){t&&(t.tick=0,t.reverseTick=0,t.willLoop=!1,t.next=!1,Yy.push(t))},zy=function(t){return!!t&&new Ticker(t)};J.Ticker=Ticker;const Tracer=function(t=tr){return this.makeName(t.name),this.register(),this.initializePositions(),this.set(this.defs),this.onEnter=qs,this.onLeave=qs,this.onDown=qs,this.onUp=qs,this.stampAction=qs,this.trace=Wd(t),t.group||(t.group=du),this.set(t),this.purge&&this.purgeArtefact(this.purge),this},Ny=Tracer.prototype=Sr();Ny.type="Tracer",Ny.lib=ze,Ny.isArtefact=!0,Ny.isAsset=!1,Co(Ny),Ju(Ny);const Vy={artefact:null,historyLength:1,hitRadius:10,showHitRadius:!1,hitRadiusColor:qt};Ny.defs=hr(Ny.defs,Vy),Ny.packetObjects=dr(Ny.packetObjects,["artefact","particle"]),Ny.packetFunctions=dr(Ny.packetFunctions,["stampAction"]),Ny.finalizePacketOut=function(t){return t},Ny.postCloneAction=function(t,e){return t.trace=Wd({name:t.name,historyLength:e.historyLength||this.historyLength||1}),t},Ny.factoryKill=function(t){t&&this.artefact.kill(),this.trace.kill()};const Wy=Ny.setters;Wy.stampAction=function(t){or(t)&&(this.stampAction=t)},Wy.artefact=function(t){let e;t.substring?e=o[t]:lr(t)&&t.isArtefact&&(e=t),e&&(this.artefact=e,this.dirtyFilterIdentifier=!0)},Ny.regularStamp=function(){const{artefact:t,trace:e,stampAction:i,showHitRadius:n,hitRadius:s,hitRadiusColor:r,currentStampPosition:o}=this,a=this.currentHost;if(e.set({position:o}),e.manageHistory(0,a),i.call(this,t,e,a),n){const t=a.engine;t.save(),t.lineWidth=1,t.strokeStyle=r,t.setTransform(1,0,0,1,0,0),t.beginPath(),t.arc(o[0],o[1],s,0,bt),t.stroke(),t.restore()}},Ny.checkHit=function(t=[]){if(this.noUserInteraction)return!1;const e=ut(t)?t:[t],i=this.currentStampPosition;let n,s,r=!1;if(e.some((t=>{if(ut(t))n=t[0],s=t[1];else{if(!gr(t,t.x,t.y))return!1;n=t.x,s=t.y}if(!dt(n)||!dt(s))return!1;const e=Hh(i).vectorSubtract(t);return e.getMagnitude()<this.hitRadius&&(r=!0),Eh(e),r}),this)){return this.checkHitReturn(n,s)}return!1};const Uy=function(t){return!!t&&new Tracer(t)};J.Tracer=Tracer;const Tween=function(t=tr){let e;return this.makeName(t.name),this.register(),this.set(this.defs),this.setObj=null,this.set(t),this.setDefinitionsValues(),this.status=-1,this.calculateEffectiveTime(),this.calculateEffectiveDuration(),s[t.ticker]?this.addToTicker(t.ticker):(e=`${this.name}_ticker`,zy({name:e,order:this.order,subscribers:this.name,duration:this.effectiveDuration,eventChoke:mr(t.eventChoke,0),cycles:mr(t.cycles,1),killOnComplete:mr(t.killOnComplete,!1),observer:t.observer}),this.ticker=e,s[e].recalculateEffectiveDuration()),this},Zy=Tween.prototype=Sr();Zy.type=ps,Zy.lib=Fs,Zy.isArtefact=!1,Zy.isAsset=!1,Co(Zy),_u(Zy);Zy.defs=hr(Zy.defs,{definitions:null,duration:0,killOnComplete:!1,commenceAction:null,onRun:null,onHalt:null,onResume:null,onReverse:null,onSeekTo:null,onSeekFor:null,completeAction:null}),Zy.packetExclusions=dr(Zy.packetExclusions,["definitions","targets"]),Zy.packetFunctions=dr(Zy.packetFunctions,["commenceAction","completeAction","onRun","onHalt","onResume","onReverse","onSeekTo","onSeekFor","action"]),Zy.finalizePacketOut=function(t){return ut(this.targets)&&(t.targets=this.targets.map((t=>t.name))),ut(this.definitions)&&(t.definitions=this.definitions.map((t=>{const e={};if(e.attribute=t.attribute,e.start=t.start,e.end=t.end,t.engine&&t.engine.substring)e.engine=t.engine.substring;else if(pr(t.engine)&&null!=t.engine){const i=this.stringifyFunction(t.engine);i&&(e.engine=i,e.engineIsFunction=!0)}return e}))),t},Zy.postCloneAction=function(t,e){if(e.useNewTicker){const i=s[this.ticker];pr(e.cycles)?t.cycles=e.cycles:t.cycles=i?i.cycles:1;const n=s[t.ticker];n.cycles=t.cycles,pr(e.duration)&&(t.duration=e.duration,t.calculateEffectiveDuration(),n&&n.recalculateEffectiveDuration())}return ut(t.definitions)&&t.definitions.forEach(((t,e)=>{t.engineIsFunction&&(t.engine=this.definitions[e].engine)})),t};const _y=Zy.getters,Ky=Zy.setters;_y.definitions=function(){return[].concat(this.definitions)},Ky.definitions=function(t){this.definitions=[].concat(t),this.setDefinitionsValues()},Ky.commenceAction=function(t){this.commenceAction=t,typeof this.commenceAction!=Qe&&(this.commenceAction=qs)},Ky.completeAction=function(t){this.completeAction=t,typeof this.completeAction!=Qe&&(this.completeAction=qs)},Zy.set=function(t=tr){const e=this.setters,i=ft(t),n=this.defs,s=!!pr(t.ticker)&&this.ticker;let r,o,a,l;for(o=0,a=i.length;o<a;o++)r=i[o],r!=Li&&(l=e[r],l?l.call(this,t[r]):typeof n[r]!=Ts&&(this[r]=t[r]));return s?(this.ticker=s,this.addToTicker(t.ticker)):yr(t.time,t.duration)&&(this.calculateEffectiveTime(),this.calculateEffectiveDuration()),this},Zy.getEndTime=function(){return this.effectiveTime+this.effectiveDuration},Zy.calculateEffectiveDuration=function(t){const e=mr(t,this.duration),i=Zs(e),n=i[1],r=i[0],o=this.ticker;let a,l=0;return this.effectiveDuration=0,r===Vi?o&&(a=s[o],a&&(l=a.effectiveDuration,this.effectiveDuration=l*(n/100))):this.effectiveDuration=n,this},Zy.update=function(t=tr){const e=t.tick||0,i=t.reverseTick||0,n=this.effectiveTime,s=this.effectiveDuration,r=this.reversed;let o,a,l=0;r?(o=n+s,a=n,i>o?l=1:i<a&&(l=-1)):(o=n,a=n+s,e<o?l=-1:e>a&&(l=1)),s?l&&l==this.status||(this.status=l,this.doSimpleUpdate(t),t.next||(this.status=r?-1:1)):l!=this.status&&(this.status=l,this.doSimpleUpdate(t),t.next||(this.status=r?-1:1)),t.willLoop&&(this.reverseOnCycleEnd?this.reversed=!r:this.status=-1)},Zy.doSimpleUpdate=function(t=tr){const e=this.effectiveTime,i=this.engineActions,n=this.effectiveDuration,s=this.status,r=this.definitions,o=this.targets,a=this.action,l=this.setObj||{};let c,h,u,d,f,p,g,m,y,b,S,k,C;const A=this.reversed?t.reverseTick-e:t.tick-e;for(C=n&&!s?A/n:s>0?1:0,y=0,b=r.length;y<b;y++)c=r[y],h=c.engine,d=c.effectiveStart,f=c.effectiveChange,p=c.integer,g=c.suffix,m=c.attribute,u=h.substring?i(h,d,f,C):h(d,f,C),p&&(u=vt(u)),g&&(u+=g),l[m]=u;for(S=0,k=o.length;S<k;S++){const t=o[S];Qn===t.type?t.setArtefacts(l):t.set(l)}this.setObj=l,a&&a()},Zy.engineActions=function(t,e,i,n){const s=null!=br[t]?t:mi;return e+i*br[s](n)},Zy.setDefinitionsValues=function(){const t=this.parseDefinitionsValue,e=this.definitions;let i,n,s,r;for(i=0,n=e.length;i<n;i++)r=e[i],r&&(s=t(r.start),r.effectiveStart=s[1],r.suffix=s[0],s=t(r.end),r.effectiveEnd=s[1],pr(r.engine)||(r.engine=mi),r.effectiveChange=r.effectiveEnd-r.effectiveStart);return this},Zy.parseDefinitionsValue=function(t){const e=[zs,0];if(pr(t))if(t.toFixed)e[1]=t;else if(t.substring){const i=t.match(/^-?\d+\.?\d*(\D*)/);pr(i[0])&&(e[1]=parseFloat(i)),pr(i[1])&&(e[0]=i[1])}return e},Zy.run=function(){const t=s[this.ticker];return t&&(this.commenceAction(),t.run(),typeof this.onRun===Qe&&this.onRun()),this},Zy.isRunning=function(){const t=s[this.ticker];return!!t&&t.isRunning()},Zy.halt=function(){const t=s[this.ticker];return t&&(t.halt(),typeof this.onHalt===Qe&&this.onHalt()),this},Zy.reverse=function(){const t=s[this.ticker];return t&&(t.reverse(),typeof this.onReverse===Qe&&this.onReverse()),this},Zy.resume=function(){const t=s[this.ticker];return t&&(t.resume(),typeof this.onResume===Qe&&this.onResume()),this},Zy.seekTo=function(t){const e=s[this.ticker];return e&&(e.seekTo(t),typeof this.onSeekTo===Qe&&this.onSeekTo()),this},Zy.seekFor=function(t){const e=s[this.ticker];return e&&(e.seekFor(t),typeof this.onSeekFor===Qe&&this.onSeekFor()),this};const qy=function(t){return!!t&&new Tween(t)};J.Tween=Tween;const Qy=(t,e)=>(t=parseFloat(t),ar(t)||(t=0),ar(e)||(e=0),parseFloat(t.toFixed(e))),Wheel=function(t=tr){return yr(t.dimensions,t.width,t.height,t.radius)||(t.radius=5),this.currentRadius=5,this.entityInit(t),this},Jy=Wheel.prototype=Sr();Jy.type="Wheel",Jy.lib=ze,Jy.isArtefact=!0,Jy.isAsset=!1,Co(Jy),Ju(Jy);Jy.defs=hr(Jy.defs,{radius:5,startAngle:0,endAngle:360,clockwise:!0,includeCenter:!1,closed:!0});const tb=Jy.setters,eb=Jy.deltaSetters;tb.width=function(t){if(null!=t){const e=this.dimensions;e[0]=e[1]=t,this.dimensionsHelper()}},eb.width=function(t){const e=this.dimensions;e[0]=e[1]=Ws(e[0],t),this.dimensionsHelper()},tb.height=function(t){if(null!=t){const e=this.dimensions;e[0]=e[1]=t,this.dimensionsHelper()}},eb.height=function(t){const e=this.dimensions;e[0]=e[1]=Ws(e[0],t),this.dimensionsHelper()},tb.dimensions=function(t,e){this.setCoordinateHelper(Te,t,e),this.dimensionsHelper()},eb.dimensions=function(t,e){this.setDeltaCoordinateHelper(Te,t,e),this.dimensionsHelper()},tb.radius=function(t){this.radius=t,this.radiusHelper()},eb.radius=function(t){this.radius=Ws(this.radius,t),this.radiusHelper()},tb.startAngle=function(t){this.startAngle=Qy(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},eb.startAngle=function(t){this.startAngle+=Qy(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},tb.endAngle=function(t){this.endAngle=Qy(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},eb.endAngle=function(t){this.endAngle+=Qy(t,4),this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0},tb.closed=function(t){pr(t)&&(this.closed=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},tb.includeCenter=function(t){pr(t)&&(this.includeCenter=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},tb.clockwise=function(t){pr(t)&&(this.clockwise=!!t,this.dirtyPathObject=!0,this.dirtyFilterIdentifier=!0)},Jy.dimensionsHelper=function(){const t=this.dimensions[0];t.substring?this.radius=parseFloat(t)/2+"%":this.radius=t/2,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},Jy.radiusHelper=function(){const t=this.radius,e=this.dimensions;t.substring?e[0]=e[1]=2*parseFloat(t)+Vi:e[0]=e[1]=2*t,this.dirtyDimensions=!0,this.dirtyFilterIdentifier=!0},Jy.cleanDimensionsAdditionalActions=function(){const t=this.radius,e=this.currentDimensions,i=t.substring?parseFloat(t)/100*e[0]:t;e[0]!==2*i?(e[1]=e[0],this.currentRadius=e[0]/2):this.currentRadius=i},Jy.cleanPathObject=function(){if(this.dirtyPathObject=!1,!this.noPathUpdates||!this.pathObject){const t=this.pathObject=new Path2D,e=this.currentStampHandlePosition,i=this.currentScale,n=this.currentRadius*i,s=n-e[0]*i,r=n-e[1]*i,o=this.startAngle*Ct,a=this.endAngle*Ct;t.arc(s,r,n,o,a,!this.clockwise),this.includeCenter?(t.lineTo(s,r),t.closePath()):this.closed&&t.closePath()}};const ib=function(t){return!!t&&new Wheel(t)};J.Wheel=Wheel;const World=function(t=tr){this.makeName(t.name),this.register(),this.set(this.defs);const e=t.keytypes||{};return e.gravity||(e.gravity=gs),t.gravity||(t.gravity=[0,9.81,0]),t.userAttributes&&t.userAttributes.forEach((t=>{this.addAttribute(t),t.type&&(e[t.key]=t.type)})),this.initializeAttributes(e),this.set(t),this},nb=World.prototype=Sr();nb.type=ys,nb.lib="world",nb.isArtefact=!1,nb.isAsset=!1,Co(nb);nb.defs=hr(nb.defs,{gravity:null,tickMultiplier:1,keytypes:null}),nb.kill=function(){return this.deregister(),!0};const sb=nb.getters,rb=nb.setters,ob=nb.deltaSetters;rb.gravityX=function(t){this.gravity&&pr(t)&&this.gravity.setX(t)},rb.gravityY=function(t){this.gravity&&pr(t)&&this.gravity.setY(t)},rb.gravityZ=function(t){this.gravity&&pr(t)&&this.gravity.setZ(t)},rb.gravity=function(t){this.gravity&&pr(t)&&this.gravity.set(t)},nb.addAttribute=function(t=tr){const{key:e,defaultValue:i,setter:n,deltaSetter:s,getter:r}=t;return e&&e.substring&&(this.defs[e]=pr(i)?i:null,this[e]=pr(i)?i:null,or(n)&&(rb[e]=n),or(s)&&(ob[e]=s),or(r)&&(sb[e]=r)),this},nb.removeAttribute=function(t){return t&&t.substring&&(delete this.defs[t],delete this[t],delete sb[t],delete rb[t],delete ob[t]),this},nb.initializeAttributes=function(t){for(const[e,i]of lt(t))switch(i){case ls:this[e]=Yh();break;case gs:this[e]=Ih();break;case _n:this[e]=qa()}};const ab=function(t){return!!t&&new World(t)};J.World=World;const lb={},cb=function(t=tr){const e=(t=tr)=>{if(t&&t.target){let e=t.target,n="";for(;!n&&(lb[e.id]&&(n=e.id),e.tagName!==Ft);)e=e.parentElement;const r=lb[n];if(r)for(let e=0,n=r.length;e<n;e++){const n=r[e].pickup(t);if(n.current){i=n.move,s=n.drop;break}}}};let i=qs;const n=(t=tr)=>{i(t)};let s=qs;const r=(t=tr)=>{s(t),i=qs,s=qs},a=function(t=tr,e,i){let{zone:n,coordinateSource:s,collisionGroup:r,startOn:a,endOn:l,updateOnStart:c,updateOnEnd:h,updateWhileMoving:u,updateOnShiftStart:d,updateOnShiftEnd:f,updateWhileShiftMoving:p,updateOnPrematureExit:g,exposeCurrentArtefact:m,preventTouchDefaultWhenDragging:y,resetCoordsToZeroOnTouchEnd:b,processingOrder:S}=t;if(!n)return new Error("dragZone constructor - no zone supplied");if(n.substring&&(n=o[n]),!n||!It.includes(n.type))return new Error("dragZone constructor - zone object is not a Stack or Canvas wrapper");const k=n.domElement;if(!k)return new Error("dragZone constructor - zone does not contain a target DOM element");if(r?r.substring&&(r=A[r]):r=n.type===Wn?A[n.base.name]:A[n.name],!r||r.type!==Qn)return new Error("dragZone constructor - unable to recover collisionGroup group");if(s?s.here?s=s.here:gr(s.x,s.y)||(s=!1):s=n.type===Wn?n.base.here:n.here,!s)return new Error("dragZone constructor - unable to discover a usable coordinateSource object");ut(a)||(a=[Le]),ut(l)||(l=[Es]),null==m&&(m=!1),null==y&&(y=!1),null==b&&(b=!0),lr(c)&&(c=function(){C.artefact.set(t.updateOnStart)}),or(c)||(c=qs),lr(d)&&(d=function(){C.artefact.set(t.updateOnShiftStart)}),or(d)||(d=c),lr(h)&&(h=function(){C.artefact.set(t.updateOnEnd)}),or(h)||(h=qs),lr(f)&&(f=function(){C.artefact.set(t.updateOnShiftEnd)}),or(f)||(f=h),or(u)||(u=qs),or(p)||(p=u),or(g)||(g=qs),nr(m)||(m=!1),null==S&&(S=0);let C=!1;const v=function(t){t&&t.cancelable&&(y&&C?(t.preventDefault(),t.returnValue=!1):y||(t.preventDefault(),t.returnValue=!1))},P=function(t=tr){C&&(v(t),t.type===Os&&Zo(t),t.shiftKey?p(t):u(t))},x=function(t=tr){C&&(v(t),t.type===xs&&Zo(t,b),C.artefact.dropArtefact(),t.shiftKey?f(t):h(t),C=!1)};lb[n.name]||(lb[n.name]=[],e(a,l,k));const O=function(){const t=`${n.name}_${r.name}_${S}`;lb[n.name]=lb[n.name].filter((e=>e.name!==t)),lb[n.name].length||(i(a,l,k),delete lb[n.name])},w=function(t){if(!t)return C;"exit"===t||"drop"===t?(x(),g()):O()},D={name:`${n.name}_${r.name}_${S}`,exposeCurrentArtefact:m,target:k,processingOrder:S,pickup:function(t=tr){v(t);const e=t.type;return e!==ws&&e!==Ps||Zo(t,b),C=r.getArtefactAt(s),C&&(C.artefact.pickupArtefact(s),t.shiftKey?d(t):c(t)),{current:C,move:P,drop:x}},move:P,drop:x,kill:O,getCurrent:w};return lb[n.name].push(D),lb[n.name].sort(((t,e)=>t.processingOrder-e.processingOrder)),{exposeCurrentArtefact:m,getCurrent:w,kill:O,zone:n}}(t,((t,i,s)=>{ho(t,e,s),ho(Ei,n,s),ho(i,r,s)}),((t,i,s)=>{uo(t,e,s),uo(Ei,n,s),uo(i,r,s)}));return a.exposeCurrentArtefact?a.getCurrent:a.kill},hb="keydown",ub="keyup",db=["none","shiftOnly","altOnly","ctrlOnly","metaOnly","shiftAlt","shiftCtrl","shiftMeta","altCtrl","altMeta","ctrlMeta","shiftAltCtrl","shiftAltMeta","shiftCtrlMeta","altCtrlMeta","all"],fb={},pb=function(t=tr){const e=(t=tr)=>{if(t&&t.target){let e=t.target,n="";for(;!n&&(fb[e.id]&&(n=e.id),e.tagName!==Ft);)e=e.parentElement;const s=fb[n];s?(s.onKeyDown(t),i=s.onKeyUp):i=qs}};let i=qs;const n=t=>{i(t)};return function(t=tr,e,i){let n=t.zone;if(!n)return new Error("keyboardZone constructor - no zone supplied");if(n.substring&&(n=o[n]),!n||!It.includes(n.type))return new Error("keyboardZone constructor - zone object is not a Stack or Canvas wrapper");const s=n.domElement;if(!s)return new Error("keyboardZone constructor - zone does not contain a target DOM element");let r=fb[n.name];if(r||(fb[n.name]={},r=fb[n.name],e(s)),r.extraKeys||(r.extraKeys={Shift:!1,Control:!1,Alt:!1,Meta:!1}),!r.keyGroups){const t={};db.forEach((e=>t[e]={})),r.keyGroups=t}const a=r.keyGroups;return db.forEach((e=>{const i=t[e];null!=i&&ur(a[e],i)})),r.onKeyDown||(r.onKeyDown=(t=tr)=>{if(t&&t.key){t.preventDefault();const{extraKeys:e,keyGroups:i}=r,{key:n}=t;if("Tab"===n||"Escape"===n)return void s.blur();if(null!=e[n])return void(e[n]=!0);const{Shift:o,Control:a,Alt:l,Meta:c}=e;let h=i.none;(o||a||l||c)&&(h=o?l?a?c?i.all:i.shiftAltCtrl:c?i.shiftAltMeta:i.shiftAlt:a?c?i.shiftCtrlMeta:i.shiftCtrl:c?i.shiftMeta:i.shiftOnly:l?a?c?i.altCtrlMeta:i.altCtrl:c?i.altMeta:i.altOnly:a?c?i.ctrlMeta:i.ctrlOnly:c?i.altOnly:i.none),h[n]&&h[n]()}}),r.onKeyUp||(r.onKeyUp=(t=tr)=>{if(t&&t.key){t.preventDefault();const e=r.extraKeys,i=t.key;null!=e[i]&&(e[i]=!1)}}),r.kill||(r.kill=function(){delete fb[n.name],i(s)}),{kill:r.kill,getMappedKeys:(t=Yi)=>null!=r.keyGroups[t]?ft(r.keyGroups[t]):[]}}(t,(t=>{mo(hb,e,t),mo(ub,n,t)}),(t=>{yo(hb,e,t),yo(ub,n,t)}))},gb=function(t=tr){if(!gr(t.event,t.origin,t.updates))return!1;const e=t.target.substring&&t.targetLibrarySection?tt[t.targetLibrarySection][t.target]:t.target;if(!e)return!1;const i=t.event,n=t.origin,s=t.useNativeListener?mo:ho,r=t.useNativeListener?yo:uo;let o=qs;t.preventDefault&&(o=t=>{t.preventDefault(),t.returnValue=!1});const a=or(t.setup)?t.setup:qs,l=or(t.callback)?t.callback:qs,c=function(i){o(i);const n=!(!i||!i.target)&&i.target.id;if(n){const s=t.updates[n];if(s){a();const t=s[0],n=s[1],r=i.target.value;let o,c=!0;switch(n){case"float":o=parseFloat(r);break;case"int":o=parseInt(r,10);break;case"round":o=vt(r);break;case"roundDown":o=ct(r);break;case"roundUp":o=st(r);break;case"raw":o=r;break;case"parse":o=r.substring?JSON.parse(r):r;break;case"string":o=`${r}`;break;case"boolean":o=!!pr(r)&&(r.substring?Ds===r.toLowerCase()||"false"!==r.toLowerCase()&&!!parseFloat(r):!!r);break;default:n.substring?o=`${parseFloat(r)}${n}`:c=!1}c&&(e.type===Qn?e.setArtefacts({[t]:o}):e.set({[t]:o}),l(i))}}};return s(i,c,n),function(){r(i,c,n)}},mb=(t=tr)=>gb(t),yb=Ru;"undefined"!=typeof window&&Ru();export{gu as addCanvas,ho as addListener,mo as addNativeListener,Du as addStack,X as checkFontIsLoaded,Eu as clear,Iu as compile,Ac as createImageFromCell,Pc as createImageFromEntity,vc as createImageFromGroup,wo as currentCorePosition,G as findArtefact,j as findAsset,N as findCanvas,Z as findCell,Q as findElement,z as findEntity,_ as findFilter,K as findGroup,U as findPattern,q as findStack,V as findStyles,W as findTween,Zr as forceUpdate,uu as getCanvas,Y as getFontMetadata,Lo as getIgnorePixelRatio,lc as getLastUsedReducePalette,Io as getPixelRatio,Fu as getStack,Wo as getTouchActionChoke,Cc as importDomImage,Wg as importDomVideo,kc as importImage,Ug as importMediaStream,Zg as importScreenCapture,Qg as importSprite,_g as importVideo,yb as init,tt as library,Qu as makeAction,vo as makeAnimation,co as makeAnimationObserver,bd as makeBezier,ed as makeBlock,Pd as makeCog,Yl as makeColor,Hd as makeConicGradient,Ld as makeCrescent,cb as makeDragZone,bu as makeElement,ef as makeEmitter,Zf as makeEnhancedLabel,bp as makeFilter,kp as makeForce,hp as makeGradient,Rp as makeGrid,Tc as makeGroup,pb as makeKeyboardZone,Lp as makeLabel,Mp as makeLine,jp as makeLineSpiral,Zp as makeLoom,Jp as makeMesh,mg as makeNet,$g as makeNoise,Lg as makeNoiseAsset,Gg as makeOval,im as makePattern,cm as makePicture,fm as makePolygon,bm as makePolyline,Pm as makeQuadratic,Fm as makeRadialGradient,Im as makeRawAsset,Ym as makeReactionDiffusionAsset,yy as makeRectangle,Mu as makeRender,Sy as makeShape,zu as makeSnippet,xy as makeSpiral,ig as makeSpring,Fy as makeStar,Ey as makeTetragon,zy as makeTicker,Uy as makeTracer,qy as makeTween,mb as makeUpdater,ib as makeWheel,ab as makeWorld,gb as observeAndUpdate,M as purge,ia as purgeFontMetadata,la as recalculateFonts,Ka as releaseCoordinate,Xh as releaseQuaternion,Eh as releaseVector,uo as removeListener,yo as removeNativeListener,Lu as render,_a as requestCoordinate,Mh as requestQuaternion,Hh as requestVector,xa as seededRandomNumberGenerator,pu as setCurrentCanvas,Ra as setFilterMemoizationChoke,$o as setIgnorePixelRatio,Xo as setPixelRatioChangeAction,Uo as setTouchActionChoke,Fa as setWorkstoreLifetimeLength,$a as setWorkstorePurgeChoke,Bu as show,ao as startCoreAnimationLoop,Qo as startCoreListeners,lo as stopCoreAnimationLoop,Jo as stopCoreListeners};
